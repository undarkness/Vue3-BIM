{
  "version": 3,
  "sources": ["browser-external:canvas", "browser-external:http", "browser-external:https", "browser-external:url", "browser-external:zlib", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/webpack/universalModuleDefinition", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/shared/util.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/api.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/annotation_storage.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/editor/editor.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/editor/tools.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/display_utils.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/base_factory.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/shared/murmurhash3.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/font_loader.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/shared/is_node.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/canvas.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/pattern_helper.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/shared/image_utils.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/worker_options.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/shared/message_handler.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/metadata.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/optional_content_config.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/transport_stream.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/xfa_text.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/node_utils.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/node_stream.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/network_utils.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/content_disposition.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/network.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/fetch_stream.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/text_layer.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/editor/annotation_editor_layer.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/editor/freetext.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/annotation_layer.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/shared/scripting_utils.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/xfa_layer.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/web/l10n_utils.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/editor/ink.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/display/svg.js", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/webpack/bootstrap", "../../.pnpm/pdfjs-dist@3.8.162/node_modules/pdfjs-dist/build/webpack:/pdfjs-dist/build/pdf/src/pdf.js"],
  "sourcesContent": ["module.exports = Object.create(new Proxy({}, {\n  get(_, key) {\n    if (\n      key !== '__esModule' &&\n      key !== '__proto__' &&\n      key !== 'constructor' &&\n      key !== 'splice'\n    ) {\n      console.warn(`Module \"canvas\" has been externalized for browser compatibility. Cannot access \"canvas.${key}\" in client code. See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)\n    }\n  }\n}))", "module.exports = Object.create(new Proxy({}, {\n  get(_, key) {\n    if (\n      key !== '__esModule' &&\n      key !== '__proto__' &&\n      key !== 'constructor' &&\n      key !== 'splice'\n    ) {\n      console.warn(`Module \"http\" has been externalized for browser compatibility. Cannot access \"http.${key}\" in client code. See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)\n    }\n  }\n}))", "module.exports = Object.create(new Proxy({}, {\n  get(_, key) {\n    if (\n      key !== '__esModule' &&\n      key !== '__proto__' &&\n      key !== 'constructor' &&\n      key !== 'splice'\n    ) {\n      console.warn(`Module \"https\" has been externalized for browser compatibility. Cannot access \"https.${key}\" in client code. See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)\n    }\n  }\n}))", "module.exports = Object.create(new Proxy({}, {\n  get(_, key) {\n    if (\n      key !== '__esModule' &&\n      key !== '__proto__' &&\n      key !== 'constructor' &&\n      key !== 'splice'\n    ) {\n      console.warn(`Module \"url\" has been externalized for browser compatibility. Cannot access \"url.${key}\" in client code. See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)\n    }\n  }\n}))", "module.exports = Object.create(new Proxy({}, {\n  get(_, key) {\n    if (\n      key !== '__esModule' &&\n      key !== '__proto__' &&\n      key !== 'constructor' &&\n      key !== 'splice'\n    ) {\n      console.warn(`Module \"zlib\" has been externalized for browser compatibility. Cannot access \"zlib.${key}\" in client code. See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)\n    }\n  }\n}))", "(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"pdfjs-dist/build/pdf\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pdfjs-dist/build/pdf\"] = factory();\n\telse\n\t\troot[\"pdfjs-dist/build/pdf\"] = factory();\n})(globalThis, () => {\nreturn ", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Skip compatibility checks for modern builds and if we already ran the module.\nif (\n  typeof PDFJSDev !== \"undefined\" &&\n  !PDFJSDev.test(\"SKIP_BABEL\") &&\n  !globalThis._pdfjsCompatibilityChecked\n) {\n  globalThis._pdfjsCompatibilityChecked = true;\n  require(\"./compatibility.js\");\n}\n\nconst IDENTITY_MATRIX = [1, 0, 0, 1, 0, 0];\nconst FONT_IDENTITY_MATRIX = [0.001, 0, 0, 0.001, 0, 0];\n\nconst MAX_IMAGE_SIZE_TO_CACHE = 10e6; // Ten megabytes.\n\n// Represent the percentage of the height of a single-line field over\n// the font size. Acrobat seems to use this value.\nconst LINE_FACTOR = 1.35;\nconst LINE_DESCENT_FACTOR = 0.35;\nconst BASELINE_FACTOR = LINE_DESCENT_FACTOR / LINE_FACTOR;\n\n/**\n * Refer to the `WorkerTransport.getRenderingIntent`-method in the API, to see\n * how these flags are being used:\n *  - ANY, DISPLAY, and PRINT are the normal rendering intents, note the\n *    `PDFPageProxy.{render, getOperatorList, getAnnotations}`-methods.\n *  - ANNOTATIONS_FORMS, ANNOTATIONS_STORAGE, ANNOTATIONS_DISABLE control which\n *    annotations are rendered onto the canvas (i.e. by being included in the\n *    operatorList), note the `PDFPageProxy.{render, getOperatorList}`-methods\n *    and their `annotationMode`-option.\n *  - OPLIST is used with the `PDFPageProxy.getOperatorList`-method, note the\n *    `OperatorList`-constructor (on the worker-thread).\n */\nconst RenderingIntentFlag = {\n  ANY: 0x01,\n  DISPLAY: 0x02,\n  PRINT: 0x04,\n  SAVE: 0x08,\n  ANNOTATIONS_FORMS: 0x10,\n  ANNOTATIONS_STORAGE: 0x20,\n  ANNOTATIONS_DISABLE: 0x40,\n  OPLIST: 0x100,\n};\n\nconst AnnotationMode = {\n  DISABLE: 0,\n  ENABLE: 1,\n  ENABLE_FORMS: 2,\n  ENABLE_STORAGE: 3,\n};\n\nconst AnnotationEditorPrefix = \"pdfjs_internal_editor_\";\n\nconst AnnotationEditorType = {\n  DISABLE: -1,\n  NONE: 0,\n  FREETEXT: 3,\n  STAMP: 13,\n  INK: 15,\n};\n\nconst AnnotationEditorParamsType = {\n  FREETEXT_SIZE: 1,\n  FREETEXT_COLOR: 2,\n  FREETEXT_OPACITY: 3,\n  INK_COLOR: 11,\n  INK_THICKNESS: 12,\n  INK_OPACITY: 13,\n};\n\n// Permission flags from Table 22, Section 7.6.3.2 of the PDF specification.\nconst PermissionFlag = {\n  PRINT: 0x04,\n  MODIFY_CONTENTS: 0x08,\n  COPY: 0x10,\n  MODIFY_ANNOTATIONS: 0x20,\n  FILL_INTERACTIVE_FORMS: 0x100,\n  COPY_FOR_ACCESSIBILITY: 0x200,\n  ASSEMBLE: 0x400,\n  PRINT_HIGH_QUALITY: 0x800,\n};\n\nconst TextRenderingMode = {\n  FILL: 0,\n  STROKE: 1,\n  FILL_STROKE: 2,\n  INVISIBLE: 3,\n  FILL_ADD_TO_PATH: 4,\n  STROKE_ADD_TO_PATH: 5,\n  FILL_STROKE_ADD_TO_PATH: 6,\n  ADD_TO_PATH: 7,\n  FILL_STROKE_MASK: 3,\n  ADD_TO_PATH_FLAG: 4,\n};\n\nconst ImageKind = {\n  GRAYSCALE_1BPP: 1,\n  RGB_24BPP: 2,\n  RGBA_32BPP: 3,\n};\n\nconst AnnotationType = {\n  TEXT: 1,\n  LINK: 2,\n  FREETEXT: 3,\n  LINE: 4,\n  SQUARE: 5,\n  CIRCLE: 6,\n  POLYGON: 7,\n  POLYLINE: 8,\n  HIGHLIGHT: 9,\n  UNDERLINE: 10,\n  SQUIGGLY: 11,\n  STRIKEOUT: 12,\n  STAMP: 13,\n  CARET: 14,\n  INK: 15,\n  POPUP: 16,\n  FILEATTACHMENT: 17,\n  SOUND: 18,\n  MOVIE: 19,\n  WIDGET: 20,\n  SCREEN: 21,\n  PRINTERMARK: 22,\n  TRAPNET: 23,\n  WATERMARK: 24,\n  THREED: 25,\n  REDACT: 26,\n};\n\nconst AnnotationReplyType = {\n  GROUP: \"Group\",\n  REPLY: \"R\",\n};\n\nconst AnnotationFlag = {\n  INVISIBLE: 0x01,\n  HIDDEN: 0x02,\n  PRINT: 0x04,\n  NOZOOM: 0x08,\n  NOROTATE: 0x10,\n  NOVIEW: 0x20,\n  READONLY: 0x40,\n  LOCKED: 0x80,\n  TOGGLENOVIEW: 0x100,\n  LOCKEDCONTENTS: 0x200,\n};\n\nconst AnnotationFieldFlag = {\n  READONLY: 0x0000001,\n  REQUIRED: 0x0000002,\n  NOEXPORT: 0x0000004,\n  MULTILINE: 0x0001000,\n  PASSWORD: 0x0002000,\n  NOTOGGLETOOFF: 0x0004000,\n  RADIO: 0x0008000,\n  PUSHBUTTON: 0x0010000,\n  COMBO: 0x0020000,\n  EDIT: 0x0040000,\n  SORT: 0x0080000,\n  FILESELECT: 0x0100000,\n  MULTISELECT: 0x0200000,\n  DONOTSPELLCHECK: 0x0400000,\n  DONOTSCROLL: 0x0800000,\n  COMB: 0x1000000,\n  RICHTEXT: 0x2000000,\n  RADIOSINUNISON: 0x2000000,\n  COMMITONSELCHANGE: 0x4000000,\n};\n\nconst AnnotationBorderStyleType = {\n  SOLID: 1,\n  DASHED: 2,\n  BEVELED: 3,\n  INSET: 4,\n  UNDERLINE: 5,\n};\n\nconst AnnotationActionEventType = {\n  E: \"Mouse Enter\",\n  X: \"Mouse Exit\",\n  D: \"Mouse Down\",\n  U: \"Mouse Up\",\n  Fo: \"Focus\",\n  Bl: \"Blur\",\n  PO: \"PageOpen\",\n  PC: \"PageClose\",\n  PV: \"PageVisible\",\n  PI: \"PageInvisible\",\n  K: \"Keystroke\",\n  F: \"Format\",\n  V: \"Validate\",\n  C: \"Calculate\",\n};\n\nconst DocumentActionEventType = {\n  WC: \"WillClose\",\n  WS: \"WillSave\",\n  DS: \"DidSave\",\n  WP: \"WillPrint\",\n  DP: \"DidPrint\",\n};\n\nconst PageActionEventType = {\n  O: \"PageOpen\",\n  C: \"PageClose\",\n};\n\nconst VerbosityLevel = {\n  ERRORS: 0,\n  WARNINGS: 1,\n  INFOS: 5,\n};\n\nconst CMapCompressionType = {\n  NONE: 0,\n  BINARY: 1,\n};\n\n// All the possible operations for an operator list.\nconst OPS = {\n  // Intentionally start from 1 so it is easy to spot bad operators that will be\n  // 0's.\n  // PLEASE NOTE: We purposely keep any removed operators commented out, since\n  //              re-numbering the list would risk breaking third-party users.\n  dependency: 1,\n  setLineWidth: 2,\n  setLineCap: 3,\n  setLineJoin: 4,\n  setMiterLimit: 5,\n  setDash: 6,\n  setRenderingIntent: 7,\n  setFlatness: 8,\n  setGState: 9,\n  save: 10,\n  restore: 11,\n  transform: 12,\n  moveTo: 13,\n  lineTo: 14,\n  curveTo: 15,\n  curveTo2: 16,\n  curveTo3: 17,\n  closePath: 18,\n  rectangle: 19,\n  stroke: 20,\n  closeStroke: 21,\n  fill: 22,\n  eoFill: 23,\n  fillStroke: 24,\n  eoFillStroke: 25,\n  closeFillStroke: 26,\n  closeEOFillStroke: 27,\n  endPath: 28,\n  clip: 29,\n  eoClip: 30,\n  beginText: 31,\n  endText: 32,\n  setCharSpacing: 33,\n  setWordSpacing: 34,\n  setHScale: 35,\n  setLeading: 36,\n  setFont: 37,\n  setTextRenderingMode: 38,\n  setTextRise: 39,\n  moveText: 40,\n  setLeadingMoveText: 41,\n  setTextMatrix: 42,\n  nextLine: 43,\n  showText: 44,\n  showSpacedText: 45,\n  nextLineShowText: 46,\n  nextLineSetSpacingShowText: 47,\n  setCharWidth: 48,\n  setCharWidthAndBounds: 49,\n  setStrokeColorSpace: 50,\n  setFillColorSpace: 51,\n  setStrokeColor: 52,\n  setStrokeColorN: 53,\n  setFillColor: 54,\n  setFillColorN: 55,\n  setStrokeGray: 56,\n  setFillGray: 57,\n  setStrokeRGBColor: 58,\n  setFillRGBColor: 59,\n  setStrokeCMYKColor: 60,\n  setFillCMYKColor: 61,\n  shadingFill: 62,\n  beginInlineImage: 63,\n  beginImageData: 64,\n  endInlineImage: 65,\n  paintXObject: 66,\n  markPoint: 67,\n  markPointProps: 68,\n  beginMarkedContent: 69,\n  beginMarkedContentProps: 70,\n  endMarkedContent: 71,\n  beginCompat: 72,\n  endCompat: 73,\n  paintFormXObjectBegin: 74,\n  paintFormXObjectEnd: 75,\n  beginGroup: 76,\n  endGroup: 77,\n  // beginAnnotations: 78,\n  // endAnnotations: 79,\n  beginAnnotation: 80,\n  endAnnotation: 81,\n  // paintJpegXObject: 82,\n  paintImageMaskXObject: 83,\n  paintImageMaskXObjectGroup: 84,\n  paintImageXObject: 85,\n  paintInlineImageXObject: 86,\n  paintInlineImageXObjectGroup: 87,\n  paintImageXObjectRepeat: 88,\n  paintImageMaskXObjectRepeat: 89,\n  paintSolidColorImageMask: 90,\n  constructPath: 91,\n};\n\nconst PasswordResponses = {\n  NEED_PASSWORD: 1,\n  INCORRECT_PASSWORD: 2,\n};\n\nlet verbosity = VerbosityLevel.WARNINGS;\n\nfunction setVerbosityLevel(level) {\n  if (Number.isInteger(level)) {\n    verbosity = level;\n  }\n}\n\nfunction getVerbosityLevel() {\n  return verbosity;\n}\n\n// A notice for devs. These are good for things that are helpful to devs, such\n// as warning that Workers were disabled, which is important to devs but not\n// end users.\nfunction info(msg) {\n  if (verbosity >= VerbosityLevel.INFOS) {\n    console.log(`Info: ${msg}`);\n  }\n}\n\n// Non-fatal warnings.\nfunction warn(msg) {\n  if (verbosity >= VerbosityLevel.WARNINGS) {\n    console.log(`Warning: ${msg}`);\n  }\n}\n\nfunction unreachable(msg) {\n  throw new Error(msg);\n}\n\nfunction assert(cond, msg) {\n  if (!cond) {\n    unreachable(msg);\n  }\n}\n\n// Checks if URLs use one of the allowed protocols, e.g. to avoid XSS.\nfunction _isValidProtocol(url) {\n  switch (url?.protocol) {\n    case \"http:\":\n    case \"https:\":\n    case \"ftp:\":\n    case \"mailto:\":\n    case \"tel:\":\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Attempts to create a valid absolute URL.\n *\n * @param {URL|string} url - An absolute, or relative, URL.\n * @param {URL|string} [baseUrl] - An absolute URL.\n * @param {Object} [options]\n * @returns Either a valid {URL}, or `null` otherwise.\n */\nfunction createValidAbsoluteUrl(url, baseUrl = null, options = null) {\n  if (!url) {\n    return null;\n  }\n  try {\n    if (options && typeof url === \"string\") {\n      // Let URLs beginning with \"www.\" default to using the \"http://\" protocol.\n      if (options.addDefaultProtocol && url.startsWith(\"www.\")) {\n        const dots = url.match(/\\./g);\n        // Avoid accidentally matching a *relative* URL pointing to a file named\n        // e.g. \"www.pdf\" or similar.\n        if (dots?.length >= 2) {\n          url = `http://${url}`;\n        }\n      }\n\n      // According to ISO 32000-1:2008, section 12.6.4.7, URIs should be encoded\n      // in 7-bit ASCII. Some bad PDFs use UTF-8 encoding; see bug 1122280.\n      if (options.tryConvertEncoding) {\n        try {\n          url = stringToUTF8String(url);\n        } catch {}\n      }\n    }\n\n    const absoluteUrl = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    if (_isValidProtocol(absoluteUrl)) {\n      return absoluteUrl;\n    }\n  } catch {\n    /* `new URL()` will throw on incorrect data. */\n  }\n  return null;\n}\n\nfunction shadow(obj, prop, value, nonSerializable = false) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    assert(\n      prop in obj,\n      `shadow: Property \"${prop && prop.toString()}\" not found in object.`\n    );\n  }\n  Object.defineProperty(obj, prop, {\n    value,\n    enumerable: !nonSerializable,\n    configurable: true,\n    writable: false,\n  });\n  return value;\n}\n\n/**\n * @type {any}\n */\nconst BaseException = (function BaseExceptionClosure() {\n  // eslint-disable-next-line no-shadow\n  function BaseException(message, name) {\n    if (this.constructor === BaseException) {\n      unreachable(\"Cannot initialize BaseException.\");\n    }\n    this.message = message;\n    this.name = name;\n  }\n  BaseException.prototype = new Error();\n  BaseException.constructor = BaseException;\n\n  return BaseException;\n})();\n\nclass PasswordException extends BaseException {\n  constructor(msg, code) {\n    super(msg, \"PasswordException\");\n    this.code = code;\n  }\n}\n\nclass UnknownErrorException extends BaseException {\n  constructor(msg, details) {\n    super(msg, \"UnknownErrorException\");\n    this.details = details;\n  }\n}\n\nclass InvalidPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"InvalidPDFException\");\n  }\n}\n\nclass MissingPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"MissingPDFException\");\n  }\n}\n\nclass UnexpectedResponseException extends BaseException {\n  constructor(msg, status) {\n    super(msg, \"UnexpectedResponseException\");\n    this.status = status;\n  }\n}\n\n/**\n * Error caused during parsing PDF data.\n */\nclass FormatError extends BaseException {\n  constructor(msg) {\n    super(msg, \"FormatError\");\n  }\n}\n\n/**\n * Error used to indicate task cancellation.\n */\nclass AbortException extends BaseException {\n  constructor(msg) {\n    super(msg, \"AbortException\");\n  }\n}\n\nfunction bytesToString(bytes) {\n  if (typeof bytes !== \"object\" || bytes?.length === undefined) {\n    unreachable(\"Invalid argument for bytesToString\");\n  }\n  const length = bytes.length;\n  const MAX_ARGUMENT_COUNT = 8192;\n  if (length < MAX_ARGUMENT_COUNT) {\n    return String.fromCharCode.apply(null, bytes);\n  }\n  const strBuf = [];\n  for (let i = 0; i < length; i += MAX_ARGUMENT_COUNT) {\n    const chunkEnd = Math.min(i + MAX_ARGUMENT_COUNT, length);\n    const chunk = bytes.subarray(i, chunkEnd);\n    strBuf.push(String.fromCharCode.apply(null, chunk));\n  }\n  return strBuf.join(\"\");\n}\n\nfunction stringToBytes(str) {\n  if (typeof str !== \"string\") {\n    unreachable(\"Invalid argument for stringToBytes\");\n  }\n  const length = str.length;\n  const bytes = new Uint8Array(length);\n  for (let i = 0; i < length; ++i) {\n    bytes[i] = str.charCodeAt(i) & 0xff;\n  }\n  return bytes;\n}\n\nfunction string32(value) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    assert(\n      typeof value === \"number\" && Math.abs(value) < 2 ** 32,\n      `string32: Unexpected input \"${value}\".`\n    );\n  }\n  return String.fromCharCode(\n    (value >> 24) & 0xff,\n    (value >> 16) & 0xff,\n    (value >> 8) & 0xff,\n    value & 0xff\n  );\n}\n\nfunction objectSize(obj) {\n  return Object.keys(obj).length;\n}\n\n// Ensure that the returned Object has a `null` prototype; hence why\n// `Object.fromEntries(...)` is not used.\nfunction objectFromMap(map) {\n  const obj = Object.create(null);\n  for (const [key, value] of map) {\n    obj[key] = value;\n  }\n  return obj;\n}\n\n// Checks the endianness of the platform.\nfunction isLittleEndian() {\n  const buffer8 = new Uint8Array(4);\n  buffer8[0] = 1;\n  const view32 = new Uint32Array(buffer8.buffer, 0, 1);\n  return view32[0] === 1;\n}\n\n// Checks if it's possible to eval JS expressions.\nfunction isEvalSupported() {\n  try {\n    new Function(\"\"); // eslint-disable-line no-new, no-new-func\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nclass FeatureTest {\n  static get isLittleEndian() {\n    return shadow(this, \"isLittleEndian\", isLittleEndian());\n  }\n\n  static get isEvalSupported() {\n    return shadow(this, \"isEvalSupported\", isEvalSupported());\n  }\n\n  static get isOffscreenCanvasSupported() {\n    return shadow(\n      this,\n      \"isOffscreenCanvasSupported\",\n      typeof OffscreenCanvas !== \"undefined\"\n    );\n  }\n\n  static get platform() {\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      typeof navigator === \"undefined\"\n    ) {\n      return shadow(this, \"platform\", { isWin: false, isMac: false });\n    }\n    return shadow(this, \"platform\", {\n      isWin: navigator.platform.includes(\"Win\"),\n      isMac: navigator.platform.includes(\"Mac\"),\n    });\n  }\n}\n\nconst hexNumbers = [...Array(256).keys()].map(n =>\n  n.toString(16).padStart(2, \"0\")\n);\n\nclass Util {\n  static makeHexColor(r, g, b) {\n    return `#${hexNumbers[r]}${hexNumbers[g]}${hexNumbers[b]}`;\n  }\n\n  // Apply a scaling matrix to some min/max values.\n  // If a scaling factor is negative then min and max must be\n  // swaped.\n  static scaleMinMax(transform, minMax) {\n    let temp;\n    if (transform[0]) {\n      if (transform[0] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[1];\n        minMax[1] = temp;\n      }\n      minMax[0] *= transform[0];\n      minMax[1] *= transform[0];\n\n      if (transform[3] < 0) {\n        temp = minMax[2];\n        minMax[2] = minMax[3];\n        minMax[3] = temp;\n      }\n      minMax[2] *= transform[3];\n      minMax[3] *= transform[3];\n    } else {\n      temp = minMax[0];\n      minMax[0] = minMax[2];\n      minMax[2] = temp;\n      temp = minMax[1];\n      minMax[1] = minMax[3];\n      minMax[3] = temp;\n\n      if (transform[1] < 0) {\n        temp = minMax[2];\n        minMax[2] = minMax[3];\n        minMax[3] = temp;\n      }\n      minMax[2] *= transform[1];\n      minMax[3] *= transform[1];\n\n      if (transform[2] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[1];\n        minMax[1] = temp;\n      }\n      minMax[0] *= transform[2];\n      minMax[1] *= transform[2];\n    }\n    minMax[0] += transform[4];\n    minMax[1] += transform[4];\n    minMax[2] += transform[5];\n    minMax[3] += transform[5];\n  }\n\n  // Concatenates two transformation matrices together and returns the result.\n  static transform(m1, m2) {\n    return [\n      m1[0] * m2[0] + m1[2] * m2[1],\n      m1[1] * m2[0] + m1[3] * m2[1],\n      m1[0] * m2[2] + m1[2] * m2[3],\n      m1[1] * m2[2] + m1[3] * m2[3],\n      m1[0] * m2[4] + m1[2] * m2[5] + m1[4],\n      m1[1] * m2[4] + m1[3] * m2[5] + m1[5],\n    ];\n  }\n\n  // For 2d affine transforms\n  static applyTransform(p, m) {\n    const xt = p[0] * m[0] + p[1] * m[2] + m[4];\n    const yt = p[0] * m[1] + p[1] * m[3] + m[5];\n    return [xt, yt];\n  }\n\n  static applyInverseTransform(p, m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    const xt = (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d;\n    const yt = (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d;\n    return [xt, yt];\n  }\n\n  // Applies the transform to the rectangle and finds the minimum axially\n  // aligned bounding box.\n  static getAxialAlignedBoundingBox(r, m) {\n    const p1 = this.applyTransform(r, m);\n    const p2 = this.applyTransform(r.slice(2, 4), m);\n    const p3 = this.applyTransform([r[0], r[3]], m);\n    const p4 = this.applyTransform([r[2], r[1]], m);\n    return [\n      Math.min(p1[0], p2[0], p3[0], p4[0]),\n      Math.min(p1[1], p2[1], p3[1], p4[1]),\n      Math.max(p1[0], p2[0], p3[0], p4[0]),\n      Math.max(p1[1], p2[1], p3[1], p4[1]),\n    ];\n  }\n\n  static inverseTransform(m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    return [\n      m[3] / d,\n      -m[1] / d,\n      -m[2] / d,\n      m[0] / d,\n      (m[2] * m[5] - m[4] * m[3]) / d,\n      (m[4] * m[1] - m[5] * m[0]) / d,\n    ];\n  }\n\n  // This calculation uses Singular Value Decomposition.\n  // The SVD can be represented with formula A = USV. We are interested in the\n  // matrix S here because it represents the scale values.\n  static singularValueDecompose2dScale(m) {\n    const transpose = [m[0], m[2], m[1], m[3]];\n\n    // Multiply matrix m with its transpose.\n    const a = m[0] * transpose[0] + m[1] * transpose[2];\n    const b = m[0] * transpose[1] + m[1] * transpose[3];\n    const c = m[2] * transpose[0] + m[3] * transpose[2];\n    const d = m[2] * transpose[1] + m[3] * transpose[3];\n\n    // Solve the second degree polynomial to get roots.\n    const first = (a + d) / 2;\n    const second = Math.sqrt((a + d) ** 2 - 4 * (a * d - c * b)) / 2;\n    const sx = first + second || 1;\n    const sy = first - second || 1;\n\n    // Scale values are the square roots of the eigenvalues.\n    return [Math.sqrt(sx), Math.sqrt(sy)];\n  }\n\n  // Normalize rectangle rect=[x1, y1, x2, y2] so that (x1,y1) < (x2,y2)\n  // For coordinate systems whose origin lies in the bottom-left, this\n  // means normalization to (BL,TR) ordering. For systems with origin in the\n  // top-left, this means (TL,BR) ordering.\n  static normalizeRect(rect) {\n    const r = rect.slice(0); // clone rect\n    if (rect[0] > rect[2]) {\n      r[0] = rect[2];\n      r[2] = rect[0];\n    }\n    if (rect[1] > rect[3]) {\n      r[1] = rect[3];\n      r[3] = rect[1];\n    }\n    return r;\n  }\n\n  // Returns a rectangle [x1, y1, x2, y2] corresponding to the\n  // intersection of rect1 and rect2. If no intersection, returns 'null'\n  // The rectangle coordinates of rect1, rect2 should be [x1, y1, x2, y2]\n  static intersect(rect1, rect2) {\n    const xLow = Math.max(\n      Math.min(rect1[0], rect1[2]),\n      Math.min(rect2[0], rect2[2])\n    );\n    const xHigh = Math.min(\n      Math.max(rect1[0], rect1[2]),\n      Math.max(rect2[0], rect2[2])\n    );\n    if (xLow > xHigh) {\n      return null;\n    }\n    const yLow = Math.max(\n      Math.min(rect1[1], rect1[3]),\n      Math.min(rect2[1], rect2[3])\n    );\n    const yHigh = Math.min(\n      Math.max(rect1[1], rect1[3]),\n      Math.max(rect2[1], rect2[3])\n    );\n    if (yLow > yHigh) {\n      return null;\n    }\n\n    return [xLow, yLow, xHigh, yHigh];\n  }\n\n  // From https://github.com/adobe-webplatform/Snap.svg/blob/b365287722a72526000ac4bfcf0ce4cac2faa015/src/path.js#L852\n  static bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3) {\n    const tvalues = [],\n      bounds = [[], []];\n    let a, b, c, t, t1, t2, b2ac, sqrtb2ac;\n    for (let i = 0; i < 2; ++i) {\n      if (i === 0) {\n        b = 6 * x0 - 12 * x1 + 6 * x2;\n        a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n        c = 3 * x1 - 3 * x0;\n      } else {\n        b = 6 * y0 - 12 * y1 + 6 * y2;\n        a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n        c = 3 * y1 - 3 * y0;\n      }\n      if (Math.abs(a) < 1e-12) {\n        if (Math.abs(b) < 1e-12) {\n          continue;\n        }\n        t = -c / b;\n        if (0 < t && t < 1) {\n          tvalues.push(t);\n        }\n        continue;\n      }\n      b2ac = b * b - 4 * c * a;\n      sqrtb2ac = Math.sqrt(b2ac);\n      if (b2ac < 0) {\n        continue;\n      }\n      t1 = (-b + sqrtb2ac) / (2 * a);\n      if (0 < t1 && t1 < 1) {\n        tvalues.push(t1);\n      }\n      t2 = (-b - sqrtb2ac) / (2 * a);\n      if (0 < t2 && t2 < 1) {\n        tvalues.push(t2);\n      }\n    }\n\n    let j = tvalues.length,\n      mt;\n    const jlen = j;\n    while (j--) {\n      t = tvalues[j];\n      mt = 1 - t;\n      bounds[0][j] =\n        mt * mt * mt * x0 +\n        3 * mt * mt * t * x1 +\n        3 * mt * t * t * x2 +\n        t * t * t * x3;\n      bounds[1][j] =\n        mt * mt * mt * y0 +\n        3 * mt * mt * t * y1 +\n        3 * mt * t * t * y2 +\n        t * t * t * y3;\n    }\n\n    bounds[0][jlen] = x0;\n    bounds[1][jlen] = y0;\n    bounds[0][jlen + 1] = x3;\n    bounds[1][jlen + 1] = y3;\n    bounds[0].length = bounds[1].length = jlen + 2;\n\n    return [\n      Math.min(...bounds[0]),\n      Math.min(...bounds[1]),\n      Math.max(...bounds[0]),\n      Math.max(...bounds[1]),\n    ];\n  }\n}\n\nconst PDFStringTranslateTable = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2d8,\n  0x2c7, 0x2c6, 0x2d9, 0x2dd, 0x2db, 0x2da, 0x2dc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0x2022, 0x2020, 0x2021, 0x2026, 0x2014, 0x2013, 0x192,\n  0x2044, 0x2039, 0x203a, 0x2212, 0x2030, 0x201e, 0x201c, 0x201d, 0x2018,\n  0x2019, 0x201a, 0x2122, 0xfb01, 0xfb02, 0x141, 0x152, 0x160, 0x178, 0x17d,\n  0x131, 0x142, 0x153, 0x161, 0x17e, 0, 0x20ac,\n];\n\nfunction stringToPDFString(str) {\n  if (str[0] >= \"\\xEF\") {\n    let encoding;\n    if (str[0] === \"\\xFE\" && str[1] === \"\\xFF\") {\n      encoding = \"utf-16be\";\n    } else if (str[0] === \"\\xFF\" && str[1] === \"\\xFE\") {\n      encoding = \"utf-16le\";\n    } else if (str[0] === \"\\xEF\" && str[1] === \"\\xBB\" && str[2] === \"\\xBF\") {\n      encoding = \"utf-8\";\n    }\n\n    if (encoding) {\n      try {\n        const decoder = new TextDecoder(encoding, { fatal: true });\n        const buffer = stringToBytes(str);\n        return decoder.decode(buffer);\n      } catch (ex) {\n        warn(`stringToPDFString: \"${ex}\".`);\n      }\n    }\n  }\n  // ISO Latin 1\n  const strBuf = [];\n  for (let i = 0, ii = str.length; i < ii; i++) {\n    const code = PDFStringTranslateTable[str.charCodeAt(i)];\n    strBuf.push(code ? String.fromCharCode(code) : str.charAt(i));\n  }\n  return strBuf.join(\"\");\n}\n\nfunction stringToUTF8String(str) {\n  return decodeURIComponent(escape(str));\n}\n\nfunction utf8StringToString(str) {\n  return unescape(encodeURIComponent(str));\n}\n\nfunction isArrayBuffer(v) {\n  return typeof v === \"object\" && v?.byteLength !== undefined;\n}\n\nfunction isArrayEqual(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  for (let i = 0, ii = arr1.length; i < ii; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction getModificationDate(date = new Date()) {\n  const buffer = [\n    date.getUTCFullYear().toString(),\n    (date.getUTCMonth() + 1).toString().padStart(2, \"0\"),\n    date.getUTCDate().toString().padStart(2, \"0\"),\n    date.getUTCHours().toString().padStart(2, \"0\"),\n    date.getUTCMinutes().toString().padStart(2, \"0\"),\n    date.getUTCSeconds().toString().padStart(2, \"0\"),\n  ];\n\n  return buffer.join(\"\");\n}\n\nclass PromiseCapability {\n  #settled = false;\n\n  constructor() {\n    /**\n     * @type {Promise<any>} The Promise object.\n     */\n    this.promise = new Promise((resolve, reject) => {\n      /**\n       * @type {function} Fulfills the Promise.\n       */\n      this.resolve = data => {\n        this.#settled = true;\n        resolve(data);\n      };\n\n      /**\n       * @type {function} Rejects the Promise.\n       */\n      this.reject = reason => {\n        if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n          assert(reason instanceof Error, 'Expected valid \"reason\" argument.');\n        }\n        this.#settled = true;\n        reject(reason);\n      };\n    });\n  }\n\n  /**\n   * @type {boolean} If the Promise has been fulfilled/rejected.\n   */\n  get settled() {\n    return this.#settled;\n  }\n}\n\nlet NormalizeRegex = null;\nlet NormalizationMap = null;\nfunction normalizeUnicode(str) {\n  if (!NormalizeRegex) {\n    // In order to generate the following regex:\n    //  - create a PDF containing all the chars in the range 0000-FFFF with\n    //    a NFKC which is different of the char.\n    //  - copy and paste all those chars and get the ones where NFKC is\n    //    required.\n    // It appears that most the chars here contain some ligatures.\n    NormalizeRegex =\n      /([\\u00a0\\u00b5\\u037e\\u0eb3\\u2000-\\u200a\\u202f\\u2126\\ufb00-\\ufb04\\ufb06\\ufb20-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufba1\\ufba4-\\ufba9\\ufbae-\\ufbb1\\ufbd3-\\ufbdc\\ufbde-\\ufbe7\\ufbea-\\ufbf8\\ufbfc-\\ufbfd\\ufc00-\\ufc5d\\ufc64-\\ufcf1\\ufcf5-\\ufd3d\\ufd88\\ufdf4\\ufdfa-\\ufdfb\\ufe71\\ufe77\\ufe79\\ufe7b\\ufe7d]+)|(\\ufb05+)/gu;\n    NormalizationMap = new Map([[\"ﬅ\", \"ſt\"]]);\n  }\n  return str.replaceAll(NormalizeRegex, (_, p1, p2) => {\n    return p1 ? p1.normalize(\"NFKC\") : NormalizationMap.get(p2);\n  });\n}\n\nexport {\n  AbortException,\n  AnnotationActionEventType,\n  AnnotationBorderStyleType,\n  AnnotationEditorParamsType,\n  AnnotationEditorPrefix,\n  AnnotationEditorType,\n  AnnotationFieldFlag,\n  AnnotationFlag,\n  AnnotationMode,\n  AnnotationReplyType,\n  AnnotationType,\n  assert,\n  BaseException,\n  BASELINE_FACTOR,\n  bytesToString,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  DocumentActionEventType,\n  FeatureTest,\n  FONT_IDENTITY_MATRIX,\n  FormatError,\n  getModificationDate,\n  getVerbosityLevel,\n  IDENTITY_MATRIX,\n  ImageKind,\n  info,\n  InvalidPDFException,\n  isArrayBuffer,\n  isArrayEqual,\n  LINE_DESCENT_FACTOR,\n  LINE_FACTOR,\n  MAX_IMAGE_SIZE_TO_CACHE,\n  MissingPDFException,\n  normalizeUnicode,\n  objectFromMap,\n  objectSize,\n  OPS,\n  PageActionEventType,\n  PasswordException,\n  PasswordResponses,\n  PermissionFlag,\n  PromiseCapability,\n  RenderingIntentFlag,\n  setVerbosityLevel,\n  shadow,\n  string32,\n  stringToBytes,\n  stringToPDFString,\n  stringToUTF8String,\n  TextRenderingMode,\n  UnexpectedResponseException,\n  UnknownErrorException,\n  unreachable,\n  utf8StringToString,\n  Util,\n  VerbosityLevel,\n  warn,\n};\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @module pdfjsLib\n */\n\nimport {\n  AbortException,\n  AnnotationMode,\n  assert,\n  getVerbosityLevel,\n  info,\n  InvalidPDFException,\n  isArrayBuffer,\n  MAX_IMAGE_SIZE_TO_CACHE,\n  MissingPDFException,\n  PasswordException,\n  PromiseCapability,\n  RenderingIntentFlag,\n  setVerbosityLevel,\n  shadow,\n  stringToBytes,\n  UnexpectedResponseException,\n  UnknownErrorException,\n  unreachable,\n  warn,\n} from \"../shared/util.js\";\nimport {\n  AnnotationStorage,\n  PrintAnnotationStorage,\n  SerializableEmpty,\n} from \"./annotation_storage.js\";\nimport {\n  deprecated,\n  DOMCanvasFactory,\n  DOMCMapReaderFactory,\n  DOMFilterFactory,\n  DOMStandardFontDataFactory,\n  isDataScheme,\n  isValidFetchUrl,\n  loadScript,\n  PageViewport,\n  RenderingCancelledException,\n  StatTimer,\n} from \"./display_utils.js\";\nimport { FontFaceObject, FontLoader } from \"./font_loader.js\";\nimport { CanvasGraphics } from \"./canvas.js\";\nimport { GlobalWorkerOptions } from \"./worker_options.js\";\nimport { isNodeJS } from \"../shared/is_node.js\";\nimport { MessageHandler } from \"../shared/message_handler.js\";\nimport { Metadata } from \"./metadata.js\";\nimport { OptionalContentConfig } from \"./optional_content_config.js\";\nimport { PDFDataTransportStream } from \"./transport_stream.js\";\nimport { XfaText } from \"./xfa_text.js\";\n\nconst DEFAULT_RANGE_CHUNK_SIZE = 65536; // 2^16 = 65536\nconst RENDERING_CANCELLED_TIMEOUT = 100; // ms\nconst DELAYED_CLEANUP_TIMEOUT = 5000; // ms\n\nconst DefaultCanvasFactory =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\") && isNodeJS\n    ? require(\"./node_utils.js\").NodeCanvasFactory\n    : DOMCanvasFactory;\nconst DefaultCMapReaderFactory =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\") && isNodeJS\n    ? require(\"./node_utils.js\").NodeCMapReaderFactory\n    : DOMCMapReaderFactory;\nconst DefaultFilterFactory =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\") && isNodeJS\n    ? require(\"./node_utils.js\").NodeFilterFactory\n    : DOMFilterFactory;\nconst DefaultStandardFontDataFactory =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\") && isNodeJS\n    ? require(\"./node_utils.js\").NodeStandardFontDataFactory\n    : DOMStandardFontDataFactory;\n\nlet createPDFNetworkStream;\nif (typeof PDFJSDev === \"undefined\") {\n  const streamsPromise = Promise.all([\n    import(\"./network.js\"),\n    import(\"./fetch_stream.js\"),\n  ]);\n\n  createPDFNetworkStream = async params => {\n    const [{ PDFNetworkStream }, { PDFFetchStream }] = await streamsPromise;\n\n    return isValidFetchUrl(params.url)\n      ? new PDFFetchStream(params)\n      : new PDFNetworkStream(params);\n  };\n} else if (PDFJSDev.test(\"GENERIC || CHROME\")) {\n  if (PDFJSDev.test(\"GENERIC\") && isNodeJS) {\n    const { PDFNodeStream } = require(\"./node_stream.js\");\n\n    createPDFNetworkStream = params => {\n      return new PDFNodeStream(params);\n    };\n  } else {\n    const { PDFNetworkStream } = require(\"./network.js\");\n    const { PDFFetchStream } = require(\"./fetch_stream.js\");\n\n    createPDFNetworkStream = params => {\n      return isValidFetchUrl(params.url)\n        ? new PDFFetchStream(params)\n        : new PDFNetworkStream(params);\n    };\n  }\n}\n\n/**\n * @typedef { Int8Array | Uint8Array | Uint8ClampedArray |\n *            Int16Array | Uint16Array |\n *            Int32Array | Uint32Array | Float32Array |\n *            Float64Array\n * } TypedArray\n */\n\n/**\n * @typedef { TypedArray | ArrayBuffer | Array<number> | string } BinaryData\n */\n\n/**\n * @typedef {Object} RefProxy\n * @property {number} num\n * @property {number} gen\n */\n\n/**\n * Document initialization / loading parameters object.\n *\n * @typedef {Object} DocumentInitParameters\n * @property {string | URL} [url] - The URL of the PDF.\n * @property {BinaryData} [data] - Binary PDF data.\n *   Use TypedArrays (Uint8Array) to improve the memory usage. If PDF data is\n *   BASE64-encoded, use `atob()` to convert it to a binary string first.\n *\n *   NOTE: If TypedArrays are used they will generally be transferred to the\n *   worker-thread. This will help reduce main-thread memory usage, however\n *   it will take ownership of the TypedArrays.\n * @property {Object} [httpHeaders] - Basic authentication headers.\n * @property {boolean} [withCredentials] - Indicates whether or not\n *   cross-site Access-Control requests should be made using credentials such\n *   as cookies or authorization headers. The default is `false`.\n * @property {string} [password] - For decrypting password-protected PDFs.\n * @property {number} [length] - The PDF file length. It's used for progress\n *   reports and range requests operations.\n * @property {PDFDataRangeTransport} [range] - Allows for using a custom range\n *   transport implementation.\n * @property {number} [rangeChunkSize] - Specify maximum number of bytes fetched\n *   per range request. The default value is {@link DEFAULT_RANGE_CHUNK_SIZE}.\n * @property {PDFWorker} [worker] - The worker that will be used for loading and\n *   parsing the PDF data.\n * @property {number} [verbosity] - Controls the logging level; the constants\n *   from {@link VerbosityLevel} should be used.\n * @property {string} [docBaseUrl] - The base URL of the document, used when\n *   attempting to recover valid absolute URLs for annotations, and outline\n *   items, that (incorrectly) only specify relative URLs.\n * @property {string} [cMapUrl] - The URL where the predefined Adobe CMaps are\n *   located. Include the trailing slash.\n * @property {boolean} [cMapPacked] - Specifies if the Adobe CMaps are binary\n *   packed or not. The default value is `true`.\n * @property {Object} [CMapReaderFactory] - The factory that will be used when\n *   reading built-in CMap files. Providing a custom factory is useful for\n *   environments without Fetch API or `XMLHttpRequest` support, such as\n *   Node.js. The default value is {DOMCMapReaderFactory}.\n * @property {boolean} [useSystemFonts] - When `true`, fonts that aren't\n *   embedded in the PDF document will fallback to a system font.\n *   The default value is `true` in web environments and `false` in Node.js;\n *   unless `disableFontFace === true` in which case this defaults to `false`\n *   regardless of the environment (to prevent completely broken fonts).\n * @property {string} [standardFontDataUrl] - The URL where the standard font\n *   files are located. Include the trailing slash.\n * @property {Object} [StandardFontDataFactory] - The factory that will be used\n *   when reading the standard font files. Providing a custom factory is useful\n *   for environments without Fetch API or `XMLHttpRequest` support, such as\n *   Node.js. The default value is {DOMStandardFontDataFactory}.\n * @property {boolean} [useWorkerFetch] - Enable using the Fetch API in the\n *   worker-thread when reading CMap and standard font files. When `true`,\n *   the `CMapReaderFactory` and `StandardFontDataFactory` options are ignored.\n *   The default value is `true` in web environments and `false` in Node.js.\n * @property {boolean} [stopAtErrors] - Reject certain promises, e.g.\n *   `getOperatorList`, `getTextContent`, and `RenderTask`, when the associated\n *   PDF data cannot be successfully parsed, instead of attempting to recover\n *   whatever possible of the data. The default value is `false`.\n * @property {number} [maxImageSize] - The maximum allowed image size in total\n *   pixels, i.e. width * height. Images above this value will not be rendered.\n *   Use -1 for no limit, which is also the default value.\n * @property {boolean} [isEvalSupported] - Determines if we can evaluate strings\n *   as JavaScript. Primarily used to improve performance of font rendering, and\n *   when parsing PDF functions. The default value is `true`.\n * @property {boolean} [isOffscreenCanvasSupported] - Determines if we can use\n *   `OffscreenCanvas` in the worker. Primarily used to improve performance of\n *   image conversion/rendering.\n *   The default value is `true` in web environments and `false` in Node.js.\n * @property {number} [canvasMaxAreaInBytes] - The integer value is used to\n *   know when an image must be resized (uses `OffscreenCanvas` in the worker).\n *   If it's -1 then a possibly slow algorithm is used to guess the max value.\n * @property {boolean} [disableFontFace] - By default fonts are converted to\n *   OpenType fonts and loaded via the Font Loading API or `@font-face` rules.\n *   If disabled, fonts will be rendered using a built-in font renderer that\n *   constructs the glyphs with primitive path commands.\n *   The default value is `false` in web environments and `true` in Node.js.\n * @property {boolean} [fontExtraProperties] - Include additional properties,\n *   which are unused during rendering of PDF documents, when exporting the\n *   parsed font data from the worker-thread. This may be useful for debugging\n *   purposes (and backwards compatibility), but note that it will lead to\n *   increased memory usage. The default value is `false`.\n * @property {boolean} [enableXfa] - Render Xfa forms if any.\n *   The default value is `false`.\n * @property {HTMLDocument} [ownerDocument] - Specify an explicit document\n *   context to create elements with and to load resources, such as fonts,\n *   into. Defaults to the current document.\n * @property {boolean} [disableRange] - Disable range request loading of PDF\n *   files. When enabled, and if the server supports partial content requests,\n *   then the PDF will be fetched in chunks. The default value is `false`.\n * @property {boolean} [disableStream] - Disable streaming of PDF file data.\n *   By default PDF.js attempts to load PDF files in chunks. The default value\n *   is `false`.\n * @property {boolean} [disableAutoFetch] - Disable pre-fetching of PDF file\n *   data. When range requests are enabled PDF.js will automatically keep\n *   fetching more data even if it isn't needed to display the current page.\n *   The default value is `false`.\n *\n *   NOTE: It is also necessary to disable streaming, see above, in order for\n *   disabling of pre-fetching to work correctly.\n * @property {boolean} [pdfBug] - Enables special hooks for debugging PDF.js\n *   (see `web/debugger.js`). The default value is `false`.\n * @property {Object} [canvasFactory] - The factory instance that will be used\n *   when creating canvases. The default value is {new DOMCanvasFactory()}.\n * @property {Object} [filterFactory] - A factory instance that will be used\n *   to create SVG filters when rendering some images on the main canvas.\n */\n\n/**\n * This is the main entry point for loading a PDF and interacting with it.\n *\n * NOTE: If a URL is used to fetch the PDF data a standard Fetch API call (or\n * XHR as fallback) is used, which means it must follow same origin rules,\n * e.g. no cross-domain requests without CORS.\n *\n * @param {string | URL | TypedArray | ArrayBuffer | DocumentInitParameters}\n *   src - Can be a URL where a PDF file is located, a typed array (Uint8Array)\n *         already populated with data, or a parameter object.\n * @returns {PDFDocumentLoadingTask}\n */\nfunction getDocument(src) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n    if (typeof src === \"string\" || src instanceof URL) {\n      src = { url: src };\n    } else if (isArrayBuffer(src)) {\n      src = { data: src };\n    }\n  }\n  if (typeof src !== \"object\") {\n    throw new Error(\"Invalid parameter in getDocument, need parameter object.\");\n  }\n  if (!src.url && !src.data && !src.range) {\n    throw new Error(\n      \"Invalid parameter object: need either .data, .range or .url\"\n    );\n  }\n  const task = new PDFDocumentLoadingTask();\n  const { docId } = task;\n\n  const url = src.url ? getUrlProp(src.url) : null;\n  const data = src.data ? getDataProp(src.data) : null;\n  const httpHeaders = src.httpHeaders || null;\n  const withCredentials = src.withCredentials === true;\n  const password = src.password ?? null;\n  const rangeTransport =\n    src.range instanceof PDFDataRangeTransport ? src.range : null;\n  const rangeChunkSize =\n    Number.isInteger(src.rangeChunkSize) && src.rangeChunkSize > 0\n      ? src.rangeChunkSize\n      : DEFAULT_RANGE_CHUNK_SIZE;\n  let worker = src.worker instanceof PDFWorker ? src.worker : null;\n  const verbosity = src.verbosity;\n  // Ignore \"data:\"-URLs, since they can't be used to recover valid absolute\n  // URLs anyway. We want to avoid sending them to the worker-thread, since\n  // they contain the *entire* PDF document and can thus be arbitrarily long.\n  const docBaseUrl =\n    typeof src.docBaseUrl === \"string\" && !isDataScheme(src.docBaseUrl)\n      ? src.docBaseUrl\n      : null;\n  const cMapUrl = typeof src.cMapUrl === \"string\" ? src.cMapUrl : null;\n  const cMapPacked = src.cMapPacked !== false;\n  const CMapReaderFactory = src.CMapReaderFactory || DefaultCMapReaderFactory;\n  const standardFontDataUrl =\n    typeof src.standardFontDataUrl === \"string\"\n      ? src.standardFontDataUrl\n      : null;\n  const StandardFontDataFactory =\n    src.StandardFontDataFactory || DefaultStandardFontDataFactory;\n  const ignoreErrors = src.stopAtErrors !== true;\n  const maxImageSize =\n    Number.isInteger(src.maxImageSize) && src.maxImageSize > -1\n      ? src.maxImageSize\n      : -1;\n  const isEvalSupported = src.isEvalSupported !== false;\n  const isOffscreenCanvasSupported =\n    typeof src.isOffscreenCanvasSupported === \"boolean\"\n      ? src.isOffscreenCanvasSupported\n      : !isNodeJS;\n  const canvasMaxAreaInBytes = Number.isInteger(src.canvasMaxAreaInBytes)\n    ? src.canvasMaxAreaInBytes\n    : -1;\n  const disableFontFace =\n    typeof src.disableFontFace === \"boolean\" ? src.disableFontFace : isNodeJS;\n  const fontExtraProperties = src.fontExtraProperties === true;\n  const enableXfa = src.enableXfa === true;\n  const ownerDocument = src.ownerDocument || globalThis.document;\n  const disableRange = src.disableRange === true;\n  const disableStream = src.disableStream === true;\n  const disableAutoFetch = src.disableAutoFetch === true;\n  const pdfBug = src.pdfBug === true;\n\n  // Parameters whose default values depend on other parameters.\n  const length = rangeTransport ? rangeTransport.length : src.length ?? NaN;\n  const useSystemFonts =\n    typeof src.useSystemFonts === \"boolean\"\n      ? src.useSystemFonts\n      : !isNodeJS && !disableFontFace;\n  const useWorkerFetch =\n    typeof src.useWorkerFetch === \"boolean\"\n      ? src.useWorkerFetch\n      : (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n        (CMapReaderFactory === DOMCMapReaderFactory &&\n          StandardFontDataFactory === DOMStandardFontDataFactory &&\n          isValidFetchUrl(cMapUrl, document.baseURI) &&\n          isValidFetchUrl(standardFontDataUrl, document.baseURI));\n  const canvasFactory =\n    src.canvasFactory || new DefaultCanvasFactory({ ownerDocument });\n  const filterFactory =\n    src.filterFactory || new DefaultFilterFactory({ docId, ownerDocument });\n\n  // Parameters only intended for development/testing purposes.\n  const styleElement =\n    typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")\n      ? src.styleElement\n      : null;\n\n  // Set the main-thread verbosity level.\n  setVerbosityLevel(verbosity);\n\n  // Ensure that the various factories can be initialized, when necessary,\n  // since the user may provide *custom* ones.\n  const transportFactory = {\n    canvasFactory,\n    filterFactory,\n  };\n  if (!useWorkerFetch) {\n    transportFactory.cMapReaderFactory = new CMapReaderFactory({\n      baseUrl: cMapUrl,\n      isCompressed: cMapPacked,\n    });\n    transportFactory.standardFontDataFactory = new StandardFontDataFactory({\n      baseUrl: standardFontDataUrl,\n    });\n  }\n\n  if (!worker) {\n    const workerParams = {\n      verbosity,\n      port: GlobalWorkerOptions.workerPort,\n    };\n    // Worker was not provided -- creating and owning our own. If message port\n    // is specified in global worker options, using it.\n    worker = workerParams.port\n      ? PDFWorker.fromPort(workerParams)\n      : new PDFWorker(workerParams);\n    task._worker = worker;\n  }\n\n  const fetchDocParams = {\n    docId,\n    apiVersion:\n      typeof PDFJSDev !== \"undefined\" && !PDFJSDev.test(\"TESTING\")\n        ? PDFJSDev.eval(\"BUNDLE_VERSION\")\n        : null,\n    data,\n    password,\n    disableAutoFetch,\n    rangeChunkSize,\n    length,\n    docBaseUrl,\n    enableXfa,\n    evaluatorOptions: {\n      maxImageSize,\n      disableFontFace,\n      ignoreErrors,\n      isEvalSupported,\n      isOffscreenCanvasSupported,\n      canvasMaxAreaInBytes,\n      fontExtraProperties,\n      useSystemFonts,\n      cMapUrl: useWorkerFetch ? cMapUrl : null,\n      standardFontDataUrl: useWorkerFetch ? standardFontDataUrl : null,\n    },\n  };\n  const transportParams = {\n    ignoreErrors,\n    isEvalSupported,\n    disableFontFace,\n    fontExtraProperties,\n    enableXfa,\n    ownerDocument,\n    disableAutoFetch,\n    pdfBug,\n    styleElement,\n  };\n\n  worker.promise\n    .then(function () {\n      if (task.destroyed) {\n        throw new Error(\"Loading aborted\");\n      }\n\n      const workerIdPromise = _fetchDocument(worker, fetchDocParams);\n      const networkStreamPromise = new Promise(function (resolve) {\n        let networkStream;\n        if (rangeTransport) {\n          networkStream = new PDFDataTransportStream(\n            {\n              length,\n              initialData: rangeTransport.initialData,\n              progressiveDone: rangeTransport.progressiveDone,\n              contentDispositionFilename:\n                rangeTransport.contentDispositionFilename,\n              disableRange,\n              disableStream,\n            },\n            rangeTransport\n          );\n        } else if (!data) {\n          if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n            throw new Error(\"Not implemented: createPDFNetworkStream\");\n          }\n          networkStream = createPDFNetworkStream({\n            url,\n            length,\n            httpHeaders,\n            withCredentials,\n            rangeChunkSize,\n            disableRange,\n            disableStream,\n          });\n        }\n        resolve(networkStream);\n      });\n\n      return Promise.all([workerIdPromise, networkStreamPromise]).then(\n        function ([workerId, networkStream]) {\n          if (task.destroyed) {\n            throw new Error(\"Loading aborted\");\n          }\n\n          const messageHandler = new MessageHandler(\n            docId,\n            workerId,\n            worker.port\n          );\n          const transport = new WorkerTransport(\n            messageHandler,\n            task,\n            networkStream,\n            transportParams,\n            transportFactory\n          );\n          task._transport = transport;\n          messageHandler.send(\"Ready\", null);\n        }\n      );\n    })\n    .catch(task._capability.reject);\n\n  return task;\n}\n\n/**\n * Starts fetching of specified PDF document/data.\n *\n * @param {PDFWorker} worker\n * @param {Object} source\n * @returns {Promise<string>} A promise that is resolved when the worker ID of\n *   the `MessageHandler` is known.\n * @private\n */\nasync function _fetchDocument(worker, source) {\n  if (worker.destroyed) {\n    throw new Error(\"Worker was destroyed\");\n  }\n  const workerId = await worker.messageHandler.sendWithPromise(\n    \"GetDocRequest\",\n    source,\n    source.data ? [source.data.buffer] : null\n  );\n\n  if (worker.destroyed) {\n    throw new Error(\"Worker was destroyed\");\n  }\n  return workerId;\n}\n\nfunction getUrlProp(val) {\n  if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n    return null; // The 'url' is unused with `PDFDataRangeTransport`.\n  }\n  if (val instanceof URL) {\n    return val.href;\n  }\n  try {\n    // The full path is required in the 'url' field.\n    return new URL(val, window.location).href;\n  } catch {\n    if (\n      typeof PDFJSDev !== \"undefined\" &&\n      PDFJSDev.test(\"GENERIC\") &&\n      isNodeJS &&\n      typeof val === \"string\"\n    ) {\n      return val; // Use the url as-is in Node.js environments.\n    }\n  }\n  throw new Error(\n    \"Invalid PDF url data: \" +\n      \"either string or URL-object is expected in the url property.\"\n  );\n}\n\nfunction getDataProp(val) {\n  // Converting string or array-like data to Uint8Array.\n  if (\n    typeof PDFJSDev !== \"undefined\" &&\n    PDFJSDev.test(\"GENERIC\") &&\n    isNodeJS &&\n    typeof Buffer !== \"undefined\" && // eslint-disable-line no-undef\n    val instanceof Buffer // eslint-disable-line no-undef\n  ) {\n    throw new Error(\n      \"Please provide binary data as `Uint8Array`, rather than `Buffer`.\"\n    );\n  }\n  if (val instanceof Uint8Array && val.byteLength === val.buffer.byteLength) {\n    // Use the data as-is when it's already a Uint8Array that completely\n    // \"utilizes\" its underlying ArrayBuffer, to prevent any possible\n    // issues when transferring it to the worker-thread.\n    return val;\n  }\n  if (typeof val === \"string\") {\n    return stringToBytes(val);\n  }\n  if ((typeof val === \"object\" && !isNaN(val?.length)) || isArrayBuffer(val)) {\n    return new Uint8Array(val);\n  }\n  throw new Error(\n    \"Invalid PDF binary data: either TypedArray, \" +\n      \"string, or array-like object is expected in the data property.\"\n  );\n}\n\n/**\n * @typedef {Object} OnProgressParameters\n * @property {number} loaded - Currently loaded number of bytes.\n * @property {number} total - Total number of bytes in the PDF file.\n */\n\n/**\n * The loading task controls the operations required to load a PDF document\n * (such as network requests) and provides a way to listen for completion,\n * after which individual pages can be rendered.\n */\nclass PDFDocumentLoadingTask {\n  static #docId = 0;\n\n  constructor() {\n    this._capability = new PromiseCapability();\n    this._transport = null;\n    this._worker = null;\n\n    /**\n     * Unique identifier for the document loading task.\n     * @type {string}\n     */\n    this.docId = `d${PDFDocumentLoadingTask.#docId++}`;\n\n    /**\n     * Whether the loading task is destroyed or not.\n     * @type {boolean}\n     */\n    this.destroyed = false;\n\n    /**\n     * Callback to request a password if a wrong or no password was provided.\n     * The callback receives two parameters: a function that should be called\n     * with the new password, and a reason (see {@link PasswordResponses}).\n     * @type {function}\n     */\n    this.onPassword = null;\n\n    /**\n     * Callback to be able to monitor the loading progress of the PDF file\n     * (necessary to implement e.g. a loading bar).\n     * The callback receives an {@link OnProgressParameters} argument.\n     * @type {function}\n     */\n    this.onProgress = null;\n  }\n\n  /**\n   * Promise for document loading task completion.\n   * @type {Promise<PDFDocumentProxy>}\n   */\n  get promise() {\n    return this._capability.promise;\n  }\n\n  /**\n   * Abort all network requests and destroy the worker.\n   * @returns {Promise<void>} A promise that is resolved when destruction is\n   *   completed.\n   */\n  async destroy() {\n    this.destroyed = true;\n    await this._transport?.destroy();\n\n    this._transport = null;\n    if (this._worker) {\n      this._worker.destroy();\n      this._worker = null;\n    }\n  }\n}\n\n/**\n * Abstract class to support range requests file loading.\n *\n * NOTE: The TypedArrays passed to the constructor and relevant methods below\n * will generally be transferred to the worker-thread. This will help reduce\n * main-thread memory usage, however it will take ownership of the TypedArrays.\n */\nclass PDFDataRangeTransport {\n  /**\n   * @param {number} length\n   * @param {Uint8Array|null} initialData\n   * @param {boolean} [progressiveDone]\n   * @param {string} [contentDispositionFilename]\n   */\n  constructor(\n    length,\n    initialData,\n    progressiveDone = false,\n    contentDispositionFilename = null\n  ) {\n    this.length = length;\n    this.initialData = initialData;\n    this.progressiveDone = progressiveDone;\n    this.contentDispositionFilename = contentDispositionFilename;\n\n    this._rangeListeners = [];\n    this._progressListeners = [];\n    this._progressiveReadListeners = [];\n    this._progressiveDoneListeners = [];\n    this._readyCapability = new PromiseCapability();\n  }\n\n  /**\n   * @param {function} listener\n   */\n  addRangeListener(listener) {\n    this._rangeListeners.push(listener);\n  }\n\n  /**\n   * @param {function} listener\n   */\n  addProgressListener(listener) {\n    this._progressListeners.push(listener);\n  }\n\n  /**\n   * @param {function} listener\n   */\n  addProgressiveReadListener(listener) {\n    this._progressiveReadListeners.push(listener);\n  }\n\n  /**\n   * @param {function} listener\n   */\n  addProgressiveDoneListener(listener) {\n    this._progressiveDoneListeners.push(listener);\n  }\n\n  /**\n   * @param {number} begin\n   * @param {Uint8Array|null} chunk\n   */\n  onDataRange(begin, chunk) {\n    for (const listener of this._rangeListeners) {\n      listener(begin, chunk);\n    }\n  }\n\n  /**\n   * @param {number} loaded\n   * @param {number|undefined} total\n   */\n  onDataProgress(loaded, total) {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressListeners) {\n        listener(loaded, total);\n      }\n    });\n  }\n\n  /**\n   * @param {Uint8Array|null} chunk\n   */\n  onDataProgressiveRead(chunk) {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressiveReadListeners) {\n        listener(chunk);\n      }\n    });\n  }\n\n  onDataProgressiveDone() {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressiveDoneListeners) {\n        listener();\n      }\n    });\n  }\n\n  transportReady() {\n    this._readyCapability.resolve();\n  }\n\n  /**\n   * @param {number} begin\n   * @param {number} end\n   */\n  requestDataRange(begin, end) {\n    unreachable(\"Abstract method PDFDataRangeTransport.requestDataRange\");\n  }\n\n  abort() {}\n}\n\n/**\n * Proxy to a `PDFDocument` in the worker thread.\n */\nclass PDFDocumentProxy {\n  constructor(pdfInfo, transport) {\n    this._pdfInfo = pdfInfo;\n    this._transport = transport;\n\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      // For testing purposes.\n      Object.defineProperty(this, \"getXFADatasets\", {\n        value: () => {\n          return this._transport.getXFADatasets();\n        },\n      });\n      Object.defineProperty(this, \"getXRefPrevValue\", {\n        value: () => {\n          return this._transport.getXRefPrevValue();\n        },\n      });\n      Object.defineProperty(this, \"getAnnotArray\", {\n        value: pageIndex => {\n          return this._transport.getAnnotArray(pageIndex);\n        },\n      });\n    }\n  }\n\n  /**\n   * @type {AnnotationStorage} Storage for annotation data in forms.\n   */\n  get annotationStorage() {\n    return this._transport.annotationStorage;\n  }\n\n  /**\n   * @type {Object} The filter factory instance.\n   */\n  get filterFactory() {\n    return this._transport.filterFactory;\n  }\n\n  /**\n   * @type {number} Total number of pages in the PDF file.\n   */\n  get numPages() {\n    return this._pdfInfo.numPages;\n  }\n\n  /**\n   * @type {Array<string, string|null>} A (not guaranteed to be) unique ID to\n   *   identify the PDF document.\n   *   NOTE: The first element will always be defined for all PDF documents,\n   *   whereas the second element is only defined for *modified* PDF documents.\n   */\n  get fingerprints() {\n    return this._pdfInfo.fingerprints;\n  }\n\n  /**\n   * @type {boolean} True if only XFA form.\n   */\n  get isPureXfa() {\n    return shadow(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n  }\n\n  /**\n   * NOTE: This is (mostly) intended to support printing of XFA forms.\n   *\n   * @type {Object | null} An object representing a HTML tree structure\n   *   to render the XFA, or `null` when no XFA form exists.\n   */\n  get allXfaHtml() {\n    return this._transport._htmlForXfa;\n  }\n\n  /**\n   * @param {number} pageNumber - The page number to get. The first page is 1.\n   * @returns {Promise<PDFPageProxy>} A promise that is resolved with\n   *   a {@link PDFPageProxy} object.\n   */\n  getPage(pageNumber) {\n    return this._transport.getPage(pageNumber);\n  }\n\n  /**\n   * @param {RefProxy} ref - The page reference.\n   * @returns {Promise<number>} A promise that is resolved with the page index,\n   *   starting from zero, that is associated with the reference.\n   */\n  getPageIndex(ref) {\n    return this._transport.getPageIndex(ref);\n  }\n\n  /**\n   * @returns {Promise<Object<string, Array<any>>>} A promise that is resolved\n   *   with a mapping from named destinations to references.\n   *\n   * This can be slow for large documents. Use `getDestination` instead.\n   */\n  getDestinations() {\n    return this._transport.getDestinations();\n  }\n\n  /**\n   * @param {string} id - The named destination to get.\n   * @returns {Promise<Array<any> | null>} A promise that is resolved with all\n   *   information of the given named destination, or `null` when the named\n   *   destination is not present in the PDF file.\n   */\n  getDestination(id) {\n    return this._transport.getDestination(id);\n  }\n\n  /**\n   * @returns {Promise<Array<string> | null>} A promise that is resolved with\n   *   an {Array} containing the page labels that correspond to the page\n   *   indexes, or `null` when no page labels are present in the PDF file.\n   */\n  getPageLabels() {\n    return this._transport.getPageLabels();\n  }\n\n  /**\n   * @returns {Promise<string>} A promise that is resolved with a {string}\n   *   containing the page layout name.\n   */\n  getPageLayout() {\n    return this._transport.getPageLayout();\n  }\n\n  /**\n   * @returns {Promise<string>} A promise that is resolved with a {string}\n   *   containing the page mode name.\n   */\n  getPageMode() {\n    return this._transport.getPageMode();\n  }\n\n  /**\n   * @returns {Promise<Object | null>} A promise that is resolved with an\n   *   {Object} containing the viewer preferences, or `null` when no viewer\n   *   preferences are present in the PDF file.\n   */\n  getViewerPreferences() {\n    return this._transport.getViewerPreferences();\n  }\n\n  /**\n   * @returns {Promise<any | null>} A promise that is resolved with an {Array}\n   *   containing the destination, or `null` when no open action is present\n   *   in the PDF.\n   */\n  getOpenAction() {\n    return this._transport.getOpenAction();\n  }\n\n  /**\n   * @returns {Promise<any>} A promise that is resolved with a lookup table\n   *   for mapping named attachments to their content.\n   */\n  getAttachments() {\n    return this._transport.getAttachments();\n  }\n\n  /**\n   * @returns {Promise<Array<string> | null>} A promise that is resolved with\n   *   an {Array} of all the JavaScript strings in the name tree, or `null`\n   *   if no JavaScript exists.\n   */\n  getJavaScript() {\n    return this._transport.getJavaScript();\n  }\n\n  /**\n   * @returns {Promise<Object | null>} A promise that is resolved with\n   *   an {Object} with the JavaScript actions:\n   *     - from the name tree (like getJavaScript);\n   *     - from A or AA entries in the catalog dictionary.\n   *   , or `null` if no JavaScript exists.\n   */\n  getJSActions() {\n    return this._transport.getDocJSActions();\n  }\n\n  /**\n   * @typedef {Object} OutlineNode\n   * @property {string} title\n   * @property {boolean} bold\n   * @property {boolean} italic\n   * @property {Uint8ClampedArray} color - The color in RGB format to use for\n   *   display purposes.\n   * @property {string | Array<any> | null} dest\n   * @property {string | null} url\n   * @property {string | undefined} unsafeUrl\n   * @property {boolean | undefined} newWindow\n   * @property {number | undefined} count\n   * @property {Array<OutlineNode>} items\n   */\n\n  /**\n   * @returns {Promise<Array<OutlineNode>>} A promise that is resolved with an\n   *   {Array} that is a tree outline (if it has one) of the PDF file.\n   */\n  getOutline() {\n    return this._transport.getOutline();\n  }\n\n  /**\n   * @returns {Promise<OptionalContentConfig>} A promise that is resolved with\n   *   an {@link OptionalContentConfig} that contains all the optional content\n   *   groups (assuming that the document has any).\n   */\n  getOptionalContentConfig() {\n    return this._transport.getOptionalContentConfig();\n  }\n\n  /**\n   * @returns {Promise<Array<number> | null>} A promise that is resolved with\n   *   an {Array} that contains the permission flags for the PDF document, or\n   *   `null` when no permissions are present in the PDF file.\n   */\n  getPermissions() {\n    return this._transport.getPermissions();\n  }\n\n  /**\n   * @returns {Promise<{ info: Object, metadata: Metadata }>} A promise that is\n   *   resolved with an {Object} that has `info` and `metadata` properties.\n   *   `info` is an {Object} filled with anything available in the information\n   *   dictionary and similarly `metadata` is a {Metadata} object with\n   *   information from the metadata section of the PDF.\n   */\n  getMetadata() {\n    return this._transport.getMetadata();\n  }\n\n  /**\n   * @typedef {Object} MarkInfo\n   * Properties correspond to Table 321 of the PDF 32000-1:2008 spec.\n   * @property {boolean} Marked\n   * @property {boolean} UserProperties\n   * @property {boolean} Suspects\n   */\n\n  /**\n   * @returns {Promise<MarkInfo | null>} A promise that is resolved with\n   *   a {MarkInfo} object that contains the MarkInfo flags for the PDF\n   *   document, or `null` when no MarkInfo values are present in the PDF file.\n   */\n  getMarkInfo() {\n    return this._transport.getMarkInfo();\n  }\n\n  /**\n   * @returns {Promise<Uint8Array>} A promise that is resolved with a\n   *   {Uint8Array} containing the raw data of the PDF document.\n   */\n  getData() {\n    return this._transport.getData();\n  }\n\n  /**\n   * @returns {Promise<Uint8Array>} A promise that is resolved with a\n   *   {Uint8Array} containing the full data of the saved document.\n   */\n  saveDocument() {\n    return this._transport.saveDocument();\n  }\n\n  /**\n   * @returns {Promise<{ length: number }>} A promise that is resolved when the\n   *   document's data is loaded. It is resolved with an {Object} that contains\n   *   the `length` property that indicates size of the PDF data in bytes.\n   */\n  getDownloadInfo() {\n    return this._transport.downloadInfoCapability.promise;\n  }\n\n  /**\n   * Cleans up resources allocated by the document on both the main and worker\n   * threads.\n   *\n   * NOTE: Do not, under any circumstances, call this method when rendering is\n   * currently ongoing since that may lead to rendering errors.\n   *\n   * @param {boolean} [keepLoadedFonts] - Let fonts remain attached to the DOM.\n   *   NOTE: This will increase persistent memory usage, hence don't use this\n   *   option unless absolutely necessary. The default value is `false`.\n   * @returns {Promise} A promise that is resolved when clean-up has finished.\n   */\n  cleanup(keepLoadedFonts = false) {\n    return this._transport.startCleanup(keepLoadedFonts || this.isPureXfa);\n  }\n\n  /**\n   * Destroys the current document instance and terminates the worker.\n   */\n  destroy() {\n    return this.loadingTask.destroy();\n  }\n\n  /**\n   * @type {DocumentInitParameters} A subset of the current\n   *   {DocumentInitParameters}, which are needed in the viewer.\n   */\n  get loadingParams() {\n    return this._transport.loadingParams;\n  }\n\n  /**\n   * @type {PDFDocumentLoadingTask} The loadingTask for the current document.\n   */\n  get loadingTask() {\n    return this._transport.loadingTask;\n  }\n\n  /**\n   * @returns {Promise<Object<string, Array<Object>> | null>} A promise that is\n   *   resolved with an {Object} containing /AcroForm field data for the JS\n   *   sandbox, or `null` when no field data is present in the PDF file.\n   */\n  getFieldObjects() {\n    return this._transport.getFieldObjects();\n  }\n\n  /**\n   * @returns {Promise<boolean>} A promise that is resolved with `true`\n   *   if some /AcroForm fields have JavaScript actions.\n   */\n  hasJSActions() {\n    return this._transport.hasJSActions();\n  }\n\n  /**\n   * @returns {Promise<Array<string> | null>} A promise that is resolved with an\n   *   {Array<string>} containing IDs of annotations that have a calculation\n   *   action, or `null` when no such annotations are present in the PDF file.\n   */\n  getCalculationOrderIds() {\n    return this._transport.getCalculationOrderIds();\n  }\n}\n\n/**\n * Page getViewport parameters.\n *\n * @typedef {Object} GetViewportParameters\n * @property {number} scale - The desired scale of the viewport.\n * @property {number} [rotation] - The desired rotation, in degrees, of\n *   the viewport. If omitted it defaults to the page rotation.\n * @property {number} [offsetX] - The horizontal, i.e. x-axis, offset.\n *   The default value is `0`.\n * @property {number} [offsetY] - The vertical, i.e. y-axis, offset.\n *   The default value is `0`.\n * @property {boolean} [dontFlip] - If true, the y-axis will not be\n *   flipped. The default value is `false`.\n */\n\n/**\n * Page getTextContent parameters.\n *\n * @typedef {Object} getTextContentParameters\n * @property {boolean} [includeMarkedContent] - When true include marked\n *   content items in the items array of TextContent. The default is `false`.\n * @property {boolean} [disableNormalization] - When true the text is *not*\n *   normalized in the worker-thread. The default is `false`.\n */\n\n/**\n * Page text content.\n *\n * @typedef {Object} TextContent\n * @property {Array<TextItem | TextMarkedContent>} items - Array of\n *   {@link TextItem} and {@link TextMarkedContent} objects. TextMarkedContent\n *   items are included when includeMarkedContent is true.\n * @property {Object<string, TextStyle>} styles - {@link TextStyle} objects,\n *   indexed by font name.\n */\n\n/**\n * Page text content part.\n *\n * @typedef {Object} TextItem\n * @property {string} str - Text content.\n * @property {string} dir - Text direction: 'ttb', 'ltr' or 'rtl'.\n * @property {Array<any>} transform - Transformation matrix.\n * @property {number} width - Width in device space.\n * @property {number} height - Height in device space.\n * @property {string} fontName - Font name used by PDF.js for converted font.\n * @property {boolean} hasEOL - Indicating if the text content is followed by a\n *   line-break.\n */\n\n/**\n * Page text marked content part.\n *\n * @typedef {Object} TextMarkedContent\n * @property {string} type - Either 'beginMarkedContent',\n *   'beginMarkedContentProps', or 'endMarkedContent'.\n * @property {string} id - The marked content identifier. Only used for type\n *   'beginMarkedContentProps'.\n */\n\n/**\n * Text style.\n *\n * @typedef {Object} TextStyle\n * @property {number} ascent - Font ascent.\n * @property {number} descent - Font descent.\n * @property {boolean} vertical - Whether or not the text is in vertical mode.\n * @property {string} fontFamily - The possible font family.\n */\n\n/**\n * Page annotation parameters.\n *\n * @typedef {Object} GetAnnotationsParameters\n * @property {string} [intent] - Determines the annotations that are fetched,\n *   can be 'display' (viewable annotations), 'print' (printable annotations),\n *   or 'any' (all annotations). The default value is 'display'.\n */\n\n/**\n * Page render parameters.\n *\n * @typedef {Object} RenderParameters\n * @property {CanvasRenderingContext2D} canvasContext - A 2D context of a DOM\n *   Canvas object.\n * @property {PageViewport} viewport - Rendering viewport obtained by calling\n *   the `PDFPageProxy.getViewport` method.\n * @property {string} [intent] - Rendering intent, can be 'display', 'print',\n *   or 'any'. The default value is 'display'.\n * @property {number} [annotationMode] Controls which annotations are rendered\n *   onto the canvas, for annotations with appearance-data; the values from\n *   {@link AnnotationMode} should be used. The following values are supported:\n *    - `AnnotationMode.DISABLE`, which disables all annotations.\n *    - `AnnotationMode.ENABLE`, which includes all possible annotations (thus\n *      it also depends on the `intent`-option, see above).\n *    - `AnnotationMode.ENABLE_FORMS`, which excludes annotations that contain\n *      interactive form elements (those will be rendered in the display layer).\n *    - `AnnotationMode.ENABLE_STORAGE`, which includes all possible annotations\n *      (as above) but where interactive form elements are updated with data\n *      from the {@link AnnotationStorage}-instance; useful e.g. for printing.\n *   The default value is `AnnotationMode.ENABLE`.\n * @property {Array<any>} [transform] - Additional transform, applied just\n *   before viewport transform.\n * @property {CanvasGradient | CanvasPattern | string} [background] - Background\n *   to use for the canvas.\n *   Any valid `canvas.fillStyle` can be used: a `DOMString` parsed as CSS\n *   <color> value, a `CanvasGradient` object (a linear or radial gradient) or\n *   a `CanvasPattern` object (a repetitive image). The default value is\n *   'rgb(255,255,255)'.\n *\n *   NOTE: This option may be partially, or completely, ignored when the\n *   `pageColors`-option is used.\n * @property {Object} [pageColors] - Overwrites background and foreground colors\n *   with user defined ones in order to improve readability in high contrast\n *   mode.\n * @property {Promise<OptionalContentConfig>} [optionalContentConfigPromise] -\n *   A promise that should resolve with an {@link OptionalContentConfig}\n *   created from `PDFDocumentProxy.getOptionalContentConfig`. If `null`,\n *   the configuration will be fetched automatically with the default visibility\n *   states set.\n * @property {Map<string, HTMLCanvasElement>} [annotationCanvasMap] - Map some\n *   annotation ids with canvases used to render them.\n * @property {PrintAnnotationStorage} [printAnnotationStorage]\n */\n\n/**\n * Page getOperatorList parameters.\n *\n * @typedef {Object} GetOperatorListParameters\n * @property {string} [intent] - Rendering intent, can be 'display', 'print',\n *   or 'any'. The default value is 'display'.\n * @property {number} [annotationMode] Controls which annotations are included\n *   in the operatorList, for annotations with appearance-data; the values from\n *   {@link AnnotationMode} should be used. The following values are supported:\n *    - `AnnotationMode.DISABLE`, which disables all annotations.\n *    - `AnnotationMode.ENABLE`, which includes all possible annotations (thus\n *      it also depends on the `intent`-option, see above).\n *    - `AnnotationMode.ENABLE_FORMS`, which excludes annotations that contain\n *      interactive form elements (those will be rendered in the display layer).\n *    - `AnnotationMode.ENABLE_STORAGE`, which includes all possible annotations\n *      (as above) but where interactive form elements are updated with data\n *      from the {@link AnnotationStorage}-instance; useful e.g. for printing.\n *   The default value is `AnnotationMode.ENABLE`.\n * @property {PrintAnnotationStorage} [printAnnotationStorage]\n */\n\n/**\n * Structure tree node. The root node will have a role \"Root\".\n *\n * @typedef {Object} StructTreeNode\n * @property {Array<StructTreeNode | StructTreeContent>} children - Array of\n *   {@link StructTreeNode} and {@link StructTreeContent} objects.\n * @property {string} role - element's role, already mapped if a role map exists\n * in the PDF.\n */\n\n/**\n * Structure tree content.\n *\n * @typedef {Object} StructTreeContent\n * @property {string} type - either \"content\" for page and stream structure\n *   elements or \"object\" for object references.\n * @property {string} id - unique id that will map to the text layer.\n */\n\n/**\n * PDF page operator list.\n *\n * @typedef {Object} PDFOperatorList\n * @property {Array<number>} fnArray - Array containing the operator functions.\n * @property {Array<any>} argsArray - Array containing the arguments of the\n *   functions.\n */\n\n/**\n * Proxy to a `PDFPage` in the worker thread.\n */\nclass PDFPageProxy {\n  #delayedCleanupTimeout = null;\n\n  #pendingCleanup = false;\n\n  constructor(pageIndex, pageInfo, transport, pdfBug = false) {\n    this._pageIndex = pageIndex;\n    this._pageInfo = pageInfo;\n    this._transport = transport;\n    this._stats = pdfBug ? new StatTimer() : null;\n    this._pdfBug = pdfBug;\n    /** @type {PDFObjects} */\n    this.commonObjs = transport.commonObjs;\n    this.objs = new PDFObjects();\n\n    this._maybeCleanupAfterRender = false;\n    this._intentStates = new Map();\n    this.destroyed = false;\n  }\n\n  /**\n   * @type {number} Page number of the page. First page is 1.\n   */\n  get pageNumber() {\n    return this._pageIndex + 1;\n  }\n\n  /**\n   * @type {number} The number of degrees the page is rotated clockwise.\n   */\n  get rotate() {\n    return this._pageInfo.rotate;\n  }\n\n  /**\n   * @type {RefProxy | null} The reference that points to this page.\n   */\n  get ref() {\n    return this._pageInfo.ref;\n  }\n\n  /**\n   * @type {number} The default size of units in 1/72nds of an inch.\n   */\n  get userUnit() {\n    return this._pageInfo.userUnit;\n  }\n\n  /**\n   * @type {Array<number>} An array of the visible portion of the PDF page in\n   *   user space units [x1, y1, x2, y2].\n   */\n  get view() {\n    return this._pageInfo.view;\n  }\n\n  /**\n   * @param {GetViewportParameters} params - Viewport parameters.\n   * @returns {PageViewport} Contains 'width' and 'height' properties\n   *   along with transforms required for rendering.\n   */\n  getViewport({\n    scale,\n    rotation = this.rotate,\n    offsetX = 0,\n    offsetY = 0,\n    dontFlip = false,\n  } = {}) {\n    return new PageViewport({\n      viewBox: this.view,\n      scale,\n      rotation,\n      offsetX,\n      offsetY,\n      dontFlip,\n    });\n  }\n\n  /**\n   * @param {GetAnnotationsParameters} params - Annotation parameters.\n   * @returns {Promise<Array<any>>} A promise that is resolved with an\n   *   {Array} of the annotation objects.\n   */\n  getAnnotations({ intent = \"display\" } = {}) {\n    const intentArgs = this._transport.getRenderingIntent(intent);\n\n    return this._transport.getAnnotations(\n      this._pageIndex,\n      intentArgs.renderingIntent\n    );\n  }\n\n  /**\n   * @returns {Promise<Object>} A promise that is resolved with an\n   *   {Object} with JS actions.\n   */\n  getJSActions() {\n    return this._transport.getPageJSActions(this._pageIndex);\n  }\n\n  /**\n   * @type {Object} The filter factory instance.\n   */\n  get filterFactory() {\n    return this._transport.filterFactory;\n  }\n\n  /**\n   * @type {boolean} True if only XFA form.\n   */\n  get isPureXfa() {\n    return shadow(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n  }\n\n  /**\n   * @returns {Promise<Object | null>} A promise that is resolved with\n   *   an {Object} with a fake DOM object (a tree structure where elements\n   *   are {Object} with a name, attributes (class, style, ...), value and\n   *   children, very similar to a HTML DOM tree), or `null` if no XFA exists.\n   */\n  async getXfa() {\n    return this._transport._htmlForXfa?.children[this._pageIndex] || null;\n  }\n\n  /**\n   * Begins the process of rendering a page to the desired context.\n   *\n   * @param {RenderParameters} params - Page render parameters.\n   * @returns {RenderTask} An object that contains a promise that is\n   *   resolved when the page finishes rendering.\n   */\n  render({\n    canvasContext,\n    viewport,\n    intent = \"display\",\n    annotationMode = AnnotationMode.ENABLE,\n    transform = null,\n    background = null,\n    optionalContentConfigPromise = null,\n    annotationCanvasMap = null,\n    pageColors = null,\n    printAnnotationStorage = null,\n  }) {\n    this._stats?.time(\"Overall\");\n\n    const intentArgs = this._transport.getRenderingIntent(\n      intent,\n      annotationMode,\n      printAnnotationStorage\n    );\n    // If there was a pending destroy, cancel it so no cleanup happens during\n    // this call to render...\n    this.#pendingCleanup = false;\n    // ... and ensure that a delayed cleanup is always aborted.\n    this.#abortDelayedCleanup();\n\n    if (!optionalContentConfigPromise) {\n      optionalContentConfigPromise = this._transport.getOptionalContentConfig();\n    }\n\n    let intentState = this._intentStates.get(intentArgs.cacheKey);\n    if (!intentState) {\n      intentState = Object.create(null);\n      this._intentStates.set(intentArgs.cacheKey, intentState);\n    }\n\n    // Ensure that a pending `streamReader` cancel timeout is always aborted.\n    if (intentState.streamReaderCancelTimeout) {\n      clearTimeout(intentState.streamReaderCancelTimeout);\n      intentState.streamReaderCancelTimeout = null;\n    }\n\n    const intentPrint = !!(\n      intentArgs.renderingIntent & RenderingIntentFlag.PRINT\n    );\n\n    // If there's no displayReadyCapability yet, then the operatorList\n    // was never requested before. Make the request and create the promise.\n    if (!intentState.displayReadyCapability) {\n      intentState.displayReadyCapability = new PromiseCapability();\n      intentState.operatorList = {\n        fnArray: [],\n        argsArray: [],\n        lastChunk: false,\n        separateAnnots: null,\n      };\n\n      this._stats?.time(\"Page Request\");\n      this._pumpOperatorList(intentArgs);\n    }\n\n    const complete = error => {\n      intentState.renderTasks.delete(internalRenderTask);\n\n      // Attempt to reduce memory usage during *printing*, by always running\n      // cleanup immediately once rendering has finished.\n      if (this._maybeCleanupAfterRender || intentPrint) {\n        this.#pendingCleanup = true;\n      }\n      this.#tryCleanup(/* delayed = */ !intentPrint);\n\n      if (error) {\n        internalRenderTask.capability.reject(error);\n\n        this._abortOperatorList({\n          intentState,\n          reason: error instanceof Error ? error : new Error(error),\n        });\n      } else {\n        internalRenderTask.capability.resolve();\n      }\n\n      this._stats?.timeEnd(\"Rendering\");\n      this._stats?.timeEnd(\"Overall\");\n    };\n\n    const internalRenderTask = new InternalRenderTask({\n      callback: complete,\n      // Only include the required properties, and *not* the entire object.\n      params: {\n        canvasContext,\n        viewport,\n        transform,\n        background,\n      },\n      objs: this.objs,\n      commonObjs: this.commonObjs,\n      annotationCanvasMap,\n      operatorList: intentState.operatorList,\n      pageIndex: this._pageIndex,\n      canvasFactory: this._transport.canvasFactory,\n      filterFactory: this._transport.filterFactory,\n      useRequestAnimationFrame: !intentPrint,\n      pdfBug: this._pdfBug,\n      pageColors,\n    });\n\n    (intentState.renderTasks ||= new Set()).add(internalRenderTask);\n    const renderTask = internalRenderTask.task;\n\n    Promise.all([\n      intentState.displayReadyCapability.promise,\n      optionalContentConfigPromise,\n    ])\n      .then(([transparency, optionalContentConfig]) => {\n        if (this.destroyed) {\n          complete();\n          return;\n        }\n        this._stats?.time(\"Rendering\");\n\n        internalRenderTask.initializeGraphics({\n          transparency,\n          optionalContentConfig,\n        });\n        internalRenderTask.operatorListChanged();\n      })\n      .catch(complete);\n\n    return renderTask;\n  }\n\n  /**\n   * @param {GetOperatorListParameters} params - Page getOperatorList\n   *   parameters.\n   * @returns {Promise<PDFOperatorList>} A promise resolved with an\n   *   {@link PDFOperatorList} object that represents the page's operator list.\n   */\n  getOperatorList({\n    intent = \"display\",\n    annotationMode = AnnotationMode.ENABLE,\n    printAnnotationStorage = null,\n  } = {}) {\n    if (typeof PDFJSDev !== \"undefined\" && !PDFJSDev.test(\"GENERIC\")) {\n      throw new Error(\"Not implemented: getOperatorList\");\n    }\n    function operatorListChanged() {\n      if (intentState.operatorList.lastChunk) {\n        intentState.opListReadCapability.resolve(intentState.operatorList);\n\n        intentState.renderTasks.delete(opListTask);\n      }\n    }\n\n    const intentArgs = this._transport.getRenderingIntent(\n      intent,\n      annotationMode,\n      printAnnotationStorage,\n      /* isOpList = */ true\n    );\n    let intentState = this._intentStates.get(intentArgs.cacheKey);\n    if (!intentState) {\n      intentState = Object.create(null);\n      this._intentStates.set(intentArgs.cacheKey, intentState);\n    }\n    let opListTask;\n\n    if (!intentState.opListReadCapability) {\n      opListTask = Object.create(null);\n      opListTask.operatorListChanged = operatorListChanged;\n      intentState.opListReadCapability = new PromiseCapability();\n      (intentState.renderTasks ||= new Set()).add(opListTask);\n      intentState.operatorList = {\n        fnArray: [],\n        argsArray: [],\n        lastChunk: false,\n        separateAnnots: null,\n      };\n\n      this._stats?.time(\"Page Request\");\n      this._pumpOperatorList(intentArgs);\n    }\n    return intentState.opListReadCapability.promise;\n  }\n\n  /**\n   * NOTE: All occurrences of whitespace will be replaced by\n   * standard spaces (0x20).\n   *\n   * @param {getTextContentParameters} params - getTextContent parameters.\n   * @returns {ReadableStream} Stream for reading text content chunks.\n   */\n  streamTextContent({\n    includeMarkedContent = false,\n    disableNormalization = false,\n  } = {}) {\n    const TEXT_CONTENT_CHUNK_SIZE = 100;\n\n    return this._transport.messageHandler.sendWithStream(\n      \"GetTextContent\",\n      {\n        pageIndex: this._pageIndex,\n        includeMarkedContent: includeMarkedContent === true,\n        disableNormalization: disableNormalization === true,\n      },\n      {\n        highWaterMark: TEXT_CONTENT_CHUNK_SIZE,\n        size(textContent) {\n          return textContent.items.length;\n        },\n      }\n    );\n  }\n\n  /**\n   * NOTE: All occurrences of whitespace will be replaced by\n   * standard spaces (0x20).\n   *\n   * @param {getTextContentParameters} params - getTextContent parameters.\n   * @returns {Promise<TextContent>} A promise that is resolved with a\n   *   {@link TextContent} object that represents the page's text content.\n   */\n  getTextContent(params = {}) {\n    if (this._transport._htmlForXfa) {\n      // TODO: We need to revisit this once the XFA foreground patch lands and\n      // only do this for non-foreground XFA.\n      return this.getXfa().then(xfa => {\n        return XfaText.textContent(xfa);\n      });\n    }\n    const readableStream = this.streamTextContent(params);\n\n    return new Promise(function (resolve, reject) {\n      function pump() {\n        reader.read().then(function ({ value, done }) {\n          if (done) {\n            resolve(textContent);\n            return;\n          }\n          Object.assign(textContent.styles, value.styles);\n          textContent.items.push(...value.items);\n          pump();\n        }, reject);\n      }\n\n      const reader = readableStream.getReader();\n      const textContent = {\n        items: [],\n        styles: Object.create(null),\n      };\n      pump();\n    });\n  }\n\n  /**\n   * @returns {Promise<StructTreeNode>} A promise that is resolved with a\n   *   {@link StructTreeNode} object that represents the page's structure tree,\n   *   or `null` when no structure tree is present for the current page.\n   */\n  getStructTree() {\n    return this._transport.getStructTree(this._pageIndex);\n  }\n\n  /**\n   * Destroys the page object.\n   * @private\n   */\n  _destroy() {\n    this.destroyed = true;\n\n    const waitOn = [];\n    for (const intentState of this._intentStates.values()) {\n      this._abortOperatorList({\n        intentState,\n        reason: new Error(\"Page was destroyed.\"),\n        force: true,\n      });\n\n      if (intentState.opListReadCapability) {\n        // Avoid errors below, since the renderTasks are just stubs.\n        continue;\n      }\n      for (const internalRenderTask of intentState.renderTasks) {\n        waitOn.push(internalRenderTask.completed);\n        internalRenderTask.cancel();\n      }\n    }\n    this.objs.clear();\n    this.#pendingCleanup = false;\n    this.#abortDelayedCleanup();\n\n    return Promise.all(waitOn);\n  }\n\n  /**\n   * Cleans up resources allocated by the page.\n   *\n   * @param {boolean} [resetStats] - Reset page stats, if enabled.\n   *   The default value is `false`.\n   * @returns {boolean} Indicates if clean-up was successfully run.\n   */\n  cleanup(resetStats = false) {\n    this.#pendingCleanup = true;\n    const success = this.#tryCleanup(/* delayed = */ false);\n\n    if (resetStats && success) {\n      this._stats &&= new StatTimer();\n    }\n    return success;\n  }\n\n  /**\n   * Attempts to clean up if rendering is in a state where that's possible.\n   * @param {boolean} [delayed] - Delay the cleanup, to e.g. improve zooming\n   *   performance in documents with large images.\n   *   The default value is `false`.\n   * @returns {boolean} Indicates if clean-up was successfully run.\n   */\n  #tryCleanup(delayed = false) {\n    this.#abortDelayedCleanup();\n\n    if (!this.#pendingCleanup || this.destroyed) {\n      return false;\n    }\n    if (delayed) {\n      this.#delayedCleanupTimeout = setTimeout(() => {\n        this.#delayedCleanupTimeout = null;\n        this.#tryCleanup(/* delayed = */ false);\n      }, DELAYED_CLEANUP_TIMEOUT);\n\n      return false;\n    }\n    for (const { renderTasks, operatorList } of this._intentStates.values()) {\n      if (renderTasks.size > 0 || !operatorList.lastChunk) {\n        return false;\n      }\n    }\n    this._intentStates.clear();\n    this.objs.clear();\n    this.#pendingCleanup = false;\n    return true;\n  }\n\n  #abortDelayedCleanup() {\n    if (this.#delayedCleanupTimeout) {\n      clearTimeout(this.#delayedCleanupTimeout);\n      this.#delayedCleanupTimeout = null;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _startRenderPage(transparency, cacheKey) {\n    const intentState = this._intentStates.get(cacheKey);\n    if (!intentState) {\n      return; // Rendering was cancelled.\n    }\n    this._stats?.timeEnd(\"Page Request\");\n\n    // TODO Refactor RenderPageRequest to separate rendering\n    // and operator list logic\n    intentState.displayReadyCapability?.resolve(transparency);\n  }\n\n  /**\n   * @private\n   */\n  _renderPageChunk(operatorListChunk, intentState) {\n    // Add the new chunk to the current operator list.\n    for (let i = 0, ii = operatorListChunk.length; i < ii; i++) {\n      intentState.operatorList.fnArray.push(operatorListChunk.fnArray[i]);\n      intentState.operatorList.argsArray.push(operatorListChunk.argsArray[i]);\n    }\n    intentState.operatorList.lastChunk = operatorListChunk.lastChunk;\n    intentState.operatorList.separateAnnots = operatorListChunk.separateAnnots;\n\n    // Notify all the rendering tasks there are more operators to be consumed.\n    for (const internalRenderTask of intentState.renderTasks) {\n      internalRenderTask.operatorListChanged();\n    }\n\n    if (operatorListChunk.lastChunk) {\n      this.#tryCleanup(/* delayed = */ true);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _pumpOperatorList({\n    renderingIntent,\n    cacheKey,\n    annotationStorageSerializable,\n  }) {\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      assert(\n        Number.isInteger(renderingIntent) && renderingIntent > 0,\n        '_pumpOperatorList: Expected valid \"renderingIntent\" argument.'\n      );\n    }\n    const { map, transfers } = annotationStorageSerializable;\n\n    const readableStream = this._transport.messageHandler.sendWithStream(\n      \"GetOperatorList\",\n      {\n        pageIndex: this._pageIndex,\n        intent: renderingIntent,\n        cacheKey,\n        annotationStorage: map,\n      },\n      transfers\n    );\n    const reader = readableStream.getReader();\n\n    const intentState = this._intentStates.get(cacheKey);\n    intentState.streamReader = reader;\n\n    const pump = () => {\n      reader.read().then(\n        ({ value, done }) => {\n          if (done) {\n            intentState.streamReader = null;\n            return;\n          }\n          if (this._transport.destroyed) {\n            return; // Ignore any pending requests if the worker was terminated.\n          }\n          this._renderPageChunk(value, intentState);\n          pump();\n        },\n        reason => {\n          intentState.streamReader = null;\n\n          if (this._transport.destroyed) {\n            return; // Ignore any pending requests if the worker was terminated.\n          }\n          if (intentState.operatorList) {\n            // Mark operator list as complete.\n            intentState.operatorList.lastChunk = true;\n\n            for (const internalRenderTask of intentState.renderTasks) {\n              internalRenderTask.operatorListChanged();\n            }\n            this.#tryCleanup(/* delayed = */ true);\n          }\n\n          if (intentState.displayReadyCapability) {\n            intentState.displayReadyCapability.reject(reason);\n          } else if (intentState.opListReadCapability) {\n            intentState.opListReadCapability.reject(reason);\n          } else {\n            throw reason;\n          }\n        }\n      );\n    };\n    pump();\n  }\n\n  /**\n   * @private\n   */\n  _abortOperatorList({ intentState, reason, force = false }) {\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      assert(\n        reason instanceof Error,\n        '_abortOperatorList: Expected valid \"reason\" argument.'\n      );\n    }\n\n    if (!intentState.streamReader) {\n      return;\n    }\n    // Ensure that a pending `streamReader` cancel timeout is always aborted.\n    if (intentState.streamReaderCancelTimeout) {\n      clearTimeout(intentState.streamReaderCancelTimeout);\n      intentState.streamReaderCancelTimeout = null;\n    }\n\n    if (!force) {\n      // Ensure that an Error occurring in *only* one `InternalRenderTask`, e.g.\n      // multiple render() calls on the same canvas, won't break all rendering.\n      if (intentState.renderTasks.size > 0) {\n        return;\n      }\n      // Don't immediately abort parsing on the worker-thread when rendering is\n      // cancelled, since that will unnecessarily delay re-rendering when (for\n      // partially parsed pages) e.g. zooming/rotation occurs in the viewer.\n      if (reason instanceof RenderingCancelledException) {\n        let delay = RENDERING_CANCELLED_TIMEOUT;\n        if (reason.extraDelay > 0 && reason.extraDelay < /* ms = */ 1000) {\n          // Above, we prevent the total delay from becoming arbitrarily large.\n          delay += reason.extraDelay;\n        }\n\n        intentState.streamReaderCancelTimeout = setTimeout(() => {\n          intentState.streamReaderCancelTimeout = null;\n          this._abortOperatorList({ intentState, reason, force: true });\n        }, delay);\n        return;\n      }\n    }\n    intentState.streamReader\n      .cancel(new AbortException(reason.message))\n      .catch(() => {\n        // Avoid \"Uncaught promise\" messages in the console.\n      });\n    intentState.streamReader = null;\n\n    if (this._transport.destroyed) {\n      return; // Ignore any pending requests if the worker was terminated.\n    }\n    // Remove the current `intentState`, since a cancelled `getOperatorList`\n    // call on the worker-thread cannot be re-started...\n    for (const [curCacheKey, curIntentState] of this._intentStates) {\n      if (curIntentState === intentState) {\n        this._intentStates.delete(curCacheKey);\n        break;\n      }\n    }\n    // ... and force clean-up to ensure that any old state is always removed.\n    this.cleanup();\n  }\n\n  /**\n   * @type {StatTimer | null} Returns page stats, if enabled; returns `null`\n   *   otherwise.\n   */\n  get stats() {\n    return this._stats;\n  }\n}\n\nclass LoopbackPort {\n  #listeners = new Set();\n\n  #deferred = Promise.resolve();\n\n  postMessage(obj, transfer) {\n    const event = {\n      data: structuredClone(\n        obj,\n        (typeof PDFJSDev === \"undefined\" ||\n          PDFJSDev.test(\"SKIP_BABEL || TESTING\")) &&\n          transfer\n          ? { transfer }\n          : null\n      ),\n    };\n\n    this.#deferred.then(() => {\n      for (const listener of this.#listeners) {\n        listener.call(this, event);\n      }\n    });\n  }\n\n  addEventListener(name, listener) {\n    this.#listeners.add(listener);\n  }\n\n  removeEventListener(name, listener) {\n    this.#listeners.delete(listener);\n  }\n\n  terminate() {\n    this.#listeners.clear();\n  }\n}\n\n/**\n * @typedef {Object} PDFWorkerParameters\n * @property {string} [name] - The name of the worker.\n * @property {Worker} [port] - The `workerPort` object.\n * @property {number} [verbosity] - Controls the logging level;\n *   the constants from {@link VerbosityLevel} should be used.\n */\n\nconst PDFWorkerUtil = {\n  isWorkerDisabled: false,\n  fallbackWorkerSrc: null,\n  fakeWorkerId: 0,\n};\nif (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n  // eslint-disable-next-line no-undef\n  if (isNodeJS && typeof __non_webpack_require__ === \"function\") {\n    // Workers aren't supported in Node.js, force-disabling them there.\n    PDFWorkerUtil.isWorkerDisabled = true;\n\n    PDFWorkerUtil.fallbackWorkerSrc = PDFJSDev.test(\"LIB\")\n      ? \"../pdf.worker.js\"\n      : \"./pdf.worker.js\";\n  } else if (typeof document === \"object\") {\n    const pdfjsFilePath = document?.currentScript?.src;\n    if (pdfjsFilePath) {\n      PDFWorkerUtil.fallbackWorkerSrc = pdfjsFilePath.replace(\n        /(\\.(?:min\\.)?js)(\\?.*)?$/i,\n        \".worker$1$2\"\n      );\n    }\n  }\n\n  // Check if URLs have the same origin. For non-HTTP based URLs, returns false.\n  PDFWorkerUtil.isSameOrigin = function (baseUrl, otherUrl) {\n    let base;\n    try {\n      base = new URL(baseUrl);\n      if (!base.origin || base.origin === \"null\") {\n        return false; // non-HTTP url\n      }\n    } catch {\n      return false;\n    }\n\n    const other = new URL(otherUrl, base);\n    return base.origin === other.origin;\n  };\n\n  PDFWorkerUtil.createCDNWrapper = function (url) {\n    // We will rely on blob URL's property to specify origin.\n    // We want this function to fail in case if createObjectURL or Blob do not\n    // exist or fail for some reason -- our Worker creation will fail anyway.\n    const wrapper = `importScripts(\"${url}\");`;\n    return URL.createObjectURL(new Blob([wrapper]));\n  };\n}\n\n/**\n * PDF.js web worker abstraction that controls the instantiation of PDF\n * documents. Message handlers are used to pass information from the main\n * thread to the worker thread and vice versa. If the creation of a web\n * worker is not possible, a \"fake\" worker will be used instead.\n *\n * @param {PDFWorkerParameters} params - The worker initialization parameters.\n */\nclass PDFWorker {\n  static #workerPorts = new WeakMap();\n\n  constructor({\n    name = null,\n    port = null,\n    verbosity = getVerbosityLevel(),\n  } = {}) {\n    if (port && PDFWorker.#workerPorts.has(port)) {\n      throw new Error(\"Cannot use more than one PDFWorker per port.\");\n    }\n\n    this.name = name;\n    this.destroyed = false;\n    this.verbosity = verbosity;\n\n    this._readyCapability = new PromiseCapability();\n    this._port = null;\n    this._webWorker = null;\n    this._messageHandler = null;\n\n    if (port) {\n      PDFWorker.#workerPorts.set(port, this);\n      this._initializeFromPort(port);\n      return;\n    }\n    this._initialize();\n  }\n\n  /**\n   * Promise for worker initialization completion.\n   * @type {Promise<void>}\n   */\n  get promise() {\n    return this._readyCapability.promise;\n  }\n\n  /**\n   * The current `workerPort`, when it exists.\n   * @type {Worker}\n   */\n  get port() {\n    return this._port;\n  }\n\n  /**\n   * The current MessageHandler-instance.\n   * @type {MessageHandler}\n   */\n  get messageHandler() {\n    return this._messageHandler;\n  }\n\n  _initializeFromPort(port) {\n    this._port = port;\n    this._messageHandler = new MessageHandler(\"main\", \"worker\", port);\n    this._messageHandler.on(\"ready\", function () {\n      // Ignoring \"ready\" event -- MessageHandler should already be initialized\n      // and ready to accept messages.\n    });\n    this._readyCapability.resolve();\n    // Send global setting, e.g. verbosity level.\n    this._messageHandler.send(\"configure\", {\n      verbosity: this.verbosity,\n    });\n  }\n\n  _initialize() {\n    // If worker support isn't disabled explicit and the browser has worker\n    // support, create a new web worker and test if it/the browser fulfills\n    // all requirements to run parts of pdf.js in a web worker.\n    // Right now, the requirement is, that an Uint8Array is still an\n    // Uint8Array as it arrives on the worker. (Chrome added this with v.15.)\n    if (\n      !PDFWorkerUtil.isWorkerDisabled &&\n      !PDFWorker._mainThreadWorkerMessageHandler\n    ) {\n      let { workerSrc } = PDFWorker;\n\n      try {\n        // Wraps workerSrc path into blob URL, if the former does not belong\n        // to the same origin.\n        if (\n          typeof PDFJSDev !== \"undefined\" &&\n          PDFJSDev.test(\"GENERIC\") &&\n          !PDFWorkerUtil.isSameOrigin(window.location.href, workerSrc)\n        ) {\n          workerSrc = PDFWorkerUtil.createCDNWrapper(\n            new URL(workerSrc, window.location).href\n          );\n        }\n\n        const worker =\n          typeof PDFJSDev === \"undefined\" &&\n          !workerSrc.endsWith(\"/build/pdf.worker.js\")\n            ? new Worker(workerSrc, { type: \"module\" })\n            : new Worker(workerSrc);\n        const messageHandler = new MessageHandler(\"main\", \"worker\", worker);\n        const terminateEarly = () => {\n          worker.removeEventListener(\"error\", onWorkerError);\n          messageHandler.destroy();\n          worker.terminate();\n          if (this.destroyed) {\n            this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n          } else {\n            // Fall back to fake worker if the termination is caused by an\n            // error (e.g. NetworkError / SecurityError).\n            this._setupFakeWorker();\n          }\n        };\n\n        const onWorkerError = () => {\n          if (!this._webWorker) {\n            // Worker failed to initialize due to an error. Clean up and fall\n            // back to the fake worker.\n            terminateEarly();\n          }\n        };\n        worker.addEventListener(\"error\", onWorkerError);\n\n        messageHandler.on(\"test\", data => {\n          worker.removeEventListener(\"error\", onWorkerError);\n          if (this.destroyed) {\n            terminateEarly();\n            return; // worker was destroyed\n          }\n          if (data) {\n            this._messageHandler = messageHandler;\n            this._port = worker;\n            this._webWorker = worker;\n\n            this._readyCapability.resolve();\n            // Send global setting, e.g. verbosity level.\n            messageHandler.send(\"configure\", {\n              verbosity: this.verbosity,\n            });\n          } else {\n            this._setupFakeWorker();\n            messageHandler.destroy();\n            worker.terminate();\n          }\n        });\n\n        messageHandler.on(\"ready\", data => {\n          worker.removeEventListener(\"error\", onWorkerError);\n          if (this.destroyed) {\n            terminateEarly();\n            return; // worker was destroyed\n          }\n          try {\n            sendTest();\n          } catch {\n            // We need fallback to a faked worker.\n            this._setupFakeWorker();\n          }\n        });\n\n        const sendTest = () => {\n          const testObj = new Uint8Array();\n          // Ensure that we can use `postMessage` transfers.\n          messageHandler.send(\"test\", testObj, [testObj.buffer]);\n        };\n\n        // It might take time for the worker to initialize. We will try to send\n        // the \"test\" message immediately, and once the \"ready\" message arrives.\n        // The worker shall process only the first received \"test\" message.\n        sendTest();\n        return;\n      } catch {\n        info(\"The worker has been disabled.\");\n      }\n    }\n    // Either workers are disabled, not supported or have thrown an exception.\n    // Thus, we fallback to a faked worker.\n    this._setupFakeWorker();\n  }\n\n  _setupFakeWorker() {\n    if (!PDFWorkerUtil.isWorkerDisabled) {\n      warn(\"Setting up fake worker.\");\n      PDFWorkerUtil.isWorkerDisabled = true;\n    }\n\n    PDFWorker._setupFakeWorkerGlobal\n      .then(WorkerMessageHandler => {\n        if (this.destroyed) {\n          this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n          return;\n        }\n        const port = new LoopbackPort();\n        this._port = port;\n\n        // All fake workers use the same port, making id unique.\n        const id = `fake${PDFWorkerUtil.fakeWorkerId++}`;\n\n        // If the main thread is our worker, setup the handling for the\n        // messages -- the main thread sends to it self.\n        const workerHandler = new MessageHandler(id + \"_worker\", id, port);\n        WorkerMessageHandler.setup(workerHandler, port);\n\n        const messageHandler = new MessageHandler(id, id + \"_worker\", port);\n        this._messageHandler = messageHandler;\n        this._readyCapability.resolve();\n        // Send global setting, e.g. verbosity level.\n        messageHandler.send(\"configure\", {\n          verbosity: this.verbosity,\n        });\n      })\n      .catch(reason => {\n        this._readyCapability.reject(\n          new Error(`Setting up fake worker failed: \"${reason.message}\".`)\n        );\n      });\n  }\n\n  /**\n   * Destroys the worker instance.\n   */\n  destroy() {\n    this.destroyed = true;\n    if (this._webWorker) {\n      // We need to terminate only web worker created resource.\n      this._webWorker.terminate();\n      this._webWorker = null;\n    }\n    PDFWorker.#workerPorts.delete(this._port);\n    this._port = null;\n    if (this._messageHandler) {\n      this._messageHandler.destroy();\n      this._messageHandler = null;\n    }\n  }\n\n  /**\n   * @param {PDFWorkerParameters} params - The worker initialization parameters.\n   */\n  static fromPort(params) {\n    if (!params?.port) {\n      throw new Error(\"PDFWorker.fromPort - invalid method signature.\");\n    }\n    if (this.#workerPorts.has(params.port)) {\n      return this.#workerPorts.get(params.port);\n    }\n    return new PDFWorker(params);\n  }\n\n  /**\n   * The current `workerSrc`, when it exists.\n   * @type {string}\n   */\n  static get workerSrc() {\n    if (GlobalWorkerOptions.workerSrc) {\n      return GlobalWorkerOptions.workerSrc;\n    }\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      PDFWorkerUtil.fallbackWorkerSrc !== null\n    ) {\n      if (!isNodeJS) {\n        deprecated('No \"GlobalWorkerOptions.workerSrc\" specified.');\n      }\n      return PDFWorkerUtil.fallbackWorkerSrc;\n    }\n    throw new Error('No \"GlobalWorkerOptions.workerSrc\" specified.');\n  }\n\n  static get _mainThreadWorkerMessageHandler() {\n    try {\n      return globalThis.pdfjsWorker?.WorkerMessageHandler || null;\n    } catch {\n      return null;\n    }\n  }\n\n  // Loads worker code into the main-thread.\n  static get _setupFakeWorkerGlobal() {\n    const loader = async () => {\n      const mainWorkerMessageHandler = this._mainThreadWorkerMessageHandler;\n\n      if (mainWorkerMessageHandler) {\n        // The worker was already loaded using e.g. a `<script>` tag.\n        return mainWorkerMessageHandler;\n      }\n      if (typeof PDFJSDev === \"undefined\") {\n        const worker = await import(\"pdfjs/pdf.worker.js\");\n        return worker.WorkerMessageHandler;\n      }\n      if (\n        PDFJSDev.test(\"GENERIC\") &&\n        isNodeJS &&\n        // eslint-disable-next-line no-undef\n        typeof __non_webpack_require__ === \"function\"\n      ) {\n        // Since bundlers, such as Webpack, cannot be told to leave `require`\n        // statements alone we are thus forced to jump through hoops in order\n        // to prevent `Critical dependency: ...` warnings in third-party\n        // deployments of the built `pdf.js`/`pdf.worker.js` files; see\n        // https://github.com/webpack/webpack/issues/8826\n        //\n        // The following hack is based on the assumption that code running in\n        // Node.js won't ever be affected by e.g. Content Security Policies that\n        // prevent the use of `eval`. If that ever occurs, we should revert this\n        // to a normal `__non_webpack_require__` statement and simply document\n        // the Webpack warnings instead (telling users to ignore them).\n        //\n        // eslint-disable-next-line no-eval\n        const worker = eval(\"require\")(this.workerSrc);\n        return worker.WorkerMessageHandler;\n      }\n      await loadScript(this.workerSrc);\n      return window.pdfjsWorker.WorkerMessageHandler;\n    };\n\n    return shadow(this, \"_setupFakeWorkerGlobal\", loader());\n  }\n}\n\n/**\n * For internal use only.\n * @ignore\n */\nclass WorkerTransport {\n  #methodPromises = new Map();\n\n  #pageCache = new Map();\n\n  #pagePromises = new Map();\n\n  constructor(messageHandler, loadingTask, networkStream, params, factory) {\n    this.messageHandler = messageHandler;\n    this.loadingTask = loadingTask;\n    this.commonObjs = new PDFObjects();\n    this.fontLoader = new FontLoader({\n      ownerDocument: params.ownerDocument,\n      styleElement: params.styleElement,\n    });\n    this._params = params;\n\n    this.canvasFactory = factory.canvasFactory;\n    this.filterFactory = factory.filterFactory;\n    this.cMapReaderFactory = factory.cMapReaderFactory;\n    this.standardFontDataFactory = factory.standardFontDataFactory;\n\n    this.destroyed = false;\n    this.destroyCapability = null;\n    this._passwordCapability = null;\n\n    this._networkStream = networkStream;\n    this._fullReader = null;\n    this._lastProgress = null;\n    this.downloadInfoCapability = new PromiseCapability();\n\n    this.setupMessageHandler();\n\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      // For testing purposes.\n      Object.defineProperty(this, \"getXFADatasets\", {\n        value: () => {\n          return this.messageHandler.sendWithPromise(\"GetXFADatasets\", null);\n        },\n      });\n      Object.defineProperty(this, \"getXRefPrevValue\", {\n        value: () => {\n          return this.messageHandler.sendWithPromise(\"GetXRefPrevValue\", null);\n        },\n      });\n      Object.defineProperty(this, \"getAnnotArray\", {\n        value: pageIndex => {\n          return this.messageHandler.sendWithPromise(\"GetAnnotArray\", {\n            pageIndex,\n          });\n        },\n      });\n    }\n  }\n\n  #cacheSimpleMethod(name, data = null) {\n    const cachedPromise = this.#methodPromises.get(name);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler.sendWithPromise(name, data);\n\n    this.#methodPromises.set(name, promise);\n    return promise;\n  }\n\n  get annotationStorage() {\n    return shadow(this, \"annotationStorage\", new AnnotationStorage());\n  }\n\n  getRenderingIntent(\n    intent,\n    annotationMode = AnnotationMode.ENABLE,\n    printAnnotationStorage = null,\n    isOpList = false\n  ) {\n    let renderingIntent = RenderingIntentFlag.DISPLAY; // Default value.\n    let annotationStorageSerializable = SerializableEmpty;\n\n    switch (intent) {\n      case \"any\":\n        renderingIntent = RenderingIntentFlag.ANY;\n        break;\n      case \"display\":\n        break;\n      case \"print\":\n        renderingIntent = RenderingIntentFlag.PRINT;\n        break;\n      default:\n        warn(`getRenderingIntent - invalid intent: ${intent}`);\n    }\n\n    switch (annotationMode) {\n      case AnnotationMode.DISABLE:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_DISABLE;\n        break;\n      case AnnotationMode.ENABLE:\n        break;\n      case AnnotationMode.ENABLE_FORMS:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_FORMS;\n        break;\n      case AnnotationMode.ENABLE_STORAGE:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_STORAGE;\n\n        const annotationStorage =\n          renderingIntent & RenderingIntentFlag.PRINT &&\n          printAnnotationStorage instanceof PrintAnnotationStorage\n            ? printAnnotationStorage\n            : this.annotationStorage;\n\n        annotationStorageSerializable = annotationStorage.serializable;\n        break;\n      default:\n        warn(`getRenderingIntent - invalid annotationMode: ${annotationMode}`);\n    }\n\n    if (isOpList) {\n      renderingIntent += RenderingIntentFlag.OPLIST;\n    }\n\n    return {\n      renderingIntent,\n      cacheKey: `${renderingIntent}_${annotationStorageSerializable.hash}`,\n      annotationStorageSerializable,\n    };\n  }\n\n  destroy() {\n    if (this.destroyCapability) {\n      return this.destroyCapability.promise;\n    }\n\n    this.destroyed = true;\n    this.destroyCapability = new PromiseCapability();\n\n    if (this._passwordCapability) {\n      this._passwordCapability.reject(\n        new Error(\"Worker was destroyed during onPassword callback\")\n      );\n    }\n\n    const waitOn = [];\n    // We need to wait for all renderings to be completed, e.g.\n    // timeout/rAF can take a long time.\n    for (const page of this.#pageCache.values()) {\n      waitOn.push(page._destroy());\n    }\n    this.#pageCache.clear();\n    this.#pagePromises.clear();\n    // Allow `AnnotationStorage`-related clean-up when destroying the document.\n    if (this.hasOwnProperty(\"annotationStorage\")) {\n      this.annotationStorage.resetModified();\n    }\n    // We also need to wait for the worker to finish its long running tasks.\n    const terminated = this.messageHandler.sendWithPromise(\"Terminate\", null);\n    waitOn.push(terminated);\n\n    Promise.all(waitOn).then(() => {\n      this.commonObjs.clear();\n      this.fontLoader.clear();\n      this.#methodPromises.clear();\n      this.filterFactory.destroy();\n\n      if (this._networkStream) {\n        this._networkStream.cancelAllRequests(\n          new AbortException(\"Worker was terminated.\")\n        );\n      }\n\n      if (this.messageHandler) {\n        this.messageHandler.destroy();\n        this.messageHandler = null;\n      }\n      this.destroyCapability.resolve();\n    }, this.destroyCapability.reject);\n    return this.destroyCapability.promise;\n  }\n\n  setupMessageHandler() {\n    const { messageHandler, loadingTask } = this;\n\n    messageHandler.on(\"GetReader\", (data, sink) => {\n      assert(\n        this._networkStream,\n        \"GetReader - no `IPDFStream` instance available.\"\n      );\n      this._fullReader = this._networkStream.getFullReader();\n      this._fullReader.onProgress = evt => {\n        this._lastProgress = {\n          loaded: evt.loaded,\n          total: evt.total,\n        };\n      };\n      sink.onPull = () => {\n        this._fullReader\n          .read()\n          .then(function ({ value, done }) {\n            if (done) {\n              sink.close();\n              return;\n            }\n            assert(\n              value instanceof ArrayBuffer,\n              \"GetReader - expected an ArrayBuffer.\"\n            );\n            // Enqueue data chunk into sink, and transfer it\n            // to other side as `Transferable` object.\n            sink.enqueue(new Uint8Array(value), 1, [value]);\n          })\n          .catch(reason => {\n            sink.error(reason);\n          });\n      };\n\n      sink.onCancel = reason => {\n        this._fullReader.cancel(reason);\n\n        sink.ready.catch(readyReason => {\n          if (this.destroyed) {\n            return; // Ignore any pending requests if the worker was terminated.\n          }\n          throw readyReason;\n        });\n      };\n    });\n\n    messageHandler.on(\"ReaderHeadersReady\", data => {\n      const headersCapability = new PromiseCapability();\n      const fullReader = this._fullReader;\n      fullReader.headersReady.then(() => {\n        // If stream or range are disabled, it's our only way to report\n        // loading progress.\n        if (!fullReader.isStreamingSupported || !fullReader.isRangeSupported) {\n          if (this._lastProgress) {\n            loadingTask.onProgress?.(this._lastProgress);\n          }\n          fullReader.onProgress = evt => {\n            loadingTask.onProgress?.({\n              loaded: evt.loaded,\n              total: evt.total,\n            });\n          };\n        }\n\n        headersCapability.resolve({\n          isStreamingSupported: fullReader.isStreamingSupported,\n          isRangeSupported: fullReader.isRangeSupported,\n          contentLength: fullReader.contentLength,\n        });\n      }, headersCapability.reject);\n\n      return headersCapability.promise;\n    });\n\n    messageHandler.on(\"GetRangeReader\", (data, sink) => {\n      assert(\n        this._networkStream,\n        \"GetRangeReader - no `IPDFStream` instance available.\"\n      );\n      const rangeReader = this._networkStream.getRangeReader(\n        data.begin,\n        data.end\n      );\n\n      // When streaming is enabled, it's possible that the data requested here\n      // has already been fetched via the `_fullRequestReader` implementation.\n      // However, given that the PDF data is loaded asynchronously on the\n      // main-thread and then sent via `postMessage` to the worker-thread,\n      // it may not have been available during parsing (hence the attempt to\n      // use range requests here).\n      //\n      // To avoid wasting time and resources here, we'll thus *not* dispatch\n      // range requests if the data was already loaded but has not been sent to\n      // the worker-thread yet (which will happen via the `_fullRequestReader`).\n      if (!rangeReader) {\n        sink.close();\n        return;\n      }\n\n      sink.onPull = () => {\n        rangeReader\n          .read()\n          .then(function ({ value, done }) {\n            if (done) {\n              sink.close();\n              return;\n            }\n            assert(\n              value instanceof ArrayBuffer,\n              \"GetRangeReader - expected an ArrayBuffer.\"\n            );\n            sink.enqueue(new Uint8Array(value), 1, [value]);\n          })\n          .catch(reason => {\n            sink.error(reason);\n          });\n      };\n\n      sink.onCancel = reason => {\n        rangeReader.cancel(reason);\n\n        sink.ready.catch(readyReason => {\n          if (this.destroyed) {\n            return; // Ignore any pending requests if the worker was terminated.\n          }\n          throw readyReason;\n        });\n      };\n    });\n\n    messageHandler.on(\"GetDoc\", ({ pdfInfo }) => {\n      this._numPages = pdfInfo.numPages;\n      this._htmlForXfa = pdfInfo.htmlForXfa;\n      delete pdfInfo.htmlForXfa;\n      loadingTask._capability.resolve(new PDFDocumentProxy(pdfInfo, this));\n    });\n\n    messageHandler.on(\"DocException\", function (ex) {\n      let reason;\n      switch (ex.name) {\n        case \"PasswordException\":\n          reason = new PasswordException(ex.message, ex.code);\n          break;\n        case \"InvalidPDFException\":\n          reason = new InvalidPDFException(ex.message);\n          break;\n        case \"MissingPDFException\":\n          reason = new MissingPDFException(ex.message);\n          break;\n        case \"UnexpectedResponseException\":\n          reason = new UnexpectedResponseException(ex.message, ex.status);\n          break;\n        case \"UnknownErrorException\":\n          reason = new UnknownErrorException(ex.message, ex.details);\n          break;\n        default:\n          unreachable(\"DocException - expected a valid Error.\");\n      }\n      loadingTask._capability.reject(reason);\n    });\n\n    messageHandler.on(\"PasswordRequest\", exception => {\n      this._passwordCapability = new PromiseCapability();\n\n      if (loadingTask.onPassword) {\n        const updatePassword = password => {\n          if (password instanceof Error) {\n            this._passwordCapability.reject(password);\n          } else {\n            this._passwordCapability.resolve({ password });\n          }\n        };\n        try {\n          loadingTask.onPassword(updatePassword, exception.code);\n        } catch (ex) {\n          this._passwordCapability.reject(ex);\n        }\n      } else {\n        this._passwordCapability.reject(\n          new PasswordException(exception.message, exception.code)\n        );\n      }\n      return this._passwordCapability.promise;\n    });\n\n    messageHandler.on(\"DataLoaded\", data => {\n      // For consistency: Ensure that progress is always reported when the\n      // entire PDF file has been loaded, regardless of how it was fetched.\n      loadingTask.onProgress?.({\n        loaded: data.length,\n        total: data.length,\n      });\n\n      this.downloadInfoCapability.resolve(data);\n    });\n\n    messageHandler.on(\"StartRenderPage\", data => {\n      if (this.destroyed) {\n        return; // Ignore any pending requests if the worker was terminated.\n      }\n\n      const page = this.#pageCache.get(data.pageIndex);\n      page._startRenderPage(data.transparency, data.cacheKey);\n    });\n\n    messageHandler.on(\"commonobj\", ([id, type, exportedData]) => {\n      if (this.destroyed) {\n        return; // Ignore any pending requests if the worker was terminated.\n      }\n\n      if (this.commonObjs.has(id)) {\n        return;\n      }\n\n      switch (type) {\n        case \"Font\":\n          const params = this._params;\n\n          if (\"error\" in exportedData) {\n            const exportedError = exportedData.error;\n            warn(`Error during font loading: ${exportedError}`);\n            this.commonObjs.resolve(id, exportedError);\n            break;\n          }\n\n          const inspectFont =\n            params.pdfBug && globalThis.FontInspector?.enabled\n              ? (font, url) => globalThis.FontInspector.fontAdded(font, url)\n              : null;\n          const font = new FontFaceObject(exportedData, {\n            isEvalSupported: params.isEvalSupported,\n            disableFontFace: params.disableFontFace,\n            ignoreErrors: params.ignoreErrors,\n            inspectFont,\n          });\n\n          this.fontLoader\n            .bind(font)\n            .catch(reason => {\n              return messageHandler.sendWithPromise(\"FontFallback\", { id });\n            })\n            .finally(() => {\n              if (!params.fontExtraProperties && font.data) {\n                // Immediately release the `font.data` property once the font\n                // has been attached to the DOM, since it's no longer needed,\n                // rather than waiting for a `PDFDocumentProxy.cleanup` call.\n                // Since `font.data` could be very large, e.g. in some cases\n                // multiple megabytes, this will help reduce memory usage.\n                font.data = null;\n              }\n              this.commonObjs.resolve(id, font);\n            });\n          break;\n        case \"FontPath\":\n        case \"Image\":\n        case \"Pattern\":\n          this.commonObjs.resolve(id, exportedData);\n          break;\n        default:\n          throw new Error(`Got unknown common object type ${type}`);\n      }\n    });\n\n    messageHandler.on(\"obj\", ([id, pageIndex, type, imageData]) => {\n      if (this.destroyed) {\n        // Ignore any pending requests if the worker was terminated.\n        return;\n      }\n\n      const pageProxy = this.#pageCache.get(pageIndex);\n      if (pageProxy.objs.has(id)) {\n        return;\n      }\n\n      switch (type) {\n        case \"Image\":\n          pageProxy.objs.resolve(id, imageData);\n\n          // Heuristic that will allow us not to store large data.\n          if (imageData) {\n            let length;\n            if (imageData.bitmap) {\n              const { width, height } = imageData;\n              length = width * height * 4;\n            } else {\n              length = imageData.data?.length || 0;\n            }\n\n            if (length > MAX_IMAGE_SIZE_TO_CACHE) {\n              pageProxy._maybeCleanupAfterRender = true;\n            }\n          }\n          break;\n        case \"Pattern\":\n          pageProxy.objs.resolve(id, imageData);\n          break;\n        default:\n          throw new Error(`Got unknown object type ${type}`);\n      }\n    });\n\n    messageHandler.on(\"DocProgress\", data => {\n      if (this.destroyed) {\n        return; // Ignore any pending requests if the worker was terminated.\n      }\n      loadingTask.onProgress?.({\n        loaded: data.loaded,\n        total: data.total,\n      });\n    });\n\n    messageHandler.on(\"FetchBuiltInCMap\", data => {\n      if (this.destroyed) {\n        return Promise.reject(new Error(\"Worker was destroyed.\"));\n      }\n      if (!this.cMapReaderFactory) {\n        return Promise.reject(\n          new Error(\n            \"CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.\"\n          )\n        );\n      }\n      return this.cMapReaderFactory.fetch(data);\n    });\n\n    messageHandler.on(\"FetchStandardFontData\", data => {\n      if (this.destroyed) {\n        return Promise.reject(new Error(\"Worker was destroyed.\"));\n      }\n      if (!this.standardFontDataFactory) {\n        return Promise.reject(\n          new Error(\n            \"StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.\"\n          )\n        );\n      }\n      return this.standardFontDataFactory.fetch(data);\n    });\n  }\n\n  getData() {\n    return this.messageHandler.sendWithPromise(\"GetData\", null);\n  }\n\n  saveDocument() {\n    if (this.annotationStorage.size <= 0) {\n      warn(\n        \"saveDocument called while `annotationStorage` is empty, \" +\n          \"please use the getData-method instead.\"\n      );\n    }\n    const { map, transfers } = this.annotationStorage.serializable;\n\n    return this.messageHandler\n      .sendWithPromise(\n        \"SaveDocument\",\n        {\n          isPureXfa: !!this._htmlForXfa,\n          numPages: this._numPages,\n          annotationStorage: map,\n          filename: this._fullReader?.filename ?? null,\n        },\n        transfers\n      )\n      .finally(() => {\n        this.annotationStorage.resetModified();\n      });\n  }\n\n  getPage(pageNumber) {\n    if (\n      !Number.isInteger(pageNumber) ||\n      pageNumber <= 0 ||\n      pageNumber > this._numPages\n    ) {\n      return Promise.reject(new Error(\"Invalid page request.\"));\n    }\n\n    const pageIndex = pageNumber - 1,\n      cachedPromise = this.#pagePromises.get(pageIndex);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler\n      .sendWithPromise(\"GetPage\", {\n        pageIndex,\n      })\n      .then(pageInfo => {\n        if (this.destroyed) {\n          throw new Error(\"Transport destroyed\");\n        }\n        const page = new PDFPageProxy(\n          pageIndex,\n          pageInfo,\n          this,\n          this._params.pdfBug\n        );\n        this.#pageCache.set(pageIndex, page);\n        return page;\n      });\n    this.#pagePromises.set(pageIndex, promise);\n    return promise;\n  }\n\n  getPageIndex(ref) {\n    if (\n      typeof ref !== \"object\" ||\n      ref === null ||\n      !Number.isInteger(ref.num) ||\n      ref.num < 0 ||\n      !Number.isInteger(ref.gen) ||\n      ref.gen < 0\n    ) {\n      return Promise.reject(new Error(\"Invalid pageIndex request.\"));\n    }\n    return this.messageHandler.sendWithPromise(\"GetPageIndex\", {\n      num: ref.num,\n      gen: ref.gen,\n    });\n  }\n\n  getAnnotations(pageIndex, intent) {\n    return this.messageHandler.sendWithPromise(\"GetAnnotations\", {\n      pageIndex,\n      intent,\n    });\n  }\n\n  getFieldObjects() {\n    return this.#cacheSimpleMethod(\"GetFieldObjects\");\n  }\n\n  hasJSActions() {\n    return this.#cacheSimpleMethod(\"HasJSActions\");\n  }\n\n  getCalculationOrderIds() {\n    return this.messageHandler.sendWithPromise(\"GetCalculationOrderIds\", null);\n  }\n\n  getDestinations() {\n    return this.messageHandler.sendWithPromise(\"GetDestinations\", null);\n  }\n\n  getDestination(id) {\n    if (typeof id !== \"string\") {\n      return Promise.reject(new Error(\"Invalid destination request.\"));\n    }\n    return this.messageHandler.sendWithPromise(\"GetDestination\", {\n      id,\n    });\n  }\n\n  getPageLabels() {\n    return this.messageHandler.sendWithPromise(\"GetPageLabels\", null);\n  }\n\n  getPageLayout() {\n    return this.messageHandler.sendWithPromise(\"GetPageLayout\", null);\n  }\n\n  getPageMode() {\n    return this.messageHandler.sendWithPromise(\"GetPageMode\", null);\n  }\n\n  getViewerPreferences() {\n    return this.messageHandler.sendWithPromise(\"GetViewerPreferences\", null);\n  }\n\n  getOpenAction() {\n    return this.messageHandler.sendWithPromise(\"GetOpenAction\", null);\n  }\n\n  getAttachments() {\n    return this.messageHandler.sendWithPromise(\"GetAttachments\", null);\n  }\n\n  getJavaScript() {\n    return this.messageHandler.sendWithPromise(\"GetJavaScript\", null);\n  }\n\n  getDocJSActions() {\n    return this.messageHandler.sendWithPromise(\"GetDocJSActions\", null);\n  }\n\n  getPageJSActions(pageIndex) {\n    return this.messageHandler.sendWithPromise(\"GetPageJSActions\", {\n      pageIndex,\n    });\n  }\n\n  getStructTree(pageIndex) {\n    return this.messageHandler.sendWithPromise(\"GetStructTree\", {\n      pageIndex,\n    });\n  }\n\n  getOutline() {\n    return this.messageHandler.sendWithPromise(\"GetOutline\", null);\n  }\n\n  getOptionalContentConfig() {\n    return this.messageHandler\n      .sendWithPromise(\"GetOptionalContentConfig\", null)\n      .then(results => {\n        return new OptionalContentConfig(results);\n      });\n  }\n\n  getPermissions() {\n    return this.messageHandler.sendWithPromise(\"GetPermissions\", null);\n  }\n\n  getMetadata() {\n    const name = \"GetMetadata\",\n      cachedPromise = this.#methodPromises.get(name);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler\n      .sendWithPromise(name, null)\n      .then(results => {\n        return {\n          info: results[0],\n          metadata: results[1] ? new Metadata(results[1]) : null,\n          contentDispositionFilename: this._fullReader?.filename ?? null,\n          contentLength: this._fullReader?.contentLength ?? null,\n        };\n      });\n    this.#methodPromises.set(name, promise);\n    return promise;\n  }\n\n  getMarkInfo() {\n    return this.messageHandler.sendWithPromise(\"GetMarkInfo\", null);\n  }\n\n  async startCleanup(keepLoadedFonts = false) {\n    if (this.destroyed) {\n      return; // No need to manually clean-up when destruction has started.\n    }\n    await this.messageHandler.sendWithPromise(\"Cleanup\", null);\n\n    for (const page of this.#pageCache.values()) {\n      const cleanupSuccessful = page.cleanup();\n\n      if (!cleanupSuccessful) {\n        throw new Error(\n          `startCleanup: Page ${page.pageNumber} is currently rendering.`\n        );\n      }\n    }\n    this.commonObjs.clear();\n    if (!keepLoadedFonts) {\n      this.fontLoader.clear();\n    }\n    this.#methodPromises.clear();\n    this.filterFactory.destroy(/* keepHCM = */ true);\n  }\n\n  get loadingParams() {\n    const { disableAutoFetch, enableXfa } = this._params;\n    return shadow(this, \"loadingParams\", {\n      disableAutoFetch,\n      enableXfa,\n    });\n  }\n}\n\n/**\n * A PDF document and page is built of many objects. E.g. there are objects for\n * fonts, images, rendering code, etc. These objects may get processed inside of\n * a worker. This class implements some basic methods to manage these objects.\n */\nclass PDFObjects {\n  #objs = Object.create(null);\n\n  /**\n   * Ensures there is an object defined for `objId`.\n   *\n   * @param {string} objId\n   * @returns {Object}\n   */\n  #ensureObj(objId) {\n    const obj = this.#objs[objId];\n    if (obj) {\n      return obj;\n    }\n    return (this.#objs[objId] = {\n      capability: new PromiseCapability(),\n      data: null,\n    });\n  }\n\n  /**\n   * If called *without* callback, this returns the data of `objId` but the\n   * object needs to be resolved. If it isn't, this method throws.\n   *\n   * If called *with* a callback, the callback is called with the data of the\n   * object once the object is resolved. That means, if you call this method\n   * and the object is already resolved, the callback gets called right away.\n   *\n   * @param {string} objId\n   * @param {function} [callback]\n   * @returns {any}\n   */\n  get(objId, callback = null) {\n    // If there is a callback, then the get can be async and the object is\n    // not required to be resolved right now.\n    if (callback) {\n      const obj = this.#ensureObj(objId);\n      obj.capability.promise.then(() => callback(obj.data));\n      return null;\n    }\n    // If there isn't a callback, the user expects to get the resolved data\n    // directly.\n    const obj = this.#objs[objId];\n    // If there isn't an object yet or the object isn't resolved, then the\n    // data isn't ready yet!\n    if (!obj?.capability.settled) {\n      throw new Error(`Requesting object that isn't resolved yet ${objId}.`);\n    }\n    return obj.data;\n  }\n\n  /**\n   * @param {string} objId\n   * @returns {boolean}\n   */\n  has(objId) {\n    const obj = this.#objs[objId];\n    return obj?.capability.settled || false;\n  }\n\n  /**\n   * Resolves the object `objId` with optional `data`.\n   *\n   * @param {string} objId\n   * @param {any} [data]\n   */\n  resolve(objId, data = null) {\n    const obj = this.#ensureObj(objId);\n    obj.data = data;\n    obj.capability.resolve();\n  }\n\n  clear() {\n    for (const objId in this.#objs) {\n      const { data } = this.#objs[objId];\n      data?.bitmap?.close(); // Release any `ImageBitmap` data.\n    }\n    this.#objs = Object.create(null);\n  }\n}\n\n/**\n * Allows controlling of the rendering tasks.\n */\nclass RenderTask {\n  #internalRenderTask = null;\n\n  constructor(internalRenderTask) {\n    this.#internalRenderTask = internalRenderTask;\n\n    /**\n     * Callback for incremental rendering -- a function that will be called\n     * each time the rendering is paused.  To continue rendering call the\n     * function that is the first argument to the callback.\n     * @type {function}\n     */\n    this.onContinue = null;\n  }\n\n  /**\n   * Promise for rendering task completion.\n   * @type {Promise<void>}\n   */\n  get promise() {\n    return this.#internalRenderTask.capability.promise;\n  }\n\n  /**\n   * Cancels the rendering task. If the task is currently rendering it will\n   * not be cancelled until graphics pauses with a timeout. The promise that\n   * this object extends will be rejected when cancelled.\n   *\n   * @param {number} [extraDelay]\n   */\n  cancel(extraDelay = 0) {\n    this.#internalRenderTask.cancel(/* error = */ null, extraDelay);\n  }\n\n  /**\n   * Whether form fields are rendered separately from the main operatorList.\n   * @type {boolean}\n   */\n  get separateAnnots() {\n    const { separateAnnots } = this.#internalRenderTask.operatorList;\n    if (!separateAnnots) {\n      return false;\n    }\n    const { annotationCanvasMap } = this.#internalRenderTask;\n    return (\n      separateAnnots.form ||\n      (separateAnnots.canvas && annotationCanvasMap?.size > 0)\n    );\n  }\n}\n\n/**\n * For internal use only.\n * @ignore\n */\nclass InternalRenderTask {\n  static #canvasInUse = new WeakSet();\n\n  constructor({\n    callback,\n    params,\n    objs,\n    commonObjs,\n    annotationCanvasMap,\n    operatorList,\n    pageIndex,\n    canvasFactory,\n    filterFactory,\n    useRequestAnimationFrame = false,\n    pdfBug = false,\n    pageColors = null,\n  }) {\n    this.callback = callback;\n    this.params = params;\n    this.objs = objs;\n    this.commonObjs = commonObjs;\n    this.annotationCanvasMap = annotationCanvasMap;\n    this.operatorListIdx = null;\n    this.operatorList = operatorList;\n    this._pageIndex = pageIndex;\n    this.canvasFactory = canvasFactory;\n    this.filterFactory = filterFactory;\n    this._pdfBug = pdfBug;\n    this.pageColors = pageColors;\n\n    this.running = false;\n    this.graphicsReadyCallback = null;\n    this.graphicsReady = false;\n    this._useRequestAnimationFrame =\n      useRequestAnimationFrame === true && typeof window !== \"undefined\";\n    this.cancelled = false;\n    this.capability = new PromiseCapability();\n    this.task = new RenderTask(this);\n    // caching this-bound methods\n    this._cancelBound = this.cancel.bind(this);\n    this._continueBound = this._continue.bind(this);\n    this._scheduleNextBound = this._scheduleNext.bind(this);\n    this._nextBound = this._next.bind(this);\n    this._canvas = params.canvasContext.canvas;\n  }\n\n  get completed() {\n    return this.capability.promise.catch(function () {\n      // Ignoring errors, since we only want to know when rendering is\n      // no longer pending.\n    });\n  }\n\n  initializeGraphics({ transparency = false, optionalContentConfig }) {\n    if (this.cancelled) {\n      return;\n    }\n    if (this._canvas) {\n      if (InternalRenderTask.#canvasInUse.has(this._canvas)) {\n        throw new Error(\n          \"Cannot use the same canvas during multiple render() operations. \" +\n            \"Use different canvas or ensure previous operations were \" +\n            \"cancelled or completed.\"\n        );\n      }\n      InternalRenderTask.#canvasInUse.add(this._canvas);\n    }\n\n    if (this._pdfBug && globalThis.StepperManager?.enabled) {\n      this.stepper = globalThis.StepperManager.create(this._pageIndex);\n      this.stepper.init(this.operatorList);\n      this.stepper.nextBreakPoint = this.stepper.getNextBreakPoint();\n    }\n    const { canvasContext, viewport, transform, background } = this.params;\n\n    this.gfx = new CanvasGraphics(\n      canvasContext,\n      this.commonObjs,\n      this.objs,\n      this.canvasFactory,\n      this.filterFactory,\n      { optionalContentConfig },\n      this.annotationCanvasMap,\n      this.pageColors\n    );\n    this.gfx.beginDrawing({\n      transform,\n      viewport,\n      transparency,\n      background,\n    });\n    this.operatorListIdx = 0;\n    this.graphicsReady = true;\n    this.graphicsReadyCallback?.();\n  }\n\n  cancel(error = null, extraDelay = 0) {\n    this.running = false;\n    this.cancelled = true;\n    this.gfx?.endDrawing();\n\n    if (this._canvas) {\n      InternalRenderTask.#canvasInUse.delete(this._canvas);\n    }\n    this.callback(\n      error ||\n        new RenderingCancelledException(\n          `Rendering cancelled, page ${this._pageIndex + 1}`,\n          extraDelay\n        )\n    );\n  }\n\n  operatorListChanged() {\n    if (!this.graphicsReady) {\n      this.graphicsReadyCallback ||= this._continueBound;\n      return;\n    }\n    this.stepper?.updateOperatorList(this.operatorList);\n\n    if (this.running) {\n      return;\n    }\n    this._continue();\n  }\n\n  _continue() {\n    this.running = true;\n    if (this.cancelled) {\n      return;\n    }\n    if (this.task.onContinue) {\n      this.task.onContinue(this._scheduleNextBound);\n    } else {\n      this._scheduleNext();\n    }\n  }\n\n  _scheduleNext() {\n    if (this._useRequestAnimationFrame) {\n      window.requestAnimationFrame(() => {\n        this._nextBound().catch(this._cancelBound);\n      });\n    } else {\n      Promise.resolve().then(this._nextBound).catch(this._cancelBound);\n    }\n  }\n\n  async _next() {\n    if (this.cancelled) {\n      return;\n    }\n    this.operatorListIdx = this.gfx.executeOperatorList(\n      this.operatorList,\n      this.operatorListIdx,\n      this._continueBound,\n      this.stepper\n    );\n    if (this.operatorListIdx === this.operatorList.argsArray.length) {\n      this.running = false;\n      if (this.operatorList.lastChunk) {\n        this.gfx.endDrawing(this.pageColors);\n        if (this._canvas) {\n          InternalRenderTask.#canvasInUse.delete(this._canvas);\n        }\n        this.callback();\n      }\n    }\n  }\n}\n\n/** @type {string} */\nconst version =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_VERSION\") : null;\n/** @type {string} */\nconst build =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_BUILD\") : null;\n\nexport {\n  build,\n  DefaultCanvasFactory,\n  DefaultCMapReaderFactory,\n  DefaultFilterFactory,\n  DefaultStandardFontDataFactory,\n  getDocument,\n  LoopbackPort,\n  PDFDataRangeTransport,\n  PDFDocumentLoadingTask,\n  PDFDocumentProxy,\n  PDFPageProxy,\n  PDFWorker,\n  PDFWorkerUtil,\n  RenderTask,\n  version,\n};\n", "/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { objectFromMap, unreachable } from \"../shared/util.js\";\nimport { AnnotationEditor } from \"./editor/editor.js\";\nimport { MurmurHash3_64 } from \"../shared/murmurhash3.js\";\n\nconst SerializableEmpty = Object.freeze({\n  map: null,\n  hash: \"\",\n  transfers: undefined,\n});\n\n/**\n * Key/value storage for annotation data in forms.\n */\nclass AnnotationStorage {\n  #modified = false;\n\n  #storage = new Map();\n\n  constructor() {\n    // Callbacks to signal when the modification state is set or reset.\n    // This is used by the viewer to only bind on `beforeunload` if forms\n    // are actually edited to prevent doing so unconditionally since that\n    // can have undesirable effects.\n    this.onSetModified = null;\n    this.onResetModified = null;\n    this.onAnnotationEditor = null;\n  }\n\n  /**\n   * Get the value for a given key if it exists, or return the default value.\n   * @param {string} key\n   * @param {Object} defaultValue\n   * @returns {Object}\n   */\n  getValue(key, defaultValue) {\n    const value = this.#storage.get(key);\n    if (value === undefined) {\n      return defaultValue;\n    }\n\n    return Object.assign(defaultValue, value);\n  }\n\n  /**\n   * Get the value for a given key.\n   * @param {string} key\n   * @returns {Object}\n   */\n  getRawValue(key) {\n    return this.#storage.get(key);\n  }\n\n  /**\n   * Remove a value from the storage.\n   * @param {string} key\n   */\n  remove(key) {\n    this.#storage.delete(key);\n\n    if (this.#storage.size === 0) {\n      this.resetModified();\n    }\n\n    if (typeof this.onAnnotationEditor === \"function\") {\n      for (const value of this.#storage.values()) {\n        if (value instanceof AnnotationEditor) {\n          return;\n        }\n      }\n      this.onAnnotationEditor(null);\n    }\n  }\n\n  /**\n   * Set the value for a given key\n   * @param {string} key\n   * @param {Object} value\n   */\n  setValue(key, value) {\n    const obj = this.#storage.get(key);\n    let modified = false;\n    if (obj !== undefined) {\n      for (const [entry, val] of Object.entries(value)) {\n        if (obj[entry] !== val) {\n          modified = true;\n          obj[entry] = val;\n        }\n      }\n    } else {\n      modified = true;\n      this.#storage.set(key, value);\n    }\n    if (modified) {\n      this.#setModified();\n    }\n\n    if (\n      value instanceof AnnotationEditor &&\n      typeof this.onAnnotationEditor === \"function\"\n    ) {\n      this.onAnnotationEditor(value.constructor._type);\n    }\n  }\n\n  /**\n   * Check if the storage contains the given key.\n   * @param {string} key\n   * @returns {boolean}\n   */\n  has(key) {\n    return this.#storage.has(key);\n  }\n\n  /**\n   * @returns {Object | null}\n   */\n  getAll() {\n    return this.#storage.size > 0 ? objectFromMap(this.#storage) : null;\n  }\n\n  /**\n   * @param {Object} obj\n   */\n  setAll(obj) {\n    for (const [key, val] of Object.entries(obj)) {\n      this.setValue(key, val);\n    }\n  }\n\n  get size() {\n    return this.#storage.size;\n  }\n\n  #setModified() {\n    if (!this.#modified) {\n      this.#modified = true;\n      if (typeof this.onSetModified === \"function\") {\n        this.onSetModified();\n      }\n    }\n  }\n\n  resetModified() {\n    if (this.#modified) {\n      this.#modified = false;\n      if (typeof this.onResetModified === \"function\") {\n        this.onResetModified();\n      }\n    }\n  }\n\n  /**\n   * @returns {PrintAnnotationStorage}\n   */\n  get print() {\n    return new PrintAnnotationStorage(this);\n  }\n\n  /**\n   * PLEASE NOTE: Only intended for usage within the API itself.\n   * @ignore\n   */\n  get serializable() {\n    if (this.#storage.size === 0) {\n      return SerializableEmpty;\n    }\n    const map = new Map(),\n      hash = new MurmurHash3_64(),\n      transfers = [];\n    for (const [key, val] of this.#storage) {\n      const serialized =\n        val instanceof AnnotationEditor ? val.serialize() : val;\n      if (serialized) {\n        map.set(key, serialized);\n\n        hash.update(`${key}:${JSON.stringify(serialized)}`);\n\n        if (serialized.bitmap) {\n          transfers.push(serialized.bitmap);\n        }\n      }\n    }\n    return map.size > 0\n      ? { map, hash: hash.hexdigest(), transfers }\n      : SerializableEmpty;\n  }\n}\n\n/**\n * A special `AnnotationStorage` for use during printing, where the serializable\n * data is *frozen* upon initialization, to prevent scripting from modifying its\n * contents. (Necessary since printing is triggered synchronously in browsers.)\n */\nclass PrintAnnotationStorage extends AnnotationStorage {\n  #serializable;\n\n  constructor(parent) {\n    super();\n    const { map, hash, transfers } = parent.serializable;\n    // Create a *copy* of the data, since Objects are passed by reference in JS.\n    const clone = structuredClone(\n      map,\n      (typeof PDFJSDev === \"undefined\" ||\n        PDFJSDev.test(\"SKIP_BABEL || TESTING\")) &&\n        transfers\n        ? { transfer: transfers }\n        : null\n    );\n    this.#serializable = { map: clone, hash, transfers };\n  }\n\n  /**\n   * @returns {PrintAnnotationStorage}\n   */\n  // eslint-disable-next-line getter-return\n  get print() {\n    unreachable(\"Should not call PrintAnnotationStorage.print\");\n  }\n\n  /**\n   * PLEASE NOTE: Only intended for usage within the API itself.\n   * @ignore\n   */\n  get serializable() {\n    return this.#serializable;\n  }\n}\n\nexport { AnnotationStorage, PrintAnnotationStorage, SerializableEmpty };\n", "/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./annotation_editor_layer.js\").AnnotationEditorLayer} AnnotationEditorLayer */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./tools.js\").AnnotationEditorUIManager} AnnotationEditorUIManager */\n\nimport { bindEvents, ColorManager } from \"./tools.js\";\nimport { FeatureTest, shadow, unreachable } from \"../../shared/util.js\";\n\n/**\n * @typedef {Object} AnnotationEditorParameters\n * @property {AnnotationEditorUIManager} uiManager - the global manager\n * @property {AnnotationEditorLayer} parent - the layer containing this editor\n * @property {string} id - editor id\n * @property {number} x - x-coordinate\n * @property {number} y - y-coordinate\n */\n\n/**\n * Base class for editors.\n */\nclass AnnotationEditor {\n  #boundFocusin = this.focusin.bind(this);\n\n  #boundFocusout = this.focusout.bind(this);\n\n  #hasBeenSelected = false;\n\n  #isEditing = false;\n\n  #isInEditMode = false;\n\n  _uiManager = null;\n\n  #zIndex = AnnotationEditor._zIndex++;\n\n  static _colorManager = new ColorManager();\n\n  static _zIndex = 1;\n\n  /**\n   * @param {AnnotationEditorParameters} parameters\n   */\n  constructor(parameters) {\n    if (this.constructor === AnnotationEditor) {\n      unreachable(\"Cannot initialize AnnotationEditor.\");\n    }\n\n    this.parent = parameters.parent;\n    this.id = parameters.id;\n    this.width = this.height = null;\n    this.pageIndex = parameters.parent.pageIndex;\n    this.name = parameters.name;\n    this.div = null;\n    this._uiManager = parameters.uiManager;\n    this.annotationElementId = null;\n\n    const {\n      rotation,\n      rawDims: { pageWidth, pageHeight, pageX, pageY },\n    } = this.parent.viewport;\n\n    this.rotation = rotation;\n    this.pageRotation =\n      (360 + rotation - this._uiManager.viewParameters.rotation) % 360;\n    this.pageDimensions = [pageWidth, pageHeight];\n    this.pageTranslation = [pageX, pageY];\n\n    const [width, height] = this.parentDimensions;\n    this.x = parameters.x / width;\n    this.y = parameters.y / height;\n\n    this.isAttachedToDOM = false;\n    this.deleted = false;\n  }\n\n  static get _defaultLineColor() {\n    return shadow(\n      this,\n      \"_defaultLineColor\",\n      this._colorManager.getHexCode(\"CanvasText\")\n    );\n  }\n\n  static deleteAnnotationElement(editor) {\n    const fakeEditor = new FakeEditor({\n      id: editor.parent.getNextId(),\n      parent: editor.parent,\n      uiManager: editor._uiManager,\n    });\n    fakeEditor.annotationElementId = editor.annotationElementId;\n    fakeEditor.deleted = true;\n    fakeEditor._uiManager.addToAnnotationStorage(fakeEditor);\n  }\n\n  /**\n   * Add some commands into the CommandManager (undo/redo stuff).\n   * @param {Object} params\n   */\n  addCommands(params) {\n    this._uiManager.addCommands(params);\n  }\n\n  get currentLayer() {\n    return this._uiManager.currentLayer;\n  }\n\n  /**\n   * This editor will be behind the others.\n   */\n  setInBackground() {\n    this.div.style.zIndex = 0;\n  }\n\n  /**\n   * This editor will be in the foreground.\n   */\n  setInForeground() {\n    this.div.style.zIndex = this.#zIndex;\n  }\n\n  setParent(parent) {\n    if (parent !== null) {\n      this.pageIndex = parent.pageIndex;\n      this.pageDimensions = parent.pageDimensions;\n    }\n    this.parent = parent;\n  }\n\n  /**\n   * onfocus callback.\n   */\n  focusin(event) {\n    if (!this.#hasBeenSelected) {\n      this.parent.setSelected(this);\n    } else {\n      this.#hasBeenSelected = false;\n    }\n  }\n\n  /**\n   * onblur callback.\n   * @param {FocusEvent} event\n   */\n  focusout(event) {\n    if (!this.isAttachedToDOM) {\n      return;\n    }\n\n    // In case of focusout, the relatedTarget is the element which\n    // is grabbing the focus.\n    // So if the related target is an element under the div for this\n    // editor, then the editor isn't unactive.\n    const target = event.relatedTarget;\n    if (target?.closest(`#${this.id}`)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (!this.parent?.isMultipleSelection) {\n      this.commitOrRemove();\n    }\n  }\n\n  commitOrRemove() {\n    if (this.isEmpty()) {\n      this.remove();\n    } else {\n      this.commit();\n    }\n  }\n\n  /**\n   * Commit the data contained in this editor.\n   */\n  commit() {\n    this.addToAnnotationStorage();\n  }\n\n  addToAnnotationStorage() {\n    this._uiManager.addToAnnotationStorage(this);\n  }\n\n  /**\n   * We use drag-and-drop in order to move an editor on a page.\n   * @param {DragEvent} event\n   */\n  dragstart(event) {\n    const rect = this.parent.div.getBoundingClientRect();\n    this.startX = event.clientX - rect.x;\n    this.startY = event.clientY - rect.y;\n    event.dataTransfer.setData(\"text/plain\", this.id);\n    event.dataTransfer.effectAllowed = \"move\";\n  }\n\n  /**\n   * Set the editor position within its parent.\n   * @param {number} x\n   * @param {number} y\n   * @param {number} tx - x-translation in screen coordinates.\n   * @param {number} ty - y-translation in screen coordinates.\n   */\n  setAt(x, y, tx, ty) {\n    const [width, height] = this.parentDimensions;\n    [tx, ty] = this.screenToPageTranslation(tx, ty);\n\n    this.x = (x + tx) / width;\n    this.y = (y + ty) / height;\n\n    this.div.style.left = `${100 * this.x}%`;\n    this.div.style.top = `${100 * this.y}%`;\n  }\n\n  /**\n   * Translate the editor position within its parent.\n   * @param {number} x - x-translation in screen coordinates.\n   * @param {number} y - y-translation in screen coordinates.\n   */\n  translate(x, y) {\n    const [width, height] = this.parentDimensions;\n    [x, y] = this.screenToPageTranslation(x, y);\n\n    this.x += x / width;\n    this.y += y / height;\n\n    this.div.style.left = `${100 * this.x}%`;\n    this.div.style.top = `${100 * this.y}%`;\n  }\n\n  /**\n   * Convert a screen translation into a page one.\n   * @param {number} x\n   * @param {number} y\n   */\n  screenToPageTranslation(x, y) {\n    switch (this.parentRotation) {\n      case 90:\n        return [y, -x];\n      case 180:\n        return [-x, -y];\n      case 270:\n        return [-y, x];\n      default:\n        return [x, y];\n    }\n  }\n\n  get parentScale() {\n    return this._uiManager.viewParameters.realScale;\n  }\n\n  get parentRotation() {\n    return (this._uiManager.viewParameters.rotation + this.pageRotation) % 360;\n  }\n\n  get parentDimensions() {\n    const { realScale } = this._uiManager.viewParameters;\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    return [pageWidth * realScale, pageHeight * realScale];\n  }\n\n  /**\n   * Set the dimensions of this editor.\n   * @param {number} width\n   * @param {number} height\n   */\n  setDims(width, height) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.div.style.width = `${(100 * width) / parentWidth}%`;\n    this.div.style.height = `${(100 * height) / parentHeight}%`;\n  }\n\n  fixDims() {\n    const { style } = this.div;\n    const { height, width } = style;\n    const widthPercent = width.endsWith(\"%\");\n    const heightPercent = height.endsWith(\"%\");\n    if (widthPercent && heightPercent) {\n      return;\n    }\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    if (!widthPercent) {\n      style.width = `${(100 * parseFloat(width)) / parentWidth}%`;\n    }\n    if (!heightPercent) {\n      style.height = `${(100 * parseFloat(height)) / parentHeight}%`;\n    }\n  }\n\n  /**\n   * Get the translation used to position this editor when it's created.\n   * @returns {Array<number>}\n   */\n  getInitialTranslation() {\n    return [0, 0];\n  }\n\n  /**\n   * Render this editor in a div.\n   * @returns {HTMLDivElement}\n   */\n  render() {\n    this.div = document.createElement(\"div\");\n    this.div.setAttribute(\"data-editor-rotation\", (360 - this.rotation) % 360);\n    this.div.className = this.name;\n    this.div.setAttribute(\"id\", this.id);\n    this.div.setAttribute(\"tabIndex\", 0);\n\n    this.setInForeground();\n\n    this.div.addEventListener(\"focusin\", this.#boundFocusin);\n    this.div.addEventListener(\"focusout\", this.#boundFocusout);\n\n    const [tx, ty] = this.getInitialTranslation();\n    this.translate(tx, ty);\n\n    bindEvents(this, this.div, [\"dragstart\", \"pointerdown\"]);\n\n    return this.div;\n  }\n\n  /**\n   * Onpointerdown callback.\n   * @param {PointerEvent} event\n   */\n  pointerdown(event) {\n    const { isMac } = FeatureTest.platform;\n    if (event.button !== 0 || (event.ctrlKey && isMac)) {\n      // Avoid to focus this editor because of a non-left click.\n      event.preventDefault();\n      return;\n    }\n\n    if (\n      (event.ctrlKey && !isMac) ||\n      event.shiftKey ||\n      (event.metaKey && isMac)\n    ) {\n      this.parent.toggleSelected(this);\n    } else {\n      this.parent.setSelected(this);\n    }\n\n    this.#hasBeenSelected = true;\n  }\n\n  getRect(tx, ty) {\n    const scale = this.parentScale;\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const [pageX, pageY] = this.pageTranslation;\n    const shiftX = tx / scale;\n    const shiftY = ty / scale;\n    const x = this.x * pageWidth;\n    const y = this.y * pageHeight;\n    const width = this.width * pageWidth;\n    const height = this.height * pageHeight;\n\n    switch (this.rotation) {\n      case 0:\n        return [\n          x + shiftX + pageX,\n          pageHeight - y - shiftY - height + pageY,\n          x + shiftX + width + pageX,\n          pageHeight - y - shiftY + pageY,\n        ];\n      case 90:\n        return [\n          x + shiftY + pageX,\n          pageHeight - y + shiftX + pageY,\n          x + shiftY + height + pageX,\n          pageHeight - y + shiftX + width + pageY,\n        ];\n      case 180:\n        return [\n          x - shiftX - width + pageX,\n          pageHeight - y + shiftY + pageY,\n          x - shiftX + pageX,\n          pageHeight - y + shiftY + height + pageY,\n        ];\n      case 270:\n        return [\n          x - shiftY - height + pageX,\n          pageHeight - y - shiftX - width + pageY,\n          x - shiftY + pageX,\n          pageHeight - y - shiftX + pageY,\n        ];\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n  }\n\n  getRectInCurrentCoords(rect, pageHeight) {\n    const [x1, y1, x2, y2] = rect;\n\n    const width = x2 - x1;\n    const height = y2 - y1;\n\n    switch (this.rotation) {\n      case 0:\n        return [x1, pageHeight - y2, width, height];\n      case 90:\n        return [x1, pageHeight - y1, height, width];\n      case 180:\n        return [x2, pageHeight - y1, width, height];\n      case 270:\n        return [x2, pageHeight - y2, height, width];\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n  }\n\n  /**\n   * Executed once this editor has been rendered.\n   */\n  onceAdded() {}\n\n  /**\n   * Check if the editor contains something.\n   * @returns {boolean}\n   */\n  isEmpty() {\n    return false;\n  }\n\n  /**\n   * Enable edit mode.\n   */\n  enableEditMode() {\n    this.#isInEditMode = true;\n  }\n\n  /**\n   * Disable edit mode.\n   */\n  disableEditMode() {\n    this.#isInEditMode = false;\n  }\n\n  /**\n   * Check if the editor is edited.\n   * @returns {boolean}\n   */\n  isInEditMode() {\n    return this.#isInEditMode;\n  }\n\n  /**\n   * If it returns true, then this editor handle the keyboard\n   * events itself.\n   * @returns {boolean}\n   */\n  shouldGetKeyboardEvents() {\n    return false;\n  }\n\n  /**\n   * Check if this editor needs to be rebuilt or not.\n   * @returns {boolean}\n   */\n  needsToBeRebuilt() {\n    return this.div && !this.isAttachedToDOM;\n  }\n\n  /**\n   * Rebuild the editor in case it has been removed on undo.\n   *\n   * To implement in subclasses.\n   */\n  rebuild() {\n    this.div?.addEventListener(\"focusin\", this.#boundFocusin);\n    this.div?.addEventListener(\"focusout\", this.#boundFocusout);\n  }\n\n  /**\n   * Serialize the editor.\n   * The result of the serialization will be used to construct a\n   * new annotation to add to the pdf document.\n   *\n   * To implement in subclasses.\n   * @param {boolean} isForCopying\n   */\n  serialize(_isForCopying = false) {\n    unreachable(\"An editor must be serializable\");\n  }\n\n  /**\n   * Deserialize the editor.\n   * The result of the deserialization is a new editor.\n   *\n   * @param {Object} data\n   * @param {AnnotationEditorLayer} parent\n   * @param {AnnotationEditorUIManager} uiManager\n   * @returns {AnnotationEditor}\n   */\n  static deserialize(data, parent, uiManager) {\n    const editor = new this.prototype.constructor({\n      parent,\n      id: parent.getNextId(),\n      uiManager,\n    });\n    editor.rotation = data.rotation;\n\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    const [x, y, width, height] = editor.getRectInCurrentCoords(\n      data.rect,\n      pageHeight\n    );\n    editor.x = x / pageWidth;\n    editor.y = y / pageHeight;\n    editor.width = width / pageWidth;\n    editor.height = height / pageHeight;\n\n    return editor;\n  }\n\n  /**\n   * Remove this editor.\n   * It's used on ctrl+backspace action.\n   */\n  remove() {\n    this.div.removeEventListener(\"focusin\", this.#boundFocusin);\n    this.div.removeEventListener(\"focusout\", this.#boundFocusout);\n\n    if (!this.isEmpty()) {\n      // The editor is removed but it can be back at some point thanks to\n      // undo/redo so we must commit it before.\n      this.commit();\n    }\n    this.parent.remove(this);\n  }\n\n  /**\n   * Select this editor.\n   */\n  select() {\n    this.div?.classList.add(\"selectedEditor\");\n  }\n\n  /**\n   * Unselect this editor.\n   */\n  unselect() {\n    this.div?.classList.remove(\"selectedEditor\");\n  }\n\n  /**\n   * Update some parameters which have been changed through the UI.\n   * @param {number} type\n   * @param {*} value\n   */\n  updateParams(type, value) {}\n\n  /**\n   * When the user disables the editing mode some editors can change some of\n   * their properties.\n   */\n  disableEditing() {}\n\n  /**\n   * When the user enables the editing mode some editors can change some of\n   * their properties.\n   */\n  enableEditing() {}\n\n  /**\n   * Get some properties to update in the UI.\n   * @returns {Object}\n   */\n  get propertiesToUpdate() {\n    return {};\n  }\n\n  /**\n   * Get the div which really contains the displayed content.\n   */\n  get contentDiv() {\n    return this.div;\n  }\n\n  /**\n   * If true then the editor is currently edited.\n   * @type {boolean}\n   */\n  get isEditing() {\n    return this.#isEditing;\n  }\n\n  /**\n   * When set to true, it means that this editor is currently edited.\n   * @param {boolean} value\n   */\n  set isEditing(value) {\n    this.#isEditing = value;\n    if (value) {\n      this.parent.setSelected(this);\n      this.parent.setActiveEditor(this);\n    } else {\n      this.parent.setActiveEditor(null);\n    }\n  }\n}\n\n// This class is used to fake an editor which has been deleted.\nclass FakeEditor extends AnnotationEditor {\n  constructor(params) {\n    super(params);\n    this.annotationElementId = params.annotationElementId;\n    this.deleted = true;\n  }\n\n  serialize() {\n    return {\n      id: this.annotationElementId,\n      deleted: true,\n      pageIndex: this.pageIndex,\n    };\n  }\n}\n\nexport { AnnotationEditor };\n", "/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./editor.js\").AnnotationEditor} AnnotationEditor */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./annotation_editor_layer.js\").AnnotationEditorLayer} AnnotationEditorLayer */\n\nimport {\n  AnnotationEditorPrefix,\n  AnnotationEditorType,\n  FeatureTest,\n  shadow,\n  Util,\n  warn,\n} from \"../../shared/util.js\";\nimport { getColorValues, getRGB, PixelsPerInch } from \"../display_utils.js\";\n\nfunction bindEvents(obj, element, names) {\n  for (const name of names) {\n    element.addEventListener(name, obj[name].bind(obj));\n  }\n}\n\n/**\n * Convert a number between 0 and 100 into an hex number between 0 and 255.\n * @param {number} opacity\n * @return {string}\n */\nfunction opacityToHex(opacity) {\n  return Math.round(Math.min(255, Math.max(1, 255 * opacity)))\n    .toString(16)\n    .padStart(2, \"0\");\n}\n\n/**\n * Class to create some unique ids for the different editors.\n */\nclass IdManager {\n  #id = 0;\n\n  /**\n   * Get a unique id.\n   * @returns {string}\n   */\n  getId() {\n    return `${AnnotationEditorPrefix}${this.#id++}`;\n  }\n}\n\n/**\n * Class to handle undo/redo.\n * Commands are just saved in a buffer.\n * If we hit some memory issues we could likely use a circular buffer.\n * It has to be used as a singleton.\n */\nclass CommandManager {\n  #commands = [];\n\n  #locked = false;\n\n  #maxSize;\n\n  #position = -1;\n\n  constructor(maxSize = 128) {\n    this.#maxSize = maxSize;\n  }\n\n  /**\n   * @typedef {Object} addOptions\n   * @property {function} cmd\n   * @property {function} undo\n   * @property {boolean} mustExec\n   * @property {number} type\n   * @property {boolean} overwriteIfSameType\n   * @property {boolean} keepUndo\n   */\n\n  /**\n   * Add a new couple of commands to be used in case of redo/undo.\n   * @param {addOptions} options\n   */\n  add({\n    cmd,\n    undo,\n    mustExec,\n    type = NaN,\n    overwriteIfSameType = false,\n    keepUndo = false,\n  }) {\n    if (mustExec) {\n      cmd();\n    }\n\n    if (this.#locked) {\n      return;\n    }\n\n    const save = { cmd, undo, type };\n    if (this.#position === -1) {\n      if (this.#commands.length > 0) {\n        // All the commands have been undone and then a new one is added\n        // hence we clear the queue.\n        this.#commands.length = 0;\n      }\n      this.#position = 0;\n      this.#commands.push(save);\n      return;\n    }\n\n    if (overwriteIfSameType && this.#commands[this.#position].type === type) {\n      // For example when we change a color we don't want to\n      // be able to undo all the steps, hence we only want to\n      // keep the last undoable action in this sequence of actions.\n      if (keepUndo) {\n        save.undo = this.#commands[this.#position].undo;\n      }\n      this.#commands[this.#position] = save;\n      return;\n    }\n\n    const next = this.#position + 1;\n    if (next === this.#maxSize) {\n      this.#commands.splice(0, 1);\n    } else {\n      this.#position = next;\n      if (next < this.#commands.length) {\n        this.#commands.splice(next);\n      }\n    }\n\n    this.#commands.push(save);\n  }\n\n  /**\n   * Undo the last command.\n   */\n  undo() {\n    if (this.#position === -1) {\n      // Nothing to undo.\n      return;\n    }\n\n    // Avoid to insert something during the undo execution.\n    this.#locked = true;\n    this.#commands[this.#position].undo();\n    this.#locked = false;\n\n    this.#position -= 1;\n  }\n\n  /**\n   * Redo the last command.\n   */\n  redo() {\n    if (this.#position < this.#commands.length - 1) {\n      this.#position += 1;\n\n      // Avoid to insert something during the redo execution.\n      this.#locked = true;\n      this.#commands[this.#position].cmd();\n      this.#locked = false;\n    }\n  }\n\n  /**\n   * Check if there is something to undo.\n   * @returns {boolean}\n   */\n  hasSomethingToUndo() {\n    return this.#position !== -1;\n  }\n\n  /**\n   * Check if there is something to redo.\n   * @returns {boolean}\n   */\n  hasSomethingToRedo() {\n    return this.#position < this.#commands.length - 1;\n  }\n\n  destroy() {\n    this.#commands = null;\n  }\n}\n\n/**\n * Class to handle the different keyboards shortcuts we can have on mac or\n * non-mac OSes.\n */\nclass KeyboardManager {\n  /**\n   * Create a new keyboard manager class.\n   * @param {Array<Array>} callbacks - an array containing an array of shortcuts\n   * and a callback to call.\n   * A shortcut is a string like `ctrl+c` or `mac+ctrl+c` for mac OS.\n   */\n  constructor(callbacks) {\n    this.buffer = [];\n    this.callbacks = new Map();\n    this.allKeys = new Set();\n\n    const { isMac } = FeatureTest.platform;\n    for (const [keys, callback, bubbles = false] of callbacks) {\n      for (const key of keys) {\n        const isMacKey = key.startsWith(\"mac+\");\n        if (isMac && isMacKey) {\n          this.callbacks.set(key.slice(4), { callback, bubbles });\n          this.allKeys.add(key.split(\"+\").at(-1));\n        } else if (!isMac && !isMacKey) {\n          this.callbacks.set(key, { callback, bubbles });\n          this.allKeys.add(key.split(\"+\").at(-1));\n        }\n      }\n    }\n  }\n\n  /**\n   * Serialize an event into a string in order to match a\n   * potential key for a callback.\n   * @param {KeyboardEvent} event\n   * @returns {string}\n   */\n  #serialize(event) {\n    if (event.altKey) {\n      this.buffer.push(\"alt\");\n    }\n    if (event.ctrlKey) {\n      this.buffer.push(\"ctrl\");\n    }\n    if (event.metaKey) {\n      this.buffer.push(\"meta\");\n    }\n    if (event.shiftKey) {\n      this.buffer.push(\"shift\");\n    }\n    this.buffer.push(event.key);\n    const str = this.buffer.join(\"+\");\n    this.buffer.length = 0;\n\n    return str;\n  }\n\n  /**\n   * Execute a callback, if any, for a given keyboard event.\n   * The self is used as `this` in the callback.\n   * @param {Object} self.\n   * @param {KeyboardEvent} event\n   * @returns\n   */\n  exec(self, event) {\n    if (!this.allKeys.has(event.key)) {\n      return;\n    }\n    const info = this.callbacks.get(this.#serialize(event));\n    if (!info) {\n      return;\n    }\n    const { callback, bubbles } = info;\n    callback.bind(self)();\n\n    // For example, ctrl+s in a FreeText must be handled by the viewer, hence\n    // the event must bubble.\n    if (!bubbles) {\n      event.stopPropagation();\n      event.preventDefault();\n    }\n  }\n}\n\nclass ColorManager {\n  static _colorsMapping = new Map([\n    [\"CanvasText\", [0, 0, 0]],\n    [\"Canvas\", [255, 255, 255]],\n  ]);\n\n  get _colors() {\n    if (\n      typeof PDFJSDev !== \"undefined\" &&\n      PDFJSDev.test(\"LIB\") &&\n      typeof document === \"undefined\"\n    ) {\n      return shadow(this, \"_colors\", ColorManager._colorsMapping);\n    }\n\n    const colors = new Map([\n      [\"CanvasText\", null],\n      [\"Canvas\", null],\n    ]);\n    getColorValues(colors);\n    return shadow(this, \"_colors\", colors);\n  }\n\n  /**\n   * In High Contrast Mode, the color on the screen is not always the\n   * real color used in the pdf.\n   * For example in some cases white can appear to be black but when saving\n   * we want to have white.\n   * @param {string} color\n   * @returns {Array<number>}\n   */\n  convert(color) {\n    const rgb = getRGB(color);\n    if (!window.matchMedia(\"(forced-colors: active)\").matches) {\n      return rgb;\n    }\n\n    for (const [name, RGB] of this._colors) {\n      if (RGB.every((x, i) => x === rgb[i])) {\n        return ColorManager._colorsMapping.get(name);\n      }\n    }\n    return rgb;\n  }\n\n  /**\n   * An input element must have its color value as a hex string\n   * and not as color name.\n   * So this function converts a name into an hex string.\n   * @param {string} name\n   * @returns {string}\n   */\n  getHexCode(name) {\n    const rgb = this._colors.get(name);\n    if (!rgb) {\n      return name;\n    }\n    return Util.makeHexColor(...rgb);\n  }\n}\n\n/**\n * A pdf has several pages and each of them when it will rendered\n * will have an AnnotationEditorLayer which will contain the some\n * new Annotations associated to an editor in order to modify them.\n *\n * This class is used to manage all the different layers, editors and\n * some action like copy/paste, undo/redo, ...\n */\nclass AnnotationEditorUIManager {\n  #activeEditor = null;\n\n  #allEditors = new Map();\n\n  #allLayers = new Map();\n\n  #annotationStorage = null;\n\n  #commandManager = new CommandManager();\n\n  #currentPageIndex = 0;\n\n  #deletedAnnotationsElementIds = new Set();\n\n  #editorTypes = null;\n\n  #editorsToRescale = new Set();\n\n  #eventBus = null;\n\n  #idManager = new IdManager();\n\n  #isEnabled = false;\n\n  #mode = AnnotationEditorType.NONE;\n\n  #selectedEditors = new Set();\n\n  #boundCopy = this.copy.bind(this);\n\n  #boundCut = this.cut.bind(this);\n\n  #boundPaste = this.paste.bind(this);\n\n  #boundKeydown = this.keydown.bind(this);\n\n  #boundOnEditingAction = this.onEditingAction.bind(this);\n\n  #boundOnPageChanging = this.onPageChanging.bind(this);\n\n  #boundOnScaleChanging = this.onScaleChanging.bind(this);\n\n  #boundOnRotationChanging = this.onRotationChanging.bind(this);\n\n  #previousStates = {\n    isEditing: false,\n    isEmpty: true,\n    hasSomethingToUndo: false,\n    hasSomethingToRedo: false,\n    hasSelectedEditor: false,\n  };\n\n  #container = null;\n\n  static get _keyboardManager() {\n    return shadow(\n      this,\n      \"_keyboardManager\",\n      new KeyboardManager([\n        [\n          [\"ctrl+a\", \"mac+meta+a\"],\n          AnnotationEditorUIManager.prototype.selectAll,\n        ],\n        [[\"ctrl+z\", \"mac+meta+z\"], AnnotationEditorUIManager.prototype.undo],\n        [\n          [\"ctrl+y\", \"ctrl+shift+Z\", \"mac+meta+shift+Z\"],\n          AnnotationEditorUIManager.prototype.redo,\n        ],\n        [\n          [\n            \"Backspace\",\n            \"alt+Backspace\",\n            \"ctrl+Backspace\",\n            \"shift+Backspace\",\n            \"mac+Backspace\",\n            \"mac+alt+Backspace\",\n            \"mac+ctrl+Backspace\",\n            \"Delete\",\n            \"ctrl+Delete\",\n            \"shift+Delete\",\n          ],\n          AnnotationEditorUIManager.prototype.delete,\n        ],\n        [\n          [\"Escape\", \"mac+Escape\"],\n          AnnotationEditorUIManager.prototype.unselectAll,\n        ],\n      ])\n    );\n  }\n\n  constructor(container, eventBus, annotationStorage) {\n    this.#container = container;\n    this.#eventBus = eventBus;\n    this.#eventBus._on(\"editingaction\", this.#boundOnEditingAction);\n    this.#eventBus._on(\"pagechanging\", this.#boundOnPageChanging);\n    this.#eventBus._on(\"scalechanging\", this.#boundOnScaleChanging);\n    this.#eventBus._on(\"rotationchanging\", this.#boundOnRotationChanging);\n    this.#annotationStorage = annotationStorage;\n    this.viewParameters = {\n      realScale: PixelsPerInch.PDF_TO_CSS_UNITS,\n      rotation: 0,\n    };\n  }\n\n  destroy() {\n    this.#removeKeyboardManager();\n    this.#eventBus._off(\"editingaction\", this.#boundOnEditingAction);\n    this.#eventBus._off(\"pagechanging\", this.#boundOnPageChanging);\n    this.#eventBus._off(\"scalechanging\", this.#boundOnScaleChanging);\n    this.#eventBus._off(\"rotationchanging\", this.#boundOnRotationChanging);\n    for (const layer of this.#allLayers.values()) {\n      layer.destroy();\n    }\n    this.#allLayers.clear();\n    this.#allEditors.clear();\n    this.#editorsToRescale.clear();\n    this.#activeEditor = null;\n    this.#selectedEditors.clear();\n    this.#commandManager.destroy();\n  }\n\n  onPageChanging({ pageNumber }) {\n    this.#currentPageIndex = pageNumber - 1;\n  }\n\n  focusMainContainer() {\n    this.#container.focus();\n  }\n\n  addShouldRescale(editor) {\n    this.#editorsToRescale.add(editor);\n  }\n\n  removeShouldRescale(editor) {\n    this.#editorsToRescale.delete(editor);\n  }\n\n  onScaleChanging({ scale }) {\n    this.commitOrRemove();\n    this.viewParameters.realScale = scale * PixelsPerInch.PDF_TO_CSS_UNITS;\n    for (const editor of this.#editorsToRescale) {\n      editor.onScaleChanging();\n    }\n  }\n\n  onRotationChanging({ pagesRotation }) {\n    this.commitOrRemove();\n    this.viewParameters.rotation = pagesRotation;\n  }\n\n  /**\n   * Add an editor in the annotation storage.\n   * @param {AnnotationEditor} editor\n   */\n  addToAnnotationStorage(editor) {\n    if (\n      !editor.isEmpty() &&\n      this.#annotationStorage &&\n      !this.#annotationStorage.has(editor.id)\n    ) {\n      this.#annotationStorage.setValue(editor.id, editor);\n    }\n  }\n\n  #addKeyboardManager() {\n    // The keyboard events are caught at the container level in order to be able\n    // to execute some callbacks even if the current page doesn't have focus.\n    this.#container.addEventListener(\"keydown\", this.#boundKeydown);\n  }\n\n  #removeKeyboardManager() {\n    this.#container.removeEventListener(\"keydown\", this.#boundKeydown);\n  }\n\n  #addCopyPasteListeners() {\n    document.addEventListener(\"copy\", this.#boundCopy);\n    document.addEventListener(\"cut\", this.#boundCut);\n    document.addEventListener(\"paste\", this.#boundPaste);\n  }\n\n  #removeCopyPasteListeners() {\n    document.removeEventListener(\"copy\", this.#boundCopy);\n    document.removeEventListener(\"cut\", this.#boundCut);\n    document.removeEventListener(\"paste\", this.#boundPaste);\n  }\n\n  /**\n   * Copy callback.\n   * @param {ClipboardEvent} event\n   */\n  copy(event) {\n    event.preventDefault();\n\n    if (this.#activeEditor) {\n      // An editor is being edited so just commit it.\n      this.#activeEditor.commitOrRemove();\n    }\n\n    if (!this.hasSelection) {\n      return;\n    }\n\n    const editors = [];\n    for (const editor of this.#selectedEditors) {\n      const serialized = editor.serialize(/* isForCopying = */ true);\n      if (serialized) {\n        editors.push(serialized);\n      }\n    }\n    if (editors.length === 0) {\n      return;\n    }\n\n    event.clipboardData.setData(\"application/pdfjs\", JSON.stringify(editors));\n  }\n\n  /**\n   * Cut callback.\n   * @param {ClipboardEvent} event\n   */\n  cut(event) {\n    this.copy(event);\n    this.delete();\n  }\n\n  /**\n   * Paste callback.\n   * @param {ClipboardEvent} event\n   */\n  paste(event) {\n    event.preventDefault();\n\n    let data = event.clipboardData.getData(\"application/pdfjs\");\n    if (!data) {\n      return;\n    }\n\n    try {\n      data = JSON.parse(data);\n    } catch (ex) {\n      warn(`paste: \"${ex.message}\".`);\n      return;\n    }\n\n    if (!Array.isArray(data)) {\n      return;\n    }\n\n    this.unselectAll();\n    const layer = this.#allLayers.get(this.#currentPageIndex);\n\n    try {\n      const newEditors = [];\n      for (const editor of data) {\n        const deserializedEditor = layer.deserialize(editor);\n        if (!deserializedEditor) {\n          return;\n        }\n        newEditors.push(deserializedEditor);\n      }\n\n      const cmd = () => {\n        for (const editor of newEditors) {\n          this.#addEditorToLayer(editor);\n        }\n        this.#selectEditors(newEditors);\n      };\n      const undo = () => {\n        for (const editor of newEditors) {\n          editor.remove();\n        }\n      };\n      this.addCommands({ cmd, undo, mustExec: true });\n    } catch (ex) {\n      warn(`paste: \"${ex.message}\".`);\n    }\n  }\n\n  /**\n   * Keydown callback.\n   * @param {KeyboardEvent} event\n   */\n  keydown(event) {\n    if (!this.getActive()?.shouldGetKeyboardEvents()) {\n      AnnotationEditorUIManager._keyboardManager.exec(this, event);\n    }\n  }\n\n  /**\n   * Execute an action for a given name.\n   * For example, the user can click on the \"Undo\" entry in the context menu\n   * and it'll trigger the undo action.\n   * @param {Object} details\n   */\n  onEditingAction(details) {\n    if ([\"undo\", \"redo\", \"delete\", \"selectAll\"].includes(details.name)) {\n      this[details.name]();\n    }\n  }\n\n  /**\n   * Update the different possible states of this manager, e.g. is there\n   * something to undo, redo, ...\n   * @param {Object} details\n   */\n  #dispatchUpdateStates(details) {\n    const hasChanged = Object.entries(details).some(\n      ([key, value]) => this.#previousStates[key] !== value\n    );\n\n    if (hasChanged) {\n      this.#eventBus.dispatch(\"annotationeditorstateschanged\", {\n        source: this,\n        details: Object.assign(this.#previousStates, details),\n      });\n    }\n  }\n\n  #dispatchUpdateUI(details) {\n    this.#eventBus.dispatch(\"annotationeditorparamschanged\", {\n      source: this,\n      details,\n    });\n  }\n\n  /**\n   * Set the editing state.\n   * It can be useful to temporarily disable it when the user is editing a\n   * FreeText annotation.\n   * @param {boolean} isEditing\n   */\n  setEditingState(isEditing) {\n    if (isEditing) {\n      this.#addKeyboardManager();\n      this.#addCopyPasteListeners();\n      this.#dispatchUpdateStates({\n        isEditing: this.#mode !== AnnotationEditorType.NONE,\n        isEmpty: this.#isEmpty(),\n        hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n        hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n        hasSelectedEditor: false,\n      });\n    } else {\n      this.#removeKeyboardManager();\n      this.#removeCopyPasteListeners();\n      this.#dispatchUpdateStates({\n        isEditing: false,\n      });\n    }\n  }\n\n  registerEditorTypes(types) {\n    if (this.#editorTypes) {\n      return;\n    }\n    this.#editorTypes = types;\n    for (const editorType of this.#editorTypes) {\n      this.#dispatchUpdateUI(editorType.defaultPropertiesToUpdate);\n    }\n  }\n\n  /**\n   * Get an id.\n   * @returns {string}\n   */\n  getId() {\n    return this.#idManager.getId();\n  }\n\n  get currentLayer() {\n    return this.#allLayers.get(this.#currentPageIndex);\n  }\n\n  get currentPageIndex() {\n    return this.#currentPageIndex;\n  }\n\n  /**\n   * Add a new layer for a page which will contains the editors.\n   * @param {AnnotationEditorLayer} layer\n   */\n  addLayer(layer) {\n    this.#allLayers.set(layer.pageIndex, layer);\n    if (this.#isEnabled) {\n      layer.enable();\n    } else {\n      layer.disable();\n    }\n  }\n\n  /**\n   * Remove a layer.\n   * @param {AnnotationEditorLayer} layer\n   */\n  removeLayer(layer) {\n    this.#allLayers.delete(layer.pageIndex);\n  }\n\n  /**\n   * Change the editor mode (None, FreeText, Ink, ...)\n   * @param {number} mode\n   */\n  updateMode(mode) {\n    this.#mode = mode;\n    if (mode === AnnotationEditorType.NONE) {\n      this.setEditingState(false);\n      this.#disableAll();\n    } else {\n      this.setEditingState(true);\n      this.#enableAll();\n      for (const layer of this.#allLayers.values()) {\n        layer.updateMode(mode);\n      }\n    }\n  }\n\n  /**\n   * Update the toolbar if it's required to reflect the tool currently used.\n   * @param {number} mode\n   * @returns {undefined}\n   */\n  updateToolbar(mode) {\n    if (mode === this.#mode) {\n      return;\n    }\n    this.#eventBus.dispatch(\"switchannotationeditormode\", {\n      source: this,\n      mode,\n    });\n  }\n\n  /**\n   * Update a parameter in the current editor or globally.\n   * @param {number} type\n   * @param {*} value\n   */\n  updateParams(type, value) {\n    if (!this.#editorTypes) {\n      return;\n    }\n\n    for (const editor of this.#selectedEditors) {\n      editor.updateParams(type, value);\n    }\n\n    for (const editorType of this.#editorTypes) {\n      editorType.updateDefaultParams(type, value);\n    }\n  }\n\n  /**\n   * Enable all the layers.\n   */\n  #enableAll() {\n    if (!this.#isEnabled) {\n      this.#isEnabled = true;\n      for (const layer of this.#allLayers.values()) {\n        layer.enable();\n      }\n    }\n  }\n\n  /**\n   * Disable all the layers.\n   */\n  #disableAll() {\n    this.unselectAll();\n    if (this.#isEnabled) {\n      this.#isEnabled = false;\n      for (const layer of this.#allLayers.values()) {\n        layer.disable();\n      }\n    }\n  }\n\n  /**\n   * Get all the editors belonging to a give page.\n   * @param {number} pageIndex\n   * @returns {Array<AnnotationEditor>}\n   */\n  getEditors(pageIndex) {\n    const editors = [];\n    for (const editor of this.#allEditors.values()) {\n      if (editor.pageIndex === pageIndex) {\n        editors.push(editor);\n      }\n    }\n    return editors;\n  }\n\n  /**\n   * Get an editor with the given id.\n   * @param {string} id\n   * @returns {AnnotationEditor}\n   */\n  getEditor(id) {\n    return this.#allEditors.get(id);\n  }\n\n  /**\n   * Add a new editor.\n   * @param {AnnotationEditor} editor\n   */\n  addEditor(editor) {\n    this.#allEditors.set(editor.id, editor);\n  }\n\n  /**\n   * Remove an editor.\n   * @param {AnnotationEditor} editor\n   */\n  removeEditor(editor) {\n    this.#allEditors.delete(editor.id);\n    this.unselect(editor);\n    if (\n      !editor.annotationElementId ||\n      !this.#deletedAnnotationsElementIds.has(editor.annotationElementId)\n    ) {\n      this.#annotationStorage?.remove(editor.id);\n    }\n  }\n\n  /**\n   * The annotation element with the given id has been deleted.\n   * @param {AnnotationEditor} editor\n   */\n  addDeletedAnnotationElement(editor) {\n    this.#deletedAnnotationsElementIds.add(editor.annotationElementId);\n    editor.deleted = true;\n  }\n\n  /**\n   * Check if the annotation element with the given id has been deleted.\n   * @param {string} annotationElementId\n   * @returns {boolean}\n   */\n  isDeletedAnnotationElement(annotationElementId) {\n    return this.#deletedAnnotationsElementIds.has(annotationElementId);\n  }\n\n  /**\n   * The annotation element with the given id have been restored.\n   * @param {AnnotationEditor} editor\n   */\n  removeDeletedAnnotationElement(editor) {\n    this.#deletedAnnotationsElementIds.delete(editor.annotationElementId);\n    editor.deleted = false;\n  }\n\n  /**\n   * Add an editor to the layer it belongs to or add it to the global map.\n   * @param {AnnotationEditor} editor\n   */\n  #addEditorToLayer(editor) {\n    const layer = this.#allLayers.get(editor.pageIndex);\n    if (layer) {\n      layer.addOrRebuild(editor);\n    } else {\n      this.addEditor(editor);\n    }\n  }\n\n  /**\n   * Set the given editor as the active one.\n   * @param {AnnotationEditor} editor\n   */\n  setActiveEditor(editor) {\n    if (this.#activeEditor === editor) {\n      return;\n    }\n\n    this.#activeEditor = editor;\n    if (editor) {\n      this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    }\n  }\n\n  /**\n   * Add or remove an editor the current selection.\n   * @param {AnnotationEditor} editor\n   */\n  toggleSelected(editor) {\n    if (this.#selectedEditors.has(editor)) {\n      this.#selectedEditors.delete(editor);\n      editor.unselect();\n      this.#dispatchUpdateStates({\n        hasSelectedEditor: this.hasSelection,\n      });\n      return;\n    }\n    this.#selectedEditors.add(editor);\n    editor.select();\n    this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: true,\n    });\n  }\n\n  /**\n   * Set the last selected editor.\n   * @param {AnnotationEditor} editor\n   */\n  setSelected(editor) {\n    for (const ed of this.#selectedEditors) {\n      if (ed !== editor) {\n        ed.unselect();\n      }\n    }\n    this.#selectedEditors.clear();\n\n    this.#selectedEditors.add(editor);\n    editor.select();\n    this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: true,\n    });\n  }\n\n  /**\n   * Check if the editor is selected.\n   * @param {AnnotationEditor} editor\n   */\n  isSelected(editor) {\n    return this.#selectedEditors.has(editor);\n  }\n\n  /**\n   * Unselect an editor.\n   * @param {AnnotationEditor} editor\n   */\n  unselect(editor) {\n    editor.unselect();\n    this.#selectedEditors.delete(editor);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: this.hasSelection,\n    });\n  }\n\n  get hasSelection() {\n    return this.#selectedEditors.size !== 0;\n  }\n\n  /**\n   * Undo the last command.\n   */\n  undo() {\n    this.#commandManager.undo();\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n      hasSomethingToRedo: true,\n      isEmpty: this.#isEmpty(),\n    });\n  }\n\n  /**\n   * Redo the last undoed command.\n   */\n  redo() {\n    this.#commandManager.redo();\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: true,\n      hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n      isEmpty: this.#isEmpty(),\n    });\n  }\n\n  /**\n   * Add a command to execute (cmd) and another one to undo it.\n   * @param {Object} params\n   */\n  addCommands(params) {\n    this.#commandManager.add(params);\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: true,\n      hasSomethingToRedo: false,\n      isEmpty: this.#isEmpty(),\n    });\n  }\n\n  #isEmpty() {\n    if (this.#allEditors.size === 0) {\n      return true;\n    }\n\n    if (this.#allEditors.size === 1) {\n      for (const editor of this.#allEditors.values()) {\n        return editor.isEmpty();\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Delete the current editor or all.\n   */\n  delete() {\n    this.commitOrRemove();\n    if (!this.hasSelection) {\n      return;\n    }\n\n    const editors = [...this.#selectedEditors];\n    const cmd = () => {\n      for (const editor of editors) {\n        editor.remove();\n      }\n    };\n    const undo = () => {\n      for (const editor of editors) {\n        this.#addEditorToLayer(editor);\n      }\n    };\n\n    this.addCommands({ cmd, undo, mustExec: true });\n  }\n\n  commitOrRemove() {\n    // An editor is being edited so just commit it.\n    this.#activeEditor?.commitOrRemove();\n  }\n\n  /**\n   * Select the editors.\n   * @param {Array<AnnotationEditor>} editors\n   */\n  #selectEditors(editors) {\n    this.#selectedEditors.clear();\n    for (const editor of editors) {\n      if (editor.isEmpty()) {\n        continue;\n      }\n      this.#selectedEditors.add(editor);\n      editor.select();\n    }\n    this.#dispatchUpdateStates({ hasSelectedEditor: true });\n  }\n\n  /**\n   * Select all the editors.\n   */\n  selectAll() {\n    for (const editor of this.#selectedEditors) {\n      editor.commit();\n    }\n    this.#selectEditors(this.#allEditors.values());\n  }\n\n  /**\n   * Unselect all the selected editors.\n   */\n  unselectAll() {\n    if (this.#activeEditor) {\n      // An editor is being edited so just commit it.\n      this.#activeEditor.commitOrRemove();\n      return;\n    }\n\n    if (this.#selectedEditors.size === 0) {\n      return;\n    }\n    for (const editor of this.#selectedEditors) {\n      editor.unselect();\n    }\n    this.#selectedEditors.clear();\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: false,\n    });\n  }\n\n  /**\n   * Is the current editor the one passed as argument?\n   * @param {AnnotationEditor} editor\n   * @returns\n   */\n  isActive(editor) {\n    return this.#activeEditor === editor;\n  }\n\n  /**\n   * Get the current active editor.\n   * @returns {AnnotationEditor|null}\n   */\n  getActive() {\n    return this.#activeEditor;\n  }\n\n  /**\n   * Get the current editor mode.\n   * @returns {number}\n   */\n  getMode() {\n    return this.#mode;\n  }\n}\n\nexport {\n  AnnotationEditorUIManager,\n  bindEvents,\n  ColorManager,\n  CommandManager,\n  KeyboardManager,\n  opacityToHex,\n};\n", "/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BaseCanvasFactory,\n  BaseCMapReaderFactory,\n  BaseFilterFactory,\n  BaseStandardFontDataFactory,\n  BaseSVGFactory,\n} from \"./base_factory.js\";\nimport {\n  BaseException,\n  shadow,\n  stringToBytes,\n  Util,\n  warn,\n} from \"../shared/util.js\";\n\nconst SVG_NS = \"http://www.w3.org/2000/svg\";\n\nconst AnnotationPrefix = \"pdfjs_internal_id_\";\n\nclass PixelsPerInch {\n  static CSS = 96.0;\n\n  static PDF = 72.0;\n\n  static PDF_TO_CSS_UNITS = this.CSS / this.PDF;\n}\n\n/**\n * FilterFactory aims to create some SVG filters we can use when drawing an\n * image (or whatever) on a canvas.\n * Filters aren't applied with ctx.putImageData because it just overwrites the\n * underlying pixels.\n * With these filters, it's possible for example to apply some transfer maps on\n * an image without the need to apply them on the pixel arrays: the renderer\n * does the magic for us.\n */\nclass DOMFilterFactory extends BaseFilterFactory {\n  #_cache;\n\n  #_defs;\n\n  #docId;\n\n  #document;\n\n  #hcmFilter;\n\n  #hcmKey;\n\n  #hcmUrl;\n\n  #hcmHighlightFilter;\n\n  #hcmHighlightKey;\n\n  #hcmHighlightUrl;\n\n  #id = 0;\n\n  constructor({ docId, ownerDocument = globalThis.document } = {}) {\n    super();\n    this.#docId = docId;\n    this.#document = ownerDocument;\n  }\n\n  get #cache() {\n    return (this.#_cache ||= new Map());\n  }\n\n  get #defs() {\n    if (!this.#_defs) {\n      const div = this.#document.createElement(\"div\");\n      const { style } = div;\n      style.visibility = \"hidden\";\n      style.contain = \"strict\";\n      style.width = style.height = 0;\n      style.position = \"absolute\";\n      style.top = style.left = 0;\n      style.zIndex = -1;\n\n      const svg = this.#document.createElementNS(SVG_NS, \"svg\");\n      svg.setAttribute(\"width\", 0);\n      svg.setAttribute(\"height\", 0);\n      this.#_defs = this.#document.createElementNS(SVG_NS, \"defs\");\n      div.append(svg);\n      svg.append(this.#_defs);\n      this.#document.body.append(div);\n    }\n    return this.#_defs;\n  }\n\n  addFilter(maps) {\n    if (!maps) {\n      return \"none\";\n    }\n\n    // When a page is zoomed the page is re-drawn but the maps are likely\n    // the same.\n    let value = this.#cache.get(maps);\n    if (value) {\n      return value;\n    }\n\n    let tableR, tableG, tableB, key;\n    if (maps.length === 1) {\n      const mapR = maps[0];\n      const buffer = new Array(256);\n      for (let i = 0; i < 256; i++) {\n        buffer[i] = mapR[i] / 255;\n      }\n      key = tableR = tableG = tableB = buffer.join(\",\");\n    } else {\n      const [mapR, mapG, mapB] = maps;\n      const bufferR = new Array(256);\n      const bufferG = new Array(256);\n      const bufferB = new Array(256);\n      for (let i = 0; i < 256; i++) {\n        bufferR[i] = mapR[i] / 255;\n        bufferG[i] = mapG[i] / 255;\n        bufferB[i] = mapB[i] / 255;\n      }\n      tableR = bufferR.join(\",\");\n      tableG = bufferG.join(\",\");\n      tableB = bufferB.join(\",\");\n      key = `${tableR}${tableG}${tableB}`;\n    }\n\n    value = this.#cache.get(key);\n    if (value) {\n      this.#cache.set(maps, value);\n      return value;\n    }\n\n    // We create a SVG filter: feComponentTransferElement\n    //  https://www.w3.org/TR/SVG11/filters.html#feComponentTransferElement\n\n    const id = `g_${this.#docId}_transfer_map_${this.#id++}`;\n    const url = `url(#${id})`;\n    this.#cache.set(maps, url);\n    this.#cache.set(key, url);\n\n    const filter = this.#createFilter(id);\n    this.#addTransferMapConversion(tableR, tableG, tableB, filter);\n\n    return url;\n  }\n\n  addHCMFilter(fgColor, bgColor) {\n    const key = `${fgColor}-${bgColor}`;\n    if (this.#hcmKey === key) {\n      return this.#hcmUrl;\n    }\n\n    this.#hcmKey = key;\n    this.#hcmUrl = \"none\";\n    this.#hcmFilter?.remove();\n\n    if (!fgColor || !bgColor) {\n      return this.#hcmUrl;\n    }\n\n    const fgRGB = this.#getRGB(fgColor);\n    fgColor = Util.makeHexColor(...fgRGB);\n    const bgRGB = this.#getRGB(bgColor);\n    bgColor = Util.makeHexColor(...bgRGB);\n    this.#defs.style.color = \"\";\n\n    if (\n      (fgColor === \"#000000\" && bgColor === \"#ffffff\") ||\n      fgColor === bgColor\n    ) {\n      return this.#hcmUrl;\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/Accessibility/Understanding_Colors_and_Luminance\n    //\n    // Relative luminance:\n    // https://www.w3.org/TR/WCAG20/#relativeluminancedef\n    //\n    // We compute the rounded luminance of the default background color.\n    // Then for every color in the pdf, if its rounded luminance is the\n    // same as the background one then it's replaced by the new\n    // background color else by the foreground one.\n    const map = new Array(256);\n    for (let i = 0; i <= 255; i++) {\n      const x = i / 255;\n      map[i] = x <= 0.03928 ? x / 12.92 : ((x + 0.055) / 1.055) ** 2.4;\n    }\n    const table = map.join(\",\");\n\n    const id = `g_${this.#docId}_hcm_filter`;\n    const filter = (this.#hcmHighlightFilter = this.#createFilter(id));\n    this.#addTransferMapConversion(table, table, table, filter);\n    this.#addGrayConversion(filter);\n\n    const getSteps = (c, n) => {\n      const start = fgRGB[c] / 255;\n      const end = bgRGB[c] / 255;\n      const arr = new Array(n + 1);\n      for (let i = 0; i <= n; i++) {\n        arr[i] = start + (i / n) * (end - start);\n      }\n      return arr.join(\",\");\n    };\n    this.#addTransferMapConversion(\n      getSteps(0, 5),\n      getSteps(1, 5),\n      getSteps(2, 5),\n      filter\n    );\n\n    this.#hcmUrl = `url(#${id})`;\n    return this.#hcmUrl;\n  }\n\n  addHighlightHCMFilter(fgColor, bgColor, newFgColor, newBgColor) {\n    const key = `${fgColor}-${bgColor}-${newFgColor}-${newBgColor}`;\n    if (this.#hcmHighlightKey === key) {\n      return this.#hcmHighlightUrl;\n    }\n\n    this.#hcmHighlightKey = key;\n    this.#hcmHighlightUrl = \"none\";\n    this.#hcmHighlightFilter?.remove();\n\n    if (!fgColor || !bgColor) {\n      return this.#hcmHighlightUrl;\n    }\n\n    const [fgRGB, bgRGB] = [fgColor, bgColor].map(this.#getRGB.bind(this));\n    let fgGray = Math.round(\n      0.2126 * fgRGB[0] + 0.7152 * fgRGB[1] + 0.0722 * fgRGB[2]\n    );\n    let bgGray = Math.round(\n      0.2126 * bgRGB[0] + 0.7152 * bgRGB[1] + 0.0722 * bgRGB[2]\n    );\n    let [newFgRGB, newBgRGB] = [newFgColor, newBgColor].map(\n      this.#getRGB.bind(this)\n    );\n    if (bgGray < fgGray) {\n      [fgGray, bgGray, newFgRGB, newBgRGB] = [\n        bgGray,\n        fgGray,\n        newBgRGB,\n        newFgRGB,\n      ];\n    }\n    this.#defs.style.color = \"\";\n\n    // Now we can create the filters to highlight some canvas parts.\n    // The colors in the pdf will almost be Canvas and CanvasText, hence we\n    // want to filter them to finally get Highlight and HighlightText.\n    // Since we're in HCM the background color and the foreground color should\n    // be really different when converted to grayscale (if they're not then it\n    // means that we've a poor contrast). Once the canvas colors are converted\n    // to grayscale we can easily map them on their new colors.\n    // The grayscale step is important because if we've something like:\n    //   fgColor = #FF....\n    //   bgColor = #FF....\n    //   then we are enable to map the red component on the new red components\n    //   which can be different.\n\n    const getSteps = (fg, bg, n) => {\n      const arr = new Array(256);\n      const step = (bgGray - fgGray) / n;\n      const newStart = fg / 255;\n      const newStep = (bg - fg) / (255 * n);\n      let prev = 0;\n      for (let i = 0; i <= n; i++) {\n        const k = Math.round(fgGray + i * step);\n        const value = newStart + i * newStep;\n        for (let j = prev; j <= k; j++) {\n          arr[j] = value;\n        }\n        prev = k + 1;\n      }\n      for (let i = prev; i < 256; i++) {\n        arr[i] = arr[prev - 1];\n      }\n      return arr.join(\",\");\n    };\n\n    const id = `g_${this.#docId}_hcm_highlight_filter`;\n    const filter = (this.#hcmHighlightFilter = this.#createFilter(id));\n\n    this.#addGrayConversion(filter);\n    this.#addTransferMapConversion(\n      getSteps(newFgRGB[0], newBgRGB[0], 5),\n      getSteps(newFgRGB[1], newBgRGB[1], 5),\n      getSteps(newFgRGB[2], newBgRGB[2], 5),\n      filter\n    );\n\n    this.#hcmHighlightUrl = `url(#${id})`;\n    return this.#hcmHighlightUrl;\n  }\n\n  destroy(keepHCM = false) {\n    if (keepHCM && (this.#hcmUrl || this.#hcmHighlightUrl)) {\n      return;\n    }\n    if (this.#_defs) {\n      this.#_defs.parentNode.parentNode.remove();\n      this.#_defs = null;\n    }\n    if (this.#_cache) {\n      this.#_cache.clear();\n      this.#_cache = null;\n    }\n    this.#id = 0;\n  }\n\n  #addGrayConversion(filter) {\n    const feColorMatrix = this.#document.createElementNS(\n      SVG_NS,\n      \"feColorMatrix\"\n    );\n    feColorMatrix.setAttribute(\"type\", \"matrix\");\n    feColorMatrix.setAttribute(\n      \"values\",\n      \"0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0\"\n    );\n    filter.append(feColorMatrix);\n  }\n\n  #createFilter(id) {\n    const filter = this.#document.createElementNS(SVG_NS, \"filter\");\n    filter.setAttribute(\"color-interpolation-filters\", \"sRGB\");\n    filter.setAttribute(\"id\", id);\n    this.#defs.append(filter);\n\n    return filter;\n  }\n\n  #appendFeFunc(feComponentTransfer, func, table) {\n    const feFunc = this.#document.createElementNS(SVG_NS, func);\n    feFunc.setAttribute(\"type\", \"discrete\");\n    feFunc.setAttribute(\"tableValues\", table);\n    feComponentTransfer.append(feFunc);\n  }\n\n  #addTransferMapConversion(rTable, gTable, bTable, filter) {\n    const feComponentTransfer = this.#document.createElementNS(\n      SVG_NS,\n      \"feComponentTransfer\"\n    );\n    filter.append(feComponentTransfer);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncR\", rTable);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncG\", gTable);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncB\", bTable);\n  }\n\n  #getRGB(color) {\n    this.#defs.style.color = color;\n    return getRGB(getComputedStyle(this.#defs).getPropertyValue(\"color\"));\n  }\n}\n\nclass DOMCanvasFactory extends BaseCanvasFactory {\n  constructor({ ownerDocument = globalThis.document } = {}) {\n    super();\n    this._document = ownerDocument;\n  }\n\n  /**\n   * @ignore\n   */\n  _createCanvas(width, height) {\n    const canvas = this._document.createElement(\"canvas\");\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  }\n}\n\nasync function fetchData(url, asTypedArray = false) {\n  if (\n    (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n    isValidFetchUrl(url, document.baseURI)\n  ) {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(response.statusText);\n    }\n    return asTypedArray\n      ? new Uint8Array(await response.arrayBuffer())\n      : stringToBytes(await response.text());\n  }\n\n  // The Fetch API is not supported.\n  return new Promise((resolve, reject) => {\n    const request = new XMLHttpRequest();\n    request.open(\"GET\", url, /* asTypedArray = */ true);\n\n    if (asTypedArray) {\n      request.responseType = \"arraybuffer\";\n    }\n    request.onreadystatechange = () => {\n      if (request.readyState !== XMLHttpRequest.DONE) {\n        return;\n      }\n      if (request.status === 200 || request.status === 0) {\n        let data;\n        if (asTypedArray && request.response) {\n          data = new Uint8Array(request.response);\n        } else if (!asTypedArray && request.responseText) {\n          data = stringToBytes(request.responseText);\n        }\n        if (data) {\n          resolve(data);\n          return;\n        }\n      }\n      reject(new Error(request.statusText));\n    };\n\n    request.send(null);\n  });\n}\n\nclass DOMCMapReaderFactory extends BaseCMapReaderFactory {\n  /**\n   * @ignore\n   */\n  _fetchData(url, compressionType) {\n    return fetchData(url, /* asTypedArray = */ this.isCompressed).then(data => {\n      return { cMapData: data, compressionType };\n    });\n  }\n}\n\nclass DOMStandardFontDataFactory extends BaseStandardFontDataFactory {\n  /**\n   * @ignore\n   */\n  _fetchData(url) {\n    return fetchData(url, /* asTypedArray = */ true);\n  }\n}\n\nclass DOMSVGFactory extends BaseSVGFactory {\n  /**\n   * @ignore\n   */\n  _createSVG(type) {\n    return document.createElementNS(SVG_NS, type);\n  }\n}\n\n/**\n * @typedef {Object} PageViewportParameters\n * @property {Array<number>} viewBox - The xMin, yMin, xMax and\n *   yMax coordinates.\n * @property {number} scale - The scale of the viewport.\n * @property {number} rotation - The rotation, in degrees, of the viewport.\n * @property {number} [offsetX] - The horizontal, i.e. x-axis, offset. The\n *   default value is `0`.\n * @property {number} [offsetY] - The vertical, i.e. y-axis, offset. The\n *   default value is `0`.\n * @property {boolean} [dontFlip] - If true, the y-axis will not be flipped.\n *   The default value is `false`.\n */\n\n/**\n * @typedef {Object} PageViewportCloneParameters\n * @property {number} [scale] - The scale, overriding the one in the cloned\n *   viewport. The default value is `this.scale`.\n * @property {number} [rotation] - The rotation, in degrees, overriding the one\n *   in the cloned viewport. The default value is `this.rotation`.\n * @property {number} [offsetX] - The horizontal, i.e. x-axis, offset.\n *   The default value is `this.offsetX`.\n * @property {number} [offsetY] - The vertical, i.e. y-axis, offset.\n *   The default value is `this.offsetY`.\n * @property {boolean} [dontFlip] - If true, the x-axis will not be flipped.\n *   The default value is `false`.\n */\n\n/**\n * PDF page viewport created based on scale, rotation and offset.\n */\nclass PageViewport {\n  /**\n   * @param {PageViewportParameters}\n   */\n  constructor({\n    viewBox,\n    scale,\n    rotation,\n    offsetX = 0,\n    offsetY = 0,\n    dontFlip = false,\n  }) {\n    this.viewBox = viewBox;\n    this.scale = scale;\n    this.rotation = rotation;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n\n    // creating transform to convert pdf coordinate system to the normal\n    // canvas like coordinates taking in account scale and rotation\n    const centerX = (viewBox[2] + viewBox[0]) / 2;\n    const centerY = (viewBox[3] + viewBox[1]) / 2;\n    let rotateA, rotateB, rotateC, rotateD;\n    // Normalize the rotation, by clamping it to the [0, 360) range.\n    rotation %= 360;\n    if (rotation < 0) {\n      rotation += 360;\n    }\n    switch (rotation) {\n      case 180:\n        rotateA = -1;\n        rotateB = 0;\n        rotateC = 0;\n        rotateD = 1;\n        break;\n      case 90:\n        rotateA = 0;\n        rotateB = 1;\n        rotateC = 1;\n        rotateD = 0;\n        break;\n      case 270:\n        rotateA = 0;\n        rotateB = -1;\n        rotateC = -1;\n        rotateD = 0;\n        break;\n      case 0:\n        rotateA = 1;\n        rotateB = 0;\n        rotateC = 0;\n        rotateD = -1;\n        break;\n      default:\n        throw new Error(\n          \"PageViewport: Invalid rotation, must be a multiple of 90 degrees.\"\n        );\n    }\n\n    if (dontFlip) {\n      rotateC = -rotateC;\n      rotateD = -rotateD;\n    }\n\n    let offsetCanvasX, offsetCanvasY;\n    let width, height;\n    if (rotateA === 0) {\n      offsetCanvasX = Math.abs(centerY - viewBox[1]) * scale + offsetX;\n      offsetCanvasY = Math.abs(centerX - viewBox[0]) * scale + offsetY;\n      width = (viewBox[3] - viewBox[1]) * scale;\n      height = (viewBox[2] - viewBox[0]) * scale;\n    } else {\n      offsetCanvasX = Math.abs(centerX - viewBox[0]) * scale + offsetX;\n      offsetCanvasY = Math.abs(centerY - viewBox[1]) * scale + offsetY;\n      width = (viewBox[2] - viewBox[0]) * scale;\n      height = (viewBox[3] - viewBox[1]) * scale;\n    }\n    // creating transform for the following operations:\n    // translate(-centerX, -centerY), rotate and flip vertically,\n    // scale, and translate(offsetCanvasX, offsetCanvasY)\n    this.transform = [\n      rotateA * scale,\n      rotateB * scale,\n      rotateC * scale,\n      rotateD * scale,\n      offsetCanvasX - rotateA * scale * centerX - rotateC * scale * centerY,\n      offsetCanvasY - rotateB * scale * centerX - rotateD * scale * centerY,\n    ];\n\n    this.width = width;\n    this.height = height;\n  }\n\n  /**\n   * The original, un-scaled, viewport dimensions.\n   * @type {Object}\n   */\n  get rawDims() {\n    const { viewBox } = this;\n    return shadow(this, \"rawDims\", {\n      pageWidth: viewBox[2] - viewBox[0],\n      pageHeight: viewBox[3] - viewBox[1],\n      pageX: viewBox[0],\n      pageY: viewBox[1],\n    });\n  }\n\n  /**\n   * Clones viewport, with optional additional properties.\n   * @param {PageViewportCloneParameters} [params]\n   * @returns {PageViewport} Cloned viewport.\n   */\n  clone({\n    scale = this.scale,\n    rotation = this.rotation,\n    offsetX = this.offsetX,\n    offsetY = this.offsetY,\n    dontFlip = false,\n  } = {}) {\n    return new PageViewport({\n      viewBox: this.viewBox.slice(),\n      scale,\n      rotation,\n      offsetX,\n      offsetY,\n      dontFlip,\n    });\n  }\n\n  /**\n   * Converts PDF point to the viewport coordinates. For examples, useful for\n   * converting PDF location into canvas pixel coordinates.\n   * @param {number} x - The x-coordinate.\n   * @param {number} y - The y-coordinate.\n   * @returns {Array} Array containing `x`- and `y`-coordinates of the\n   *   point in the viewport coordinate space.\n   * @see {@link convertToPdfPoint}\n   * @see {@link convertToViewportRectangle}\n   */\n  convertToViewportPoint(x, y) {\n    return Util.applyTransform([x, y], this.transform);\n  }\n\n  /**\n   * Converts PDF rectangle to the viewport coordinates.\n   * @param {Array} rect - The xMin, yMin, xMax and yMax coordinates.\n   * @returns {Array} Array containing corresponding coordinates of the\n   *   rectangle in the viewport coordinate space.\n   * @see {@link convertToViewportPoint}\n   */\n  convertToViewportRectangle(rect) {\n    const topLeft = Util.applyTransform([rect[0], rect[1]], this.transform);\n    const bottomRight = Util.applyTransform([rect[2], rect[3]], this.transform);\n    return [topLeft[0], topLeft[1], bottomRight[0], bottomRight[1]];\n  }\n\n  /**\n   * Converts viewport coordinates to the PDF location. For examples, useful\n   * for converting canvas pixel location into PDF one.\n   * @param {number} x - The x-coordinate.\n   * @param {number} y - The y-coordinate.\n   * @returns {Array} Array containing `x`- and `y`-coordinates of the\n   *   point in the PDF coordinate space.\n   * @see {@link convertToViewportPoint}\n   */\n  convertToPdfPoint(x, y) {\n    return Util.applyInverseTransform([x, y], this.transform);\n  }\n}\n\nclass RenderingCancelledException extends BaseException {\n  constructor(msg, extraDelay = 0) {\n    super(msg, \"RenderingCancelledException\");\n    this.extraDelay = extraDelay;\n  }\n}\n\nfunction isDataScheme(url) {\n  const ii = url.length;\n  let i = 0;\n  while (i < ii && url[i].trim() === \"\") {\n    i++;\n  }\n  return url.substring(i, i + 5).toLowerCase() === \"data:\";\n}\n\nfunction isPdfFile(filename) {\n  return typeof filename === \"string\" && /\\.pdf$/i.test(filename);\n}\n\n/**\n * Gets the filename from a given URL.\n * @param {string} url\n * @param {boolean} [onlyStripPath]\n * @returns {string}\n */\nfunction getFilenameFromUrl(url, onlyStripPath = false) {\n  if (!onlyStripPath) {\n    [url] = url.split(/[#?]/, 1);\n  }\n  return url.substring(url.lastIndexOf(\"/\") + 1);\n}\n\n/**\n * Returns the filename or guessed filename from the url (see issue 3455).\n * @param {string} url - The original PDF location.\n * @param {string} defaultFilename - The value returned if the filename is\n *   unknown, or the protocol is unsupported.\n * @returns {string} Guessed PDF filename.\n */\nfunction getPdfFilenameFromUrl(url, defaultFilename = \"document.pdf\") {\n  if (typeof url !== \"string\") {\n    return defaultFilename;\n  }\n  if (isDataScheme(url)) {\n    warn('getPdfFilenameFromUrl: ignore \"data:\"-URL for performance reasons.');\n    return defaultFilename;\n  }\n  const reURI = /^(?:(?:[^:]+:)?\\/\\/[^/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n  //              SCHEME        HOST        1.PATH  2.QUERY   3.REF\n  // Pattern to get last matching NAME.pdf\n  const reFilename = /[^/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n  const splitURI = reURI.exec(url);\n  let suggestedFilename =\n    reFilename.exec(splitURI[1]) ||\n    reFilename.exec(splitURI[2]) ||\n    reFilename.exec(splitURI[3]);\n  if (suggestedFilename) {\n    suggestedFilename = suggestedFilename[0];\n    if (suggestedFilename.includes(\"%\")) {\n      // URL-encoded %2Fpath%2Fto%2Ffile.pdf should be file.pdf\n      try {\n        suggestedFilename = reFilename.exec(\n          decodeURIComponent(suggestedFilename)\n        )[0];\n      } catch {\n        // Possible (extremely rare) errors:\n        // URIError \"Malformed URI\", e.g. for \"%AA.pdf\"\n        // TypeError \"null has no properties\", e.g. for \"%2F.pdf\"\n      }\n    }\n  }\n  return suggestedFilename || defaultFilename;\n}\n\nclass StatTimer {\n  started = Object.create(null);\n\n  times = [];\n\n  time(name) {\n    if (name in this.started) {\n      warn(`Timer is already running for ${name}`);\n    }\n    this.started[name] = Date.now();\n  }\n\n  timeEnd(name) {\n    if (!(name in this.started)) {\n      warn(`Timer has not been started for ${name}`);\n    }\n    this.times.push({\n      name,\n      start: this.started[name],\n      end: Date.now(),\n    });\n    // Remove timer from started so it can be called again.\n    delete this.started[name];\n  }\n\n  toString() {\n    // Find the longest name for padding purposes.\n    const outBuf = [];\n    let longest = 0;\n    for (const { name } of this.times) {\n      longest = Math.max(name.length, longest);\n    }\n    for (const { name, start, end } of this.times) {\n      outBuf.push(`${name.padEnd(longest)} ${end - start}ms\\n`);\n    }\n    return outBuf.join(\"\");\n  }\n}\n\nfunction isValidFetchUrl(url, baseUrl) {\n  if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n    throw new Error(\"Not implemented: isValidFetchUrl\");\n  }\n  try {\n    const { protocol } = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    // The Fetch API only supports the http/https protocols, and not file/ftp.\n    return protocol === \"http:\" || protocol === \"https:\";\n  } catch {\n    return false; // `new URL()` will throw on incorrect data.\n  }\n}\n\n/**\n * @param {string} src\n * @param {boolean} [removeScriptElement]\n * @returns {Promise<void>}\n */\nfunction loadScript(src, removeScriptElement = false) {\n  return new Promise((resolve, reject) => {\n    const script = document.createElement(\"script\");\n    script.src = src;\n\n    script.onload = function (evt) {\n      if (removeScriptElement) {\n        script.remove();\n      }\n      resolve(evt);\n    };\n    script.onerror = function () {\n      reject(new Error(`Cannot load script at: ${script.src}`));\n    };\n    (document.head || document.documentElement).append(script);\n  });\n}\n\n// Deprecated API function -- display regardless of the `verbosity` setting.\nfunction deprecated(details) {\n  console.log(\"Deprecated API usage: \" + details);\n}\n\nlet pdfDateStringRegex;\n\nclass PDFDateString {\n  /**\n   * Convert a PDF date string to a JavaScript `Date` object.\n   *\n   * The PDF date string format is described in section 7.9.4 of the official\n   * PDF 32000-1:2008 specification. However, in the PDF 1.7 reference (sixth\n   * edition) Adobe describes the same format including a trailing apostrophe.\n   * This syntax in incorrect, but Adobe Acrobat creates PDF files that contain\n   * them. We ignore all apostrophes as they are not necessary for date parsing.\n   *\n   * Moreover, Adobe Acrobat doesn't handle changing the date to universal time\n   * and doesn't use the user's time zone (effectively ignoring the HH' and mm'\n   * parts of the date string).\n   *\n   * @param {string} input\n   * @returns {Date|null}\n   */\n  static toDateObject(input) {\n    if (!input || typeof input !== \"string\") {\n      return null;\n    }\n\n    // Lazily initialize the regular expression.\n    pdfDateStringRegex ||= new RegExp(\n      \"^D:\" + // Prefix (required)\n        \"(\\\\d{4})\" + // Year (required)\n        \"(\\\\d{2})?\" + // Month (optional)\n        \"(\\\\d{2})?\" + // Day (optional)\n        \"(\\\\d{2})?\" + // Hour (optional)\n        \"(\\\\d{2})?\" + // Minute (optional)\n        \"(\\\\d{2})?\" + // Second (optional)\n        \"([Z|+|-])?\" + // Universal time relation (optional)\n        \"(\\\\d{2})?\" + // Offset hour (optional)\n        \"'?\" + // Splitting apostrophe (optional)\n        \"(\\\\d{2})?\" + // Offset minute (optional)\n        \"'?\" // Trailing apostrophe (optional)\n    );\n\n    // Optional fields that don't satisfy the requirements from the regular\n    // expression (such as incorrect digit counts or numbers that are out of\n    // range) will fall back the defaults from the specification.\n    const matches = pdfDateStringRegex.exec(input);\n    if (!matches) {\n      return null;\n    }\n\n    // JavaScript's `Date` object expects the month to be between 0 and 11\n    // instead of 1 and 12, so we have to correct for that.\n    const year = parseInt(matches[1], 10);\n    let month = parseInt(matches[2], 10);\n    month = month >= 1 && month <= 12 ? month - 1 : 0;\n    let day = parseInt(matches[3], 10);\n    day = day >= 1 && day <= 31 ? day : 1;\n    let hour = parseInt(matches[4], 10);\n    hour = hour >= 0 && hour <= 23 ? hour : 0;\n    let minute = parseInt(matches[5], 10);\n    minute = minute >= 0 && minute <= 59 ? minute : 0;\n    let second = parseInt(matches[6], 10);\n    second = second >= 0 && second <= 59 ? second : 0;\n    const universalTimeRelation = matches[7] || \"Z\";\n    let offsetHour = parseInt(matches[8], 10);\n    offsetHour = offsetHour >= 0 && offsetHour <= 23 ? offsetHour : 0;\n    let offsetMinute = parseInt(matches[9], 10) || 0;\n    offsetMinute = offsetMinute >= 0 && offsetMinute <= 59 ? offsetMinute : 0;\n\n    // Universal time relation 'Z' means that the local time is equal to the\n    // universal time, whereas the relations '+'/'-' indicate that the local\n    // time is later respectively earlier than the universal time. Every date\n    // is normalized to universal time.\n    if (universalTimeRelation === \"-\") {\n      hour += offsetHour;\n      minute += offsetMinute;\n    } else if (universalTimeRelation === \"+\") {\n      hour -= offsetHour;\n      minute -= offsetMinute;\n    }\n\n    return new Date(Date.UTC(year, month, day, hour, minute, second));\n  }\n}\n\n/**\n * NOTE: This is (mostly) intended to support printing of XFA forms.\n */\nfunction getXfaPageViewport(xfaPage, { scale = 1, rotation = 0 }) {\n  const { width, height } = xfaPage.attributes.style;\n  const viewBox = [0, 0, parseInt(width), parseInt(height)];\n\n  return new PageViewport({\n    viewBox,\n    scale,\n    rotation,\n  });\n}\n\nfunction getRGB(color) {\n  if (color.startsWith(\"#\")) {\n    const colorRGB = parseInt(color.slice(1), 16);\n    return [\n      (colorRGB & 0xff0000) >> 16,\n      (colorRGB & 0x00ff00) >> 8,\n      colorRGB & 0x0000ff,\n    ];\n  }\n\n  if (color.startsWith(\"rgb(\")) {\n    // getComputedStyle(...).color returns a `rgb(R, G, B)` color.\n    return color\n      .slice(/* \"rgb(\".length */ 4, -1) // Strip out \"rgb(\" and \")\".\n      .split(\",\")\n      .map(x => parseInt(x));\n  }\n\n  if (color.startsWith(\"rgba(\")) {\n    return color\n      .slice(/* \"rgba(\".length */ 5, -1) // Strip out \"rgba(\" and \")\".\n      .split(\",\")\n      .map(x => parseInt(x))\n      .slice(0, 3);\n  }\n\n  warn(`Not a valid color format: \"${color}\"`);\n  return [0, 0, 0];\n}\n\nfunction getColorValues(colors) {\n  const span = document.createElement(\"span\");\n  span.style.visibility = \"hidden\";\n  document.body.append(span);\n  for (const name of colors.keys()) {\n    span.style.color = name;\n    const computedColor = window.getComputedStyle(span).color;\n    colors.set(name, getRGB(computedColor));\n  }\n  span.remove();\n}\n\nfunction getCurrentTransform(ctx) {\n  const { a, b, c, d, e, f } = ctx.getTransform();\n  return [a, b, c, d, e, f];\n}\n\nfunction getCurrentTransformInverse(ctx) {\n  const { a, b, c, d, e, f } = ctx.getTransform().invertSelf();\n  return [a, b, c, d, e, f];\n}\n\n/**\n * @param {HTMLDivElement} div\n * @param {PageViewport} viewport\n * @param {boolean} mustFlip\n * @param {boolean} mustRotate\n */\nfunction setLayerDimensions(\n  div,\n  viewport,\n  mustFlip = false,\n  mustRotate = true\n) {\n  if (viewport instanceof PageViewport) {\n    const { pageWidth, pageHeight } = viewport.rawDims;\n    const { style } = div;\n\n    // TODO: Investigate if it could be interesting to use the css round\n    // function (https://developer.mozilla.org/en-US/docs/Web/CSS/round):\n    // const widthStr =\n    //   `round(down, var(--scale-factor) * ${pageWidth}px, 1px)`;\n    // const heightStr =\n    //   `round(down, var(--scale-factor) * ${pageHeight}px, 1px)`;\n    const widthStr = `calc(var(--scale-factor) * ${pageWidth}px)`;\n    const heightStr = `calc(var(--scale-factor) * ${pageHeight}px)`;\n\n    if (!mustFlip || viewport.rotation % 180 === 0) {\n      style.width = widthStr;\n      style.height = heightStr;\n    } else {\n      style.width = heightStr;\n      style.height = widthStr;\n    }\n  }\n\n  if (mustRotate) {\n    div.setAttribute(\"data-main-rotation\", viewport.rotation);\n  }\n}\n\nexport {\n  AnnotationPrefix,\n  deprecated,\n  DOMCanvasFactory,\n  DOMCMapReaderFactory,\n  DOMFilterFactory,\n  DOMStandardFontDataFactory,\n  DOMSVGFactory,\n  getColorValues,\n  getCurrentTransform,\n  getCurrentTransformInverse,\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl,\n  getRGB,\n  getXfaPageViewport,\n  isDataScheme,\n  isPdfFile,\n  isValidFetchUrl,\n  loadScript,\n  PageViewport,\n  PDFDateString,\n  PixelsPerInch,\n  RenderingCancelledException,\n  setLayerDimensions,\n  StatTimer,\n};\n", "/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CMapCompressionType, unreachable } from \"../shared/util.js\";\n\nclass BaseFilterFactory {\n  constructor() {\n    if (this.constructor === BaseFilterFactory) {\n      unreachable(\"Cannot initialize BaseFilterFactory.\");\n    }\n  }\n\n  addFilter(maps) {\n    return \"none\";\n  }\n\n  addHCMFilter(fgColor, bgColor) {\n    return \"none\";\n  }\n\n  addHighlightHCMFilter(fgColor, bgColor, newFgColor, newBgColor) {\n    return \"none\";\n  }\n\n  destroy(keepHCM = false) {}\n}\n\nclass BaseCanvasFactory {\n  constructor() {\n    if (this.constructor === BaseCanvasFactory) {\n      unreachable(\"Cannot initialize BaseCanvasFactory.\");\n    }\n  }\n\n  create(width, height) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid canvas size\");\n    }\n    const canvas = this._createCanvas(width, height);\n    return {\n      canvas,\n      context: canvas.getContext(\"2d\"),\n    };\n  }\n\n  reset(canvasAndContext, width, height) {\n    if (!canvasAndContext.canvas) {\n      throw new Error(\"Canvas is not specified\");\n    }\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid canvas size\");\n    }\n    canvasAndContext.canvas.width = width;\n    canvasAndContext.canvas.height = height;\n  }\n\n  destroy(canvasAndContext) {\n    if (!canvasAndContext.canvas) {\n      throw new Error(\"Canvas is not specified\");\n    }\n    // Zeroing the width and height cause Firefox to release graphics\n    // resources immediately, which can greatly reduce memory consumption.\n    canvasAndContext.canvas.width = 0;\n    canvasAndContext.canvas.height = 0;\n    canvasAndContext.canvas = null;\n    canvasAndContext.context = null;\n  }\n\n  /**\n   * @ignore\n   */\n  _createCanvas(width, height) {\n    unreachable(\"Abstract method `_createCanvas` called.\");\n  }\n}\n\nclass BaseCMapReaderFactory {\n  constructor({ baseUrl = null, isCompressed = true }) {\n    if (this.constructor === BaseCMapReaderFactory) {\n      unreachable(\"Cannot initialize BaseCMapReaderFactory.\");\n    }\n    this.baseUrl = baseUrl;\n    this.isCompressed = isCompressed;\n  }\n\n  async fetch({ name }) {\n    if (!this.baseUrl) {\n      throw new Error(\n        'The CMap \"baseUrl\" parameter must be specified, ensure that ' +\n          'the \"cMapUrl\" and \"cMapPacked\" API parameters are provided.'\n      );\n    }\n    if (!name) {\n      throw new Error(\"CMap name must be specified.\");\n    }\n    const url = this.baseUrl + name + (this.isCompressed ? \".bcmap\" : \"\");\n    const compressionType = this.isCompressed\n      ? CMapCompressionType.BINARY\n      : CMapCompressionType.NONE;\n\n    return this._fetchData(url, compressionType).catch(reason => {\n      throw new Error(\n        `Unable to load ${this.isCompressed ? \"binary \" : \"\"}CMap at: ${url}`\n      );\n    });\n  }\n\n  /**\n   * @ignore\n   */\n  _fetchData(url, compressionType) {\n    unreachable(\"Abstract method `_fetchData` called.\");\n  }\n}\n\nclass BaseStandardFontDataFactory {\n  constructor({ baseUrl = null }) {\n    if (this.constructor === BaseStandardFontDataFactory) {\n      unreachable(\"Cannot initialize BaseStandardFontDataFactory.\");\n    }\n    this.baseUrl = baseUrl;\n  }\n\n  async fetch({ filename }) {\n    if (!this.baseUrl) {\n      throw new Error(\n        'The standard font \"baseUrl\" parameter must be specified, ensure that ' +\n          'the \"standardFontDataUrl\" API parameter is provided.'\n      );\n    }\n    if (!filename) {\n      throw new Error(\"Font filename must be specified.\");\n    }\n    const url = `${this.baseUrl}${filename}`;\n\n    return this._fetchData(url).catch(reason => {\n      throw new Error(`Unable to load font data at: ${url}`);\n    });\n  }\n\n  /**\n   * @ignore\n   */\n  _fetchData(url) {\n    unreachable(\"Abstract method `_fetchData` called.\");\n  }\n}\n\nclass BaseSVGFactory {\n  constructor() {\n    if (this.constructor === BaseSVGFactory) {\n      unreachable(\"Cannot initialize BaseSVGFactory.\");\n    }\n  }\n\n  create(width, height, skipDimensions = false) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid SVG dimensions\");\n    }\n    const svg = this._createSVG(\"svg:svg\");\n    svg.setAttribute(\"version\", \"1.1\");\n\n    if (!skipDimensions) {\n      svg.setAttribute(\"width\", `${width}px`);\n      svg.setAttribute(\"height\", `${height}px`);\n    }\n\n    svg.setAttribute(\"preserveAspectRatio\", \"none\");\n    svg.setAttribute(\"viewBox\", `0 0 ${width} ${height}`);\n\n    return svg;\n  }\n\n  createElement(type) {\n    if (typeof type !== \"string\") {\n      throw new Error(\"Invalid SVG element type\");\n    }\n    return this._createSVG(type);\n  }\n\n  /**\n   * @ignore\n   */\n  _createSVG(type) {\n    unreachable(\"Abstract method `_createSVG` called.\");\n  }\n}\n\nexport {\n  BaseCanvasFactory,\n  BaseCMapReaderFactory,\n  BaseFilterFactory,\n  BaseStandardFontDataFactory,\n  BaseSVGFactory,\n};\n", "/* Copyright 2014 Opera Software ASA\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n *\n * Based on https://code.google.com/p/smhasher/wiki/MurmurHash3.\n * Hashes roughly 100 KB per millisecond on i7 3.4 GHz.\n */\n\nimport { isArrayBuffer } from \"./util.js\";\n\nconst SEED = 0xc3d2e1f0;\n// Workaround for missing math precision in JS.\nconst MASK_HIGH = 0xffff0000;\nconst MASK_LOW = 0xffff;\n\nclass MurmurHash3_64 {\n  constructor(seed) {\n    this.h1 = seed ? seed & 0xffffffff : SEED;\n    this.h2 = seed ? seed & 0xffffffff : SEED;\n  }\n\n  update(input) {\n    let data, length;\n    if (typeof input === \"string\") {\n      data = new Uint8Array(input.length * 2);\n      length = 0;\n      for (let i = 0, ii = input.length; i < ii; i++) {\n        const code = input.charCodeAt(i);\n        if (code <= 0xff) {\n          data[length++] = code;\n        } else {\n          data[length++] = code >>> 8;\n          data[length++] = code & 0xff;\n        }\n      }\n    } else if (isArrayBuffer(input)) {\n      data = input.slice();\n      length = data.byteLength;\n    } else {\n      throw new Error(\n        \"Wrong data format in MurmurHash3_64_update. \" +\n          \"Input must be a string or array.\"\n      );\n    }\n\n    const blockCounts = length >> 2;\n    const tailLength = length - blockCounts * 4;\n    // We don't care about endianness here.\n    const dataUint32 = new Uint32Array(data.buffer, 0, blockCounts);\n    let k1 = 0,\n      k2 = 0;\n    let h1 = this.h1,\n      h2 = this.h2;\n    const C1 = 0xcc9e2d51,\n      C2 = 0x1b873593;\n    const C1_LOW = C1 & MASK_LOW,\n      C2_LOW = C2 & MASK_LOW;\n\n    for (let i = 0; i < blockCounts; i++) {\n      if (i & 1) {\n        k1 = dataUint32[i];\n        k1 = ((k1 * C1) & MASK_HIGH) | ((k1 * C1_LOW) & MASK_LOW);\n        k1 = (k1 << 15) | (k1 >>> 17);\n        k1 = ((k1 * C2) & MASK_HIGH) | ((k1 * C2_LOW) & MASK_LOW);\n        h1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n        h1 = h1 * 5 + 0xe6546b64;\n      } else {\n        k2 = dataUint32[i];\n        k2 = ((k2 * C1) & MASK_HIGH) | ((k2 * C1_LOW) & MASK_LOW);\n        k2 = (k2 << 15) | (k2 >>> 17);\n        k2 = ((k2 * C2) & MASK_HIGH) | ((k2 * C2_LOW) & MASK_LOW);\n        h2 ^= k2;\n        h2 = (h2 << 13) | (h2 >>> 19);\n        h2 = h2 * 5 + 0xe6546b64;\n      }\n    }\n\n    k1 = 0;\n\n    switch (tailLength) {\n      case 3:\n        k1 ^= data[blockCounts * 4 + 2] << 16;\n      /* falls through */\n      case 2:\n        k1 ^= data[blockCounts * 4 + 1] << 8;\n      /* falls through */\n      case 1:\n        k1 ^= data[blockCounts * 4];\n        /* falls through */\n\n        k1 = ((k1 * C1) & MASK_HIGH) | ((k1 * C1_LOW) & MASK_LOW);\n        k1 = (k1 << 15) | (k1 >>> 17);\n        k1 = ((k1 * C2) & MASK_HIGH) | ((k1 * C2_LOW) & MASK_LOW);\n        if (blockCounts & 1) {\n          h1 ^= k1;\n        } else {\n          h2 ^= k1;\n        }\n    }\n\n    this.h1 = h1;\n    this.h2 = h2;\n  }\n\n  hexdigest() {\n    let h1 = this.h1,\n      h2 = this.h2;\n\n    h1 ^= h2 >>> 1;\n    h1 = ((h1 * 0xed558ccd) & MASK_HIGH) | ((h1 * 0x8ccd) & MASK_LOW);\n    h2 =\n      ((h2 * 0xff51afd7) & MASK_HIGH) |\n      (((((h2 << 16) | (h1 >>> 16)) * 0xafd7ed55) & MASK_HIGH) >>> 16);\n    h1 ^= h2 >>> 1;\n    h1 = ((h1 * 0x1a85ec53) & MASK_HIGH) | ((h1 * 0xec53) & MASK_LOW);\n    h2 =\n      ((h2 * 0xc4ceb9fe) & MASK_HIGH) |\n      (((((h2 << 16) | (h1 >>> 16)) * 0xb9fe1a85) & MASK_HIGH) >>> 16);\n    h1 ^= h2 >>> 1;\n\n    return (\n      (h1 >>> 0).toString(16).padStart(8, \"0\") +\n      (h2 >>> 0).toString(16).padStart(8, \"0\")\n    );\n  }\n}\n\nexport { MurmurHash3_64 };\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  assert,\n  bytesToString,\n  FeatureTest,\n  shadow,\n  string32,\n  unreachable,\n  warn,\n} from \"../shared/util.js\";\nimport { isNodeJS } from \"../shared/is_node.js\";\n\nclass FontLoader {\n  #systemFonts = new Set();\n\n  constructor({\n    ownerDocument = globalThis.document,\n    styleElement = null, // For testing only.\n  }) {\n    this._document = ownerDocument;\n\n    this.nativeFontFaces = new Set();\n    this.styleElement =\n      typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")\n        ? styleElement\n        : null;\n\n    if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n      this.loadingRequests = [];\n      this.loadTestFontId = 0;\n    }\n  }\n\n  addNativeFontFace(nativeFontFace) {\n    this.nativeFontFaces.add(nativeFontFace);\n    this._document.fonts.add(nativeFontFace);\n  }\n\n  removeNativeFontFace(nativeFontFace) {\n    this.nativeFontFaces.delete(nativeFontFace);\n    this._document.fonts.delete(nativeFontFace);\n  }\n\n  insertRule(rule) {\n    if (!this.styleElement) {\n      this.styleElement = this._document.createElement(\"style\");\n      this._document.documentElement\n        .getElementsByTagName(\"head\")[0]\n        .append(this.styleElement);\n    }\n    const styleSheet = this.styleElement.sheet;\n    styleSheet.insertRule(rule, styleSheet.cssRules.length);\n  }\n\n  clear() {\n    for (const nativeFontFace of this.nativeFontFaces) {\n      this._document.fonts.delete(nativeFontFace);\n    }\n    this.nativeFontFaces.clear();\n    this.#systemFonts.clear();\n\n    if (this.styleElement) {\n      // Note: ChildNode.remove doesn't throw if the parentNode is undefined.\n      this.styleElement.remove();\n      this.styleElement = null;\n    }\n  }\n\n  async loadSystemFont(info) {\n    if (!info || this.#systemFonts.has(info.loadedName)) {\n      return;\n    }\n    assert(\n      !this.disableFontFace,\n      \"loadSystemFont shouldn't be called when `disableFontFace` is set.\"\n    );\n\n    if (this.isFontLoadingAPISupported) {\n      const { loadedName, src, style } = info;\n      const fontFace = new FontFace(loadedName, src, style);\n      this.addNativeFontFace(fontFace);\n      try {\n        await fontFace.load();\n        this.#systemFonts.add(loadedName);\n      } catch {\n        warn(\n          `Cannot load system font: ${info.baseFontName}, installing it could help to improve PDF rendering.`\n        );\n\n        this.removeNativeFontFace(fontFace);\n      }\n      return;\n    }\n\n    unreachable(\n      \"Not implemented: loadSystemFont without the Font Loading API.\"\n    );\n  }\n\n  async bind(font) {\n    // Add the font to the DOM only once; skip if the font is already loaded.\n    if (font.attached || (font.missingFile && !font.systemFontInfo)) {\n      return;\n    }\n    font.attached = true;\n\n    if (font.systemFontInfo) {\n      await this.loadSystemFont(font.systemFontInfo);\n      return;\n    }\n\n    if (this.isFontLoadingAPISupported) {\n      const nativeFontFace = font.createNativeFontFace();\n      if (nativeFontFace) {\n        this.addNativeFontFace(nativeFontFace);\n        try {\n          await nativeFontFace.loaded;\n        } catch (ex) {\n          warn(`Failed to load font '${nativeFontFace.family}': '${ex}'.`);\n\n          // When font loading failed, fall back to the built-in font renderer.\n          font.disableFontFace = true;\n          throw ex;\n        }\n      }\n      return; // The font was, asynchronously, loaded.\n    }\n\n    // !this.isFontLoadingAPISupported\n    const rule = font.createFontFaceRule();\n    if (rule) {\n      this.insertRule(rule);\n\n      if (this.isSyncFontLoadingSupported) {\n        return; // The font was, synchronously, loaded.\n      }\n      if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n        throw new Error(\"Not implemented: async font loading\");\n      }\n      await new Promise(resolve => {\n        const request = this._queueLoadingCallback(resolve);\n        this._prepareFontLoadEvent(font, request);\n      });\n      // The font was, asynchronously, loaded.\n    }\n  }\n\n  get isFontLoadingAPISupported() {\n    const hasFonts = !!this._document?.fonts;\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      return shadow(\n        this,\n        \"isFontLoadingAPISupported\",\n        hasFonts && !this.styleElement\n      );\n    }\n    return shadow(this, \"isFontLoadingAPISupported\", hasFonts);\n  }\n\n  get isSyncFontLoadingSupported() {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      return shadow(this, \"isSyncFontLoadingSupported\", true);\n    }\n\n    let supported = false;\n    if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"CHROME\")) {\n      if (isNodeJS) {\n        // Node.js - we can pretend that sync font loading is supported.\n        supported = true;\n      } else if (\n        typeof navigator !== \"undefined\" &&\n        // User agent string sniffing is bad, but there is no reliable way to\n        // tell if the font is fully loaded and ready to be used with canvas.\n        /Mozilla\\/5.0.*?rv:\\d+.*? Gecko/.test(navigator.userAgent)\n      ) {\n        // Firefox, from version 14, supports synchronous font loading.\n        supported = true;\n      }\n    }\n    return shadow(this, \"isSyncFontLoadingSupported\", supported);\n  }\n\n  _queueLoadingCallback(callback) {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: _queueLoadingCallback\");\n    }\n\n    function completeRequest() {\n      assert(!request.done, \"completeRequest() cannot be called twice.\");\n      request.done = true;\n\n      // Sending all completed requests in order of how they were queued.\n      while (loadingRequests.length > 0 && loadingRequests[0].done) {\n        const otherRequest = loadingRequests.shift();\n        setTimeout(otherRequest.callback, 0);\n      }\n    }\n\n    const { loadingRequests } = this;\n    const request = {\n      done: false,\n      complete: completeRequest,\n      callback,\n    };\n    loadingRequests.push(request);\n    return request;\n  }\n\n  get _loadTestFont() {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: _loadTestFont\");\n    }\n\n    // This is a CFF font with 1 glyph for '.' that fills its entire width\n    // and height.\n    const testFont = atob(\n      \"T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQA\" +\n        \"FQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAA\" +\n        \"ALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgA\" +\n        \"AAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1\" +\n        \"AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD\" +\n        \"6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACM\" +\n        \"AooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4D\" +\n        \"IP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAA\" +\n        \"AAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUA\" +\n        \"AQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgAB\" +\n        \"AAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABY\" +\n        \"AAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAA\" +\n        \"AC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n        \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAA\" +\n        \"AAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQAC\" +\n        \"AQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3\" +\n        \"Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTj\" +\n        \"FQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==\"\n    );\n    return shadow(this, \"_loadTestFont\", testFont);\n  }\n\n  _prepareFontLoadEvent(font, request) {\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: _prepareFontLoadEvent\");\n    }\n\n    /** Hack begin */\n    // There's currently no event when a font has finished downloading so the\n    // following code is a dirty hack to 'guess' when a font is ready.\n    // It's assumed fonts are loaded in order, so add a known test font after\n    // the desired fonts and then test for the loading of that test font.\n\n    function int32(data, offset) {\n      return (\n        (data.charCodeAt(offset) << 24) |\n        (data.charCodeAt(offset + 1) << 16) |\n        (data.charCodeAt(offset + 2) << 8) |\n        (data.charCodeAt(offset + 3) & 0xff)\n      );\n    }\n    function spliceString(s, offset, remove, insert) {\n      const chunk1 = s.substring(0, offset);\n      const chunk2 = s.substring(offset + remove);\n      return chunk1 + insert + chunk2;\n    }\n    let i, ii;\n\n    // The temporary canvas is used to determine if fonts are loaded.\n    const canvas = this._document.createElement(\"canvas\");\n    canvas.width = 1;\n    canvas.height = 1;\n    const ctx = canvas.getContext(\"2d\");\n\n    let called = 0;\n    function isFontReady(name, callback) {\n      // With setTimeout clamping this gives the font ~100ms to load.\n      if (++called > 30) {\n        warn(\"Load test font never loaded.\");\n        callback();\n        return;\n      }\n      ctx.font = \"30px \" + name;\n      ctx.fillText(\".\", 0, 20);\n      const imageData = ctx.getImageData(0, 0, 1, 1);\n      if (imageData.data[3] > 0) {\n        callback();\n        return;\n      }\n      setTimeout(isFontReady.bind(null, name, callback));\n    }\n\n    const loadTestFontId = `lt${Date.now()}${this.loadTestFontId++}`;\n    // Chromium seems to cache fonts based on a hash of the actual font data,\n    // so the font must be modified for each load test else it will appear to\n    // be loaded already.\n    // TODO: This could maybe be made faster by avoiding the btoa of the full\n    // font by splitting it in chunks before hand and padding the font id.\n    let data = this._loadTestFont;\n    const COMMENT_OFFSET = 976; // has to be on 4 byte boundary (for checksum)\n    data = spliceString(\n      data,\n      COMMENT_OFFSET,\n      loadTestFontId.length,\n      loadTestFontId\n    );\n    // CFF checksum is important for IE, adjusting it\n    const CFF_CHECKSUM_OFFSET = 16;\n    const XXXX_VALUE = 0x58585858; // the \"comment\" filled with 'X'\n    let checksum = int32(data, CFF_CHECKSUM_OFFSET);\n    for (i = 0, ii = loadTestFontId.length - 3; i < ii; i += 4) {\n      checksum = (checksum - XXXX_VALUE + int32(loadTestFontId, i)) | 0;\n    }\n    if (i < loadTestFontId.length) {\n      // align to 4 bytes boundary\n      checksum = (checksum - XXXX_VALUE + int32(loadTestFontId + \"XXX\", i)) | 0;\n    }\n    data = spliceString(data, CFF_CHECKSUM_OFFSET, 4, string32(checksum));\n\n    const url = `url(data:font/opentype;base64,${btoa(data)});`;\n    const rule = `@font-face {font-family:\"${loadTestFontId}\";src:${url}}`;\n    this.insertRule(rule);\n\n    const div = this._document.createElement(\"div\");\n    div.style.visibility = \"hidden\";\n    div.style.width = div.style.height = \"10px\";\n    div.style.position = \"absolute\";\n    div.style.top = div.style.left = \"0px\";\n\n    for (const name of [font.loadedName, loadTestFontId]) {\n      const span = this._document.createElement(\"span\");\n      span.textContent = \"Hi\";\n      span.style.fontFamily = name;\n      div.append(span);\n    }\n    this._document.body.append(div);\n\n    isFontReady(loadTestFontId, () => {\n      div.remove();\n      request.complete();\n    });\n    /** Hack end */\n  }\n}\n\nclass FontFaceObject {\n  constructor(\n    translatedData,\n    {\n      isEvalSupported = true,\n      disableFontFace = false,\n      ignoreErrors = false,\n      inspectFont = null,\n    }\n  ) {\n    this.compiledGlyphs = Object.create(null);\n    // importing translated data\n    for (const i in translatedData) {\n      this[i] = translatedData[i];\n    }\n    this.isEvalSupported = isEvalSupported !== false;\n    this.disableFontFace = disableFontFace === true;\n    this.ignoreErrors = ignoreErrors === true;\n    this._inspectFont = inspectFont;\n  }\n\n  createNativeFontFace() {\n    if (!this.data || this.disableFontFace) {\n      return null;\n    }\n    let nativeFontFace;\n    if (!this.cssFontInfo) {\n      nativeFontFace = new FontFace(this.loadedName, this.data, {});\n    } else {\n      const css = {\n        weight: this.cssFontInfo.fontWeight,\n      };\n      if (this.cssFontInfo.italicAngle) {\n        css.style = `oblique ${this.cssFontInfo.italicAngle}deg`;\n      }\n      nativeFontFace = new FontFace(\n        this.cssFontInfo.fontFamily,\n        this.data,\n        css\n      );\n    }\n\n    this._inspectFont?.(this);\n    return nativeFontFace;\n  }\n\n  createFontFaceRule() {\n    if (!this.data || this.disableFontFace) {\n      return null;\n    }\n    const data = bytesToString(this.data);\n    // Add the @font-face rule to the document.\n    const url = `url(data:${this.mimetype};base64,${btoa(data)});`;\n    let rule;\n    if (!this.cssFontInfo) {\n      rule = `@font-face {font-family:\"${this.loadedName}\";src:${url}}`;\n    } else {\n      let css = `font-weight: ${this.cssFontInfo.fontWeight};`;\n      if (this.cssFontInfo.italicAngle) {\n        css += `font-style: oblique ${this.cssFontInfo.italicAngle}deg;`;\n      }\n      rule = `@font-face {font-family:\"${this.cssFontInfo.fontFamily}\";${css}src:${url}}`;\n    }\n\n    this._inspectFont?.(this, url);\n    return rule;\n  }\n\n  getPathGenerator(objs, character) {\n    if (this.compiledGlyphs[character] !== undefined) {\n      return this.compiledGlyphs[character];\n    }\n\n    let cmds;\n    try {\n      cmds = objs.get(this.loadedName + \"_path_\" + character);\n    } catch (ex) {\n      if (!this.ignoreErrors) {\n        throw ex;\n      }\n      warn(`getPathGenerator - ignoring character: \"${ex}\".`);\n\n      return (this.compiledGlyphs[character] = function (c, size) {\n        // No-op function, to allow rendering to continue.\n      });\n    }\n\n    // If we can, compile cmds into JS for MAXIMUM SPEED...\n    if (this.isEvalSupported && FeatureTest.isEvalSupported) {\n      const jsBuf = [];\n      for (const current of cmds) {\n        const args = current.args !== undefined ? current.args.join(\",\") : \"\";\n        jsBuf.push(\"c.\", current.cmd, \"(\", args, \");\\n\");\n      }\n      // eslint-disable-next-line no-new-func\n      return (this.compiledGlyphs[character] = new Function(\n        \"c\",\n        \"size\",\n        jsBuf.join(\"\")\n      ));\n    }\n    // ... but fall back on using Function.prototype.apply() if we're\n    // blocked from using eval() for whatever reason (like CSP policies).\n    return (this.compiledGlyphs[character] = function (c, size) {\n      for (const current of cmds) {\n        if (current.cmd === \"scale\") {\n          current.args = [size, -size];\n        }\n        // eslint-disable-next-line prefer-spread\n        c[current.cmd].apply(c, current.args);\n      }\n    });\n  }\n}\n\nexport { FontFaceObject, FontLoader };\n", "/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals process */\n\n// NW.js / Electron is a browser context, but copies some Node.js objects; see\n// http://docs.nwjs.io/en/latest/For%20Users/Advanced/JavaScript%20Contexts%20in%20NW.js/#access-nodejs-and-nwjs-api-in-browser-context\n// https://www.electronjs.org/docs/api/process#processversionselectron-readonly\n// https://www.electronjs.org/docs/api/process#processtype-readonly\nconst isNodeJS =\n  (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n  typeof process === \"object\" &&\n  process + \"\" === \"[object process]\" &&\n  !process.versions.nw &&\n  !(process.versions.electron && process.type && process.type !== \"browser\");\n\nexport { isNodeJS };\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FeatureTest,\n  FONT_IDENTITY_MATRIX,\n  IDENTITY_MATRIX,\n  ImageKind,\n  info,\n  OPS,\n  shadow,\n  TextRenderingMode,\n  unreachable,\n  Util,\n  warn,\n} from \"../shared/util.js\";\nimport {\n  getCurrentTransform,\n  getCurrentTransformInverse,\n  PixelsPerInch,\n} from \"./display_utils.js\";\nimport {\n  getShadingPattern,\n  PathType,\n  TilingPattern,\n} from \"./pattern_helper.js\";\nimport { convertBlackAndWhiteToRGBA } from \"../shared/image_utils.js\";\nimport { isNodeJS } from \"../shared/is_node.js\";\n\n// <canvas> contexts store most of the state we need natively.\n// However, PDF needs a bit more state, which we store here.\n// Minimal font size that would be used during canvas fillText operations.\nconst MIN_FONT_SIZE = 16;\n// Maximum font size that would be used during canvas fillText operations.\nconst MAX_FONT_SIZE = 100;\nconst MAX_GROUP_SIZE = 4096;\n\n// Defines the time the `executeOperatorList`-method is going to be executing\n// before it stops and schedules a continue of execution.\nconst EXECUTION_TIME = 15; // ms\n// Defines the number of steps before checking the execution time.\nconst EXECUTION_STEPS = 10;\n\n// To disable Type3 compilation, set the value to `-1`.\nconst MAX_SIZE_TO_COMPILE = 1000;\n\nconst FULL_CHUNK_HEIGHT = 16;\n\n/**\n * Overrides certain methods on a 2d ctx so that when they are called they\n * will also call the same method on the destCtx. The methods that are\n * overridden are all the transformation state modifiers, path creation, and\n * save/restore. We only forward these specific methods because they are the\n * only state modifiers that we cannot copy over when we switch contexts.\n *\n * To remove mirroring call `ctx._removeMirroring()`.\n *\n * @param {Object} ctx - The 2d canvas context that will duplicate its calls on\n *   the destCtx.\n * @param {Object} destCtx - The 2d canvas context that will receive the\n *   forwarded calls.\n */\nfunction mirrorContextOperations(ctx, destCtx) {\n  if (ctx._removeMirroring) {\n    throw new Error(\"Context is already forwarding operations.\");\n  }\n  ctx.__originalSave = ctx.save;\n  ctx.__originalRestore = ctx.restore;\n  ctx.__originalRotate = ctx.rotate;\n  ctx.__originalScale = ctx.scale;\n  ctx.__originalTranslate = ctx.translate;\n  ctx.__originalTransform = ctx.transform;\n  ctx.__originalSetTransform = ctx.setTransform;\n  ctx.__originalResetTransform = ctx.resetTransform;\n  ctx.__originalClip = ctx.clip;\n  ctx.__originalMoveTo = ctx.moveTo;\n  ctx.__originalLineTo = ctx.lineTo;\n  ctx.__originalBezierCurveTo = ctx.bezierCurveTo;\n  ctx.__originalRect = ctx.rect;\n  ctx.__originalClosePath = ctx.closePath;\n  ctx.__originalBeginPath = ctx.beginPath;\n\n  ctx._removeMirroring = () => {\n    ctx.save = ctx.__originalSave;\n    ctx.restore = ctx.__originalRestore;\n    ctx.rotate = ctx.__originalRotate;\n    ctx.scale = ctx.__originalScale;\n    ctx.translate = ctx.__originalTranslate;\n    ctx.transform = ctx.__originalTransform;\n    ctx.setTransform = ctx.__originalSetTransform;\n    ctx.resetTransform = ctx.__originalResetTransform;\n\n    ctx.clip = ctx.__originalClip;\n    ctx.moveTo = ctx.__originalMoveTo;\n    ctx.lineTo = ctx.__originalLineTo;\n    ctx.bezierCurveTo = ctx.__originalBezierCurveTo;\n    ctx.rect = ctx.__originalRect;\n    ctx.closePath = ctx.__originalClosePath;\n    ctx.beginPath = ctx.__originalBeginPath;\n    delete ctx._removeMirroring;\n  };\n\n  ctx.save = function ctxSave() {\n    destCtx.save();\n    this.__originalSave();\n  };\n\n  ctx.restore = function ctxRestore() {\n    destCtx.restore();\n    this.__originalRestore();\n  };\n\n  ctx.translate = function ctxTranslate(x, y) {\n    destCtx.translate(x, y);\n    this.__originalTranslate(x, y);\n  };\n\n  ctx.scale = function ctxScale(x, y) {\n    destCtx.scale(x, y);\n    this.__originalScale(x, y);\n  };\n\n  ctx.transform = function ctxTransform(a, b, c, d, e, f) {\n    destCtx.transform(a, b, c, d, e, f);\n    this.__originalTransform(a, b, c, d, e, f);\n  };\n\n  ctx.setTransform = function ctxSetTransform(a, b, c, d, e, f) {\n    destCtx.setTransform(a, b, c, d, e, f);\n    this.__originalSetTransform(a, b, c, d, e, f);\n  };\n\n  ctx.resetTransform = function ctxResetTransform() {\n    destCtx.resetTransform();\n    this.__originalResetTransform();\n  };\n\n  ctx.rotate = function ctxRotate(angle) {\n    destCtx.rotate(angle);\n    this.__originalRotate(angle);\n  };\n\n  ctx.clip = function ctxRotate(rule) {\n    destCtx.clip(rule);\n    this.__originalClip(rule);\n  };\n\n  ctx.moveTo = function (x, y) {\n    destCtx.moveTo(x, y);\n    this.__originalMoveTo(x, y);\n  };\n\n  ctx.lineTo = function (x, y) {\n    destCtx.lineTo(x, y);\n    this.__originalLineTo(x, y);\n  };\n\n  ctx.bezierCurveTo = function (cp1x, cp1y, cp2x, cp2y, x, y) {\n    destCtx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n    this.__originalBezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n  };\n\n  ctx.rect = function (x, y, width, height) {\n    destCtx.rect(x, y, width, height);\n    this.__originalRect(x, y, width, height);\n  };\n\n  ctx.closePath = function () {\n    destCtx.closePath();\n    this.__originalClosePath();\n  };\n\n  ctx.beginPath = function () {\n    destCtx.beginPath();\n    this.__originalBeginPath();\n  };\n}\n\nclass CachedCanvases {\n  constructor(canvasFactory) {\n    this.canvasFactory = canvasFactory;\n    this.cache = Object.create(null);\n  }\n\n  getCanvas(id, width, height) {\n    let canvasEntry;\n    if (this.cache[id] !== undefined) {\n      canvasEntry = this.cache[id];\n      this.canvasFactory.reset(canvasEntry, width, height);\n    } else {\n      canvasEntry = this.canvasFactory.create(width, height);\n      this.cache[id] = canvasEntry;\n    }\n    return canvasEntry;\n  }\n\n  delete(id) {\n    delete this.cache[id];\n  }\n\n  clear() {\n    for (const id in this.cache) {\n      const canvasEntry = this.cache[id];\n      this.canvasFactory.destroy(canvasEntry);\n      delete this.cache[id];\n    }\n  }\n}\n\nfunction drawImageAtIntegerCoords(\n  ctx,\n  srcImg,\n  srcX,\n  srcY,\n  srcW,\n  srcH,\n  destX,\n  destY,\n  destW,\n  destH\n) {\n  const [a, b, c, d, tx, ty] = getCurrentTransform(ctx);\n  if (b === 0 && c === 0) {\n    // top-left corner is at (X, Y) and\n    // bottom-right one is at (X + width, Y + height).\n\n    // If leftX is 4.321 then it's rounded to 4.\n    // If width is 10.432 then it's rounded to 11 because\n    // rightX = leftX + width = 14.753 which is rounded to 15\n    // so after rounding the total width is 11 (15 - 4).\n    // It's why we can't just floor/ceil uniformly, it just depends\n    // on the values we've.\n\n    const tlX = destX * a + tx;\n    const rTlX = Math.round(tlX);\n    const tlY = destY * d + ty;\n    const rTlY = Math.round(tlY);\n    const brX = (destX + destW) * a + tx;\n\n    // Some pdf contains images with 1x1 images so in case of 0-width after\n    // scaling we must fallback on 1 to be sure there is something.\n    const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n    const brY = (destY + destH) * d + ty;\n    const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n\n    // We must apply a transformation in order to apply it on the image itself.\n    // For example if a == 1 && d == -1, it means that the image itself is\n    // mirrored w.r.t. the x-axis.\n    ctx.setTransform(Math.sign(a), 0, 0, Math.sign(d), rTlX, rTlY);\n    ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rWidth, rHeight);\n    ctx.setTransform(a, b, c, d, tx, ty);\n\n    return [rWidth, rHeight];\n  }\n\n  if (a === 0 && d === 0) {\n    // This path is taken in issue9462.pdf (page 3).\n    const tlX = destY * c + tx;\n    const rTlX = Math.round(tlX);\n    const tlY = destX * b + ty;\n    const rTlY = Math.round(tlY);\n    const brX = (destY + destH) * c + tx;\n    const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n    const brY = (destX + destW) * b + ty;\n    const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n\n    ctx.setTransform(0, Math.sign(b), Math.sign(c), 0, rTlX, rTlY);\n    ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rHeight, rWidth);\n    ctx.setTransform(a, b, c, d, tx, ty);\n\n    return [rHeight, rWidth];\n  }\n\n  // Not a scale matrix so let the render handle the case without rounding.\n  ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, destX, destY, destW, destH);\n\n  const scaleX = Math.hypot(a, b);\n  const scaleY = Math.hypot(c, d);\n  return [scaleX * destW, scaleY * destH];\n}\n\nfunction compileType3Glyph(imgData) {\n  const { width, height } = imgData;\n  if (width > MAX_SIZE_TO_COMPILE || height > MAX_SIZE_TO_COMPILE) {\n    return null;\n  }\n\n  const POINT_TO_PROCESS_LIMIT = 1000;\n  const POINT_TYPES = new Uint8Array([\n    0, 2, 4, 0, 1, 0, 5, 4, 8, 10, 0, 8, 0, 2, 1, 0,\n  ]);\n\n  const width1 = width + 1;\n  let points = new Uint8Array(width1 * (height + 1));\n  let i, j, j0;\n\n  // decodes bit-packed mask data\n  const lineSize = (width + 7) & ~7;\n  let data = new Uint8Array(lineSize * height),\n    pos = 0;\n  for (const elem of imgData.data) {\n    let mask = 128;\n    while (mask > 0) {\n      data[pos++] = elem & mask ? 0 : 255;\n      mask >>= 1;\n    }\n  }\n\n  // finding interesting points: every point is located between mask pixels,\n  // so there will be points of the (width + 1)x(height + 1) grid. Every point\n  // will have flags assigned based on neighboring mask pixels:\n  //   4 | 8\n  //   --P--\n  //   2 | 1\n  // We are interested only in points with the flags:\n  //   - outside corners: 1, 2, 4, 8;\n  //   - inside corners: 7, 11, 13, 14;\n  //   - and, intersections: 5, 10.\n  let count = 0;\n  pos = 0;\n  if (data[pos] !== 0) {\n    points[0] = 1;\n    ++count;\n  }\n  for (j = 1; j < width; j++) {\n    if (data[pos] !== data[pos + 1]) {\n      points[j] = data[pos] ? 2 : 1;\n      ++count;\n    }\n    pos++;\n  }\n  if (data[pos] !== 0) {\n    points[j] = 2;\n    ++count;\n  }\n  for (i = 1; i < height; i++) {\n    pos = i * lineSize;\n    j0 = i * width1;\n    if (data[pos - lineSize] !== data[pos]) {\n      points[j0] = data[pos] ? 1 : 8;\n      ++count;\n    }\n    // 'sum' is the position of the current pixel configuration in the 'TYPES'\n    // array (in order 8-1-2-4, so we can use '>>2' to shift the column).\n    let sum = (data[pos] ? 4 : 0) + (data[pos - lineSize] ? 8 : 0);\n    for (j = 1; j < width; j++) {\n      sum =\n        (sum >> 2) +\n        (data[pos + 1] ? 4 : 0) +\n        (data[pos - lineSize + 1] ? 8 : 0);\n      if (POINT_TYPES[sum]) {\n        points[j0 + j] = POINT_TYPES[sum];\n        ++count;\n      }\n      pos++;\n    }\n    if (data[pos - lineSize] !== data[pos]) {\n      points[j0 + j] = data[pos] ? 2 : 4;\n      ++count;\n    }\n\n    if (count > POINT_TO_PROCESS_LIMIT) {\n      return null;\n    }\n  }\n\n  pos = lineSize * (height - 1);\n  j0 = i * width1;\n  if (data[pos] !== 0) {\n    points[j0] = 8;\n    ++count;\n  }\n  for (j = 1; j < width; j++) {\n    if (data[pos] !== data[pos + 1]) {\n      points[j0 + j] = data[pos] ? 4 : 8;\n      ++count;\n    }\n    pos++;\n  }\n  if (data[pos] !== 0) {\n    points[j0 + j] = 4;\n    ++count;\n  }\n  if (count > POINT_TO_PROCESS_LIMIT) {\n    return null;\n  }\n\n  // building outlines\n  const steps = new Int32Array([0, width1, -1, 0, -width1, 0, 0, 0, 1]);\n  const path = new Path2D();\n\n  for (i = 0; count && i <= height; i++) {\n    let p = i * width1;\n    const end = p + width;\n    while (p < end && !points[p]) {\n      p++;\n    }\n    if (p === end) {\n      continue;\n    }\n    path.moveTo(p % width1, i);\n\n    const p0 = p;\n    let type = points[p];\n    do {\n      const step = steps[type];\n      do {\n        p += step;\n      } while (!points[p]);\n\n      const pp = points[p];\n      if (pp !== 5 && pp !== 10) {\n        // set new direction\n        type = pp;\n        // delete mark\n        points[p] = 0;\n      } else {\n        // type is 5 or 10, ie, a crossing\n        // set new direction\n        type = pp & ((0x33 * type) >> 4);\n        // set new type for \"future hit\"\n        points[p] &= (type >> 2) | (type << 2);\n      }\n      path.lineTo(p % width1, (p / width1) | 0);\n\n      if (!points[p]) {\n        --count;\n      }\n    } while (p0 !== p);\n    --i;\n  }\n\n  // Immediately release the, potentially large, `Uint8Array`s after parsing.\n  data = null;\n  points = null;\n\n  const drawOutline = function (c) {\n    c.save();\n    // the path shall be painted in [0..1]x[0..1] space\n    c.scale(1 / width, -1 / height);\n    c.translate(0, -height);\n    c.fill(path);\n    c.beginPath();\n    c.restore();\n  };\n\n  return drawOutline;\n}\n\nclass CanvasExtraState {\n  constructor(width, height) {\n    // Are soft masks and alpha values shapes or opacities?\n    this.alphaIsShape = false;\n    this.fontSize = 0;\n    this.fontSizeScale = 1;\n    this.textMatrix = IDENTITY_MATRIX;\n    this.textMatrixScale = 1;\n    this.fontMatrix = FONT_IDENTITY_MATRIX;\n    this.leading = 0;\n    // Current point (in user coordinates)\n    this.x = 0;\n    this.y = 0;\n    // Start of text line (in text coordinates)\n    this.lineX = 0;\n    this.lineY = 0;\n    // Character and word spacing\n    this.charSpacing = 0;\n    this.wordSpacing = 0;\n    this.textHScale = 1;\n    this.textRenderingMode = TextRenderingMode.FILL;\n    this.textRise = 0;\n    // Default fore and background colors\n    this.fillColor = \"#000000\";\n    this.strokeColor = \"#000000\";\n    this.patternFill = false;\n    // Note: fill alpha applies to all non-stroking operations\n    this.fillAlpha = 1;\n    this.strokeAlpha = 1;\n    this.lineWidth = 1;\n    this.activeSMask = null;\n    this.transferMaps = \"none\";\n\n    this.startNewPathAndClipBox([0, 0, width, height]);\n  }\n\n  clone() {\n    const clone = Object.create(this);\n    clone.clipBox = this.clipBox.slice();\n    return clone;\n  }\n\n  setCurrentPoint(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  updatePathMinMax(transform, x, y) {\n    [x, y] = Util.applyTransform([x, y], transform);\n    this.minX = Math.min(this.minX, x);\n    this.minY = Math.min(this.minY, y);\n    this.maxX = Math.max(this.maxX, x);\n    this.maxY = Math.max(this.maxY, y);\n  }\n\n  updateRectMinMax(transform, rect) {\n    const p1 = Util.applyTransform(rect, transform);\n    const p2 = Util.applyTransform(rect.slice(2), transform);\n    this.minX = Math.min(this.minX, p1[0], p2[0]);\n    this.minY = Math.min(this.minY, p1[1], p2[1]);\n    this.maxX = Math.max(this.maxX, p1[0], p2[0]);\n    this.maxY = Math.max(this.maxY, p1[1], p2[1]);\n  }\n\n  updateScalingPathMinMax(transform, minMax) {\n    Util.scaleMinMax(transform, minMax);\n    this.minX = Math.min(this.minX, minMax[0]);\n    this.maxX = Math.max(this.maxX, minMax[1]);\n    this.minY = Math.min(this.minY, minMax[2]);\n    this.maxY = Math.max(this.maxY, minMax[3]);\n  }\n\n  updateCurvePathMinMax(transform, x0, y0, x1, y1, x2, y2, x3, y3, minMax) {\n    const box = Util.bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3);\n    if (minMax) {\n      minMax[0] = Math.min(minMax[0], box[0], box[2]);\n      minMax[1] = Math.max(minMax[1], box[0], box[2]);\n      minMax[2] = Math.min(minMax[2], box[1], box[3]);\n      minMax[3] = Math.max(minMax[3], box[1], box[3]);\n      return;\n    }\n    this.updateRectMinMax(transform, box);\n  }\n\n  getPathBoundingBox(pathType = PathType.FILL, transform = null) {\n    const box = [this.minX, this.minY, this.maxX, this.maxY];\n    if (pathType === PathType.STROKE) {\n      if (!transform) {\n        unreachable(\"Stroke bounding box must include transform.\");\n      }\n      // Stroked paths can be outside of the path bounding box by 1/2 the line\n      // width.\n      const scale = Util.singularValueDecompose2dScale(transform);\n      const xStrokePad = (scale[0] * this.lineWidth) / 2;\n      const yStrokePad = (scale[1] * this.lineWidth) / 2;\n      box[0] -= xStrokePad;\n      box[1] -= yStrokePad;\n      box[2] += xStrokePad;\n      box[3] += yStrokePad;\n    }\n    return box;\n  }\n\n  updateClipFromPath() {\n    const intersect = Util.intersect(this.clipBox, this.getPathBoundingBox());\n    this.startNewPathAndClipBox(intersect || [0, 0, 0, 0]);\n  }\n\n  isEmptyClip() {\n    return this.minX === Infinity;\n  }\n\n  startNewPathAndClipBox(box) {\n    this.clipBox = box;\n    this.minX = Infinity;\n    this.minY = Infinity;\n    this.maxX = 0;\n    this.maxY = 0;\n  }\n\n  getClippedPathBoundingBox(pathType = PathType.FILL, transform = null) {\n    return Util.intersect(\n      this.clipBox,\n      this.getPathBoundingBox(pathType, transform)\n    );\n  }\n}\n\nfunction putBinaryImageData(ctx, imgData) {\n  if (typeof ImageData !== \"undefined\" && imgData instanceof ImageData) {\n    ctx.putImageData(imgData, 0, 0);\n    return;\n  }\n\n  // Put the image data to the canvas in chunks, rather than putting the\n  // whole image at once.  This saves JS memory, because the ImageData object\n  // is smaller. It also possibly saves C++ memory within the implementation\n  // of putImageData(). (E.g. in Firefox we make two short-lived copies of\n  // the data passed to putImageData()). |n| shouldn't be too small, however,\n  // because too many putImageData() calls will slow things down.\n  //\n  // Note: as written, if the last chunk is partial, the putImageData() call\n  // will (conceptually) put pixels past the bounds of the canvas.  But\n  // that's ok; any such pixels are ignored.\n\n  const height = imgData.height,\n    width = imgData.width;\n  const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n  const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n  const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n\n  const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n  let srcPos = 0,\n    destPos;\n  const src = imgData.data;\n  const dest = chunkImgData.data;\n  let i, j, thisChunkHeight, elemsInThisChunk;\n\n  // There are multiple forms in which the pixel data can be passed, and\n  // imgData.kind tells us which one this is.\n  if (imgData.kind === ImageKind.GRAYSCALE_1BPP) {\n    // Grayscale, 1 bit per pixel (i.e. black-and-white).\n    const srcLength = src.byteLength;\n    const dest32 = new Uint32Array(dest.buffer, 0, dest.byteLength >> 2);\n    const dest32DataLength = dest32.length;\n    const fullSrcDiff = (width + 7) >> 3;\n    const white = 0xffffffff;\n    const black = FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n\n    for (i = 0; i < totalChunks; i++) {\n      thisChunkHeight = i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n      destPos = 0;\n      for (j = 0; j < thisChunkHeight; j++) {\n        const srcDiff = srcLength - srcPos;\n        let k = 0;\n        const kEnd = srcDiff > fullSrcDiff ? width : srcDiff * 8 - 7;\n        const kEndUnrolled = kEnd & ~7;\n        let mask = 0;\n        let srcByte = 0;\n        for (; k < kEndUnrolled; k += 8) {\n          srcByte = src[srcPos++];\n          dest32[destPos++] = srcByte & 128 ? white : black;\n          dest32[destPos++] = srcByte & 64 ? white : black;\n          dest32[destPos++] = srcByte & 32 ? white : black;\n          dest32[destPos++] = srcByte & 16 ? white : black;\n          dest32[destPos++] = srcByte & 8 ? white : black;\n          dest32[destPos++] = srcByte & 4 ? white : black;\n          dest32[destPos++] = srcByte & 2 ? white : black;\n          dest32[destPos++] = srcByte & 1 ? white : black;\n        }\n        for (; k < kEnd; k++) {\n          if (mask === 0) {\n            srcByte = src[srcPos++];\n            mask = 128;\n          }\n\n          dest32[destPos++] = srcByte & mask ? white : black;\n          mask >>= 1;\n        }\n      }\n      // We ran out of input. Make all remaining pixels transparent.\n      while (destPos < dest32DataLength) {\n        dest32[destPos++] = 0;\n      }\n\n      ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n    }\n  } else if (imgData.kind === ImageKind.RGBA_32BPP) {\n    // RGBA, 32-bits per pixel.\n    j = 0;\n    elemsInThisChunk = width * FULL_CHUNK_HEIGHT * 4;\n    for (i = 0; i < fullChunks; i++) {\n      dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n      srcPos += elemsInThisChunk;\n\n      ctx.putImageData(chunkImgData, 0, j);\n      j += FULL_CHUNK_HEIGHT;\n    }\n    if (i < totalChunks) {\n      elemsInThisChunk = width * partialChunkHeight * 4;\n      dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n\n      ctx.putImageData(chunkImgData, 0, j);\n    }\n  } else if (imgData.kind === ImageKind.RGB_24BPP) {\n    // RGB, 24-bits per pixel.\n    thisChunkHeight = FULL_CHUNK_HEIGHT;\n    elemsInThisChunk = width * thisChunkHeight;\n    for (i = 0; i < totalChunks; i++) {\n      if (i >= fullChunks) {\n        thisChunkHeight = partialChunkHeight;\n        elemsInThisChunk = width * thisChunkHeight;\n      }\n\n      destPos = 0;\n      for (j = elemsInThisChunk; j--; ) {\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = 255;\n      }\n\n      ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n    }\n  } else {\n    throw new Error(`bad image kind: ${imgData.kind}`);\n  }\n}\n\nfunction putBinaryImageMask(ctx, imgData) {\n  if (imgData.bitmap) {\n    // The bitmap has been created in the worker.\n    ctx.drawImage(imgData.bitmap, 0, 0);\n    return;\n  }\n\n  // Slow path: OffscreenCanvas isn't available in the worker.\n  const height = imgData.height,\n    width = imgData.width;\n  const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n  const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n  const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n\n  const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n  let srcPos = 0;\n  const src = imgData.data;\n  const dest = chunkImgData.data;\n\n  for (let i = 0; i < totalChunks; i++) {\n    const thisChunkHeight =\n      i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n\n    // Expand the mask so it can be used by the canvas.  Any required\n    // inversion has already been handled.\n\n    ({ srcPos } = convertBlackAndWhiteToRGBA({\n      src,\n      srcPos,\n      dest,\n      width,\n      height: thisChunkHeight,\n      nonBlackColor: 0,\n    }));\n\n    ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n  }\n}\n\nfunction copyCtxState(sourceCtx, destCtx) {\n  const properties = [\n    \"strokeStyle\",\n    \"fillStyle\",\n    \"fillRule\",\n    \"globalAlpha\",\n    \"lineWidth\",\n    \"lineCap\",\n    \"lineJoin\",\n    \"miterLimit\",\n    \"globalCompositeOperation\",\n    \"font\",\n    \"filter\",\n  ];\n  for (const property of properties) {\n    if (sourceCtx[property] !== undefined) {\n      destCtx[property] = sourceCtx[property];\n    }\n  }\n  if (sourceCtx.setLineDash !== undefined) {\n    destCtx.setLineDash(sourceCtx.getLineDash());\n    destCtx.lineDashOffset = sourceCtx.lineDashOffset;\n  }\n}\n\nfunction resetCtxToDefault(ctx) {\n  ctx.strokeStyle = ctx.fillStyle = \"#000000\";\n  ctx.fillRule = \"nonzero\";\n  ctx.globalAlpha = 1;\n  ctx.lineWidth = 1;\n  ctx.lineCap = \"butt\";\n  ctx.lineJoin = \"miter\";\n  ctx.miterLimit = 10;\n  ctx.globalCompositeOperation = \"source-over\";\n  ctx.font = \"10px sans-serif\";\n  if (ctx.setLineDash !== undefined) {\n    ctx.setLineDash([]);\n    ctx.lineDashOffset = 0;\n  }\n  if (\n    (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n    !isNodeJS\n  ) {\n    ctx.filter = \"none\";\n  }\n}\n\nfunction composeSMaskBackdrop(bytes, r0, g0, b0) {\n  const length = bytes.length;\n  for (let i = 3; i < length; i += 4) {\n    const alpha = bytes[i];\n    if (alpha === 0) {\n      bytes[i - 3] = r0;\n      bytes[i - 2] = g0;\n      bytes[i - 1] = b0;\n    } else if (alpha < 255) {\n      const alpha_ = 255 - alpha;\n      bytes[i - 3] = (bytes[i - 3] * alpha + r0 * alpha_) >> 8;\n      bytes[i - 2] = (bytes[i - 2] * alpha + g0 * alpha_) >> 8;\n      bytes[i - 1] = (bytes[i - 1] * alpha + b0 * alpha_) >> 8;\n    }\n  }\n}\n\nfunction composeSMaskAlpha(maskData, layerData, transferMap) {\n  const length = maskData.length;\n  const scale = 1 / 255;\n  for (let i = 3; i < length; i += 4) {\n    const alpha = transferMap ? transferMap[maskData[i]] : maskData[i];\n    layerData[i] = (layerData[i] * alpha * scale) | 0;\n  }\n}\n\nfunction composeSMaskLuminosity(maskData, layerData, transferMap) {\n  const length = maskData.length;\n  for (let i = 3; i < length; i += 4) {\n    const y =\n      maskData[i - 3] * 77 + // * 0.3 / 255 * 0x10000\n      maskData[i - 2] * 152 + // * 0.59 ....\n      maskData[i - 1] * 28; // * 0.11 ....\n    layerData[i] = transferMap\n      ? (layerData[i] * transferMap[y >> 8]) >> 8\n      : (layerData[i] * y) >> 16;\n  }\n}\n\nfunction genericComposeSMask(\n  maskCtx,\n  layerCtx,\n  width,\n  height,\n  subtype,\n  backdrop,\n  transferMap,\n  layerOffsetX,\n  layerOffsetY,\n  maskOffsetX,\n  maskOffsetY\n) {\n  const hasBackdrop = !!backdrop;\n  const r0 = hasBackdrop ? backdrop[0] : 0;\n  const g0 = hasBackdrop ? backdrop[1] : 0;\n  const b0 = hasBackdrop ? backdrop[2] : 0;\n\n  let composeFn;\n  if (subtype === \"Luminosity\") {\n    composeFn = composeSMaskLuminosity;\n  } else {\n    composeFn = composeSMaskAlpha;\n  }\n\n  // processing image in chunks to save memory\n  const PIXELS_TO_PROCESS = 1048576;\n  const chunkSize = Math.min(height, Math.ceil(PIXELS_TO_PROCESS / width));\n  for (let row = 0; row < height; row += chunkSize) {\n    const chunkHeight = Math.min(chunkSize, height - row);\n    const maskData = maskCtx.getImageData(\n      layerOffsetX - maskOffsetX,\n      row + (layerOffsetY - maskOffsetY),\n      width,\n      chunkHeight\n    );\n    const layerData = layerCtx.getImageData(\n      layerOffsetX,\n      row + layerOffsetY,\n      width,\n      chunkHeight\n    );\n\n    if (hasBackdrop) {\n      composeSMaskBackdrop(maskData.data, r0, g0, b0);\n    }\n    composeFn(maskData.data, layerData.data, transferMap);\n\n    layerCtx.putImageData(layerData, layerOffsetX, row + layerOffsetY);\n  }\n}\n\nfunction composeSMask(ctx, smask, layerCtx, layerBox) {\n  const layerOffsetX = layerBox[0];\n  const layerOffsetY = layerBox[1];\n  const layerWidth = layerBox[2] - layerOffsetX;\n  const layerHeight = layerBox[3] - layerOffsetY;\n  if (layerWidth === 0 || layerHeight === 0) {\n    return;\n  }\n  genericComposeSMask(\n    smask.context,\n    layerCtx,\n    layerWidth,\n    layerHeight,\n    smask.subtype,\n    smask.backdrop,\n    smask.transferMap,\n    layerOffsetX,\n    layerOffsetY,\n    smask.offsetX,\n    smask.offsetY\n  );\n  ctx.save();\n  ctx.globalAlpha = 1;\n  ctx.globalCompositeOperation = \"source-over\";\n  ctx.setTransform(1, 0, 0, 1, 0, 0);\n  ctx.drawImage(layerCtx.canvas, 0, 0);\n  ctx.restore();\n}\n\nfunction getImageSmoothingEnabled(transform, interpolate) {\n  const scale = Util.singularValueDecompose2dScale(transform);\n  // Round to a 32bit float so that `<=` check below will pass for numbers that\n  // are very close, but not exactly the same 64bit floats.\n  scale[0] = Math.fround(scale[0]);\n  scale[1] = Math.fround(scale[1]);\n  const actualScale = Math.fround(\n    (globalThis.devicePixelRatio || 1) * PixelsPerInch.PDF_TO_CSS_UNITS\n  );\n  if (interpolate !== undefined) {\n    // If the value is explicitly set use it.\n    return interpolate;\n  } else if (scale[0] <= actualScale || scale[1] <= actualScale) {\n    // Smooth when downscaling.\n    return true;\n  }\n  // Don't smooth when upscaling.\n  return false;\n}\n\nconst LINE_CAP_STYLES = [\"butt\", \"round\", \"square\"];\nconst LINE_JOIN_STYLES = [\"miter\", \"round\", \"bevel\"];\nconst NORMAL_CLIP = {};\nconst EO_CLIP = {};\n\nclass CanvasGraphics {\n  constructor(\n    canvasCtx,\n    commonObjs,\n    objs,\n    canvasFactory,\n    filterFactory,\n    { optionalContentConfig, markedContentStack = null },\n    annotationCanvasMap,\n    pageColors\n  ) {\n    this.ctx = canvasCtx;\n    this.current = new CanvasExtraState(\n      this.ctx.canvas.width,\n      this.ctx.canvas.height\n    );\n    this.stateStack = [];\n    this.pendingClip = null;\n    this.pendingEOFill = false;\n    this.res = null;\n    this.xobjs = null;\n    this.commonObjs = commonObjs;\n    this.objs = objs;\n    this.canvasFactory = canvasFactory;\n    this.filterFactory = filterFactory;\n    this.groupStack = [];\n    this.processingType3 = null;\n    // Patterns are painted relative to the initial page/form transform, see\n    // PDF spec 8.7.2 NOTE 1.\n    this.baseTransform = null;\n    this.baseTransformStack = [];\n    this.groupLevel = 0;\n    this.smaskStack = [];\n    this.smaskCounter = 0;\n    this.tempSMask = null;\n    this.suspendedCtx = null;\n    this.contentVisible = true;\n    this.markedContentStack = markedContentStack || [];\n    this.optionalContentConfig = optionalContentConfig;\n    this.cachedCanvases = new CachedCanvases(this.canvasFactory);\n    this.cachedPatterns = new Map();\n    this.annotationCanvasMap = annotationCanvasMap;\n    this.viewportScale = 1;\n    this.outputScaleX = 1;\n    this.outputScaleY = 1;\n    this.pageColors = pageColors;\n\n    this._cachedScaleForStroking = [-1, 0];\n    this._cachedGetSinglePixelWidth = null;\n    this._cachedBitmapsMap = new Map();\n  }\n\n  getObject(data, fallback = null) {\n    if (typeof data === \"string\") {\n      return data.startsWith(\"g_\")\n        ? this.commonObjs.get(data)\n        : this.objs.get(data);\n    }\n    return fallback;\n  }\n\n  beginDrawing({\n    transform,\n    viewport,\n    transparency = false,\n    background = null,\n  }) {\n    // For pdfs that use blend modes we have to clear the canvas else certain\n    // blend modes can look wrong since we'd be blending with a white\n    // backdrop. The problem with a transparent backdrop though is we then\n    // don't get sub pixel anti aliasing on text, creating temporary\n    // transparent canvas when we have blend modes.\n    const width = this.ctx.canvas.width;\n    const height = this.ctx.canvas.height;\n\n    const savedFillStyle = this.ctx.fillStyle;\n    this.ctx.fillStyle = background || \"#ffffff\";\n    this.ctx.fillRect(0, 0, width, height);\n    this.ctx.fillStyle = savedFillStyle;\n\n    if (transparency) {\n      const transparentCanvas = this.cachedCanvases.getCanvas(\n        \"transparent\",\n        width,\n        height\n      );\n      this.compositeCtx = this.ctx;\n      this.transparentCanvas = transparentCanvas.canvas;\n      this.ctx = transparentCanvas.context;\n      this.ctx.save();\n      // The transform can be applied before rendering, transferring it to\n      // the new canvas.\n      this.ctx.transform(...getCurrentTransform(this.compositeCtx));\n    }\n\n    this.ctx.save();\n    resetCtxToDefault(this.ctx);\n    if (transform) {\n      this.ctx.transform(...transform);\n      this.outputScaleX = transform[0];\n      this.outputScaleY = transform[0];\n    }\n    this.ctx.transform(...viewport.transform);\n    this.viewportScale = viewport.scale;\n\n    this.baseTransform = getCurrentTransform(this.ctx);\n  }\n\n  executeOperatorList(\n    operatorList,\n    executionStartIdx,\n    continueCallback,\n    stepper\n  ) {\n    const argsArray = operatorList.argsArray;\n    const fnArray = operatorList.fnArray;\n    let i = executionStartIdx || 0;\n    const argsArrayLen = argsArray.length;\n\n    // Sometimes the OperatorList to execute is empty.\n    if (argsArrayLen === i) {\n      return i;\n    }\n\n    const chunkOperations =\n      argsArrayLen - i > EXECUTION_STEPS &&\n      typeof continueCallback === \"function\";\n    const endTime = chunkOperations ? Date.now() + EXECUTION_TIME : 0;\n    let steps = 0;\n\n    const commonObjs = this.commonObjs;\n    const objs = this.objs;\n    let fnId;\n\n    while (true) {\n      if (stepper !== undefined && i === stepper.nextBreakPoint) {\n        stepper.breakIt(i, continueCallback);\n        return i;\n      }\n\n      fnId = fnArray[i];\n\n      if (fnId !== OPS.dependency) {\n        // eslint-disable-next-line prefer-spread\n        this[fnId].apply(this, argsArray[i]);\n      } else {\n        for (const depObjId of argsArray[i]) {\n          const objsPool = depObjId.startsWith(\"g_\") ? commonObjs : objs;\n\n          // If the promise isn't resolved yet, add the continueCallback\n          // to the promise and bail out.\n          if (!objsPool.has(depObjId)) {\n            objsPool.get(depObjId, continueCallback);\n            return i;\n          }\n        }\n      }\n\n      i++;\n\n      // If the entire operatorList was executed, stop as were done.\n      if (i === argsArrayLen) {\n        return i;\n      }\n\n      // If the execution took longer then a certain amount of time and\n      // `continueCallback` is specified, interrupt the execution.\n      if (chunkOperations && ++steps > EXECUTION_STEPS) {\n        if (Date.now() > endTime) {\n          continueCallback();\n          return i;\n        }\n        steps = 0;\n      }\n\n      // If the operatorList isn't executed completely yet OR the execution\n      // time was short enough, do another execution round.\n    }\n  }\n\n  #restoreInitialState() {\n    // Finishing all opened operations such as SMask group painting.\n    while (this.stateStack.length || this.inSMaskMode) {\n      this.restore();\n    }\n\n    this.ctx.restore();\n\n    if (this.transparentCanvas) {\n      this.ctx = this.compositeCtx;\n      this.ctx.save();\n      this.ctx.setTransform(1, 0, 0, 1, 0, 0); // Avoid apply transform twice\n      this.ctx.drawImage(this.transparentCanvas, 0, 0);\n      this.ctx.restore();\n      this.transparentCanvas = null;\n    }\n  }\n\n  endDrawing() {\n    this.#restoreInitialState();\n\n    this.cachedCanvases.clear();\n    this.cachedPatterns.clear();\n\n    for (const cache of this._cachedBitmapsMap.values()) {\n      for (const canvas of cache.values()) {\n        if (\n          typeof HTMLCanvasElement !== \"undefined\" &&\n          canvas instanceof HTMLCanvasElement\n        ) {\n          canvas.width = canvas.height = 0;\n        }\n      }\n      cache.clear();\n    }\n    this._cachedBitmapsMap.clear();\n    this.#drawFilter();\n  }\n\n  #drawFilter() {\n    if (this.pageColors) {\n      const hcmFilterId = this.filterFactory.addHCMFilter(\n        this.pageColors.foreground,\n        this.pageColors.background\n      );\n      if (hcmFilterId !== \"none\") {\n        const savedFilter = this.ctx.filter;\n        this.ctx.filter = hcmFilterId;\n        this.ctx.drawImage(this.ctx.canvas, 0, 0);\n        this.ctx.filter = savedFilter;\n      }\n    }\n  }\n\n  _scaleImage(img, inverseTransform) {\n    // Vertical or horizontal scaling shall not be more than 2 to not lose the\n    // pixels during drawImage operation, painting on the temporary canvas(es)\n    // that are twice smaller in size.\n    const width = img.width;\n    const height = img.height;\n    let widthScale = Math.max(\n      Math.hypot(inverseTransform[0], inverseTransform[1]),\n      1\n    );\n    let heightScale = Math.max(\n      Math.hypot(inverseTransform[2], inverseTransform[3]),\n      1\n    );\n\n    let paintWidth = width,\n      paintHeight = height;\n    let tmpCanvasId = \"prescale1\";\n    let tmpCanvas, tmpCtx;\n    while (\n      (widthScale > 2 && paintWidth > 1) ||\n      (heightScale > 2 && paintHeight > 1)\n    ) {\n      let newWidth = paintWidth,\n        newHeight = paintHeight;\n      if (widthScale > 2 && paintWidth > 1) {\n        // See bug 1820511 (Windows specific bug).\n        // TODO: once the above bug is fixed we could revert to:\n        // newWidth = Math.ceil(paintWidth / 2);\n        newWidth =\n          paintWidth >= 16384\n            ? Math.floor(paintWidth / 2) - 1 || 1\n            : Math.ceil(paintWidth / 2);\n        widthScale /= paintWidth / newWidth;\n      }\n      if (heightScale > 2 && paintHeight > 1) {\n        // TODO: see the comment above.\n        newHeight =\n          paintHeight >= 16384\n            ? Math.floor(paintHeight / 2) - 1 || 1\n            : Math.ceil(paintHeight) / 2;\n        heightScale /= paintHeight / newHeight;\n      }\n      tmpCanvas = this.cachedCanvases.getCanvas(\n        tmpCanvasId,\n        newWidth,\n        newHeight\n      );\n      tmpCtx = tmpCanvas.context;\n      tmpCtx.clearRect(0, 0, newWidth, newHeight);\n      tmpCtx.drawImage(\n        img,\n        0,\n        0,\n        paintWidth,\n        paintHeight,\n        0,\n        0,\n        newWidth,\n        newHeight\n      );\n      img = tmpCanvas.canvas;\n      paintWidth = newWidth;\n      paintHeight = newHeight;\n      tmpCanvasId = tmpCanvasId === \"prescale1\" ? \"prescale2\" : \"prescale1\";\n    }\n    return {\n      img,\n      paintWidth,\n      paintHeight,\n    };\n  }\n\n  _createMaskCanvas(img) {\n    const ctx = this.ctx;\n    const { width, height } = img;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    const currentTransform = getCurrentTransform(ctx);\n\n    let cache, cacheKey, scaled, maskCanvas;\n    if ((img.bitmap || img.data) && img.count > 1) {\n      const mainKey = img.bitmap || img.data.buffer;\n      // We're reusing the same image several times, so we can cache it.\n      // In case we've a pattern fill we just keep the scaled version of\n      // the image.\n      // Only the scaling part matters, the translation part is just used\n      // to compute offsets (but not when filling patterns see #15573).\n      // TODO: handle the case of a pattern fill if it's possible.\n      cacheKey = JSON.stringify(\n        isPatternFill\n          ? currentTransform\n          : [currentTransform.slice(0, 4), fillColor]\n      );\n\n      cache = this._cachedBitmapsMap.get(mainKey);\n      if (!cache) {\n        cache = new Map();\n        this._cachedBitmapsMap.set(mainKey, cache);\n      }\n      const cachedImage = cache.get(cacheKey);\n      if (cachedImage && !isPatternFill) {\n        const offsetX = Math.round(\n          Math.min(currentTransform[0], currentTransform[2]) +\n            currentTransform[4]\n        );\n        const offsetY = Math.round(\n          Math.min(currentTransform[1], currentTransform[3]) +\n            currentTransform[5]\n        );\n        return {\n          canvas: cachedImage,\n          offsetX,\n          offsetY,\n        };\n      }\n      scaled = cachedImage;\n    }\n\n    if (!scaled) {\n      maskCanvas = this.cachedCanvases.getCanvas(\"maskCanvas\", width, height);\n      putBinaryImageMask(maskCanvas.context, img);\n    }\n\n    // Create the mask canvas at the size it will be drawn at and also set\n    // its transform to match the current transform so if there are any\n    // patterns applied they will be applied relative to the correct\n    // transform.\n\n    let maskToCanvas = Util.transform(currentTransform, [\n      1 / width,\n      0,\n      0,\n      -1 / height,\n      0,\n      0,\n    ]);\n    maskToCanvas = Util.transform(maskToCanvas, [1, 0, 0, 1, 0, -height]);\n    const cord1 = Util.applyTransform([0, 0], maskToCanvas);\n    const cord2 = Util.applyTransform([width, height], maskToCanvas);\n    const rect = Util.normalizeRect([cord1[0], cord1[1], cord2[0], cord2[1]]);\n    const drawnWidth = Math.round(rect[2] - rect[0]) || 1;\n    const drawnHeight = Math.round(rect[3] - rect[1]) || 1;\n    const fillCanvas = this.cachedCanvases.getCanvas(\n      \"fillCanvas\",\n      drawnWidth,\n      drawnHeight\n    );\n    const fillCtx = fillCanvas.context;\n\n    // The offset will be the top-left cordinate mask.\n    // If objToCanvas is [a,b,c,d,e,f] then:\n    //   - offsetX = min(a, c) + e\n    //   - offsetY = min(b, d) + f\n    const offsetX = Math.min(cord1[0], cord2[0]);\n    const offsetY = Math.min(cord1[1], cord2[1]);\n    fillCtx.translate(-offsetX, -offsetY);\n    fillCtx.transform(...maskToCanvas);\n\n    if (!scaled) {\n      // Pre-scale if needed to improve image smoothing.\n      scaled = this._scaleImage(\n        maskCanvas.canvas,\n        getCurrentTransformInverse(fillCtx)\n      );\n      scaled = scaled.img;\n      if (cache && isPatternFill) {\n        cache.set(cacheKey, scaled);\n      }\n    }\n\n    fillCtx.imageSmoothingEnabled = getImageSmoothingEnabled(\n      getCurrentTransform(fillCtx),\n      img.interpolate\n    );\n\n    drawImageAtIntegerCoords(\n      fillCtx,\n      scaled,\n      0,\n      0,\n      scaled.width,\n      scaled.height,\n      0,\n      0,\n      width,\n      height\n    );\n    fillCtx.globalCompositeOperation = \"source-in\";\n\n    const inverse = Util.transform(getCurrentTransformInverse(fillCtx), [\n      1,\n      0,\n      0,\n      1,\n      -offsetX,\n      -offsetY,\n    ]);\n    fillCtx.fillStyle = isPatternFill\n      ? fillColor.getPattern(ctx, this, inverse, PathType.FILL)\n      : fillColor;\n\n    fillCtx.fillRect(0, 0, width, height);\n\n    if (cache && !isPatternFill) {\n      // The fill canvas is put in the cache associated to the mask image\n      // so we must remove from the cached canvas: it mustn't be used again.\n      this.cachedCanvases.delete(\"fillCanvas\");\n      cache.set(cacheKey, fillCanvas.canvas);\n    }\n\n    // Round the offsets to avoid drawing fractional pixels.\n    return {\n      canvas: fillCanvas.canvas,\n      offsetX: Math.round(offsetX),\n      offsetY: Math.round(offsetY),\n    };\n  }\n\n  // Graphics state\n  setLineWidth(width) {\n    if (width !== this.current.lineWidth) {\n      this._cachedScaleForStroking[0] = -1;\n    }\n    this.current.lineWidth = width;\n    this.ctx.lineWidth = width;\n  }\n\n  setLineCap(style) {\n    this.ctx.lineCap = LINE_CAP_STYLES[style];\n  }\n\n  setLineJoin(style) {\n    this.ctx.lineJoin = LINE_JOIN_STYLES[style];\n  }\n\n  setMiterLimit(limit) {\n    this.ctx.miterLimit = limit;\n  }\n\n  setDash(dashArray, dashPhase) {\n    const ctx = this.ctx;\n    if (ctx.setLineDash !== undefined) {\n      ctx.setLineDash(dashArray);\n      ctx.lineDashOffset = dashPhase;\n    }\n  }\n\n  setRenderingIntent(intent) {\n    // This operation is ignored since we haven't found a use case for it yet.\n  }\n\n  setFlatness(flatness) {\n    // This operation is ignored since we haven't found a use case for it yet.\n  }\n\n  setGState(states) {\n    for (const [key, value] of states) {\n      switch (key) {\n        case \"LW\":\n          this.setLineWidth(value);\n          break;\n        case \"LC\":\n          this.setLineCap(value);\n          break;\n        case \"LJ\":\n          this.setLineJoin(value);\n          break;\n        case \"ML\":\n          this.setMiterLimit(value);\n          break;\n        case \"D\":\n          this.setDash(value[0], value[1]);\n          break;\n        case \"RI\":\n          this.setRenderingIntent(value);\n          break;\n        case \"FL\":\n          this.setFlatness(value);\n          break;\n        case \"Font\":\n          this.setFont(value[0], value[1]);\n          break;\n        case \"CA\":\n          this.current.strokeAlpha = value;\n          break;\n        case \"ca\":\n          this.current.fillAlpha = value;\n          this.ctx.globalAlpha = value;\n          break;\n        case \"BM\":\n          this.ctx.globalCompositeOperation = value;\n          break;\n        case \"SMask\":\n          this.current.activeSMask = value ? this.tempSMask : null;\n          this.tempSMask = null;\n          this.checkSMaskState();\n          break;\n        case \"TR\":\n          this.ctx.filter = this.current.transferMaps =\n            this.filterFactory.addFilter(value);\n          break;\n      }\n    }\n  }\n\n  get inSMaskMode() {\n    return !!this.suspendedCtx;\n  }\n\n  checkSMaskState() {\n    const inSMaskMode = this.inSMaskMode;\n    if (this.current.activeSMask && !inSMaskMode) {\n      this.beginSMaskMode();\n    } else if (!this.current.activeSMask && inSMaskMode) {\n      this.endSMaskMode();\n    }\n    // Else, the state is okay and nothing needs to be done.\n  }\n\n  /**\n   * Soft mask mode takes the current main drawing canvas and replaces it with\n   * a temporary canvas. Any drawing operations that happen on the temporary\n   * canvas need to be composed with the main canvas that was suspended (see\n   * `compose()`). The temporary canvas also duplicates many of its operations\n   * on the suspended canvas to keep them in sync, so that when the soft mask\n   * mode ends any clipping paths or transformations will still be active and in\n   * the right order on the canvas' graphics state stack.\n   */\n  beginSMaskMode() {\n    if (this.inSMaskMode) {\n      throw new Error(\"beginSMaskMode called while already in smask mode\");\n    }\n    const drawnWidth = this.ctx.canvas.width;\n    const drawnHeight = this.ctx.canvas.height;\n    const cacheId = \"smaskGroupAt\" + this.groupLevel;\n    const scratchCanvas = this.cachedCanvases.getCanvas(\n      cacheId,\n      drawnWidth,\n      drawnHeight\n    );\n    this.suspendedCtx = this.ctx;\n    this.ctx = scratchCanvas.context;\n    const ctx = this.ctx;\n    ctx.setTransform(...getCurrentTransform(this.suspendedCtx));\n    copyCtxState(this.suspendedCtx, ctx);\n    mirrorContextOperations(ctx, this.suspendedCtx);\n\n    this.setGState([\n      [\"BM\", \"source-over\"],\n      [\"ca\", 1],\n      [\"CA\", 1],\n    ]);\n  }\n\n  endSMaskMode() {\n    if (!this.inSMaskMode) {\n      throw new Error(\"endSMaskMode called while not in smask mode\");\n    }\n    // The soft mask is done, now restore the suspended canvas as the main\n    // drawing canvas.\n    this.ctx._removeMirroring();\n    copyCtxState(this.ctx, this.suspendedCtx);\n    this.ctx = this.suspendedCtx;\n\n    this.suspendedCtx = null;\n  }\n\n  compose(dirtyBox) {\n    if (!this.current.activeSMask) {\n      return;\n    }\n\n    if (!dirtyBox) {\n      dirtyBox = [0, 0, this.ctx.canvas.width, this.ctx.canvas.height];\n    } else {\n      dirtyBox[0] = Math.floor(dirtyBox[0]);\n      dirtyBox[1] = Math.floor(dirtyBox[1]);\n      dirtyBox[2] = Math.ceil(dirtyBox[2]);\n      dirtyBox[3] = Math.ceil(dirtyBox[3]);\n    }\n    const smask = this.current.activeSMask;\n    const suspendedCtx = this.suspendedCtx;\n\n    composeSMask(suspendedCtx, smask, this.ctx, dirtyBox);\n    // Whatever was drawn has been moved to the suspended canvas, now clear it\n    // out of the current canvas.\n    this.ctx.save();\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n    this.ctx.restore();\n  }\n\n  save() {\n    if (this.inSMaskMode) {\n      // SMask mode may be turned on/off causing us to lose graphics state.\n      // Copy the temporary canvas state to the main(suspended) canvas to keep\n      // it in sync.\n      copyCtxState(this.ctx, this.suspendedCtx);\n      // Don't bother calling save on the temporary canvas since state is not\n      // saved there.\n      this.suspendedCtx.save();\n    } else {\n      this.ctx.save();\n    }\n    const old = this.current;\n    this.stateStack.push(old);\n    this.current = old.clone();\n  }\n\n  restore() {\n    if (this.stateStack.length === 0 && this.inSMaskMode) {\n      this.endSMaskMode();\n    }\n    if (this.stateStack.length !== 0) {\n      this.current = this.stateStack.pop();\n      if (this.inSMaskMode) {\n        // Graphics state is stored on the main(suspended) canvas. Restore its\n        // state then copy it over to the temporary canvas.\n        this.suspendedCtx.restore();\n        copyCtxState(this.suspendedCtx, this.ctx);\n      } else {\n        this.ctx.restore();\n      }\n      this.checkSMaskState();\n\n      // Ensure that the clipping path is reset (fixes issue6413.pdf).\n      this.pendingClip = null;\n\n      this._cachedScaleForStroking[0] = -1;\n      this._cachedGetSinglePixelWidth = null;\n    }\n  }\n\n  transform(a, b, c, d, e, f) {\n    this.ctx.transform(a, b, c, d, e, f);\n\n    this._cachedScaleForStroking[0] = -1;\n    this._cachedGetSinglePixelWidth = null;\n  }\n\n  // Path\n  constructPath(ops, args, minMax) {\n    const ctx = this.ctx;\n    const current = this.current;\n    let x = current.x,\n      y = current.y;\n    let startX, startY;\n    const currentTransform = getCurrentTransform(ctx);\n\n    // Most of the time the current transform is a scaling matrix\n    // so we don't need to transform points before computing min/max:\n    // we can compute min/max first and then smartly \"apply\" the\n    // transform (see Util.scaleMinMax).\n    // For rectangle, moveTo and lineTo, min/max are computed in the\n    // worker (see evaluator.js).\n    const isScalingMatrix =\n      (currentTransform[0] === 0 && currentTransform[3] === 0) ||\n      (currentTransform[1] === 0 && currentTransform[2] === 0);\n    const minMaxForBezier = isScalingMatrix ? minMax.slice(0) : null;\n\n    for (let i = 0, j = 0, ii = ops.length; i < ii; i++) {\n      switch (ops[i] | 0) {\n        case OPS.rectangle:\n          x = args[j++];\n          y = args[j++];\n          const width = args[j++];\n          const height = args[j++];\n\n          const xw = x + width;\n          const yh = y + height;\n          ctx.moveTo(x, y);\n          if (width === 0 || height === 0) {\n            ctx.lineTo(xw, yh);\n          } else {\n            ctx.lineTo(xw, y);\n            ctx.lineTo(xw, yh);\n            ctx.lineTo(x, yh);\n          }\n          if (!isScalingMatrix) {\n            current.updateRectMinMax(currentTransform, [x, y, xw, yh]);\n          }\n          ctx.closePath();\n          break;\n        case OPS.moveTo:\n          x = args[j++];\n          y = args[j++];\n          ctx.moveTo(x, y);\n          if (!isScalingMatrix) {\n            current.updatePathMinMax(currentTransform, x, y);\n          }\n          break;\n        case OPS.lineTo:\n          x = args[j++];\n          y = args[j++];\n          ctx.lineTo(x, y);\n          if (!isScalingMatrix) {\n            current.updatePathMinMax(currentTransform, x, y);\n          }\n          break;\n        case OPS.curveTo:\n          startX = x;\n          startY = y;\n          x = args[j + 4];\n          y = args[j + 5];\n          ctx.bezierCurveTo(\n            args[j],\n            args[j + 1],\n            args[j + 2],\n            args[j + 3],\n            x,\n            y\n          );\n          current.updateCurvePathMinMax(\n            currentTransform,\n            startX,\n            startY,\n            args[j],\n            args[j + 1],\n            args[j + 2],\n            args[j + 3],\n            x,\n            y,\n            minMaxForBezier\n          );\n          j += 6;\n          break;\n        case OPS.curveTo2:\n          startX = x;\n          startY = y;\n          ctx.bezierCurveTo(\n            x,\n            y,\n            args[j],\n            args[j + 1],\n            args[j + 2],\n            args[j + 3]\n          );\n          current.updateCurvePathMinMax(\n            currentTransform,\n            startX,\n            startY,\n            x,\n            y,\n            args[j],\n            args[j + 1],\n            args[j + 2],\n            args[j + 3],\n            minMaxForBezier\n          );\n          x = args[j + 2];\n          y = args[j + 3];\n          j += 4;\n          break;\n        case OPS.curveTo3:\n          startX = x;\n          startY = y;\n          x = args[j + 2];\n          y = args[j + 3];\n          ctx.bezierCurveTo(args[j], args[j + 1], x, y, x, y);\n          current.updateCurvePathMinMax(\n            currentTransform,\n            startX,\n            startY,\n            args[j],\n            args[j + 1],\n            x,\n            y,\n            x,\n            y,\n            minMaxForBezier\n          );\n          j += 4;\n          break;\n        case OPS.closePath:\n          ctx.closePath();\n          break;\n      }\n    }\n\n    if (isScalingMatrix) {\n      current.updateScalingPathMinMax(currentTransform, minMaxForBezier);\n    }\n\n    current.setCurrentPoint(x, y);\n  }\n\n  closePath() {\n    this.ctx.closePath();\n  }\n\n  stroke(consumePath = true) {\n    const ctx = this.ctx;\n    const strokeColor = this.current.strokeColor;\n    // For stroke we want to temporarily change the global alpha to the\n    // stroking alpha.\n    ctx.globalAlpha = this.current.strokeAlpha;\n    if (this.contentVisible) {\n      if (typeof strokeColor === \"object\" && strokeColor?.getPattern) {\n        ctx.save();\n        ctx.strokeStyle = strokeColor.getPattern(\n          ctx,\n          this,\n          getCurrentTransformInverse(ctx),\n          PathType.STROKE\n        );\n        this.rescaleAndStroke(/* saveRestore */ false);\n        ctx.restore();\n      } else {\n        this.rescaleAndStroke(/* saveRestore */ true);\n      }\n    }\n    if (consumePath) {\n      this.consumePath(this.current.getClippedPathBoundingBox());\n    }\n    // Restore the global alpha to the fill alpha\n    ctx.globalAlpha = this.current.fillAlpha;\n  }\n\n  closeStroke() {\n    this.closePath();\n    this.stroke();\n  }\n\n  fill(consumePath = true) {\n    const ctx = this.ctx;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    let needRestore = false;\n\n    if (isPatternFill) {\n      ctx.save();\n      ctx.fillStyle = fillColor.getPattern(\n        ctx,\n        this,\n        getCurrentTransformInverse(ctx),\n        PathType.FILL\n      );\n      needRestore = true;\n    }\n\n    const intersect = this.current.getClippedPathBoundingBox();\n    if (this.contentVisible && intersect !== null) {\n      if (this.pendingEOFill) {\n        ctx.fill(\"evenodd\");\n        this.pendingEOFill = false;\n      } else {\n        ctx.fill();\n      }\n    }\n\n    if (needRestore) {\n      ctx.restore();\n    }\n    if (consumePath) {\n      this.consumePath(intersect);\n    }\n  }\n\n  eoFill() {\n    this.pendingEOFill = true;\n    this.fill();\n  }\n\n  fillStroke() {\n    this.fill(false);\n    this.stroke(false);\n\n    this.consumePath();\n  }\n\n  eoFillStroke() {\n    this.pendingEOFill = true;\n    this.fillStroke();\n  }\n\n  closeFillStroke() {\n    this.closePath();\n    this.fillStroke();\n  }\n\n  closeEOFillStroke() {\n    this.pendingEOFill = true;\n    this.closePath();\n    this.fillStroke();\n  }\n\n  endPath() {\n    this.consumePath();\n  }\n\n  // Clipping\n  clip() {\n    this.pendingClip = NORMAL_CLIP;\n  }\n\n  eoClip() {\n    this.pendingClip = EO_CLIP;\n  }\n\n  // Text\n  beginText() {\n    this.current.textMatrix = IDENTITY_MATRIX;\n    this.current.textMatrixScale = 1;\n    this.current.x = this.current.lineX = 0;\n    this.current.y = this.current.lineY = 0;\n  }\n\n  endText() {\n    const paths = this.pendingTextPaths;\n    const ctx = this.ctx;\n    if (paths === undefined) {\n      ctx.beginPath();\n      return;\n    }\n\n    ctx.save();\n    ctx.beginPath();\n    for (const path of paths) {\n      ctx.setTransform(...path.transform);\n      ctx.translate(path.x, path.y);\n      path.addToPath(ctx, path.fontSize);\n    }\n    ctx.restore();\n    ctx.clip();\n    ctx.beginPath();\n    delete this.pendingTextPaths;\n  }\n\n  setCharSpacing(spacing) {\n    this.current.charSpacing = spacing;\n  }\n\n  setWordSpacing(spacing) {\n    this.current.wordSpacing = spacing;\n  }\n\n  setHScale(scale) {\n    this.current.textHScale = scale / 100;\n  }\n\n  setLeading(leading) {\n    this.current.leading = -leading;\n  }\n\n  setFont(fontRefName, size) {\n    const fontObj = this.commonObjs.get(fontRefName);\n    const current = this.current;\n\n    if (!fontObj) {\n      throw new Error(`Can't find font for ${fontRefName}`);\n    }\n    current.fontMatrix = fontObj.fontMatrix || FONT_IDENTITY_MATRIX;\n\n    // A valid matrix needs all main diagonal elements to be non-zero\n    // This also ensures we bypass FF bugzilla bug #719844.\n    if (current.fontMatrix[0] === 0 || current.fontMatrix[3] === 0) {\n      warn(\"Invalid font matrix for font \" + fontRefName);\n    }\n\n    // The spec for Tf (setFont) says that 'size' specifies the font 'scale',\n    // and in some docs this can be negative (inverted x-y axes).\n    if (size < 0) {\n      size = -size;\n      current.fontDirection = -1;\n    } else {\n      current.fontDirection = 1;\n    }\n\n    this.current.font = fontObj;\n    this.current.fontSize = size;\n\n    if (fontObj.isType3Font) {\n      return; // we don't need ctx.font for Type3 fonts\n    }\n\n    const name = fontObj.loadedName || \"sans-serif\";\n    const typeface =\n      fontObj.systemFontInfo?.css || `\"${name}\", ${fontObj.fallbackName}`;\n\n    let bold = \"normal\";\n    if (fontObj.black) {\n      bold = \"900\";\n    } else if (fontObj.bold) {\n      bold = \"bold\";\n    }\n    const italic = fontObj.italic ? \"italic\" : \"normal\";\n\n    // Some font backends cannot handle fonts below certain size.\n    // Keeping the font at minimal size and using the fontSizeScale to change\n    // the current transformation matrix before the fillText/strokeText.\n    // See https://bugzilla.mozilla.org/show_bug.cgi?id=726227\n    let browserFontSize = size;\n    if (size < MIN_FONT_SIZE) {\n      browserFontSize = MIN_FONT_SIZE;\n    } else if (size > MAX_FONT_SIZE) {\n      browserFontSize = MAX_FONT_SIZE;\n    }\n    this.current.fontSizeScale = size / browserFontSize;\n\n    this.ctx.font = `${italic} ${bold} ${browserFontSize}px ${typeface}`;\n  }\n\n  setTextRenderingMode(mode) {\n    this.current.textRenderingMode = mode;\n  }\n\n  setTextRise(rise) {\n    this.current.textRise = rise;\n  }\n\n  moveText(x, y) {\n    this.current.x = this.current.lineX += x;\n    this.current.y = this.current.lineY += y;\n  }\n\n  setLeadingMoveText(x, y) {\n    this.setLeading(-y);\n    this.moveText(x, y);\n  }\n\n  setTextMatrix(a, b, c, d, e, f) {\n    this.current.textMatrix = [a, b, c, d, e, f];\n    this.current.textMatrixScale = Math.hypot(a, b);\n\n    this.current.x = this.current.lineX = 0;\n    this.current.y = this.current.lineY = 0;\n  }\n\n  nextLine() {\n    this.moveText(0, this.current.leading);\n  }\n\n  paintChar(character, x, y, patternTransform) {\n    const ctx = this.ctx;\n    const current = this.current;\n    const font = current.font;\n    const textRenderingMode = current.textRenderingMode;\n    const fontSize = current.fontSize / current.fontSizeScale;\n    const fillStrokeMode =\n      textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n    const isAddToPathSet = !!(\n      textRenderingMode & TextRenderingMode.ADD_TO_PATH_FLAG\n    );\n    const patternFill = current.patternFill && !font.missingFile;\n\n    let addToPath;\n    if (font.disableFontFace || isAddToPathSet || patternFill) {\n      addToPath = font.getPathGenerator(this.commonObjs, character);\n    }\n\n    if (font.disableFontFace || patternFill) {\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.beginPath();\n      addToPath(ctx, fontSize);\n      if (patternTransform) {\n        ctx.setTransform(...patternTransform);\n      }\n      if (\n        fillStrokeMode === TextRenderingMode.FILL ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        ctx.fill();\n      }\n      if (\n        fillStrokeMode === TextRenderingMode.STROKE ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        ctx.stroke();\n      }\n      ctx.restore();\n    } else {\n      if (\n        fillStrokeMode === TextRenderingMode.FILL ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        ctx.fillText(character, x, y);\n      }\n      if (\n        fillStrokeMode === TextRenderingMode.STROKE ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        ctx.strokeText(character, x, y);\n      }\n    }\n\n    if (isAddToPathSet) {\n      const paths = (this.pendingTextPaths ||= []);\n      paths.push({\n        transform: getCurrentTransform(ctx),\n        x,\n        y,\n        fontSize,\n        addToPath,\n      });\n    }\n  }\n\n  get isFontSubpixelAAEnabled() {\n    // Checks if anti-aliasing is enabled when scaled text is painted.\n    // On Windows GDI scaled fonts looks bad.\n    const { context: ctx } = this.cachedCanvases.getCanvas(\n      \"isFontSubpixelAAEnabled\",\n      10,\n      10\n    );\n    ctx.scale(1.5, 1);\n    ctx.fillText(\"I\", 0, 10);\n    const data = ctx.getImageData(0, 0, 10, 10).data;\n    let enabled = false;\n    for (let i = 3; i < data.length; i += 4) {\n      if (data[i] > 0 && data[i] < 255) {\n        enabled = true;\n        break;\n      }\n    }\n    return shadow(this, \"isFontSubpixelAAEnabled\", enabled);\n  }\n\n  showText(glyphs) {\n    const current = this.current;\n    const font = current.font;\n    if (font.isType3Font) {\n      return this.showType3Text(glyphs);\n    }\n\n    const fontSize = current.fontSize;\n    if (fontSize === 0) {\n      return undefined;\n    }\n\n    const ctx = this.ctx;\n    const fontSizeScale = current.fontSizeScale;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const fontDirection = current.fontDirection;\n    const textHScale = current.textHScale * fontDirection;\n    const glyphsLength = glyphs.length;\n    const vertical = font.vertical;\n    const spacingDir = vertical ? 1 : -1;\n    const defaultVMetrics = font.defaultVMetrics;\n    const widthAdvanceScale = fontSize * current.fontMatrix[0];\n\n    const simpleFillText =\n      current.textRenderingMode === TextRenderingMode.FILL &&\n      !font.disableFontFace &&\n      !current.patternFill;\n\n    ctx.save();\n    ctx.transform(...current.textMatrix);\n    ctx.translate(current.x, current.y + current.textRise);\n\n    if (fontDirection > 0) {\n      ctx.scale(textHScale, -1);\n    } else {\n      ctx.scale(textHScale, 1);\n    }\n\n    let patternTransform;\n    if (current.patternFill) {\n      ctx.save();\n      const pattern = current.fillColor.getPattern(\n        ctx,\n        this,\n        getCurrentTransformInverse(ctx),\n        PathType.FILL\n      );\n      patternTransform = getCurrentTransform(ctx);\n      ctx.restore();\n      ctx.fillStyle = pattern;\n    }\n\n    let lineWidth = current.lineWidth;\n    const scale = current.textMatrixScale;\n    if (scale === 0 || lineWidth === 0) {\n      const fillStrokeMode =\n        current.textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n      if (\n        fillStrokeMode === TextRenderingMode.STROKE ||\n        fillStrokeMode === TextRenderingMode.FILL_STROKE\n      ) {\n        lineWidth = this.getSinglePixelWidth();\n      }\n    } else {\n      lineWidth /= scale;\n    }\n\n    if (fontSizeScale !== 1.0) {\n      ctx.scale(fontSizeScale, fontSizeScale);\n      lineWidth /= fontSizeScale;\n    }\n\n    ctx.lineWidth = lineWidth;\n\n    if (font.isInvalidPDFjsFont) {\n      const chars = [];\n      let width = 0;\n      for (const glyph of glyphs) {\n        chars.push(glyph.unicode);\n        width += glyph.width;\n      }\n      ctx.fillText(chars.join(\"\"), 0, 0);\n      current.x += width * widthAdvanceScale * textHScale;\n      ctx.restore();\n      this.compose();\n\n      return undefined;\n    }\n\n    let x = 0,\n      i;\n    for (i = 0; i < glyphsLength; ++i) {\n      const glyph = glyphs[i];\n      if (typeof glyph === \"number\") {\n        x += (spacingDir * glyph * fontSize) / 1000;\n        continue;\n      }\n\n      let restoreNeeded = false;\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const character = glyph.fontChar;\n      const accent = glyph.accent;\n      let scaledX, scaledY;\n      let width = glyph.width;\n      if (vertical) {\n        const vmetric = glyph.vmetric || defaultVMetrics;\n        const vx =\n          -(glyph.vmetric ? vmetric[1] : width * 0.5) * widthAdvanceScale;\n        const vy = vmetric[2] * widthAdvanceScale;\n\n        width = vmetric ? -vmetric[0] : width;\n        scaledX = vx / fontSizeScale;\n        scaledY = (x + vy) / fontSizeScale;\n      } else {\n        scaledX = x / fontSizeScale;\n        scaledY = 0;\n      }\n\n      if (font.remeasure && width > 0) {\n        // Some standard fonts may not have the exact width: rescale per\n        // character if measured width is greater than expected glyph width\n        // and subpixel-aa is enabled, otherwise just center the glyph.\n        const measuredWidth =\n          ((ctx.measureText(character).width * 1000) / fontSize) *\n          fontSizeScale;\n        if (width < measuredWidth && this.isFontSubpixelAAEnabled) {\n          const characterScaleX = width / measuredWidth;\n          restoreNeeded = true;\n          ctx.save();\n          ctx.scale(characterScaleX, 1);\n          scaledX /= characterScaleX;\n        } else if (width !== measuredWidth) {\n          scaledX +=\n            (((width - measuredWidth) / 2000) * fontSize) / fontSizeScale;\n        }\n      }\n\n      // Only attempt to draw the glyph if it is actually in the embedded font\n      // file or if there isn't a font file so the fallback font is shown.\n      if (this.contentVisible && (glyph.isInFont || font.missingFile)) {\n        if (simpleFillText && !accent) {\n          // common case\n          ctx.fillText(character, scaledX, scaledY);\n        } else {\n          this.paintChar(character, scaledX, scaledY, patternTransform);\n          if (accent) {\n            const scaledAccentX =\n              scaledX + (fontSize * accent.offset.x) / fontSizeScale;\n            const scaledAccentY =\n              scaledY - (fontSize * accent.offset.y) / fontSizeScale;\n            this.paintChar(\n              accent.fontChar,\n              scaledAccentX,\n              scaledAccentY,\n              patternTransform\n            );\n          }\n        }\n      }\n\n      let charWidth;\n      if (vertical) {\n        charWidth = width * widthAdvanceScale - spacing * fontDirection;\n      } else {\n        charWidth = width * widthAdvanceScale + spacing * fontDirection;\n      }\n      x += charWidth;\n\n      if (restoreNeeded) {\n        ctx.restore();\n      }\n    }\n    if (vertical) {\n      current.y -= x;\n    } else {\n      current.x += x * textHScale;\n    }\n    ctx.restore();\n    this.compose();\n\n    return undefined;\n  }\n\n  showType3Text(glyphs) {\n    // Type3 fonts - each glyph is a \"mini-PDF\"\n    const ctx = this.ctx;\n    const current = this.current;\n    const font = current.font;\n    const fontSize = current.fontSize;\n    const fontDirection = current.fontDirection;\n    const spacingDir = font.vertical ? 1 : -1;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const textHScale = current.textHScale * fontDirection;\n    const fontMatrix = current.fontMatrix || FONT_IDENTITY_MATRIX;\n    const glyphsLength = glyphs.length;\n    const isTextInvisible =\n      current.textRenderingMode === TextRenderingMode.INVISIBLE;\n    let i, glyph, width, spacingLength;\n\n    if (isTextInvisible || fontSize === 0) {\n      return;\n    }\n    this._cachedScaleForStroking[0] = -1;\n    this._cachedGetSinglePixelWidth = null;\n\n    ctx.save();\n    ctx.transform(...current.textMatrix);\n    ctx.translate(current.x, current.y);\n\n    ctx.scale(textHScale, fontDirection);\n\n    for (i = 0; i < glyphsLength; ++i) {\n      glyph = glyphs[i];\n      if (typeof glyph === \"number\") {\n        spacingLength = (spacingDir * glyph * fontSize) / 1000;\n        this.ctx.translate(spacingLength, 0);\n        current.x += spacingLength * textHScale;\n        continue;\n      }\n\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const operatorList = font.charProcOperatorList[glyph.operatorListId];\n      if (!operatorList) {\n        warn(`Type3 character \"${glyph.operatorListId}\" is not available.`);\n        continue;\n      }\n      if (this.contentVisible) {\n        this.processingType3 = glyph;\n        this.save();\n        ctx.scale(fontSize, fontSize);\n        ctx.transform(...fontMatrix);\n        this.executeOperatorList(operatorList);\n        this.restore();\n      }\n\n      const transformed = Util.applyTransform([glyph.width, 0], fontMatrix);\n      width = transformed[0] * fontSize + spacing;\n\n      ctx.translate(width, 0);\n      current.x += width * textHScale;\n    }\n    ctx.restore();\n    this.processingType3 = null;\n  }\n\n  // Type3 fonts\n  setCharWidth(xWidth, yWidth) {\n    // We can safely ignore this since the width should be the same\n    // as the width in the Widths array.\n  }\n\n  setCharWidthAndBounds(xWidth, yWidth, llx, lly, urx, ury) {\n    this.ctx.rect(llx, lly, urx - llx, ury - lly);\n    this.ctx.clip();\n    this.endPath();\n  }\n\n  // Color\n  getColorN_Pattern(IR) {\n    let pattern;\n    if (IR[0] === \"TilingPattern\") {\n      const color = IR[1];\n      const baseTransform = this.baseTransform || getCurrentTransform(this.ctx);\n      const canvasGraphicsFactory = {\n        createCanvasGraphics: ctx => {\n          return new CanvasGraphics(\n            ctx,\n            this.commonObjs,\n            this.objs,\n            this.canvasFactory,\n            this.filterFactory,\n            {\n              optionalContentConfig: this.optionalContentConfig,\n              markedContentStack: this.markedContentStack,\n            }\n          );\n        },\n      };\n      pattern = new TilingPattern(\n        IR,\n        color,\n        this.ctx,\n        canvasGraphicsFactory,\n        baseTransform\n      );\n    } else {\n      pattern = this._getPattern(IR[1], IR[2]);\n    }\n    return pattern;\n  }\n\n  setStrokeColorN() {\n    this.current.strokeColor = this.getColorN_Pattern(arguments);\n  }\n\n  setFillColorN() {\n    this.current.fillColor = this.getColorN_Pattern(arguments);\n    this.current.patternFill = true;\n  }\n\n  setStrokeRGBColor(r, g, b) {\n    const color = Util.makeHexColor(r, g, b);\n    this.ctx.strokeStyle = color;\n    this.current.strokeColor = color;\n  }\n\n  setFillRGBColor(r, g, b) {\n    const color = Util.makeHexColor(r, g, b);\n    this.ctx.fillStyle = color;\n    this.current.fillColor = color;\n    this.current.patternFill = false;\n  }\n\n  _getPattern(objId, matrix = null) {\n    let pattern;\n    if (this.cachedPatterns.has(objId)) {\n      pattern = this.cachedPatterns.get(objId);\n    } else {\n      pattern = getShadingPattern(this.getObject(objId));\n      this.cachedPatterns.set(objId, pattern);\n    }\n    if (matrix) {\n      pattern.matrix = matrix;\n    }\n    return pattern;\n  }\n\n  shadingFill(objId) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n\n    this.save();\n    const pattern = this._getPattern(objId);\n    ctx.fillStyle = pattern.getPattern(\n      ctx,\n      this,\n      getCurrentTransformInverse(ctx),\n      PathType.SHADING\n    );\n\n    const inv = getCurrentTransformInverse(ctx);\n    if (inv) {\n      const { width, height } = ctx.canvas;\n      const [x0, y0, x1, y1] = Util.getAxialAlignedBoundingBox(\n        [0, 0, width, height],\n        inv\n      );\n\n      this.ctx.fillRect(x0, y0, x1 - x0, y1 - y0);\n    } else {\n      // HACK to draw the gradient onto an infinite rectangle.\n      // PDF gradients are drawn across the entire image while\n      // Canvas only allows gradients to be drawn in a rectangle\n      // The following bug should allow us to remove this.\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=664884\n\n      this.ctx.fillRect(-1e10, -1e10, 2e10, 2e10);\n    }\n\n    this.compose(this.current.getClippedPathBoundingBox());\n    this.restore();\n  }\n\n  // Images\n  beginInlineImage() {\n    unreachable(\"Should not call beginInlineImage\");\n  }\n\n  beginImageData() {\n    unreachable(\"Should not call beginImageData\");\n  }\n\n  paintFormXObjectBegin(matrix, bbox) {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.save();\n    this.baseTransformStack.push(this.baseTransform);\n\n    if (Array.isArray(matrix) && matrix.length === 6) {\n      this.transform(...matrix);\n    }\n\n    this.baseTransform = getCurrentTransform(this.ctx);\n\n    if (bbox) {\n      const width = bbox[2] - bbox[0];\n      const height = bbox[3] - bbox[1];\n      this.ctx.rect(bbox[0], bbox[1], width, height);\n      this.current.updateRectMinMax(getCurrentTransform(this.ctx), bbox);\n      this.clip();\n      this.endPath();\n    }\n  }\n\n  paintFormXObjectEnd() {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.restore();\n    this.baseTransform = this.baseTransformStack.pop();\n  }\n\n  beginGroup(group) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    this.save();\n    // If there's an active soft mask we don't want it enabled for the group, so\n    // clear it out. The mask and suspended canvas will be restored in endGroup.\n    if (this.inSMaskMode) {\n      this.endSMaskMode();\n      this.current.activeSMask = null;\n    }\n\n    const currentCtx = this.ctx;\n    // TODO non-isolated groups - according to Rik at adobe non-isolated\n    // group results aren't usually that different and they even have tools\n    // that ignore this setting. Notes from Rik on implementing:\n    // - When you encounter an transparency group, create a new canvas with\n    // the dimensions of the bbox\n    // - copy the content from the previous canvas to the new canvas\n    // - draw as usual\n    // - remove the backdrop alpha:\n    // alphaNew = 1 - (1 - alpha)/(1 - alphaBackdrop) with 'alpha' the alpha\n    // value of your transparency group and 'alphaBackdrop' the alpha of the\n    // backdrop\n    // - remove background color:\n    // colorNew = color - alphaNew *colorBackdrop /(1 - alphaNew)\n    if (!group.isolated) {\n      info(\"TODO: Support non-isolated groups.\");\n    }\n\n    // TODO knockout - supposedly possible with the clever use of compositing\n    // modes.\n    if (group.knockout) {\n      warn(\"Knockout groups not supported.\");\n    }\n\n    const currentTransform = getCurrentTransform(currentCtx);\n    if (group.matrix) {\n      currentCtx.transform(...group.matrix);\n    }\n    if (!group.bbox) {\n      throw new Error(\"Bounding box is required.\");\n    }\n\n    // Based on the current transform figure out how big the bounding box\n    // will actually be.\n    let bounds = Util.getAxialAlignedBoundingBox(\n      group.bbox,\n      getCurrentTransform(currentCtx)\n    );\n    // Clip the bounding box to the current canvas.\n    const canvasBounds = [\n      0,\n      0,\n      currentCtx.canvas.width,\n      currentCtx.canvas.height,\n    ];\n    bounds = Util.intersect(bounds, canvasBounds) || [0, 0, 0, 0];\n    // Use ceil in case we're between sizes so we don't create canvas that is\n    // too small and make the canvas at least 1x1 pixels.\n    const offsetX = Math.floor(bounds[0]);\n    const offsetY = Math.floor(bounds[1]);\n    let drawnWidth = Math.max(Math.ceil(bounds[2]) - offsetX, 1);\n    let drawnHeight = Math.max(Math.ceil(bounds[3]) - offsetY, 1);\n    let scaleX = 1,\n      scaleY = 1;\n    if (drawnWidth > MAX_GROUP_SIZE) {\n      scaleX = drawnWidth / MAX_GROUP_SIZE;\n      drawnWidth = MAX_GROUP_SIZE;\n    }\n    if (drawnHeight > MAX_GROUP_SIZE) {\n      scaleY = drawnHeight / MAX_GROUP_SIZE;\n      drawnHeight = MAX_GROUP_SIZE;\n    }\n\n    this.current.startNewPathAndClipBox([0, 0, drawnWidth, drawnHeight]);\n\n    let cacheId = \"groupAt\" + this.groupLevel;\n    if (group.smask) {\n      // Using two cache entries is case if masks are used one after another.\n      cacheId += \"_smask_\" + (this.smaskCounter++ % 2);\n    }\n    const scratchCanvas = this.cachedCanvases.getCanvas(\n      cacheId,\n      drawnWidth,\n      drawnHeight\n    );\n    const groupCtx = scratchCanvas.context;\n\n    // Since we created a new canvas that is just the size of the bounding box\n    // we have to translate the group ctx.\n    groupCtx.scale(1 / scaleX, 1 / scaleY);\n    groupCtx.translate(-offsetX, -offsetY);\n    groupCtx.transform(...currentTransform);\n\n    if (group.smask) {\n      // Saving state and cached mask to be used in setGState.\n      this.smaskStack.push({\n        canvas: scratchCanvas.canvas,\n        context: groupCtx,\n        offsetX,\n        offsetY,\n        scaleX,\n        scaleY,\n        subtype: group.smask.subtype,\n        backdrop: group.smask.backdrop,\n        transferMap: group.smask.transferMap || null,\n        startTransformInverse: null, // used during suspend operation\n      });\n    } else {\n      // Setup the current ctx so when the group is popped we draw it at the\n      // right location.\n      currentCtx.setTransform(1, 0, 0, 1, 0, 0);\n      currentCtx.translate(offsetX, offsetY);\n      currentCtx.scale(scaleX, scaleY);\n      currentCtx.save();\n    }\n    // The transparency group inherits all off the current graphics state\n    // except the blend mode, soft mask, and alpha constants.\n    copyCtxState(currentCtx, groupCtx);\n    this.ctx = groupCtx;\n    this.setGState([\n      [\"BM\", \"source-over\"],\n      [\"ca\", 1],\n      [\"CA\", 1],\n    ]);\n    this.groupStack.push(currentCtx);\n    this.groupLevel++;\n  }\n\n  endGroup(group) {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.groupLevel--;\n    const groupCtx = this.ctx;\n    const ctx = this.groupStack.pop();\n    this.ctx = ctx;\n    // Turn off image smoothing to avoid sub pixel interpolation which can\n    // look kind of blurry for some pdfs.\n    this.ctx.imageSmoothingEnabled = false;\n\n    if (group.smask) {\n      this.tempSMask = this.smaskStack.pop();\n      this.restore();\n    } else {\n      this.ctx.restore();\n      const currentMtx = getCurrentTransform(this.ctx);\n      this.restore();\n      this.ctx.save();\n      this.ctx.setTransform(...currentMtx);\n      const dirtyBox = Util.getAxialAlignedBoundingBox(\n        [0, 0, groupCtx.canvas.width, groupCtx.canvas.height],\n        currentMtx\n      );\n      this.ctx.drawImage(groupCtx.canvas, 0, 0);\n      this.ctx.restore();\n      this.compose(dirtyBox);\n    }\n  }\n\n  beginAnnotation(id, rect, transform, matrix, hasOwnCanvas) {\n    // The annotations are drawn just after the page content.\n    // The page content drawing can potentially have set a transform,\n    // a clipping path, whatever...\n    // So in order to have something clean, we restore the initial state.\n    this.#restoreInitialState();\n    resetCtxToDefault(this.ctx);\n\n    this.ctx.save();\n    this.save();\n\n    if (this.baseTransform) {\n      this.ctx.setTransform(...this.baseTransform);\n    }\n\n    if (Array.isArray(rect) && rect.length === 4) {\n      const width = rect[2] - rect[0];\n      const height = rect[3] - rect[1];\n\n      if (hasOwnCanvas && this.annotationCanvasMap) {\n        transform = transform.slice();\n        transform[4] -= rect[0];\n        transform[5] -= rect[1];\n\n        rect = rect.slice();\n        rect[0] = rect[1] = 0;\n        rect[2] = width;\n        rect[3] = height;\n\n        const [scaleX, scaleY] = Util.singularValueDecompose2dScale(\n          getCurrentTransform(this.ctx)\n        );\n        const { viewportScale } = this;\n        const canvasWidth = Math.ceil(\n          width * this.outputScaleX * viewportScale\n        );\n        const canvasHeight = Math.ceil(\n          height * this.outputScaleY * viewportScale\n        );\n\n        this.annotationCanvas = this.canvasFactory.create(\n          canvasWidth,\n          canvasHeight\n        );\n        const { canvas, context } = this.annotationCanvas;\n        this.annotationCanvasMap.set(id, canvas);\n        this.annotationCanvas.savedCtx = this.ctx;\n        this.ctx = context;\n        this.ctx.save();\n        this.ctx.setTransform(scaleX, 0, 0, -scaleY, 0, height * scaleY);\n\n        resetCtxToDefault(this.ctx);\n      } else {\n        resetCtxToDefault(this.ctx);\n\n        this.ctx.rect(rect[0], rect[1], width, height);\n        this.ctx.clip();\n        this.endPath();\n      }\n    }\n\n    this.current = new CanvasExtraState(\n      this.ctx.canvas.width,\n      this.ctx.canvas.height\n    );\n\n    this.transform(...transform);\n    this.transform(...matrix);\n  }\n\n  endAnnotation() {\n    if (this.annotationCanvas) {\n      this.ctx.restore();\n      this.#drawFilter();\n\n      this.ctx = this.annotationCanvas.savedCtx;\n      delete this.annotationCanvas.savedCtx;\n      delete this.annotationCanvas;\n    }\n  }\n\n  paintImageMaskXObject(img) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const count = img.count;\n    img = this.getObject(img.data, img);\n    img.count = count;\n\n    const ctx = this.ctx;\n    const glyph = this.processingType3;\n\n    if (glyph) {\n      if (glyph.compiled === undefined) {\n        glyph.compiled = compileType3Glyph(img);\n      }\n\n      if (glyph.compiled) {\n        glyph.compiled(ctx);\n        return;\n      }\n    }\n    const mask = this._createMaskCanvas(img);\n    const maskCanvas = mask.canvas;\n\n    ctx.save();\n    // The mask is drawn with the transform applied. Reset the current\n    // transform to draw to the identity.\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.drawImage(maskCanvas, mask.offsetX, mask.offsetY);\n    ctx.restore();\n    this.compose();\n  }\n\n  paintImageMaskXObjectRepeat(\n    img,\n    scaleX,\n    skewX = 0,\n    skewY = 0,\n    scaleY,\n    positions\n  ) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    img = this.getObject(img.data, img);\n\n    const ctx = this.ctx;\n    ctx.save();\n    const currentTransform = getCurrentTransform(ctx);\n    ctx.transform(scaleX, skewX, skewY, scaleY, 0, 0);\n    const mask = this._createMaskCanvas(img);\n\n    ctx.setTransform(\n      1,\n      0,\n      0,\n      1,\n      mask.offsetX - currentTransform[4],\n      mask.offsetY - currentTransform[5]\n    );\n    for (let i = 0, ii = positions.length; i < ii; i += 2) {\n      const trans = Util.transform(currentTransform, [\n        scaleX,\n        skewX,\n        skewY,\n        scaleY,\n        positions[i],\n        positions[i + 1],\n      ]);\n\n      const [x, y] = Util.applyTransform([0, 0], trans);\n      ctx.drawImage(mask.canvas, x, y);\n    }\n    ctx.restore();\n    this.compose();\n  }\n\n  paintImageMaskXObjectGroup(images) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n\n    for (const image of images) {\n      const { data, width, height, transform } = image;\n\n      const maskCanvas = this.cachedCanvases.getCanvas(\n        \"maskCanvas\",\n        width,\n        height\n      );\n      const maskCtx = maskCanvas.context;\n      maskCtx.save();\n\n      const img = this.getObject(data, image);\n      putBinaryImageMask(maskCtx, img);\n\n      maskCtx.globalCompositeOperation = \"source-in\";\n\n      maskCtx.fillStyle = isPatternFill\n        ? fillColor.getPattern(\n            maskCtx,\n            this,\n            getCurrentTransformInverse(ctx),\n            PathType.FILL\n          )\n        : fillColor;\n      maskCtx.fillRect(0, 0, width, height);\n\n      maskCtx.restore();\n\n      ctx.save();\n      ctx.transform(...transform);\n      ctx.scale(1, -1);\n      drawImageAtIntegerCoords(\n        ctx,\n        maskCanvas.canvas,\n        0,\n        0,\n        width,\n        height,\n        0,\n        -1,\n        1,\n        1\n      );\n      ctx.restore();\n    }\n    this.compose();\n  }\n\n  paintImageXObject(objId) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const imgData = this.getObject(objId);\n    if (!imgData) {\n      warn(\"Dependent image isn't ready yet\");\n      return;\n    }\n\n    this.paintInlineImageXObject(imgData);\n  }\n\n  paintImageXObjectRepeat(objId, scaleX, scaleY, positions) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const imgData = this.getObject(objId);\n    if (!imgData) {\n      warn(\"Dependent image isn't ready yet\");\n      return;\n    }\n\n    const width = imgData.width;\n    const height = imgData.height;\n    const map = [];\n    for (let i = 0, ii = positions.length; i < ii; i += 2) {\n      map.push({\n        transform: [scaleX, 0, 0, scaleY, positions[i], positions[i + 1]],\n        x: 0,\n        y: 0,\n        w: width,\n        h: height,\n      });\n    }\n    this.paintInlineImageXObjectGroup(imgData, map);\n  }\n\n  applyTransferMapsToCanvas(ctx) {\n    if (this.current.transferMaps !== \"none\") {\n      ctx.filter = this.current.transferMaps;\n      ctx.drawImage(ctx.canvas, 0, 0);\n      ctx.filter = \"none\";\n    }\n    return ctx.canvas;\n  }\n\n  applyTransferMapsToBitmap(imgData) {\n    if (this.current.transferMaps === \"none\") {\n      return imgData.bitmap;\n    }\n    const { bitmap, width, height } = imgData;\n    const tmpCanvas = this.cachedCanvases.getCanvas(\n      \"inlineImage\",\n      width,\n      height\n    );\n    const tmpCtx = tmpCanvas.context;\n    tmpCtx.filter = this.current.transferMaps;\n    tmpCtx.drawImage(bitmap, 0, 0);\n    tmpCtx.filter = \"none\";\n\n    return tmpCanvas.canvas;\n  }\n\n  paintInlineImageXObject(imgData) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const width = imgData.width;\n    const height = imgData.height;\n    const ctx = this.ctx;\n\n    this.save();\n\n    if (\n      (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n      !isNodeJS\n    ) {\n      // The filter, if any, will be applied in applyTransferMapsToBitmap.\n      // It must be applied to the image before rescaling else some artifacts\n      // could appear.\n      // The final restore will reset it to its value.\n      ctx.filter = \"none\";\n    }\n\n    // scale the image to the unit square\n    ctx.scale(1 / width, -1 / height);\n\n    let imgToPaint;\n    if (imgData.bitmap) {\n      imgToPaint = this.applyTransferMapsToBitmap(imgData);\n    } else if (\n      (typeof HTMLElement === \"function\" && imgData instanceof HTMLElement) ||\n      !imgData.data\n    ) {\n      // typeof check is needed due to node.js support, see issue #8489\n      imgToPaint = imgData;\n    } else {\n      const tmpCanvas = this.cachedCanvases.getCanvas(\n        \"inlineImage\",\n        width,\n        height\n      );\n      const tmpCtx = tmpCanvas.context;\n      putBinaryImageData(tmpCtx, imgData);\n      imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n    }\n\n    const scaled = this._scaleImage(\n      imgToPaint,\n      getCurrentTransformInverse(ctx)\n    );\n    ctx.imageSmoothingEnabled = getImageSmoothingEnabled(\n      getCurrentTransform(ctx),\n      imgData.interpolate\n    );\n\n    drawImageAtIntegerCoords(\n      ctx,\n      scaled.img,\n      0,\n      0,\n      scaled.paintWidth,\n      scaled.paintHeight,\n      0,\n      -height,\n      width,\n      height\n    );\n    this.compose();\n    this.restore();\n  }\n\n  paintInlineImageXObjectGroup(imgData, map) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n    let imgToPaint;\n    if (imgData.bitmap) {\n      imgToPaint = imgData.bitmap;\n    } else {\n      const w = imgData.width;\n      const h = imgData.height;\n\n      const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", w, h);\n      const tmpCtx = tmpCanvas.context;\n      putBinaryImageData(tmpCtx, imgData);\n      imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n    }\n\n    for (const entry of map) {\n      ctx.save();\n      ctx.transform(...entry.transform);\n      ctx.scale(1, -1);\n      drawImageAtIntegerCoords(\n        ctx,\n        imgToPaint,\n        entry.x,\n        entry.y,\n        entry.w,\n        entry.h,\n        0,\n        -1,\n        1,\n        1\n      );\n      ctx.restore();\n    }\n    this.compose();\n  }\n\n  paintSolidColorImageMask() {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.ctx.fillRect(0, 0, 1, 1);\n    this.compose();\n  }\n\n  // Marked content\n\n  markPoint(tag) {\n    // TODO Marked content.\n  }\n\n  markPointProps(tag, properties) {\n    // TODO Marked content.\n  }\n\n  beginMarkedContent(tag) {\n    this.markedContentStack.push({\n      visible: true,\n    });\n  }\n\n  beginMarkedContentProps(tag, properties) {\n    if (tag === \"OC\") {\n      this.markedContentStack.push({\n        visible: this.optionalContentConfig.isVisible(properties),\n      });\n    } else {\n      this.markedContentStack.push({\n        visible: true,\n      });\n    }\n    this.contentVisible = this.isContentVisible();\n  }\n\n  endMarkedContent() {\n    this.markedContentStack.pop();\n    this.contentVisible = this.isContentVisible();\n  }\n\n  // Compatibility\n\n  beginCompat() {\n    // TODO ignore undefined operators (should we do that anyway?)\n  }\n\n  endCompat() {\n    // TODO stop ignoring undefined operators\n  }\n\n  // Helper functions\n\n  consumePath(clipBox) {\n    const isEmpty = this.current.isEmptyClip();\n    if (this.pendingClip) {\n      this.current.updateClipFromPath();\n    }\n    if (!this.pendingClip) {\n      this.compose(clipBox);\n    }\n    const ctx = this.ctx;\n    if (this.pendingClip) {\n      if (!isEmpty) {\n        if (this.pendingClip === EO_CLIP) {\n          ctx.clip(\"evenodd\");\n        } else {\n          ctx.clip();\n        }\n      }\n      this.pendingClip = null;\n    }\n    this.current.startNewPathAndClipBox(this.current.clipBox);\n    ctx.beginPath();\n  }\n\n  getSinglePixelWidth() {\n    if (!this._cachedGetSinglePixelWidth) {\n      const m = getCurrentTransform(this.ctx);\n      if (m[1] === 0 && m[2] === 0) {\n        // Fast path\n        this._cachedGetSinglePixelWidth =\n          1 / Math.min(Math.abs(m[0]), Math.abs(m[3]));\n      } else {\n        const absDet = Math.abs(m[0] * m[3] - m[2] * m[1]);\n        const normX = Math.hypot(m[0], m[2]);\n        const normY = Math.hypot(m[1], m[3]);\n        this._cachedGetSinglePixelWidth = Math.max(normX, normY) / absDet;\n      }\n    }\n    return this._cachedGetSinglePixelWidth;\n  }\n\n  getScaleForStroking() {\n    // A pixel has thicknessX = thicknessY = 1;\n    // A transformed pixel is a parallelogram and the thicknesses\n    // corresponds to the heights.\n    // The goal of this function is to rescale before setting the\n    // lineWidth in order to have both thicknesses greater or equal\n    // to 1 after transform.\n    if (this._cachedScaleForStroking[0] === -1) {\n      const { lineWidth } = this.current;\n      const { a, b, c, d } = this.ctx.getTransform();\n      let scaleX, scaleY;\n\n      if (b === 0 && c === 0) {\n        // Fast path\n        const normX = Math.abs(a);\n        const normY = Math.abs(d);\n        if (normX === normY) {\n          if (lineWidth === 0) {\n            scaleX = scaleY = 1 / normX;\n          } else {\n            const scaledLineWidth = normX * lineWidth;\n            scaleX = scaleY = scaledLineWidth < 1 ? 1 / scaledLineWidth : 1;\n          }\n        } else if (lineWidth === 0) {\n          scaleX = 1 / normX;\n          scaleY = 1 / normY;\n        } else {\n          const scaledXLineWidth = normX * lineWidth;\n          const scaledYLineWidth = normY * lineWidth;\n          scaleX = scaledXLineWidth < 1 ? 1 / scaledXLineWidth : 1;\n          scaleY = scaledYLineWidth < 1 ? 1 / scaledYLineWidth : 1;\n        }\n      } else {\n        // A pixel (base (x, y)) is transformed by M into a parallelogram:\n        //  - its area is |det(M)|;\n        //  - heightY (orthogonal to Mx) has a length: |det(M)| / norm(Mx);\n        //  - heightX (orthogonal to My) has a length: |det(M)| / norm(My).\n        // heightX and heightY are the thicknesses of the transformed pixel\n        // and they must be both greater or equal to 1.\n        const absDet = Math.abs(a * d - b * c);\n        const normX = Math.hypot(a, b);\n        const normY = Math.hypot(c, d);\n        if (lineWidth === 0) {\n          scaleX = normY / absDet;\n          scaleY = normX / absDet;\n        } else {\n          const baseArea = lineWidth * absDet;\n          scaleX = normY > baseArea ? normY / baseArea : 1;\n          scaleY = normX > baseArea ? normX / baseArea : 1;\n        }\n      }\n      this._cachedScaleForStroking[0] = scaleX;\n      this._cachedScaleForStroking[1] = scaleY;\n    }\n    return this._cachedScaleForStroking;\n  }\n\n  // Rescale before stroking in order to have a final lineWidth\n  // with both thicknesses greater or equal to 1.\n  rescaleAndStroke(saveRestore) {\n    const { ctx } = this;\n    const { lineWidth } = this.current;\n    const [scaleX, scaleY] = this.getScaleForStroking();\n\n    ctx.lineWidth = lineWidth || 1;\n\n    if (scaleX === 1 && scaleY === 1) {\n      ctx.stroke();\n      return;\n    }\n\n    const dashes = ctx.getLineDash();\n    if (saveRestore) {\n      ctx.save();\n    }\n\n    ctx.scale(scaleX, scaleY);\n\n    // How the dashed line is rendered depends on the current transform...\n    // so we added a rescale to handle too thin lines and consequently\n    // the way the line is dashed will be modified.\n    // If scaleX === scaleY, the dashed lines will be rendered correctly\n    // else we'll have some bugs (but only with too thin lines).\n    // Here we take the max... why not taking the min... or something else.\n    // Anyway, as said it's buggy when scaleX !== scaleY.\n    if (dashes.length > 0) {\n      const scale = Math.max(scaleX, scaleY);\n      ctx.setLineDash(dashes.map(x => x / scale));\n      ctx.lineDashOffset /= scale;\n    }\n\n    ctx.stroke();\n\n    if (saveRestore) {\n      ctx.restore();\n    }\n  }\n\n  isContentVisible() {\n    for (let i = this.markedContentStack.length - 1; i >= 0; i--) {\n      if (!this.markedContentStack[i].visible) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nfor (const op in OPS) {\n  if (CanvasGraphics.prototype[op] !== undefined) {\n    CanvasGraphics.prototype[OPS[op]] = CanvasGraphics.prototype[op];\n  }\n}\n\nexport { CanvasGraphics };\n", "/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FormatError, info, unreachable, Util } from \"../shared/util.js\";\nimport { getCurrentTransform } from \"./display_utils.js\";\n\nconst PathType = {\n  FILL: \"Fill\",\n  STROKE: \"Stroke\",\n  SHADING: \"Shading\",\n};\n\nfunction applyBoundingBox(ctx, bbox) {\n  if (!bbox) {\n    return;\n  }\n  const width = bbox[2] - bbox[0];\n  const height = bbox[3] - bbox[1];\n  const region = new Path2D();\n  region.rect(bbox[0], bbox[1], width, height);\n  ctx.clip(region);\n}\n\nclass BaseShadingPattern {\n  constructor() {\n    if (this.constructor === BaseShadingPattern) {\n      unreachable(\"Cannot initialize BaseShadingPattern.\");\n    }\n  }\n\n  getPattern() {\n    unreachable(\"Abstract method `getPattern` called.\");\n  }\n}\n\nclass RadialAxialShadingPattern extends BaseShadingPattern {\n  constructor(IR) {\n    super();\n    this._type = IR[1];\n    this._bbox = IR[2];\n    this._colorStops = IR[3];\n    this._p0 = IR[4];\n    this._p1 = IR[5];\n    this._r0 = IR[6];\n    this._r1 = IR[7];\n    this.matrix = null;\n  }\n\n  _createGradient(ctx) {\n    let grad;\n    if (this._type === \"axial\") {\n      grad = ctx.createLinearGradient(\n        this._p0[0],\n        this._p0[1],\n        this._p1[0],\n        this._p1[1]\n      );\n    } else if (this._type === \"radial\") {\n      grad = ctx.createRadialGradient(\n        this._p0[0],\n        this._p0[1],\n        this._r0,\n        this._p1[0],\n        this._p1[1],\n        this._r1\n      );\n    }\n\n    for (const colorStop of this._colorStops) {\n      grad.addColorStop(colorStop[0], colorStop[1]);\n    }\n    return grad;\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    let pattern;\n    if (pathType === PathType.STROKE || pathType === PathType.FILL) {\n      const ownerBBox = owner.current.getClippedPathBoundingBox(\n        pathType,\n        getCurrentTransform(ctx)\n      ) || [0, 0, 0, 0];\n      // Create a canvas that is only as big as the current path. This doesn't\n      // allow us to cache the pattern, but it generally creates much smaller\n      // canvases and saves memory use. See bug 1722807 for an example.\n      const width = Math.ceil(ownerBBox[2] - ownerBBox[0]) || 1;\n      const height = Math.ceil(ownerBBox[3] - ownerBBox[1]) || 1;\n\n      const tmpCanvas = owner.cachedCanvases.getCanvas(\n        \"pattern\",\n        width,\n        height,\n        true\n      );\n\n      const tmpCtx = tmpCanvas.context;\n      tmpCtx.clearRect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n      tmpCtx.beginPath();\n      tmpCtx.rect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n      // Non shading fill patterns are positioned relative to the base transform\n      // (usually the page's initial transform), but we may have created a\n      // smaller canvas based on the path, so we must account for the shift.\n      tmpCtx.translate(-ownerBBox[0], -ownerBBox[1]);\n      inverse = Util.transform(inverse, [\n        1,\n        0,\n        0,\n        1,\n        ownerBBox[0],\n        ownerBBox[1],\n      ]);\n\n      tmpCtx.transform(...owner.baseTransform);\n      if (this.matrix) {\n        tmpCtx.transform(...this.matrix);\n      }\n      applyBoundingBox(tmpCtx, this._bbox);\n\n      tmpCtx.fillStyle = this._createGradient(tmpCtx);\n      tmpCtx.fill();\n\n      pattern = ctx.createPattern(tmpCanvas.canvas, \"no-repeat\");\n      const domMatrix = new DOMMatrix(inverse);\n      pattern.setTransform(domMatrix);\n    } else {\n      // Shading fills are applied relative to the current matrix which is also\n      // how canvas gradients work, so there's no need to do anything special\n      // here.\n      applyBoundingBox(ctx, this._bbox);\n      pattern = this._createGradient(ctx);\n    }\n    return pattern;\n  }\n}\n\nfunction drawTriangle(data, context, p1, p2, p3, c1, c2, c3) {\n  // Very basic Gouraud-shaded triangle rasterization algorithm.\n  const coords = context.coords,\n    colors = context.colors;\n  const bytes = data.data,\n    rowSize = data.width * 4;\n  let tmp;\n  if (coords[p1 + 1] > coords[p2 + 1]) {\n    tmp = p1;\n    p1 = p2;\n    p2 = tmp;\n    tmp = c1;\n    c1 = c2;\n    c2 = tmp;\n  }\n  if (coords[p2 + 1] > coords[p3 + 1]) {\n    tmp = p2;\n    p2 = p3;\n    p3 = tmp;\n    tmp = c2;\n    c2 = c3;\n    c3 = tmp;\n  }\n  if (coords[p1 + 1] > coords[p2 + 1]) {\n    tmp = p1;\n    p1 = p2;\n    p2 = tmp;\n    tmp = c1;\n    c1 = c2;\n    c2 = tmp;\n  }\n  const x1 = (coords[p1] + context.offsetX) * context.scaleX;\n  const y1 = (coords[p1 + 1] + context.offsetY) * context.scaleY;\n  const x2 = (coords[p2] + context.offsetX) * context.scaleX;\n  const y2 = (coords[p2 + 1] + context.offsetY) * context.scaleY;\n  const x3 = (coords[p3] + context.offsetX) * context.scaleX;\n  const y3 = (coords[p3 + 1] + context.offsetY) * context.scaleY;\n  if (y1 >= y3) {\n    return;\n  }\n  const c1r = colors[c1],\n    c1g = colors[c1 + 1],\n    c1b = colors[c1 + 2];\n  const c2r = colors[c2],\n    c2g = colors[c2 + 1],\n    c2b = colors[c2 + 2];\n  const c3r = colors[c3],\n    c3g = colors[c3 + 1],\n    c3b = colors[c3 + 2];\n\n  const minY = Math.round(y1),\n    maxY = Math.round(y3);\n  let xa, car, cag, cab;\n  let xb, cbr, cbg, cbb;\n  for (let y = minY; y <= maxY; y++) {\n    if (y < y2) {\n      let k;\n      if (y < y1) {\n        k = 0;\n      } else {\n        k = (y1 - y) / (y1 - y2);\n      }\n      xa = x1 - (x1 - x2) * k;\n      car = c1r - (c1r - c2r) * k;\n      cag = c1g - (c1g - c2g) * k;\n      cab = c1b - (c1b - c2b) * k;\n    } else {\n      let k;\n      if (y > y3) {\n        k = 1;\n      } else if (y2 === y3) {\n        k = 0;\n      } else {\n        k = (y2 - y) / (y2 - y3);\n      }\n      xa = x2 - (x2 - x3) * k;\n      car = c2r - (c2r - c3r) * k;\n      cag = c2g - (c2g - c3g) * k;\n      cab = c2b - (c2b - c3b) * k;\n    }\n\n    let k;\n    if (y < y1) {\n      k = 0;\n    } else if (y > y3) {\n      k = 1;\n    } else {\n      k = (y1 - y) / (y1 - y3);\n    }\n    xb = x1 - (x1 - x3) * k;\n    cbr = c1r - (c1r - c3r) * k;\n    cbg = c1g - (c1g - c3g) * k;\n    cbb = c1b - (c1b - c3b) * k;\n    const x1_ = Math.round(Math.min(xa, xb));\n    const x2_ = Math.round(Math.max(xa, xb));\n    let j = rowSize * y + x1_ * 4;\n    for (let x = x1_; x <= x2_; x++) {\n      k = (xa - x) / (xa - xb);\n      if (k < 0) {\n        k = 0;\n      } else if (k > 1) {\n        k = 1;\n      }\n      bytes[j++] = (car - (car - cbr) * k) | 0;\n      bytes[j++] = (cag - (cag - cbg) * k) | 0;\n      bytes[j++] = (cab - (cab - cbb) * k) | 0;\n      bytes[j++] = 255;\n    }\n  }\n}\n\nfunction drawFigure(data, figure, context) {\n  const ps = figure.coords;\n  const cs = figure.colors;\n  let i, ii;\n  switch (figure.type) {\n    case \"lattice\":\n      const verticesPerRow = figure.verticesPerRow;\n      const rows = Math.floor(ps.length / verticesPerRow) - 1;\n      const cols = verticesPerRow - 1;\n      for (i = 0; i < rows; i++) {\n        let q = i * verticesPerRow;\n        for (let j = 0; j < cols; j++, q++) {\n          drawTriangle(\n            data,\n            context,\n            ps[q],\n            ps[q + 1],\n            ps[q + verticesPerRow],\n            cs[q],\n            cs[q + 1],\n            cs[q + verticesPerRow]\n          );\n          drawTriangle(\n            data,\n            context,\n            ps[q + verticesPerRow + 1],\n            ps[q + 1],\n            ps[q + verticesPerRow],\n            cs[q + verticesPerRow + 1],\n            cs[q + 1],\n            cs[q + verticesPerRow]\n          );\n        }\n      }\n      break;\n    case \"triangles\":\n      for (i = 0, ii = ps.length; i < ii; i += 3) {\n        drawTriangle(\n          data,\n          context,\n          ps[i],\n          ps[i + 1],\n          ps[i + 2],\n          cs[i],\n          cs[i + 1],\n          cs[i + 2]\n        );\n      }\n      break;\n    default:\n      throw new Error(\"illegal figure\");\n  }\n}\n\nclass MeshShadingPattern extends BaseShadingPattern {\n  constructor(IR) {\n    super();\n    this._coords = IR[2];\n    this._colors = IR[3];\n    this._figures = IR[4];\n    this._bounds = IR[5];\n    this._bbox = IR[7];\n    this._background = IR[8];\n    this.matrix = null;\n  }\n\n  _createMeshCanvas(combinedScale, backgroundColor, cachedCanvases) {\n    // we will increase scale on some weird factor to let antialiasing take\n    // care of \"rough\" edges\n    const EXPECTED_SCALE = 1.1;\n    // MAX_PATTERN_SIZE is used to avoid OOM situation.\n    const MAX_PATTERN_SIZE = 3000; // 10in @ 300dpi shall be enough\n    // We need to keep transparent border around our pattern for fill():\n    // createPattern with 'no-repeat' will bleed edges across entire area.\n    const BORDER_SIZE = 2;\n\n    const offsetX = Math.floor(this._bounds[0]);\n    const offsetY = Math.floor(this._bounds[1]);\n    const boundsWidth = Math.ceil(this._bounds[2]) - offsetX;\n    const boundsHeight = Math.ceil(this._bounds[3]) - offsetY;\n\n    const width = Math.min(\n      Math.ceil(Math.abs(boundsWidth * combinedScale[0] * EXPECTED_SCALE)),\n      MAX_PATTERN_SIZE\n    );\n    const height = Math.min(\n      Math.ceil(Math.abs(boundsHeight * combinedScale[1] * EXPECTED_SCALE)),\n      MAX_PATTERN_SIZE\n    );\n    const scaleX = boundsWidth / width;\n    const scaleY = boundsHeight / height;\n\n    const context = {\n      coords: this._coords,\n      colors: this._colors,\n      offsetX: -offsetX,\n      offsetY: -offsetY,\n      scaleX: 1 / scaleX,\n      scaleY: 1 / scaleY,\n    };\n\n    const paddedWidth = width + BORDER_SIZE * 2;\n    const paddedHeight = height + BORDER_SIZE * 2;\n\n    const tmpCanvas = cachedCanvases.getCanvas(\n      \"mesh\",\n      paddedWidth,\n      paddedHeight,\n      false\n    );\n    const tmpCtx = tmpCanvas.context;\n\n    const data = tmpCtx.createImageData(width, height);\n    if (backgroundColor) {\n      const bytes = data.data;\n      for (let i = 0, ii = bytes.length; i < ii; i += 4) {\n        bytes[i] = backgroundColor[0];\n        bytes[i + 1] = backgroundColor[1];\n        bytes[i + 2] = backgroundColor[2];\n        bytes[i + 3] = 255;\n      }\n    }\n    for (const figure of this._figures) {\n      drawFigure(data, figure, context);\n    }\n    tmpCtx.putImageData(data, BORDER_SIZE, BORDER_SIZE);\n    const canvas = tmpCanvas.canvas;\n\n    return {\n      canvas,\n      offsetX: offsetX - BORDER_SIZE * scaleX,\n      offsetY: offsetY - BORDER_SIZE * scaleY,\n      scaleX,\n      scaleY,\n    };\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    applyBoundingBox(ctx, this._bbox);\n    let scale;\n    if (pathType === PathType.SHADING) {\n      scale = Util.singularValueDecompose2dScale(getCurrentTransform(ctx));\n    } else {\n      // Obtain scale from matrix and current transformation matrix.\n      scale = Util.singularValueDecompose2dScale(owner.baseTransform);\n      if (this.matrix) {\n        const matrixScale = Util.singularValueDecompose2dScale(this.matrix);\n        scale = [scale[0] * matrixScale[0], scale[1] * matrixScale[1]];\n      }\n    }\n\n    // Rasterizing on the main thread since sending/queue large canvases\n    // might cause OOM.\n    const temporaryPatternCanvas = this._createMeshCanvas(\n      scale,\n      pathType === PathType.SHADING ? null : this._background,\n      owner.cachedCanvases\n    );\n\n    if (pathType !== PathType.SHADING) {\n      ctx.setTransform(...owner.baseTransform);\n      if (this.matrix) {\n        ctx.transform(...this.matrix);\n      }\n    }\n\n    ctx.translate(\n      temporaryPatternCanvas.offsetX,\n      temporaryPatternCanvas.offsetY\n    );\n    ctx.scale(temporaryPatternCanvas.scaleX, temporaryPatternCanvas.scaleY);\n\n    return ctx.createPattern(temporaryPatternCanvas.canvas, \"no-repeat\");\n  }\n}\n\nclass DummyShadingPattern extends BaseShadingPattern {\n  getPattern() {\n    return \"hotpink\";\n  }\n}\n\nfunction getShadingPattern(IR) {\n  switch (IR[0]) {\n    case \"RadialAxial\":\n      return new RadialAxialShadingPattern(IR);\n    case \"Mesh\":\n      return new MeshShadingPattern(IR);\n    case \"Dummy\":\n      return new DummyShadingPattern();\n  }\n  throw new Error(`Unknown IR type: ${IR[0]}`);\n}\n\nconst PaintType = {\n  COLORED: 1,\n  UNCOLORED: 2,\n};\n\nclass TilingPattern {\n  // 10in @ 300dpi shall be enough.\n  static MAX_PATTERN_SIZE = 3000;\n\n  constructor(IR, color, ctx, canvasGraphicsFactory, baseTransform) {\n    this.operatorList = IR[2];\n    this.matrix = IR[3] || [1, 0, 0, 1, 0, 0];\n    this.bbox = IR[4];\n    this.xstep = IR[5];\n    this.ystep = IR[6];\n    this.paintType = IR[7];\n    this.tilingType = IR[8];\n    this.color = color;\n    this.ctx = ctx;\n    this.canvasGraphicsFactory = canvasGraphicsFactory;\n    this.baseTransform = baseTransform;\n  }\n\n  createPatternCanvas(owner) {\n    const operatorList = this.operatorList;\n    const bbox = this.bbox;\n    const xstep = this.xstep;\n    const ystep = this.ystep;\n    const paintType = this.paintType;\n    const tilingType = this.tilingType;\n    const color = this.color;\n    const canvasGraphicsFactory = this.canvasGraphicsFactory;\n\n    info(\"TilingType: \" + tilingType);\n\n    // A tiling pattern as defined by PDF spec 8.7.2 is a cell whose size is\n    // described by bbox, and may repeat regularly by shifting the cell by\n    // xstep and ystep.\n    // Because the HTML5 canvas API does not support pattern repetition with\n    // gaps in between, we use the xstep/ystep instead of the bbox's size.\n    //\n    // This has the following consequences (similarly for ystep):\n    //\n    // - If xstep is the same as bbox, then there is no observable difference.\n    //\n    // - If xstep is larger than bbox, then the pattern canvas is partially\n    //   empty: the area bounded by bbox is painted, the outside area is void.\n    //\n    // - If xstep is smaller than bbox, then the pixels between xstep and the\n    //   bbox boundary will be missing. This is INCORRECT behavior.\n    //   \"Figures on adjacent tiles should not overlap\" (PDF spec 8.7.3.1),\n    //   but overlapping cells without common pixels are still valid.\n    //   TODO: Fix the implementation, to allow this scenario to be painted\n    //   correctly.\n\n    const x0 = bbox[0],\n      y0 = bbox[1],\n      x1 = bbox[2],\n      y1 = bbox[3];\n\n    // Obtain scale from matrix and current transformation matrix.\n    const matrixScale = Util.singularValueDecompose2dScale(this.matrix);\n    const curMatrixScale = Util.singularValueDecompose2dScale(\n      this.baseTransform\n    );\n    const combinedScale = [\n      matrixScale[0] * curMatrixScale[0],\n      matrixScale[1] * curMatrixScale[1],\n    ];\n\n    // Use width and height values that are as close as possible to the end\n    // result when the pattern is used. Too low value makes the pattern look\n    // blurry. Too large value makes it look too crispy.\n    const dimx = this.getSizeAndScale(\n      xstep,\n      this.ctx.canvas.width,\n      combinedScale[0]\n    );\n    const dimy = this.getSizeAndScale(\n      ystep,\n      this.ctx.canvas.height,\n      combinedScale[1]\n    );\n\n    const tmpCanvas = owner.cachedCanvases.getCanvas(\n      \"pattern\",\n      dimx.size,\n      dimy.size,\n      true\n    );\n    const tmpCtx = tmpCanvas.context;\n    const graphics = canvasGraphicsFactory.createCanvasGraphics(tmpCtx);\n    graphics.groupLevel = owner.groupLevel;\n\n    this.setFillAndStrokeStyleToContext(graphics, paintType, color);\n\n    let adjustedX0 = x0;\n    let adjustedY0 = y0;\n    let adjustedX1 = x1;\n    let adjustedY1 = y1;\n    // Some bounding boxes have negative x0/y0 coordinates which will cause the\n    // some of the drawing to be off of the canvas. To avoid this shift the\n    // bounding box over.\n    if (x0 < 0) {\n      adjustedX0 = 0;\n      adjustedX1 += Math.abs(x0);\n    }\n    if (y0 < 0) {\n      adjustedY0 = 0;\n      adjustedY1 += Math.abs(y0);\n    }\n    tmpCtx.translate(-(dimx.scale * adjustedX0), -(dimy.scale * adjustedY0));\n    graphics.transform(dimx.scale, 0, 0, dimy.scale, 0, 0);\n\n    // To match CanvasGraphics beginDrawing we must save the context here or\n    // else we end up with unbalanced save/restores.\n    tmpCtx.save();\n\n    this.clipBbox(graphics, adjustedX0, adjustedY0, adjustedX1, adjustedY1);\n\n    graphics.baseTransform = getCurrentTransform(graphics.ctx);\n\n    graphics.executeOperatorList(operatorList);\n\n    graphics.endDrawing();\n\n    return {\n      canvas: tmpCanvas.canvas,\n      scaleX: dimx.scale,\n      scaleY: dimy.scale,\n      offsetX: adjustedX0,\n      offsetY: adjustedY0,\n    };\n  }\n\n  getSizeAndScale(step, realOutputSize, scale) {\n    // xstep / ystep may be negative -- normalize.\n    step = Math.abs(step);\n    // MAX_PATTERN_SIZE is used to avoid OOM situation.\n    // Use the destination canvas's size if it is bigger than the hard-coded\n    // limit of MAX_PATTERN_SIZE to avoid clipping patterns that cover the\n    // whole canvas.\n    const maxSize = Math.max(TilingPattern.MAX_PATTERN_SIZE, realOutputSize);\n    let size = Math.ceil(step * scale);\n    if (size >= maxSize) {\n      size = maxSize;\n    } else {\n      scale = size / step;\n    }\n    return { scale, size };\n  }\n\n  clipBbox(graphics, x0, y0, x1, y1) {\n    const bboxWidth = x1 - x0;\n    const bboxHeight = y1 - y0;\n    graphics.ctx.rect(x0, y0, bboxWidth, bboxHeight);\n    graphics.current.updateRectMinMax(getCurrentTransform(graphics.ctx), [\n      x0,\n      y0,\n      x1,\n      y1,\n    ]);\n    graphics.clip();\n    graphics.endPath();\n  }\n\n  setFillAndStrokeStyleToContext(graphics, paintType, color) {\n    const context = graphics.ctx,\n      current = graphics.current;\n    switch (paintType) {\n      case PaintType.COLORED:\n        const ctx = this.ctx;\n        context.fillStyle = ctx.fillStyle;\n        context.strokeStyle = ctx.strokeStyle;\n        current.fillColor = ctx.fillStyle;\n        current.strokeColor = ctx.strokeStyle;\n        break;\n      case PaintType.UNCOLORED:\n        const cssColor = Util.makeHexColor(color[0], color[1], color[2]);\n        context.fillStyle = cssColor;\n        context.strokeStyle = cssColor;\n        // Set color needed by image masks (fixes issues 3226 and 8741).\n        current.fillColor = cssColor;\n        current.strokeColor = cssColor;\n        break;\n      default:\n        throw new FormatError(`Unsupported paint type: ${paintType}`);\n    }\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    // PDF spec 8.7.2 NOTE 1: pattern's matrix is relative to initial matrix.\n    let matrix = inverse;\n    if (pathType !== PathType.SHADING) {\n      matrix = Util.transform(matrix, owner.baseTransform);\n      if (this.matrix) {\n        matrix = Util.transform(matrix, this.matrix);\n      }\n    }\n\n    const temporaryPatternCanvas = this.createPatternCanvas(owner);\n\n    let domMatrix = new DOMMatrix(matrix);\n    // Rescale and so that the ctx.createPattern call generates a pattern with\n    // the desired size.\n    domMatrix = domMatrix.translate(\n      temporaryPatternCanvas.offsetX,\n      temporaryPatternCanvas.offsetY\n    );\n    domMatrix = domMatrix.scale(\n      1 / temporaryPatternCanvas.scaleX,\n      1 / temporaryPatternCanvas.scaleY\n    );\n\n    const pattern = ctx.createPattern(temporaryPatternCanvas.canvas, \"repeat\");\n    pattern.setTransform(domMatrix);\n\n    return pattern;\n  }\n}\n\nexport { getShadingPattern, PathType, TilingPattern };\n", "/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FeatureTest, ImageKind } from \"./util.js\";\n\nfunction convertToRGBA(params) {\n  switch (params.kind) {\n    case ImageKind.GRAYSCALE_1BPP:\n      return convertBlackAndWhiteToRGBA(params);\n    case ImageKind.RGB_24BPP:\n      return convertRGBToRGBA(params);\n  }\n\n  return null;\n}\n\nfunction convertBlackAndWhiteToRGBA({\n  src,\n  srcPos = 0,\n  dest,\n  width,\n  height,\n  nonBlackColor = 0xffffffff,\n  inverseDecode = false,\n}) {\n  const black = FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n  const [zeroMapping, oneMapping] = inverseDecode\n    ? [nonBlackColor, black]\n    : [black, nonBlackColor];\n  const widthInSource = width >> 3;\n  const widthRemainder = width & 7;\n  const srcLength = src.length;\n  dest = new Uint32Array(dest.buffer);\n  let destPos = 0;\n\n  for (let i = 0; i < height; i++) {\n    for (const max = srcPos + widthInSource; srcPos < max; srcPos++) {\n      const elem = srcPos < srcLength ? src[srcPos] : 255;\n      dest[destPos++] = elem & 0b10000000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1000000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b100000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b10000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b100 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b10 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1 ? oneMapping : zeroMapping;\n    }\n    if (widthRemainder === 0) {\n      continue;\n    }\n    const elem = srcPos < srcLength ? src[srcPos++] : 255;\n    for (let j = 0; j < widthRemainder; j++) {\n      dest[destPos++] = elem & (1 << (7 - j)) ? oneMapping : zeroMapping;\n    }\n  }\n  return { srcPos, destPos };\n}\n\nfunction convertRGBToRGBA({\n  src,\n  srcPos = 0,\n  dest,\n  destPos = 0,\n  width,\n  height,\n}) {\n  let i = 0;\n  const len32 = src.length >> 2;\n  const src32 = new Uint32Array(src.buffer, srcPos, len32);\n\n  if (FeatureTest.isLittleEndian) {\n    // It's a way faster to do the shuffle manually instead of working\n    // component by component with some Uint8 arrays.\n    for (; i < len32 - 2; i += 3, destPos += 4) {\n      const s1 = src32[i]; // R2B1G1R1\n      const s2 = src32[i + 1]; // G3R3B2G2\n      const s3 = src32[i + 2]; // B4G4R4B3\n\n      dest[destPos] = s1 | 0xff000000;\n      dest[destPos + 1] = (s1 >>> 24) | (s2 << 8) | 0xff000000;\n      dest[destPos + 2] = (s2 >>> 16) | (s3 << 16) | 0xff000000;\n      dest[destPos + 3] = (s3 >>> 8) | 0xff000000;\n    }\n\n    for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n      dest[destPos++] =\n        src[j] | (src[j + 1] << 8) | (src[j + 2] << 16) | 0xff000000;\n    }\n  } else {\n    for (; i < len32 - 2; i += 3, destPos += 4) {\n      const s1 = src32[i]; // R1G1B1R2\n      const s2 = src32[i + 1]; // G2B2R3G3\n      const s3 = src32[i + 2]; // B3R4G4B4\n\n      dest[destPos] = s1 | 0xff;\n      dest[destPos + 1] = (s1 << 24) | (s2 >>> 8) | 0xff;\n      dest[destPos + 2] = (s2 << 16) | (s3 >>> 16) | 0xff;\n      dest[destPos + 3] = (s3 << 8) | 0xff;\n    }\n\n    for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n      dest[destPos++] =\n        (src[j] << 24) | (src[j + 1] << 16) | (src[j + 2] << 8) | 0xff;\n    }\n  }\n\n  return { srcPos, destPos };\n}\n\nfunction grayToRGBA(src, dest) {\n  if (FeatureTest.isLittleEndian) {\n    for (let i = 0, ii = src.length; i < ii; i++) {\n      dest[i] = (src[i] * 0x10101) | 0xff000000;\n    }\n  } else {\n    for (let i = 0, ii = src.length; i < ii; i++) {\n      dest[i] = (src[i] * 0x1010100) | 0x000000ff;\n    }\n  }\n}\n\nexport { convertBlackAndWhiteToRGBA, convertToRGBA, grayToRGBA };\n", "/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {Object} GlobalWorkerOptionsType\n * @property {Worker | null} workerPort - Defines global port for worker\n *   process. Overrides the `workerSrc` option.\n * @property {string} workerSrc - A string containing the path and filename\n *   of the worker file.\n *\n *   NOTE: The `workerSrc` option should always be set, in order to prevent any\n *         issues when using the PDF.js library.\n */\n\n/** @type {GlobalWorkerOptionsType} */\nconst GlobalWorkerOptions = Object.create(null);\n\nGlobalWorkerOptions.workerPort = null;\nGlobalWorkerOptions.workerSrc = \"\";\n\nexport { GlobalWorkerOptions };\n", "/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AbortException,\n  assert,\n  MissingPDFException,\n  PasswordException,\n  PromiseCapability,\n  UnexpectedResponseException,\n  UnknownErrorException,\n  unreachable,\n} from \"./util.js\";\n\nconst CallbackKind = {\n  UNKNOWN: 0,\n  DATA: 1,\n  ERROR: 2,\n};\n\nconst StreamKind = {\n  UNKNOWN: 0,\n  CANCEL: 1,\n  CANCEL_COMPLETE: 2,\n  CLOSE: 3,\n  ENQUEUE: 4,\n  ERROR: 5,\n  PULL: 6,\n  PULL_COMPLETE: 7,\n  START_COMPLETE: 8,\n};\n\nfunction wrapReason(reason) {\n  if (\n    !(\n      reason instanceof Error ||\n      (typeof reason === \"object\" && reason !== null)\n    )\n  ) {\n    unreachable(\n      'wrapReason: Expected \"reason\" to be a (possibly cloned) Error.'\n    );\n  }\n  switch (reason.name) {\n    case \"AbortException\":\n      return new AbortException(reason.message);\n    case \"MissingPDFException\":\n      return new MissingPDFException(reason.message);\n    case \"PasswordException\":\n      return new PasswordException(reason.message, reason.code);\n    case \"UnexpectedResponseException\":\n      return new UnexpectedResponseException(reason.message, reason.status);\n    case \"UnknownErrorException\":\n      return new UnknownErrorException(reason.message, reason.details);\n    default:\n      return new UnknownErrorException(reason.message, reason.toString());\n  }\n}\n\nclass MessageHandler {\n  constructor(sourceName, targetName, comObj) {\n    this.sourceName = sourceName;\n    this.targetName = targetName;\n    this.comObj = comObj;\n    this.callbackId = 1;\n    this.streamId = 1;\n    this.streamSinks = Object.create(null);\n    this.streamControllers = Object.create(null);\n    this.callbackCapabilities = Object.create(null);\n    this.actionHandler = Object.create(null);\n\n    this._onComObjOnMessage = event => {\n      const data = event.data;\n      if (data.targetName !== this.sourceName) {\n        return;\n      }\n      if (data.stream) {\n        this.#processStreamMessage(data);\n        return;\n      }\n      if (data.callback) {\n        const callbackId = data.callbackId;\n        const capability = this.callbackCapabilities[callbackId];\n        if (!capability) {\n          throw new Error(`Cannot resolve callback ${callbackId}`);\n        }\n        delete this.callbackCapabilities[callbackId];\n\n        if (data.callback === CallbackKind.DATA) {\n          capability.resolve(data.data);\n        } else if (data.callback === CallbackKind.ERROR) {\n          capability.reject(wrapReason(data.reason));\n        } else {\n          throw new Error(\"Unexpected callback case\");\n        }\n        return;\n      }\n      const action = this.actionHandler[data.action];\n      if (!action) {\n        throw new Error(`Unknown action from worker: ${data.action}`);\n      }\n      if (data.callbackId) {\n        const cbSourceName = this.sourceName;\n        const cbTargetName = data.sourceName;\n\n        new Promise(function (resolve) {\n          resolve(action(data.data));\n        }).then(\n          function (result) {\n            comObj.postMessage({\n              sourceName: cbSourceName,\n              targetName: cbTargetName,\n              callback: CallbackKind.DATA,\n              callbackId: data.callbackId,\n              data: result,\n            });\n          },\n          function (reason) {\n            comObj.postMessage({\n              sourceName: cbSourceName,\n              targetName: cbTargetName,\n              callback: CallbackKind.ERROR,\n              callbackId: data.callbackId,\n              reason: wrapReason(reason),\n            });\n          }\n        );\n        return;\n      }\n      if (data.streamId) {\n        this.#createStreamSink(data);\n        return;\n      }\n      action(data.data);\n    };\n    comObj.addEventListener(\"message\", this._onComObjOnMessage);\n  }\n\n  on(actionName, handler) {\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      assert(\n        typeof handler === \"function\",\n        'MessageHandler.on: Expected \"handler\" to be a function.'\n      );\n    }\n    const ah = this.actionHandler;\n    if (ah[actionName]) {\n      throw new Error(`There is already an actionName called \"${actionName}\"`);\n    }\n    ah[actionName] = handler;\n  }\n\n  /**\n   * Sends a message to the comObj to invoke the action with the supplied data.\n   * @param {string} actionName - Action to call.\n   * @param {JSON} data - JSON data to send.\n   * @param {Array} [transfers] - List of transfers/ArrayBuffers.\n   */\n  send(actionName, data, transfers) {\n    this.comObj.postMessage(\n      {\n        sourceName: this.sourceName,\n        targetName: this.targetName,\n        action: actionName,\n        data,\n      },\n      transfers\n    );\n  }\n\n  /**\n   * Sends a message to the comObj to invoke the action with the supplied data.\n   * Expects that the other side will callback with the response.\n   * @param {string} actionName - Action to call.\n   * @param {JSON} data - JSON data to send.\n   * @param {Array} [transfers] - List of transfers/ArrayBuffers.\n   * @returns {Promise} Promise to be resolved with response data.\n   */\n  sendWithPromise(actionName, data, transfers) {\n    const callbackId = this.callbackId++;\n    const capability = new PromiseCapability();\n    this.callbackCapabilities[callbackId] = capability;\n    try {\n      this.comObj.postMessage(\n        {\n          sourceName: this.sourceName,\n          targetName: this.targetName,\n          action: actionName,\n          callbackId,\n          data,\n        },\n        transfers\n      );\n    } catch (ex) {\n      capability.reject(ex);\n    }\n    return capability.promise;\n  }\n\n  /**\n   * Sends a message to the comObj to invoke the action with the supplied data.\n   * Expect that the other side will callback to signal 'start_complete'.\n   * @param {string} actionName - Action to call.\n   * @param {JSON} data - JSON data to send.\n   * @param {Object} queueingStrategy - Strategy to signal backpressure based on\n   *                 internal queue.\n   * @param {Array} [transfers] - List of transfers/ArrayBuffers.\n   * @returns {ReadableStream} ReadableStream to read data in chunks.\n   */\n  sendWithStream(actionName, data, queueingStrategy, transfers) {\n    const streamId = this.streamId++,\n      sourceName = this.sourceName,\n      targetName = this.targetName,\n      comObj = this.comObj;\n\n    return new ReadableStream(\n      {\n        start: controller => {\n          const startCapability = new PromiseCapability();\n          this.streamControllers[streamId] = {\n            controller,\n            startCall: startCapability,\n            pullCall: null,\n            cancelCall: null,\n            isClosed: false,\n          };\n          comObj.postMessage(\n            {\n              sourceName,\n              targetName,\n              action: actionName,\n              streamId,\n              data,\n              desiredSize: controller.desiredSize,\n            },\n            transfers\n          );\n          // Return Promise for Async process, to signal success/failure.\n          return startCapability.promise;\n        },\n\n        pull: controller => {\n          const pullCapability = new PromiseCapability();\n          this.streamControllers[streamId].pullCall = pullCapability;\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL,\n            streamId,\n            desiredSize: controller.desiredSize,\n          });\n          // Returning Promise will not call \"pull\"\n          // again until current pull is resolved.\n          return pullCapability.promise;\n        },\n\n        cancel: reason => {\n          assert(reason instanceof Error, \"cancel must have a valid reason\");\n          const cancelCapability = new PromiseCapability();\n          this.streamControllers[streamId].cancelCall = cancelCapability;\n          this.streamControllers[streamId].isClosed = true;\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.CANCEL,\n            streamId,\n            reason: wrapReason(reason),\n          });\n          // Return Promise to signal success or failure.\n          return cancelCapability.promise;\n        },\n      },\n      queueingStrategy\n    );\n  }\n\n  #createStreamSink(data) {\n    const streamId = data.streamId,\n      sourceName = this.sourceName,\n      targetName = data.sourceName,\n      comObj = this.comObj;\n    const self = this,\n      action = this.actionHandler[data.action];\n\n    const streamSink = {\n      enqueue(chunk, size = 1, transfers) {\n        if (this.isCancelled) {\n          return;\n        }\n        const lastDesiredSize = this.desiredSize;\n        this.desiredSize -= size;\n        // Enqueue decreases the desiredSize property of sink,\n        // so when it changes from positive to negative,\n        // set ready as unresolved promise.\n        if (lastDesiredSize > 0 && this.desiredSize <= 0) {\n          this.sinkCapability = new PromiseCapability();\n          this.ready = this.sinkCapability.promise;\n        }\n        comObj.postMessage(\n          {\n            sourceName,\n            targetName,\n            stream: StreamKind.ENQUEUE,\n            streamId,\n            chunk,\n          },\n          transfers\n        );\n      },\n\n      close() {\n        if (this.isCancelled) {\n          return;\n        }\n        this.isCancelled = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.CLOSE,\n          streamId,\n        });\n        delete self.streamSinks[streamId];\n      },\n\n      error(reason) {\n        assert(reason instanceof Error, \"error must have a valid reason\");\n        if (this.isCancelled) {\n          return;\n        }\n        this.isCancelled = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.ERROR,\n          streamId,\n          reason: wrapReason(reason),\n        });\n      },\n\n      sinkCapability: new PromiseCapability(),\n      onPull: null,\n      onCancel: null,\n      isCancelled: false,\n      desiredSize: data.desiredSize,\n      ready: null,\n    };\n\n    streamSink.sinkCapability.resolve();\n    streamSink.ready = streamSink.sinkCapability.promise;\n    this.streamSinks[streamId] = streamSink;\n\n    new Promise(function (resolve) {\n      resolve(action(data.data, streamSink));\n    }).then(\n      function () {\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.START_COMPLETE,\n          streamId,\n          success: true,\n        });\n      },\n      function (reason) {\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.START_COMPLETE,\n          streamId,\n          reason: wrapReason(reason),\n        });\n      }\n    );\n  }\n\n  #processStreamMessage(data) {\n    const streamId = data.streamId,\n      sourceName = this.sourceName,\n      targetName = data.sourceName,\n      comObj = this.comObj;\n    const streamController = this.streamControllers[streamId],\n      streamSink = this.streamSinks[streamId];\n\n    switch (data.stream) {\n      case StreamKind.START_COMPLETE:\n        if (data.success) {\n          streamController.startCall.resolve();\n        } else {\n          streamController.startCall.reject(wrapReason(data.reason));\n        }\n        break;\n      case StreamKind.PULL_COMPLETE:\n        if (data.success) {\n          streamController.pullCall.resolve();\n        } else {\n          streamController.pullCall.reject(wrapReason(data.reason));\n        }\n        break;\n      case StreamKind.PULL:\n        // Ignore any pull after close is called.\n        if (!streamSink) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL_COMPLETE,\n            streamId,\n            success: true,\n          });\n          break;\n        }\n        // Pull increases the desiredSize property of sink, so when it changes\n        // from negative to positive, set ready property as resolved promise.\n        if (streamSink.desiredSize <= 0 && data.desiredSize > 0) {\n          streamSink.sinkCapability.resolve();\n        }\n        // Reset desiredSize property of sink on every pull.\n        streamSink.desiredSize = data.desiredSize;\n\n        new Promise(function (resolve) {\n          resolve(streamSink.onPull?.());\n        }).then(\n          function () {\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.PULL_COMPLETE,\n              streamId,\n              success: true,\n            });\n          },\n          function (reason) {\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.PULL_COMPLETE,\n              streamId,\n              reason: wrapReason(reason),\n            });\n          }\n        );\n        break;\n      case StreamKind.ENQUEUE:\n        assert(streamController, \"enqueue should have stream controller\");\n        if (streamController.isClosed) {\n          break;\n        }\n        streamController.controller.enqueue(data.chunk);\n        break;\n      case StreamKind.CLOSE:\n        assert(streamController, \"close should have stream controller\");\n        if (streamController.isClosed) {\n          break;\n        }\n        streamController.isClosed = true;\n        streamController.controller.close();\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.ERROR:\n        assert(streamController, \"error should have stream controller\");\n        streamController.controller.error(wrapReason(data.reason));\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.CANCEL_COMPLETE:\n        if (data.success) {\n          streamController.cancelCall.resolve();\n        } else {\n          streamController.cancelCall.reject(wrapReason(data.reason));\n        }\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.CANCEL:\n        if (!streamSink) {\n          break;\n        }\n\n        new Promise(function (resolve) {\n          resolve(streamSink.onCancel?.(wrapReason(data.reason)));\n        }).then(\n          function () {\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.CANCEL_COMPLETE,\n              streamId,\n              success: true,\n            });\n          },\n          function (reason) {\n            comObj.postMessage({\n              sourceName,\n              targetName,\n              stream: StreamKind.CANCEL_COMPLETE,\n              streamId,\n              reason: wrapReason(reason),\n            });\n          }\n        );\n        streamSink.sinkCapability.reject(wrapReason(data.reason));\n        streamSink.isCancelled = true;\n        delete this.streamSinks[streamId];\n        break;\n      default:\n        throw new Error(\"Unexpected stream case\");\n    }\n  }\n\n  async #deleteStreamController(streamController, streamId) {\n    // Delete the `streamController` only when the start, pull, and cancel\n    // capabilities have settled, to prevent `TypeError`s.\n    await Promise.allSettled([\n      streamController.startCall?.promise,\n      streamController.pullCall?.promise,\n      streamController.cancelCall?.promise,\n    ]);\n    delete this.streamControllers[streamId];\n  }\n\n  destroy() {\n    this.comObj.removeEventListener(\"message\", this._onComObjOnMessage);\n  }\n}\n\nexport { MessageHandler };\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { objectFromMap } from \"../shared/util.js\";\n\nclass Metadata {\n  #metadataMap;\n\n  #data;\n\n  constructor({ parsedData, rawData }) {\n    this.#metadataMap = parsedData;\n    this.#data = rawData;\n  }\n\n  getRaw() {\n    return this.#data;\n  }\n\n  get(name) {\n    return this.#metadataMap.get(name) ?? null;\n  }\n\n  getAll() {\n    return objectFromMap(this.#metadataMap);\n  }\n\n  has(name) {\n    return this.#metadataMap.has(name);\n  }\n}\n\nexport { Metadata };\n", "/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { objectFromMap, unreachable, warn } from \"../shared/util.js\";\nimport { MurmurHash3_64 } from \"../shared/murmurhash3.js\";\n\nconst INTERNAL = Symbol(\"INTERNAL\");\n\nclass OptionalContentGroup {\n  #visible = true;\n\n  constructor(name, intent) {\n    this.name = name;\n    this.intent = intent;\n  }\n\n  /**\n   * @type {boolean}\n   */\n  get visible() {\n    return this.#visible;\n  }\n\n  /**\n   * @ignore\n   */\n  _setVisible(internal, visible) {\n    if (internal !== INTERNAL) {\n      unreachable(\"Internal method `_setVisible` called.\");\n    }\n    this.#visible = visible;\n  }\n}\n\nclass OptionalContentConfig {\n  #cachedGetHash = null;\n\n  #groups = new Map();\n\n  #initialHash = null;\n\n  #order = null;\n\n  constructor(data) {\n    this.name = null;\n    this.creator = null;\n\n    if (data === null) {\n      return;\n    }\n    this.name = data.name;\n    this.creator = data.creator;\n    this.#order = data.order;\n    for (const group of data.groups) {\n      this.#groups.set(\n        group.id,\n        new OptionalContentGroup(group.name, group.intent)\n      );\n    }\n\n    if (data.baseState === \"OFF\") {\n      for (const group of this.#groups.values()) {\n        group._setVisible(INTERNAL, false);\n      }\n    }\n\n    for (const on of data.on) {\n      this.#groups.get(on)._setVisible(INTERNAL, true);\n    }\n\n    for (const off of data.off) {\n      this.#groups.get(off)._setVisible(INTERNAL, false);\n    }\n\n    // The following code must always run *last* in the constructor.\n    this.#initialHash = this.getHash();\n  }\n\n  #evaluateVisibilityExpression(array) {\n    const length = array.length;\n    if (length < 2) {\n      return true;\n    }\n    const operator = array[0];\n    for (let i = 1; i < length; i++) {\n      const element = array[i];\n      let state;\n      if (Array.isArray(element)) {\n        state = this.#evaluateVisibilityExpression(element);\n      } else if (this.#groups.has(element)) {\n        state = this.#groups.get(element).visible;\n      } else {\n        warn(`Optional content group not found: ${element}`);\n        return true;\n      }\n      switch (operator) {\n        case \"And\":\n          if (!state) {\n            return false;\n          }\n          break;\n        case \"Or\":\n          if (state) {\n            return true;\n          }\n          break;\n        case \"Not\":\n          return !state;\n        default:\n          return true;\n      }\n    }\n    return operator === \"And\";\n  }\n\n  isVisible(group) {\n    if (this.#groups.size === 0) {\n      return true;\n    }\n    if (!group) {\n      warn(\"Optional content group not defined.\");\n      return true;\n    }\n    if (group.type === \"OCG\") {\n      if (!this.#groups.has(group.id)) {\n        warn(`Optional content group not found: ${group.id}`);\n        return true;\n      }\n      return this.#groups.get(group.id).visible;\n    } else if (group.type === \"OCMD\") {\n      // Per the spec, the expression should be preferred if available.\n      if (group.expression) {\n        return this.#evaluateVisibilityExpression(group.expression);\n      }\n      if (!group.policy || group.policy === \"AnyOn\") {\n        // Default\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (this.#groups.get(id).visible) {\n            return true;\n          }\n        }\n        return false;\n      } else if (group.policy === \"AllOn\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (!this.#groups.get(id).visible) {\n            return false;\n          }\n        }\n        return true;\n      } else if (group.policy === \"AnyOff\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (!this.#groups.get(id).visible) {\n            return true;\n          }\n        }\n        return false;\n      } else if (group.policy === \"AllOff\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (this.#groups.get(id).visible) {\n            return false;\n          }\n        }\n        return true;\n      }\n      warn(`Unknown optional content policy ${group.policy}.`);\n      return true;\n    }\n    warn(`Unknown group type ${group.type}.`);\n    return true;\n  }\n\n  setVisibility(id, visible = true) {\n    if (!this.#groups.has(id)) {\n      warn(`Optional content group not found: ${id}`);\n      return;\n    }\n    this.#groups.get(id)._setVisible(INTERNAL, !!visible);\n\n    this.#cachedGetHash = null;\n  }\n\n  get hasInitialVisibility() {\n    return this.getHash() === this.#initialHash;\n  }\n\n  getOrder() {\n    if (!this.#groups.size) {\n      return null;\n    }\n    if (this.#order) {\n      return this.#order.slice();\n    }\n    return [...this.#groups.keys()];\n  }\n\n  getGroups() {\n    return this.#groups.size > 0 ? objectFromMap(this.#groups) : null;\n  }\n\n  getGroup(id) {\n    return this.#groups.get(id) || null;\n  }\n\n  getHash() {\n    if (this.#cachedGetHash !== null) {\n      return this.#cachedGetHash;\n    }\n    const hash = new MurmurHash3_64();\n\n    for (const [id, group] of this.#groups) {\n      hash.update(`${id}:${group.visible}`);\n    }\n    return (this.#cachedGetHash = hash.hexdigest());\n  }\n}\n\nexport { OptionalContentConfig };\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert, PromiseCapability } from \"../shared/util.js\";\nimport { isPdfFile } from \"./display_utils.js\";\n\n/** @implements {IPDFStream} */\nclass PDFDataTransportStream {\n  constructor(\n    {\n      length,\n      initialData,\n      progressiveDone = false,\n      contentDispositionFilename = null,\n      disableRange = false,\n      disableStream = false,\n    },\n    pdfDataRangeTransport\n  ) {\n    assert(\n      pdfDataRangeTransport,\n      'PDFDataTransportStream - missing required \"pdfDataRangeTransport\" argument.'\n    );\n\n    this._queuedChunks = [];\n    this._progressiveDone = progressiveDone;\n    this._contentDispositionFilename = contentDispositionFilename;\n\n    if (initialData?.length > 0) {\n      // Prevent any possible issues by only transferring a Uint8Array that\n      // completely \"utilizes\" its underlying ArrayBuffer.\n      const buffer =\n        initialData instanceof Uint8Array &&\n        initialData.byteLength === initialData.buffer.byteLength\n          ? initialData.buffer\n          : new Uint8Array(initialData).buffer;\n      this._queuedChunks.push(buffer);\n    }\n\n    this._pdfDataRangeTransport = pdfDataRangeTransport;\n    this._isStreamingSupported = !disableStream;\n    this._isRangeSupported = !disableRange;\n    this._contentLength = length;\n\n    this._fullRequestReader = null;\n    this._rangeReaders = [];\n\n    this._pdfDataRangeTransport.addRangeListener((begin, chunk) => {\n      this._onReceiveData({ begin, chunk });\n    });\n\n    this._pdfDataRangeTransport.addProgressListener((loaded, total) => {\n      this._onProgress({ loaded, total });\n    });\n\n    this._pdfDataRangeTransport.addProgressiveReadListener(chunk => {\n      this._onReceiveData({ chunk });\n    });\n\n    this._pdfDataRangeTransport.addProgressiveDoneListener(() => {\n      this._onProgressiveDone();\n    });\n\n    this._pdfDataRangeTransport.transportReady();\n  }\n\n  _onReceiveData({ begin, chunk }) {\n    // Prevent any possible issues by only transferring a Uint8Array that\n    // completely \"utilizes\" its underlying ArrayBuffer.\n    const buffer =\n      chunk instanceof Uint8Array &&\n      chunk.byteLength === chunk.buffer.byteLength\n        ? chunk.buffer\n        : new Uint8Array(chunk).buffer;\n\n    if (begin === undefined) {\n      if (this._fullRequestReader) {\n        this._fullRequestReader._enqueue(buffer);\n      } else {\n        this._queuedChunks.push(buffer);\n      }\n    } else {\n      const found = this._rangeReaders.some(function (rangeReader) {\n        if (rangeReader._begin !== begin) {\n          return false;\n        }\n        rangeReader._enqueue(buffer);\n        return true;\n      });\n      assert(\n        found,\n        \"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.\"\n      );\n    }\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  _onProgress(evt) {\n    if (evt.total === undefined) {\n      // Reporting to first range reader, if it exists.\n      this._rangeReaders[0]?.onProgress?.({ loaded: evt.loaded });\n    } else {\n      this._fullRequestReader?.onProgress?.({\n        loaded: evt.loaded,\n        total: evt.total,\n      });\n    }\n  }\n\n  _onProgressiveDone() {\n    this._fullRequestReader?.progressiveDone();\n    this._progressiveDone = true;\n  }\n\n  _removeRangeReader(reader) {\n    const i = this._rangeReaders.indexOf(reader);\n    if (i >= 0) {\n      this._rangeReaders.splice(i, 1);\n    }\n  }\n\n  getFullReader() {\n    assert(\n      !this._fullRequestReader,\n      \"PDFDataTransportStream.getFullReader can only be called once.\"\n    );\n    const queuedChunks = this._queuedChunks;\n    this._queuedChunks = null;\n    return new PDFDataTransportStreamReader(\n      this,\n      queuedChunks,\n      this._progressiveDone,\n      this._contentDispositionFilename\n    );\n  }\n\n  getRangeReader(begin, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const reader = new PDFDataTransportStreamRangeReader(this, begin, end);\n    this._pdfDataRangeTransport.requestDataRange(begin, end);\n    this._rangeReaders.push(reader);\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n    this._pdfDataRangeTransport.abort();\n  }\n}\n\n/** @implements {IPDFStreamReader} */\nclass PDFDataTransportStreamReader {\n  constructor(\n    stream,\n    queuedChunks,\n    progressiveDone = false,\n    contentDispositionFilename = null\n  ) {\n    this._stream = stream;\n    this._done = progressiveDone || false;\n    this._filename = isPdfFile(contentDispositionFilename)\n      ? contentDispositionFilename\n      : null;\n    this._queuedChunks = queuedChunks || [];\n    this._loaded = 0;\n    for (const chunk of this._queuedChunks) {\n      this._loaded += chunk.byteLength;\n    }\n    this._requests = [];\n    this._headersReady = Promise.resolve();\n    stream._fullRequestReader = this;\n\n    this.onProgress = null;\n  }\n\n  _enqueue(chunk) {\n    if (this._done) {\n      return; // Ignore new data.\n    }\n    if (this._requests.length > 0) {\n      const requestCapability = this._requests.shift();\n      requestCapability.resolve({ value: chunk, done: false });\n    } else {\n      this._queuedChunks.push(chunk);\n    }\n    this._loaded += chunk.byteLength;\n  }\n\n  get headersReady() {\n    return this._headersReady;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get isRangeSupported() {\n    return this._stream._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._stream._isStreamingSupported;\n  }\n\n  get contentLength() {\n    return this._stream._contentLength;\n  }\n\n  async read() {\n    if (this._queuedChunks.length > 0) {\n      const chunk = this._queuedChunks.shift();\n      return { value: chunk, done: false };\n    }\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    const requestCapability = new PromiseCapability();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n  }\n\n  progressiveDone() {\n    if (this._done) {\n      return;\n    }\n    this._done = true;\n  }\n}\n\n/** @implements {IPDFStreamRangeReader} */\nclass PDFDataTransportStreamRangeReader {\n  constructor(stream, begin, end) {\n    this._stream = stream;\n    this._begin = begin;\n    this._end = end;\n    this._queuedChunk = null;\n    this._requests = [];\n    this._done = false;\n\n    this.onProgress = null;\n  }\n\n  _enqueue(chunk) {\n    if (this._done) {\n      return; // ignore new data\n    }\n    if (this._requests.length === 0) {\n      this._queuedChunk = chunk;\n    } else {\n      const requestsCapability = this._requests.shift();\n      requestsCapability.resolve({ value: chunk, done: false });\n      for (const requestCapability of this._requests) {\n        requestCapability.resolve({ value: undefined, done: true });\n      }\n      this._requests.length = 0;\n    }\n    this._done = true;\n    this._stream._removeRangeReader(this);\n  }\n\n  get isStreamingSupported() {\n    return false;\n  }\n\n  async read() {\n    if (this._queuedChunk) {\n      const chunk = this._queuedChunk;\n      this._queuedChunk = null;\n      return { value: chunk, done: false };\n    }\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    const requestCapability = new PromiseCapability();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n    this._stream._removeRangeReader(this);\n  }\n}\n\nexport { PDFDataTransportStream };\n", "/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nclass XfaText {\n  /**\n   * Walk an XFA tree and create an array of text nodes that is compatible\n   * with a regular PDFs TextContent. Currently, only TextItem.str is supported,\n   * all other fields and styles haven't been implemented.\n   *\n   * @param {Object} xfa - An XFA fake DOM object.\n   *\n   * @returns {TextContent}\n   */\n  static textContent(xfa) {\n    const items = [];\n    const output = {\n      items,\n      styles: Object.create(null),\n    };\n    function walk(node) {\n      if (!node) {\n        return;\n      }\n      let str = null;\n      const name = node.name;\n      if (name === \"#text\") {\n        str = node.value;\n      } else if (!XfaText.shouldBuildText(name)) {\n        return;\n      } else if (node?.attributes?.textContent) {\n        str = node.attributes.textContent;\n      } else if (node.value) {\n        str = node.value;\n      }\n      if (str !== null) {\n        items.push({\n          str,\n        });\n      }\n      if (!node.children) {\n        return;\n      }\n      for (const child of node.children) {\n        walk(child);\n      }\n    }\n    walk(xfa);\n    return output;\n  }\n\n  /**\n   * @param {string} name - DOM node name. (lower case)\n   *\n   * @returns {boolean} true if the DOM node should have a corresponding text\n   * node.\n   */\n  static shouldBuildText(name) {\n    return !(\n      name === \"textarea\" ||\n      name === \"input\" ||\n      name === \"option\" ||\n      name === \"select\"\n    );\n  }\n}\n\nexport { XfaText };\n", "/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals __non_webpack_require__ */\n\nimport {\n  BaseCanvasFactory,\n  BaseCMapReaderFactory,\n  BaseFilterFactory,\n  BaseStandardFontDataFactory,\n} from \"./base_factory.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n  throw new Error(\n    'Module \"./node_utils.js\" shall not be used with MOZCENTRAL builds.'\n  );\n}\n\nconst fetchData = function (url) {\n  return new Promise((resolve, reject) => {\n    const fs = __non_webpack_require__(\"fs\");\n    fs.readFile(url, (error, data) => {\n      if (error || !data) {\n        reject(new Error(error));\n        return;\n      }\n      resolve(new Uint8Array(data));\n    });\n  });\n};\n\nclass NodeFilterFactory extends BaseFilterFactory {}\n\nclass NodeCanvasFactory extends BaseCanvasFactory {\n  /**\n   * @ignore\n   */\n  _createCanvas(width, height) {\n    const Canvas = __non_webpack_require__(\"canvas\");\n    return Canvas.createCanvas(width, height);\n  }\n}\n\nclass NodeCMapReaderFactory extends BaseCMapReaderFactory {\n  /**\n   * @ignore\n   */\n  _fetchData(url, compressionType) {\n    return fetchData(url).then(data => {\n      return { cMapData: data, compressionType };\n    });\n  }\n}\n\nclass NodeStandardFontDataFactory extends BaseStandardFontDataFactory {\n  /**\n   * @ignore\n   */\n  _fetchData(url) {\n    return fetchData(url);\n  }\n}\n\nexport {\n  NodeCanvasFactory,\n  NodeCMapReaderFactory,\n  NodeFilterFactory,\n  NodeStandardFontDataFactory,\n};\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals __non_webpack_require__ */\n\nimport {\n  AbortException,\n  assert,\n  MissingPDFException,\n  PromiseCapability,\n} from \"../shared/util.js\";\nimport {\n  extractFilenameFromHeader,\n  validateRangeRequestCapabilities,\n} from \"./network_utils.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n  throw new Error(\n    'Module \"./node_stream.js\" shall not be used with MOZCENTRAL builds.'\n  );\n}\n\nconst fs = __non_webpack_require__(\"fs\");\nconst http = __non_webpack_require__(\"http\");\nconst https = __non_webpack_require__(\"https\");\nconst url = __non_webpack_require__(\"url\");\n\nconst fileUriRegex = /^file:\\/\\/\\/[a-zA-Z]:\\//;\n\nfunction parseUrl(sourceUrl) {\n  const parsedUrl = url.parse(sourceUrl);\n  if (parsedUrl.protocol === \"file:\" || parsedUrl.host) {\n    return parsedUrl;\n  }\n  // Prepending 'file:///' to Windows absolute path.\n  if (/^[a-z]:[/\\\\]/i.test(sourceUrl)) {\n    return url.parse(`file:///${sourceUrl}`);\n  }\n  // Changes protocol to 'file:' if url refers to filesystem.\n  if (!parsedUrl.host) {\n    parsedUrl.protocol = \"file:\";\n  }\n  return parsedUrl;\n}\n\nclass PDFNodeStream {\n  constructor(source) {\n    this.source = source;\n    this.url = parseUrl(source.url);\n    this.isHttp =\n      this.url.protocol === \"http:\" || this.url.protocol === \"https:\";\n    // Check if url refers to filesystem.\n    this.isFsUrl = this.url.protocol === \"file:\";\n    this.httpHeaders = (this.isHttp && source.httpHeaders) || {};\n\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  getFullReader() {\n    assert(\n      !this._fullRequestReader,\n      \"PDFNodeStream.getFullReader can only be called once.\"\n    );\n    this._fullRequestReader = this.isFsUrl\n      ? new PDFNodeStreamFsFullReader(this)\n      : new PDFNodeStreamFullReader(this);\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(start, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const rangeReader = this.isFsUrl\n      ? new PDFNodeStreamFsRangeReader(this, start, end)\n      : new PDFNodeStreamRangeReader(this, start, end);\n    this._rangeRequestReaders.push(rangeReader);\n    return rangeReader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\n\nclass BaseFullReader {\n  constructor(stream) {\n    this._url = stream.url;\n    this._done = false;\n    this._storedError = null;\n    this.onProgress = null;\n    const source = stream.source;\n    this._contentLength = source.length; // optional\n    this._loaded = 0;\n    this._filename = null;\n\n    this._disableRange = source.disableRange || false;\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._isStreamingSupported = !source.disableStream;\n    this._isRangeSupported = !source.disableRange;\n\n    this._readableStream = null;\n    this._readCapability = new PromiseCapability();\n    this._headersCapability = new PromiseCapability();\n  }\n\n  get headersReady() {\n    return this._headersCapability.promise;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  async read() {\n    await this._readCapability.promise;\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    if (this._storedError) {\n      throw this._storedError;\n    }\n\n    const chunk = this._readableStream.read();\n    if (chunk === null) {\n      this._readCapability = new PromiseCapability();\n      return this.read();\n    }\n    this._loaded += chunk.length;\n    this.onProgress?.({\n      loaded: this._loaded,\n      total: this._contentLength,\n    });\n\n    // Ensure that `read()` method returns ArrayBuffer.\n    const buffer = new Uint8Array(chunk).buffer;\n    return { value: buffer, done: false };\n  }\n\n  cancel(reason) {\n    // Call `this._error()` method when cancel is called\n    // before _readableStream is set.\n    if (!this._readableStream) {\n      this._error(reason);\n      return;\n    }\n    this._readableStream.destroy(reason);\n  }\n\n  _error(reason) {\n    this._storedError = reason;\n    this._readCapability.resolve();\n  }\n\n  _setReadableStream(readableStream) {\n    this._readableStream = readableStream;\n    readableStream.on(\"readable\", () => {\n      this._readCapability.resolve();\n    });\n\n    readableStream.on(\"end\", () => {\n      // Destroy readable to minimize resource usage.\n      readableStream.destroy();\n      this._done = true;\n      this._readCapability.resolve();\n    });\n\n    readableStream.on(\"error\", reason => {\n      this._error(reason);\n    });\n\n    // We need to stop reading when range is supported and streaming is\n    // disabled.\n    if (!this._isStreamingSupported && this._isRangeSupported) {\n      this._error(new AbortException(\"streaming is disabled\"));\n    }\n\n    // Destroy ReadableStream if already in errored state.\n    if (this._storedError) {\n      this._readableStream.destroy(this._storedError);\n    }\n  }\n}\n\nclass BaseRangeReader {\n  constructor(stream) {\n    this._url = stream.url;\n    this._done = false;\n    this._storedError = null;\n    this.onProgress = null;\n    this._loaded = 0;\n    this._readableStream = null;\n    this._readCapability = new PromiseCapability();\n    const source = stream.source;\n    this._isStreamingSupported = !source.disableStream;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  async read() {\n    await this._readCapability.promise;\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    if (this._storedError) {\n      throw this._storedError;\n    }\n\n    const chunk = this._readableStream.read();\n    if (chunk === null) {\n      this._readCapability = new PromiseCapability();\n      return this.read();\n    }\n    this._loaded += chunk.length;\n    this.onProgress?.({ loaded: this._loaded });\n\n    // Ensure that `read()` method returns ArrayBuffer.\n    const buffer = new Uint8Array(chunk).buffer;\n    return { value: buffer, done: false };\n  }\n\n  cancel(reason) {\n    // Call `this._error()` method when cancel is called\n    // before _readableStream is set.\n    if (!this._readableStream) {\n      this._error(reason);\n      return;\n    }\n    this._readableStream.destroy(reason);\n  }\n\n  _error(reason) {\n    this._storedError = reason;\n    this._readCapability.resolve();\n  }\n\n  _setReadableStream(readableStream) {\n    this._readableStream = readableStream;\n    readableStream.on(\"readable\", () => {\n      this._readCapability.resolve();\n    });\n\n    readableStream.on(\"end\", () => {\n      // Destroy readableStream to minimize resource usage.\n      readableStream.destroy();\n      this._done = true;\n      this._readCapability.resolve();\n    });\n\n    readableStream.on(\"error\", reason => {\n      this._error(reason);\n    });\n\n    // Destroy readableStream if already in errored state.\n    if (this._storedError) {\n      this._readableStream.destroy(this._storedError);\n    }\n  }\n}\n\nfunction createRequestOptions(parsedUrl, headers) {\n  return {\n    protocol: parsedUrl.protocol,\n    auth: parsedUrl.auth,\n    host: parsedUrl.hostname,\n    port: parsedUrl.port,\n    path: parsedUrl.path,\n    method: \"GET\",\n    headers,\n  };\n}\n\nclass PDFNodeStreamFullReader extends BaseFullReader {\n  constructor(stream) {\n    super(stream);\n\n    const handleResponse = response => {\n      if (response.statusCode === 404) {\n        const error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n        this._storedError = error;\n        this._headersCapability.reject(error);\n        return;\n      }\n      this._headersCapability.resolve();\n      this._setReadableStream(response);\n\n      const getResponseHeader = name => {\n        // Make sure that headers name are in lower case, as mentioned\n        // here: https://nodejs.org/api/http.html#http_message_headers.\n        return this._readableStream.headers[name.toLowerCase()];\n      };\n      const { allowRangeRequests, suggestedLength } =\n        validateRangeRequestCapabilities({\n          getResponseHeader,\n          isHttp: stream.isHttp,\n          rangeChunkSize: this._rangeChunkSize,\n          disableRange: this._disableRange,\n        });\n\n      this._isRangeSupported = allowRangeRequests;\n      // Setting right content length.\n      this._contentLength = suggestedLength || this._contentLength;\n\n      this._filename = extractFilenameFromHeader(getResponseHeader);\n    };\n\n    this._request = null;\n    if (this._url.protocol === \"http:\") {\n      this._request = http.request(\n        createRequestOptions(this._url, stream.httpHeaders),\n        handleResponse\n      );\n    } else {\n      this._request = https.request(\n        createRequestOptions(this._url, stream.httpHeaders),\n        handleResponse\n      );\n    }\n\n    this._request.on(\"error\", reason => {\n      this._storedError = reason;\n      this._headersCapability.reject(reason);\n    });\n    // Note: `request.end(data)` is used to write `data` to request body\n    // and notify end of request. But one should always call `request.end()`\n    // even if there is no data to write -- (to notify the end of request).\n    this._request.end();\n  }\n}\n\nclass PDFNodeStreamRangeReader extends BaseRangeReader {\n  constructor(stream, start, end) {\n    super(stream);\n\n    this._httpHeaders = {};\n    for (const property in stream.httpHeaders) {\n      const value = stream.httpHeaders[property];\n      if (value === undefined) {\n        continue;\n      }\n      this._httpHeaders[property] = value;\n    }\n    this._httpHeaders.Range = `bytes=${start}-${end - 1}`;\n\n    const handleResponse = response => {\n      if (response.statusCode === 404) {\n        const error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n        this._storedError = error;\n        return;\n      }\n      this._setReadableStream(response);\n    };\n\n    this._request = null;\n    if (this._url.protocol === \"http:\") {\n      this._request = http.request(\n        createRequestOptions(this._url, this._httpHeaders),\n        handleResponse\n      );\n    } else {\n      this._request = https.request(\n        createRequestOptions(this._url, this._httpHeaders),\n        handleResponse\n      );\n    }\n\n    this._request.on(\"error\", reason => {\n      this._storedError = reason;\n    });\n    this._request.end();\n  }\n}\n\nclass PDFNodeStreamFsFullReader extends BaseFullReader {\n  constructor(stream) {\n    super(stream);\n\n    let path = decodeURIComponent(this._url.path);\n\n    // Remove the extra slash to get right path from url like `file:///C:/`\n    if (fileUriRegex.test(this._url.href)) {\n      path = path.replace(/^\\//, \"\");\n    }\n\n    fs.lstat(path, (error, stat) => {\n      if (error) {\n        if (error.code === \"ENOENT\") {\n          error = new MissingPDFException(`Missing PDF \"${path}\".`);\n        }\n        this._storedError = error;\n        this._headersCapability.reject(error);\n        return;\n      }\n      // Setting right content length.\n      this._contentLength = stat.size;\n\n      this._setReadableStream(fs.createReadStream(path));\n      this._headersCapability.resolve();\n    });\n  }\n}\n\nclass PDFNodeStreamFsRangeReader extends BaseRangeReader {\n  constructor(stream, start, end) {\n    super(stream);\n\n    let path = decodeURIComponent(this._url.path);\n\n    // Remove the extra slash to get right path from url like `file:///C:/`\n    if (fileUriRegex.test(this._url.href)) {\n      path = path.replace(/^\\//, \"\");\n    }\n\n    this._setReadableStream(fs.createReadStream(path, { start, end: end - 1 }));\n  }\n}\n\nexport { PDFNodeStream };\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  assert,\n  MissingPDFException,\n  UnexpectedResponseException,\n} from \"../shared/util.js\";\nimport { getFilenameFromContentDispositionHeader } from \"./content_disposition.js\";\nimport { isPdfFile } from \"./display_utils.js\";\n\nfunction validateRangeRequestCapabilities({\n  getResponseHeader,\n  isHttp,\n  rangeChunkSize,\n  disableRange,\n}) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    assert(\n      Number.isInteger(rangeChunkSize) && rangeChunkSize > 0,\n      \"rangeChunkSize must be an integer larger than zero.\"\n    );\n  }\n  const returnValues = {\n    allowRangeRequests: false,\n    suggestedLength: undefined,\n  };\n\n  const length = parseInt(getResponseHeader(\"Content-Length\"), 10);\n  if (!Number.isInteger(length)) {\n    return returnValues;\n  }\n\n  returnValues.suggestedLength = length;\n\n  if (length <= 2 * rangeChunkSize) {\n    // The file size is smaller than the size of two chunks, so it does not\n    // make any sense to abort the request and retry with a range request.\n    return returnValues;\n  }\n\n  if (disableRange || !isHttp) {\n    return returnValues;\n  }\n  if (getResponseHeader(\"Accept-Ranges\") !== \"bytes\") {\n    return returnValues;\n  }\n\n  const contentEncoding = getResponseHeader(\"Content-Encoding\") || \"identity\";\n  if (contentEncoding !== \"identity\") {\n    return returnValues;\n  }\n\n  returnValues.allowRangeRequests = true;\n  return returnValues;\n}\n\nfunction extractFilenameFromHeader(getResponseHeader) {\n  const contentDisposition = getResponseHeader(\"Content-Disposition\");\n  if (contentDisposition) {\n    let filename = getFilenameFromContentDispositionHeader(contentDisposition);\n    if (filename.includes(\"%\")) {\n      try {\n        filename = decodeURIComponent(filename);\n      } catch {}\n    }\n    if (isPdfFile(filename)) {\n      return filename;\n    }\n  }\n  return null;\n}\n\nfunction createResponseStatusError(status, url) {\n  if (status === 404 || (status === 0 && url.startsWith(\"file:\"))) {\n    return new MissingPDFException('Missing PDF \"' + url + '\".');\n  }\n  return new UnexpectedResponseException(\n    `Unexpected server response (${status}) while retrieving PDF \"${url}\".`,\n    status\n  );\n}\n\nfunction validateResponseStatus(status) {\n  return status === 200 || status === 206;\n}\n\nexport {\n  createResponseStatusError,\n  extractFilenameFromHeader,\n  validateRangeRequestCapabilities,\n  validateResponseStatus,\n};\n", "/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { stringToBytes } from \"../shared/util.js\";\n\n// This getFilenameFromContentDispositionHeader function is adapted from\n// https://github.com/Rob--W/open-in-browser/blob/7e2e35a38b8b4e981b11da7b2f01df0149049e92/extension/content-disposition.js\n// with the following changes:\n// - Modified to conform to PDF.js's coding style.\n// - Move return to the end of the function to prevent Babel from dropping the\n//   function declarations.\n\n/**\n * Extract file name from the Content-Disposition HTTP response header.\n *\n * @param {string} contentDisposition\n * @returns {string} Filename, if found in the Content-Disposition header.\n */\nfunction getFilenameFromContentDispositionHeader(contentDisposition) {\n  let needsEncodingFixup = true;\n\n  // filename*=ext-value (\"ext-value\" from RFC 5987, referenced by RFC 6266).\n  let tmp = toParamRegExp(\"filename\\\\*\", \"i\").exec(contentDisposition);\n  if (tmp) {\n    tmp = tmp[1];\n    let filename = rfc2616unquote(tmp);\n    filename = unescape(filename);\n    filename = rfc5987decode(filename);\n    filename = rfc2047decode(filename);\n    return fixupEncoding(filename);\n  }\n\n  // Continuations (RFC 2231 section 3, referenced by RFC 5987 section 3.1).\n  // filename*n*=part\n  // filename*n=part\n  tmp = rfc2231getparam(contentDisposition);\n  if (tmp) {\n    // RFC 2047, section\n    const filename = rfc2047decode(tmp);\n    return fixupEncoding(filename);\n  }\n\n  // filename=value (RFC 5987, section 4.1).\n  tmp = toParamRegExp(\"filename\", \"i\").exec(contentDisposition);\n  if (tmp) {\n    tmp = tmp[1];\n    let filename = rfc2616unquote(tmp);\n    filename = rfc2047decode(filename);\n    return fixupEncoding(filename);\n  }\n\n  // After this line there are only function declarations. We cannot put\n  // \"return\" here for readability because babel would then drop the function\n  // declarations...\n  function toParamRegExp(attributePattern, flags) {\n    return new RegExp(\n      \"(?:^|;)\\\\s*\" +\n        attributePattern +\n        \"\\\\s*=\\\\s*\" +\n        // Captures: value = token | quoted-string\n        // (RFC 2616, section 3.6 and referenced by RFC 6266 4.1)\n        \"(\" +\n        '[^\";\\\\s][^;\\\\s]*' +\n        \"|\" +\n        '\"(?:[^\"\\\\\\\\]|\\\\\\\\\"?)+\"?' +\n        \")\",\n      flags\n    );\n  }\n  function textdecode(encoding, value) {\n    if (encoding) {\n      if (!/^[\\x00-\\xFF]+$/.test(value)) {\n        return value;\n      }\n      try {\n        const decoder = new TextDecoder(encoding, { fatal: true });\n        const buffer = stringToBytes(value);\n        value = decoder.decode(buffer);\n        needsEncodingFixup = false;\n      } catch {\n        // TextDecoder constructor threw - unrecognized encoding.\n      }\n    }\n    return value;\n  }\n  function fixupEncoding(value) {\n    if (needsEncodingFixup && /[\\x80-\\xff]/.test(value)) {\n      // Maybe multi-byte UTF-8.\n      value = textdecode(\"utf-8\", value);\n      if (needsEncodingFixup) {\n        // Try iso-8859-1 encoding.\n        value = textdecode(\"iso-8859-1\", value);\n      }\n    }\n    return value;\n  }\n  function rfc2231getparam(contentDispositionStr) {\n    const matches = [];\n    let match;\n    // Iterate over all filename*n= and filename*n*= with n being an integer\n    // of at least zero. Any non-zero number must not start with '0'.\n    const iter = toParamRegExp(\"filename\\\\*((?!0\\\\d)\\\\d+)(\\\\*?)\", \"ig\");\n    while ((match = iter.exec(contentDispositionStr)) !== null) {\n      let [, n, quot, part] = match; // eslint-disable-line prefer-const\n      n = parseInt(n, 10);\n      if (n in matches) {\n        // Ignore anything after the invalid second filename*0.\n        if (n === 0) {\n          break;\n        }\n        continue;\n      }\n      matches[n] = [quot, part];\n    }\n    const parts = [];\n    for (let n = 0; n < matches.length; ++n) {\n      if (!(n in matches)) {\n        // Numbers must be consecutive. Truncate when there is a hole.\n        break;\n      }\n      let [quot, part] = matches[n]; // eslint-disable-line prefer-const\n      part = rfc2616unquote(part);\n      if (quot) {\n        part = unescape(part);\n        if (n === 0) {\n          part = rfc5987decode(part);\n        }\n      }\n      parts.push(part);\n    }\n    return parts.join(\"\");\n  }\n  function rfc2616unquote(value) {\n    if (value.startsWith('\"')) {\n      const parts = value.slice(1).split('\\\\\"');\n      // Find the first unescaped \" and terminate there.\n      for (let i = 0; i < parts.length; ++i) {\n        const quotindex = parts[i].indexOf('\"');\n        if (quotindex !== -1) {\n          parts[i] = parts[i].slice(0, quotindex);\n          parts.length = i + 1; // Truncates and stop the iteration.\n        }\n        parts[i] = parts[i].replaceAll(/\\\\(.)/g, \"$1\");\n      }\n      value = parts.join('\"');\n    }\n    return value;\n  }\n  function rfc5987decode(extvalue) {\n    // Decodes \"ext-value\" from RFC 5987.\n    const encodingend = extvalue.indexOf(\"'\");\n    if (encodingend === -1) {\n      // Some servers send \"filename*=\" without encoding 'language' prefix,\n      // e.g. in https://github.com/Rob--W/open-in-browser/issues/26\n      // Let's accept the value like Firefox (57) (Chrome 62 rejects it).\n      return extvalue;\n    }\n    const encoding = extvalue.slice(0, encodingend);\n    const langvalue = extvalue.slice(encodingend + 1);\n    // Ignore language (RFC 5987 section 3.2.1, and RFC 6266 section 4.1 ).\n    const value = langvalue.replace(/^[^']*'/, \"\");\n    return textdecode(encoding, value);\n  }\n  function rfc2047decode(value) {\n    // RFC 2047-decode the result. Firefox tried to drop support for it, but\n    // backed out because some servers use it - https://bugzil.la/875615\n    // Firefox's condition for decoding is here: https://searchfox.org/mozilla-central/rev/4a590a5a15e35d88a3b23dd6ac3c471cf85b04a8/netwerk/mime/nsMIMEHeaderParamImpl.cpp#742-748\n\n    // We are more strict and only recognize RFC 2047-encoding if the value\n    // starts with \"=?\", since then it is likely that the full value is\n    // RFC 2047-encoded.\n\n    // Firefox also decodes words even where RFC 2047 section 5 states:\n    // \"An 'encoded-word' MUST NOT appear within a 'quoted-string'.\"\n    if (!value.startsWith(\"=?\") || /[\\x00-\\x19\\x80-\\xff]/.test(value)) {\n      return value;\n    }\n    // RFC 2047, section 2.4\n    // encoded-word = \"=?\" charset \"?\" encoding \"?\" encoded-text \"?=\"\n    // charset = token (but let's restrict to characters that denote a\n    //       possibly valid encoding).\n    // encoding = q or b\n    // encoded-text = any printable ASCII character other than ? or space.\n    //        ... but Firefox permits ? and space.\n    return value.replaceAll(\n      /=\\?([\\w-]*)\\?([QqBb])\\?((?:[^?]|\\?(?!=))*)\\?=/g,\n      function (matches, charset, encoding, text) {\n        if (encoding === \"q\" || encoding === \"Q\") {\n          // RFC 2047 section 4.2.\n          text = text.replaceAll(\"_\", \" \");\n          text = text.replaceAll(/=([0-9a-fA-F]{2})/g, function (match, hex) {\n            return String.fromCharCode(parseInt(hex, 16));\n          });\n          return textdecode(charset, text);\n        } // else encoding is b or B - base64 (RFC 2047 section 4.1)\n        try {\n          text = atob(text);\n        } catch {}\n        return textdecode(charset, text);\n      }\n    );\n  }\n\n  return \"\";\n}\n\nexport { getFilenameFromContentDispositionHeader };\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert, PromiseCapability, stringToBytes } from \"../shared/util.js\";\nimport {\n  createResponseStatusError,\n  extractFilenameFromHeader,\n  validateRangeRequestCapabilities,\n} from \"./network_utils.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n  throw new Error(\n    'Module \"./network.js\" shall not be used with MOZCENTRAL builds.'\n  );\n}\n\nconst OK_RESPONSE = 200;\nconst PARTIAL_CONTENT_RESPONSE = 206;\n\nfunction getArrayBuffer(xhr) {\n  const data = xhr.response;\n  if (typeof data !== \"string\") {\n    return data;\n  }\n  return stringToBytes(data).buffer;\n}\n\nclass NetworkManager {\n  constructor(url, args = {}) {\n    this.url = url;\n    this.isHttp = /^https?:/i.test(url);\n    this.httpHeaders = (this.isHttp && args.httpHeaders) || Object.create(null);\n    this.withCredentials = args.withCredentials || false;\n\n    this.currXhrId = 0;\n    this.pendingRequests = Object.create(null);\n  }\n\n  requestRange(begin, end, listeners) {\n    const args = {\n      begin,\n      end,\n    };\n    for (const prop in listeners) {\n      args[prop] = listeners[prop];\n    }\n    return this.request(args);\n  }\n\n  requestFull(listeners) {\n    return this.request(listeners);\n  }\n\n  request(args) {\n    const xhr = new XMLHttpRequest();\n    const xhrId = this.currXhrId++;\n    const pendingRequest = (this.pendingRequests[xhrId] = { xhr });\n\n    xhr.open(\"GET\", this.url);\n    xhr.withCredentials = this.withCredentials;\n    for (const property in this.httpHeaders) {\n      const value = this.httpHeaders[property];\n      if (value === undefined) {\n        continue;\n      }\n      xhr.setRequestHeader(property, value);\n    }\n    if (this.isHttp && \"begin\" in args && \"end\" in args) {\n      xhr.setRequestHeader(\"Range\", `bytes=${args.begin}-${args.end - 1}`);\n      pendingRequest.expectedStatus = PARTIAL_CONTENT_RESPONSE;\n    } else {\n      pendingRequest.expectedStatus = OK_RESPONSE;\n    }\n    xhr.responseType = \"arraybuffer\";\n\n    if (args.onError) {\n      xhr.onerror = function (evt) {\n        args.onError(xhr.status);\n      };\n    }\n    xhr.onreadystatechange = this.onStateChange.bind(this, xhrId);\n    xhr.onprogress = this.onProgress.bind(this, xhrId);\n\n    pendingRequest.onHeadersReceived = args.onHeadersReceived;\n    pendingRequest.onDone = args.onDone;\n    pendingRequest.onError = args.onError;\n    pendingRequest.onProgress = args.onProgress;\n\n    xhr.send(null);\n\n    return xhrId;\n  }\n\n  onProgress(xhrId, evt) {\n    const pendingRequest = this.pendingRequests[xhrId];\n    if (!pendingRequest) {\n      return; // Maybe abortRequest was called...\n    }\n    pendingRequest.onProgress?.(evt);\n  }\n\n  onStateChange(xhrId, evt) {\n    const pendingRequest = this.pendingRequests[xhrId];\n    if (!pendingRequest) {\n      return; // Maybe abortRequest was called...\n    }\n\n    const xhr = pendingRequest.xhr;\n    if (xhr.readyState >= 2 && pendingRequest.onHeadersReceived) {\n      pendingRequest.onHeadersReceived();\n      delete pendingRequest.onHeadersReceived;\n    }\n\n    if (xhr.readyState !== 4) {\n      return;\n    }\n\n    if (!(xhrId in this.pendingRequests)) {\n      // The XHR request might have been aborted in onHeadersReceived()\n      // callback, in which case we should abort request.\n      return;\n    }\n\n    delete this.pendingRequests[xhrId];\n\n    // Success status == 0 can be on ftp, file and other protocols.\n    if (xhr.status === 0 && this.isHttp) {\n      pendingRequest.onError?.(xhr.status);\n      return;\n    }\n    const xhrStatus = xhr.status || OK_RESPONSE;\n\n    // From http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.2:\n    // \"A server MAY ignore the Range header\". This means it's possible to\n    // get a 200 rather than a 206 response from a range request.\n    const ok_response_on_range_request =\n      xhrStatus === OK_RESPONSE &&\n      pendingRequest.expectedStatus === PARTIAL_CONTENT_RESPONSE;\n\n    if (\n      !ok_response_on_range_request &&\n      xhrStatus !== pendingRequest.expectedStatus\n    ) {\n      pendingRequest.onError?.(xhr.status);\n      return;\n    }\n\n    const chunk = getArrayBuffer(xhr);\n    if (xhrStatus === PARTIAL_CONTENT_RESPONSE) {\n      const rangeHeader = xhr.getResponseHeader(\"Content-Range\");\n      const matches = /bytes (\\d+)-(\\d+)\\/(\\d+)/.exec(rangeHeader);\n      pendingRequest.onDone({\n        begin: parseInt(matches[1], 10),\n        chunk,\n      });\n    } else if (chunk) {\n      pendingRequest.onDone({\n        begin: 0,\n        chunk,\n      });\n    } else {\n      pendingRequest.onError?.(xhr.status);\n    }\n  }\n\n  getRequestXhr(xhrId) {\n    return this.pendingRequests[xhrId].xhr;\n  }\n\n  isPendingRequest(xhrId) {\n    return xhrId in this.pendingRequests;\n  }\n\n  abortRequest(xhrId) {\n    const xhr = this.pendingRequests[xhrId].xhr;\n    delete this.pendingRequests[xhrId];\n    xhr.abort();\n  }\n}\n\n/** @implements {IPDFStream} */\nclass PDFNetworkStream {\n  constructor(source) {\n    this._source = source;\n    this._manager = new NetworkManager(source.url, {\n      httpHeaders: source.httpHeaders,\n      withCredentials: source.withCredentials,\n    });\n    this._rangeChunkSize = source.rangeChunkSize;\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  _onRangeRequestReaderClosed(reader) {\n    const i = this._rangeRequestReaders.indexOf(reader);\n    if (i >= 0) {\n      this._rangeRequestReaders.splice(i, 1);\n    }\n  }\n\n  getFullReader() {\n    assert(\n      !this._fullRequestReader,\n      \"PDFNetworkStream.getFullReader can only be called once.\"\n    );\n    this._fullRequestReader = new PDFNetworkStreamFullRequestReader(\n      this._manager,\n      this._source\n    );\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(begin, end) {\n    const reader = new PDFNetworkStreamRangeRequestReader(\n      this._manager,\n      begin,\n      end\n    );\n    reader.onClosed = this._onRangeRequestReaderClosed.bind(this);\n    this._rangeRequestReaders.push(reader);\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\n\n/** @implements {IPDFStreamReader} */\nclass PDFNetworkStreamFullRequestReader {\n  constructor(manager, source) {\n    this._manager = manager;\n\n    const args = {\n      onHeadersReceived: this._onHeadersReceived.bind(this),\n      onDone: this._onDone.bind(this),\n      onError: this._onError.bind(this),\n      onProgress: this._onProgress.bind(this),\n    };\n    this._url = source.url;\n    this._fullRequestId = manager.requestFull(args);\n    this._headersReceivedCapability = new PromiseCapability();\n    this._disableRange = source.disableRange || false;\n    this._contentLength = source.length; // Optional\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._isStreamingSupported = false;\n    this._isRangeSupported = false;\n\n    this._cachedChunks = [];\n    this._requests = [];\n    this._done = false;\n    this._storedError = undefined;\n    this._filename = null;\n\n    this.onProgress = null;\n  }\n\n  _onHeadersReceived() {\n    const fullRequestXhrId = this._fullRequestId;\n    const fullRequestXhr = this._manager.getRequestXhr(fullRequestXhrId);\n\n    const getResponseHeader = name => {\n      return fullRequestXhr.getResponseHeader(name);\n    };\n    const { allowRangeRequests, suggestedLength } =\n      validateRangeRequestCapabilities({\n        getResponseHeader,\n        isHttp: this._manager.isHttp,\n        rangeChunkSize: this._rangeChunkSize,\n        disableRange: this._disableRange,\n      });\n\n    if (allowRangeRequests) {\n      this._isRangeSupported = true;\n    }\n    // Setting right content length.\n    this._contentLength = suggestedLength || this._contentLength;\n\n    this._filename = extractFilenameFromHeader(getResponseHeader);\n\n    if (this._isRangeSupported) {\n      // NOTE: by cancelling the full request, and then issuing range\n      // requests, there will be an issue for sites where you can only\n      // request the pdf once. However, if this is the case, then the\n      // server should not be returning that it can support range requests.\n      this._manager.abortRequest(fullRequestXhrId);\n    }\n\n    this._headersReceivedCapability.resolve();\n  }\n\n  _onDone(data) {\n    if (data) {\n      if (this._requests.length > 0) {\n        const requestCapability = this._requests.shift();\n        requestCapability.resolve({ value: data.chunk, done: false });\n      } else {\n        this._cachedChunks.push(data.chunk);\n      }\n    }\n    this._done = true;\n    if (this._cachedChunks.length > 0) {\n      return;\n    }\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n  }\n\n  _onError(status) {\n    this._storedError = createResponseStatusError(status, this._url);\n    this._headersReceivedCapability.reject(this._storedError);\n    for (const requestCapability of this._requests) {\n      requestCapability.reject(this._storedError);\n    }\n    this._requests.length = 0;\n    this._cachedChunks.length = 0;\n  }\n\n  _onProgress(evt) {\n    this.onProgress?.({\n      loaded: evt.loaded,\n      total: evt.lengthComputable ? evt.total : this._contentLength,\n    });\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get headersReady() {\n    return this._headersReceivedCapability.promise;\n  }\n\n  async read() {\n    if (this._storedError) {\n      throw this._storedError;\n    }\n    if (this._cachedChunks.length > 0) {\n      const chunk = this._cachedChunks.shift();\n      return { value: chunk, done: false };\n    }\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    const requestCapability = new PromiseCapability();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n\n  cancel(reason) {\n    this._done = true;\n    this._headersReceivedCapability.reject(reason);\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n    if (this._manager.isPendingRequest(this._fullRequestId)) {\n      this._manager.abortRequest(this._fullRequestId);\n    }\n    this._fullRequestReader = null;\n  }\n}\n\n/** @implements {IPDFStreamRangeReader} */\nclass PDFNetworkStreamRangeRequestReader {\n  constructor(manager, begin, end) {\n    this._manager = manager;\n\n    const args = {\n      onDone: this._onDone.bind(this),\n      onError: this._onError.bind(this),\n      onProgress: this._onProgress.bind(this),\n    };\n    this._url = manager.url;\n    this._requestId = manager.requestRange(begin, end, args);\n    this._requests = [];\n    this._queuedChunk = null;\n    this._done = false;\n    this._storedError = undefined;\n\n    this.onProgress = null;\n    this.onClosed = null;\n  }\n\n  _close() {\n    this.onClosed?.(this);\n  }\n\n  _onDone(data) {\n    const chunk = data.chunk;\n    if (this._requests.length > 0) {\n      const requestCapability = this._requests.shift();\n      requestCapability.resolve({ value: chunk, done: false });\n    } else {\n      this._queuedChunk = chunk;\n    }\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n    this._close();\n  }\n\n  _onError(status) {\n    this._storedError = createResponseStatusError(status, this._url);\n    for (const requestCapability of this._requests) {\n      requestCapability.reject(this._storedError);\n    }\n    this._requests.length = 0;\n    this._queuedChunk = null;\n  }\n\n  _onProgress(evt) {\n    if (!this.isStreamingSupported) {\n      this.onProgress?.({ loaded: evt.loaded });\n    }\n  }\n\n  get isStreamingSupported() {\n    return false;\n  }\n\n  async read() {\n    if (this._storedError) {\n      throw this._storedError;\n    }\n    if (this._queuedChunk !== null) {\n      const chunk = this._queuedChunk;\n      this._queuedChunk = null;\n      return { value: chunk, done: false };\n    }\n    if (this._done) {\n      return { value: undefined, done: true };\n    }\n    const requestCapability = new PromiseCapability();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({ value: undefined, done: true });\n    }\n    this._requests.length = 0;\n    if (this._manager.isPendingRequest(this._requestId)) {\n      this._manager.abortRequest(this._requestId);\n    }\n    this._close();\n  }\n}\n\nexport { PDFNetworkStream };\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AbortException,\n  assert,\n  PromiseCapability,\n  warn,\n} from \"../shared/util.js\";\nimport {\n  createResponseStatusError,\n  extractFilenameFromHeader,\n  validateRangeRequestCapabilities,\n  validateResponseStatus,\n} from \"./network_utils.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n  throw new Error(\n    'Module \"./fetch_stream.js\" shall not be used with MOZCENTRAL builds.'\n  );\n}\n\nfunction createFetchOptions(headers, withCredentials, abortController) {\n  return {\n    method: \"GET\",\n    headers,\n    signal: abortController.signal,\n    mode: \"cors\",\n    credentials: withCredentials ? \"include\" : \"same-origin\",\n    redirect: \"follow\",\n  };\n}\n\nfunction createHeaders(httpHeaders) {\n  const headers = new Headers();\n  for (const property in httpHeaders) {\n    const value = httpHeaders[property];\n    if (value === undefined) {\n      continue;\n    }\n    headers.append(property, value);\n  }\n  return headers;\n}\n\nfunction getArrayBuffer(val) {\n  if (val instanceof Uint8Array) {\n    return val.buffer;\n  }\n  if (val instanceof ArrayBuffer) {\n    return val;\n  }\n  warn(`getArrayBuffer - unexpected data format: ${val}`);\n  return new Uint8Array(val).buffer;\n}\n\n/** @implements {IPDFStream} */\nclass PDFFetchStream {\n  constructor(source) {\n    this.source = source;\n    this.isHttp = /^https?:/i.test(source.url);\n    this.httpHeaders = (this.isHttp && source.httpHeaders) || {};\n\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  getFullReader() {\n    assert(\n      !this._fullRequestReader,\n      \"PDFFetchStream.getFullReader can only be called once.\"\n    );\n    this._fullRequestReader = new PDFFetchStreamReader(this);\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(begin, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const reader = new PDFFetchStreamRangeReader(this, begin, end);\n    this._rangeRequestReaders.push(reader);\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\n\n/** @implements {IPDFStreamReader} */\nclass PDFFetchStreamReader {\n  constructor(stream) {\n    this._stream = stream;\n    this._reader = null;\n    this._loaded = 0;\n    this._filename = null;\n    const source = stream.source;\n    this._withCredentials = source.withCredentials || false;\n    this._contentLength = source.length;\n    this._headersCapability = new PromiseCapability();\n    this._disableRange = source.disableRange || false;\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._abortController = new AbortController();\n    this._isStreamingSupported = !source.disableStream;\n    this._isRangeSupported = !source.disableRange;\n\n    this._headers = createHeaders(this._stream.httpHeaders);\n\n    const url = source.url;\n    fetch(\n      url,\n      createFetchOptions(\n        this._headers,\n        this._withCredentials,\n        this._abortController\n      )\n    )\n      .then(response => {\n        if (!validateResponseStatus(response.status)) {\n          throw createResponseStatusError(response.status, url);\n        }\n        this._reader = response.body.getReader();\n        this._headersCapability.resolve();\n\n        const getResponseHeader = name => {\n          return response.headers.get(name);\n        };\n        const { allowRangeRequests, suggestedLength } =\n          validateRangeRequestCapabilities({\n            getResponseHeader,\n            isHttp: this._stream.isHttp,\n            rangeChunkSize: this._rangeChunkSize,\n            disableRange: this._disableRange,\n          });\n\n        this._isRangeSupported = allowRangeRequests;\n        // Setting right content length.\n        this._contentLength = suggestedLength || this._contentLength;\n\n        this._filename = extractFilenameFromHeader(getResponseHeader);\n\n        // We need to stop reading when range is supported and streaming is\n        // disabled.\n        if (!this._isStreamingSupported && this._isRangeSupported) {\n          this.cancel(new AbortException(\"Streaming is disabled.\"));\n        }\n      })\n      .catch(this._headersCapability.reject);\n\n    this.onProgress = null;\n  }\n\n  get headersReady() {\n    return this._headersCapability.promise;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  async read() {\n    await this._headersCapability.promise;\n    const { value, done } = await this._reader.read();\n    if (done) {\n      return { value, done };\n    }\n    this._loaded += value.byteLength;\n    this.onProgress?.({\n      loaded: this._loaded,\n      total: this._contentLength,\n    });\n\n    return { value: getArrayBuffer(value), done: false };\n  }\n\n  cancel(reason) {\n    this._reader?.cancel(reason);\n    this._abortController.abort();\n  }\n}\n\n/** @implements {IPDFStreamRangeReader} */\nclass PDFFetchStreamRangeReader {\n  constructor(stream, begin, end) {\n    this._stream = stream;\n    this._reader = null;\n    this._loaded = 0;\n    const source = stream.source;\n    this._withCredentials = source.withCredentials || false;\n    this._readCapability = new PromiseCapability();\n    this._isStreamingSupported = !source.disableStream;\n\n    this._abortController = new AbortController();\n    this._headers = createHeaders(this._stream.httpHeaders);\n    this._headers.append(\"Range\", `bytes=${begin}-${end - 1}`);\n\n    const url = source.url;\n    fetch(\n      url,\n      createFetchOptions(\n        this._headers,\n        this._withCredentials,\n        this._abortController\n      )\n    )\n      .then(response => {\n        if (!validateResponseStatus(response.status)) {\n          throw createResponseStatusError(response.status, url);\n        }\n        this._readCapability.resolve();\n        this._reader = response.body.getReader();\n      })\n      .catch(this._readCapability.reject);\n\n    this.onProgress = null;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  async read() {\n    await this._readCapability.promise;\n    const { value, done } = await this._reader.read();\n    if (done) {\n      return { value, done };\n    }\n    this._loaded += value.byteLength;\n    this.onProgress?.({ loaded: this._loaded });\n\n    return { value: getArrayBuffer(value), done: false };\n  }\n\n  cancel(reason) {\n    this._reader?.cancel(reason);\n    this._abortController.abort();\n  }\n}\n\nexport { PDFFetchStream };\n", "/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./display_utils\").PageViewport} PageViewport */\n/** @typedef {import(\"./api\").TextContent} TextContent */\n\nimport {\n  AbortException,\n  FeatureTest,\n  PromiseCapability,\n  Util,\n} from \"../shared/util.js\";\nimport { deprecated, setLayerDimensions } from \"./display_utils.js\";\n\n/**\n * Text layer render parameters.\n *\n * @typedef {Object} TextLayerRenderParameters\n * @property {ReadableStream | TextContent} textContentSource - Text content to\n *   render, i.e. the value returned by the page's `streamTextContent` or\n *   `getTextContent` method.\n * @property {HTMLElement} container - The DOM node that will contain the text\n *   runs.\n * @property {PageViewport} viewport - The target viewport to properly layout\n *   the text runs.\n * @property {Array<HTMLElement>} [textDivs] - HTML elements that correspond to\n *   the text items of the textContent input.\n *   This is output and shall initially be set to an empty array.\n * @property {WeakMap<HTMLElement,Object>} [textDivProperties] - Some properties\n *   weakly mapped to the HTML elements used to render the text.\n * @property {Array<string>} [textContentItemsStr] - Strings that correspond to\n *   the `str` property of the text items of the textContent input.\n *   This is output and shall initially be set to an empty array.\n * @property {boolean} [isOffscreenCanvasSupported] true if we can use\n *   OffscreenCanvas to measure string widths.\n */\n\n/**\n * Text layer update parameters.\n *\n * @typedef {Object} TextLayerUpdateParameters\n * @property {HTMLElement} container - The DOM node that will contain the text\n *   runs.\n * @property {PageViewport} viewport - The target viewport to properly layout\n *   the text runs.\n * @property {Array<HTMLElement>} [textDivs] - HTML elements that correspond to\n *   the text items of the textContent input.\n *   This is output and shall initially be set to an empty array.\n * @property {WeakMap<HTMLElement,Object>} [textDivProperties] - Some properties\n *   weakly mapped to the HTML elements used to render the text.\n * @property {boolean} [isOffscreenCanvasSupported] true if we can use\n *   OffscreenCanvas to measure string widths.\n * @property {boolean} [mustRotate] true if the text layer must be rotated.\n * @property {boolean} [mustRescale] true if the text layer contents must be\n *   rescaled.\n */\n\nconst MAX_TEXT_DIVS_TO_RENDER = 100000;\nconst DEFAULT_FONT_SIZE = 30;\nconst DEFAULT_FONT_ASCENT = 0.8;\nconst ascentCache = new Map();\n\nfunction getCtx(size, isOffscreenCanvasSupported) {\n  let ctx;\n  if (isOffscreenCanvasSupported && FeatureTest.isOffscreenCanvasSupported) {\n    ctx = new OffscreenCanvas(size, size).getContext(\"2d\", { alpha: false });\n  } else {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = canvas.height = size;\n    ctx = canvas.getContext(\"2d\", { alpha: false });\n  }\n\n  return ctx;\n}\n\nfunction getAscent(fontFamily, isOffscreenCanvasSupported) {\n  const cachedAscent = ascentCache.get(fontFamily);\n  if (cachedAscent) {\n    return cachedAscent;\n  }\n\n  const ctx = getCtx(DEFAULT_FONT_SIZE, isOffscreenCanvasSupported);\n\n  ctx.font = `${DEFAULT_FONT_SIZE}px ${fontFamily}`;\n  const metrics = ctx.measureText(\"\");\n\n  // Both properties aren't available by default in Firefox.\n  let ascent = metrics.fontBoundingBoxAscent;\n  let descent = Math.abs(metrics.fontBoundingBoxDescent);\n  if (ascent) {\n    const ratio = ascent / (ascent + descent);\n    ascentCache.set(fontFamily, ratio);\n\n    ctx.canvas.width = ctx.canvas.height = 0;\n    return ratio;\n  }\n\n  // Try basic heuristic to guess ascent/descent.\n  // Draw a g with baseline at 0,0 and then get the line\n  // number where a pixel has non-null red component (starting\n  // from bottom).\n  ctx.strokeStyle = \"red\";\n  ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n  ctx.strokeText(\"g\", 0, 0);\n  let pixels = ctx.getImageData(\n    0,\n    0,\n    DEFAULT_FONT_SIZE,\n    DEFAULT_FONT_SIZE\n  ).data;\n  descent = 0;\n  for (let i = pixels.length - 1 - 3; i >= 0; i -= 4) {\n    if (pixels[i] > 0) {\n      descent = Math.ceil(i / 4 / DEFAULT_FONT_SIZE);\n      break;\n    }\n  }\n\n  // Draw an A with baseline at 0,DEFAULT_FONT_SIZE and then get the line\n  // number where a pixel has non-null red component (starting\n  // from top).\n  ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n  ctx.strokeText(\"A\", 0, DEFAULT_FONT_SIZE);\n  pixels = ctx.getImageData(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE).data;\n  ascent = 0;\n  for (let i = 0, ii = pixels.length; i < ii; i += 4) {\n    if (pixels[i] > 0) {\n      ascent = DEFAULT_FONT_SIZE - Math.floor(i / 4 / DEFAULT_FONT_SIZE);\n      break;\n    }\n  }\n\n  ctx.canvas.width = ctx.canvas.height = 0;\n\n  if (ascent) {\n    const ratio = ascent / (ascent + descent);\n    ascentCache.set(fontFamily, ratio);\n    return ratio;\n  }\n\n  ascentCache.set(fontFamily, DEFAULT_FONT_ASCENT);\n  return DEFAULT_FONT_ASCENT;\n}\n\nfunction appendText(task, geom, styles) {\n  // Initialize all used properties to keep the caches monomorphic.\n  const textDiv = document.createElement(\"span\");\n  const textDivProperties = {\n    angle: 0,\n    canvasWidth: 0,\n    hasText: geom.str !== \"\",\n    hasEOL: geom.hasEOL,\n    fontSize: 0,\n  };\n  task._textDivs.push(textDiv);\n\n  const tx = Util.transform(task._transform, geom.transform);\n  let angle = Math.atan2(tx[1], tx[0]);\n  const style = styles[geom.fontName];\n  if (style.vertical) {\n    angle += Math.PI / 2;\n  }\n  const fontHeight = Math.hypot(tx[2], tx[3]);\n  const fontAscent =\n    fontHeight * getAscent(style.fontFamily, task._isOffscreenCanvasSupported);\n\n  let left, top;\n  if (angle === 0) {\n    left = tx[4];\n    top = tx[5] - fontAscent;\n  } else {\n    left = tx[4] + fontAscent * Math.sin(angle);\n    top = tx[5] - fontAscent * Math.cos(angle);\n  }\n\n  const scaleFactorStr = \"calc(var(--scale-factor)*\";\n  const divStyle = textDiv.style;\n  // Setting the style properties individually, rather than all at once,\n  // should be OK since the `textDiv` isn't appended to the document yet.\n  if (task._container === task._rootContainer) {\n    divStyle.left = `${((100 * left) / task._pageWidth).toFixed(2)}%`;\n    divStyle.top = `${((100 * top) / task._pageHeight).toFixed(2)}%`;\n  } else {\n    // We're in a marked content span, hence we can't use percents.\n    divStyle.left = `${scaleFactorStr}${left.toFixed(2)}px)`;\n    divStyle.top = `${scaleFactorStr}${top.toFixed(2)}px)`;\n  }\n  divStyle.fontSize = `${scaleFactorStr}${fontHeight.toFixed(2)}px)`;\n  divStyle.fontFamily = style.fontFamily;\n\n  textDivProperties.fontSize = fontHeight;\n\n  // Keeps screen readers from pausing on every new text span.\n  textDiv.setAttribute(\"role\", \"presentation\");\n\n  textDiv.textContent = geom.str;\n  // geom.dir may be 'ttb' for vertical texts.\n  textDiv.dir = geom.dir;\n\n  // `fontName` is only used by the FontInspector, and we only use `dataset`\n  // here to make the font name available in the debugger.\n  if (task._fontInspectorEnabled) {\n    textDiv.dataset.fontName = geom.fontName;\n  }\n  if (angle !== 0) {\n    textDivProperties.angle = angle * (180 / Math.PI);\n  }\n  // We don't bother scaling single-char text divs, because it has very\n  // little effect on text highlighting. This makes scrolling on docs with\n  // lots of such divs a lot faster.\n  let shouldScaleText = false;\n  if (geom.str.length > 1) {\n    shouldScaleText = true;\n  } else if (geom.str !== \" \" && geom.transform[0] !== geom.transform[3]) {\n    const absScaleX = Math.abs(geom.transform[0]),\n      absScaleY = Math.abs(geom.transform[3]);\n    // When the horizontal/vertical scaling differs significantly, also scale\n    // even single-char text to improve highlighting (fixes issue11713.pdf).\n    if (\n      absScaleX !== absScaleY &&\n      Math.max(absScaleX, absScaleY) / Math.min(absScaleX, absScaleY) > 1.5\n    ) {\n      shouldScaleText = true;\n    }\n  }\n  if (shouldScaleText) {\n    textDivProperties.canvasWidth = style.vertical ? geom.height : geom.width;\n  }\n  task._textDivProperties.set(textDiv, textDivProperties);\n  if (task._isReadableStream) {\n    task._layoutText(textDiv);\n  }\n}\n\nfunction layout(params) {\n  const { div, scale, properties, ctx, prevFontSize, prevFontFamily } = params;\n  const { style } = div;\n  let transform = \"\";\n  if (properties.canvasWidth !== 0 && properties.hasText) {\n    const { fontFamily } = style;\n    const { canvasWidth, fontSize } = properties;\n\n    if (prevFontSize !== fontSize || prevFontFamily !== fontFamily) {\n      ctx.font = `${fontSize * scale}px ${fontFamily}`;\n      params.prevFontSize = fontSize;\n      params.prevFontFamily = fontFamily;\n    }\n\n    // Only measure the width for multi-char text divs, see `appendText`.\n    const { width } = ctx.measureText(div.textContent);\n\n    if (width > 0) {\n      transform = `scaleX(${(canvasWidth * scale) / width})`;\n    }\n  }\n  if (properties.angle !== 0) {\n    transform = `rotate(${properties.angle}deg) ${transform}`;\n  }\n  if (transform.length > 0) {\n    style.transform = transform;\n  }\n}\n\nfunction render(task) {\n  if (task._canceled) {\n    return;\n  }\n  const textDivs = task._textDivs;\n  const capability = task._capability;\n  const textDivsLength = textDivs.length;\n\n  // No point in rendering many divs as it would make the browser\n  // unusable even after the divs are rendered.\n  if (textDivsLength > MAX_TEXT_DIVS_TO_RENDER) {\n    capability.resolve();\n    return;\n  }\n\n  if (!task._isReadableStream) {\n    for (const textDiv of textDivs) {\n      task._layoutText(textDiv);\n    }\n  }\n  capability.resolve();\n}\n\nclass TextLayerRenderTask {\n  constructor({\n    textContentSource,\n    container,\n    viewport,\n    textDivs,\n    textDivProperties,\n    textContentItemsStr,\n    isOffscreenCanvasSupported,\n  }) {\n    this._textContentSource = textContentSource;\n    this._isReadableStream = textContentSource instanceof ReadableStream;\n    this._container = this._rootContainer = container;\n    this._textDivs = textDivs || [];\n    this._textContentItemsStr = textContentItemsStr || [];\n    this._isOffscreenCanvasSupported = isOffscreenCanvasSupported;\n    this._fontInspectorEnabled = !!globalThis.FontInspector?.enabled;\n\n    this._reader = null;\n    this._textDivProperties = textDivProperties || new WeakMap();\n    this._canceled = false;\n    this._capability = new PromiseCapability();\n    this._layoutTextParams = {\n      prevFontSize: null,\n      prevFontFamily: null,\n      div: null,\n      scale: viewport.scale * (globalThis.devicePixelRatio || 1),\n      properties: null,\n      ctx: getCtx(0, isOffscreenCanvasSupported),\n    };\n    const { pageWidth, pageHeight, pageX, pageY } = viewport.rawDims;\n    this._transform = [1, 0, 0, -1, -pageX, pageY + pageHeight];\n    this._pageWidth = pageWidth;\n    this._pageHeight = pageHeight;\n\n    setLayerDimensions(container, viewport);\n\n    // Always clean-up the temporary canvas once rendering is no longer pending.\n    this._capability.promise\n      .finally(() => {\n        this._layoutTextParams = null;\n      })\n      .catch(() => {\n        // Avoid \"Uncaught promise\" messages in the console.\n      });\n  }\n\n  /**\n   * Promise for textLayer rendering task completion.\n   * @type {Promise<void>}\n   */\n  get promise() {\n    return this._capability.promise;\n  }\n\n  /**\n   * Cancel rendering of the textLayer.\n   */\n  cancel() {\n    this._canceled = true;\n    if (this._reader) {\n      this._reader\n        .cancel(new AbortException(\"TextLayer task cancelled.\"))\n        .catch(() => {\n          // Avoid \"Uncaught promise\" messages in the console.\n        });\n      this._reader = null;\n    }\n    this._capability.reject(new AbortException(\"TextLayer task cancelled.\"));\n  }\n\n  /**\n   * @private\n   */\n  _processItems(items, styleCache) {\n    for (const item of items) {\n      if (item.str === undefined) {\n        if (\n          item.type === \"beginMarkedContentProps\" ||\n          item.type === \"beginMarkedContent\"\n        ) {\n          const parent = this._container;\n          this._container = document.createElement(\"span\");\n          this._container.classList.add(\"markedContent\");\n          if (item.id !== null) {\n            this._container.setAttribute(\"id\", `${item.id}`);\n          }\n          parent.append(this._container);\n        } else if (item.type === \"endMarkedContent\") {\n          this._container = this._container.parentNode;\n        }\n        continue;\n      }\n      this._textContentItemsStr.push(item.str);\n      appendText(this, item, styleCache);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _layoutText(textDiv) {\n    const textDivProperties = (this._layoutTextParams.properties =\n      this._textDivProperties.get(textDiv));\n    this._layoutTextParams.div = textDiv;\n    layout(this._layoutTextParams);\n\n    if (textDivProperties.hasText) {\n      this._container.append(textDiv);\n    }\n    if (textDivProperties.hasEOL) {\n      const br = document.createElement(\"br\");\n      br.setAttribute(\"role\", \"presentation\");\n      this._container.append(br);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _render() {\n    const capability = new PromiseCapability();\n    let styleCache = Object.create(null);\n\n    if (this._isReadableStream) {\n      const pump = () => {\n        this._reader.read().then(({ value, done }) => {\n          if (done) {\n            capability.resolve();\n            return;\n          }\n\n          Object.assign(styleCache, value.styles);\n          this._processItems(value.items, styleCache);\n          pump();\n        }, capability.reject);\n      };\n\n      this._reader = this._textContentSource.getReader();\n      pump();\n    } else if (this._textContentSource) {\n      const { items, styles } = this._textContentSource;\n      this._processItems(items, styles);\n      capability.resolve();\n    } else {\n      throw new Error('No \"textContentSource\" parameter specified.');\n    }\n\n    capability.promise.then(() => {\n      styleCache = null;\n      render(this);\n    }, this._capability.reject);\n  }\n}\n\n/**\n * @param {TextLayerRenderParameters} params\n * @returns {TextLayerRenderTask}\n */\nfunction renderTextLayer(params) {\n  if (\n    (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n    !params.textContentSource &&\n    (params.textContent || params.textContentStream)\n  ) {\n    deprecated(\n      \"The TextLayerRender `textContent`/`textContentStream` parameters \" +\n        \"will be removed in the future, please use `textContentSource` instead.\"\n    );\n    params.textContentSource = params.textContent || params.textContentStream;\n  }\n  if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC && !TESTING\")) {\n    const { container, viewport } = params;\n    const style = getComputedStyle(container);\n    const visibility = style.getPropertyValue(\"visibility\");\n    const scaleFactor = parseFloat(style.getPropertyValue(\"--scale-factor\"));\n\n    if (\n      visibility === \"visible\" &&\n      (!scaleFactor || Math.abs(scaleFactor - viewport.scale) > 1e-5)\n    ) {\n      console.error(\n        \"The `--scale-factor` CSS-variable must be set, \" +\n          \"to the same value as `viewport.scale`, \" +\n          \"either on the `container`-element itself or higher up in the DOM.\"\n      );\n    }\n  }\n  const task = new TextLayerRenderTask(params);\n  task._render();\n  return task;\n}\n\n/**\n * @param {TextLayerUpdateParameters} params\n * @returns {undefined}\n */\nfunction updateTextLayer({\n  container,\n  viewport,\n  textDivs,\n  textDivProperties,\n  isOffscreenCanvasSupported,\n  mustRotate = true,\n  mustRescale = true,\n}) {\n  if (mustRotate) {\n    setLayerDimensions(container, { rotation: viewport.rotation });\n  }\n\n  if (mustRescale) {\n    const ctx = getCtx(0, isOffscreenCanvasSupported);\n    const scale = viewport.scale * (globalThis.devicePixelRatio || 1);\n    const params = {\n      prevFontSize: null,\n      prevFontFamily: null,\n      div: null,\n      scale,\n      properties: null,\n      ctx,\n    };\n    for (const div of textDivs) {\n      params.properties = textDivProperties.get(div);\n      params.div = div;\n      layout(params);\n    }\n  }\n}\n\nexport { renderTextLayer, TextLayerRenderTask, updateTextLayer };\n", "/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./tools.js\").AnnotationEditorUIManager} AnnotationEditorUIManager */\n/** @typedef {import(\"../display_utils.js\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../../web/text_accessibility.js\").TextAccessibilityManager} TextAccessibilityManager */\n/** @typedef {import(\"../../web/interfaces\").IL10n} IL10n */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/annotation_layer.js\").AnnotationLayer} AnnotationLayer */\n\nimport { AnnotationEditorType, FeatureTest } from \"../../shared/util.js\";\nimport { AnnotationEditor } from \"./editor.js\";\nimport { bindEvents } from \"./tools.js\";\nimport { FreeTextEditor } from \"./freetext.js\";\nimport { InkEditor } from \"./ink.js\";\nimport { setLayerDimensions } from \"../display_utils.js\";\n\n/**\n * @typedef {Object} AnnotationEditorLayerOptions\n * @property {Object} mode\n * @property {HTMLDivElement} div\n * @property {AnnotationEditorUIManager} uiManager\n * @property {boolean} enabled\n * @property {TextAccessibilityManager} [accessibilityManager]\n * @property {number} pageIndex\n * @property {IL10n} l10n\n * @property {AnnotationLayer} [annotationLayer]\n */\n\n/**\n * @typedef {Object} RenderEditorLayerOptions\n * @property {PageViewport} viewport\n */\n\n/**\n * Manage all the different editors on a page.\n */\nclass AnnotationEditorLayer {\n  #accessibilityManager;\n\n  #allowClick = false;\n\n  #annotationLayer = null;\n\n  #boundPointerup = this.pointerup.bind(this);\n\n  #boundPointerdown = this.pointerdown.bind(this);\n\n  #editors = new Map();\n\n  #hadPointerDown = false;\n\n  #isCleaningUp = false;\n\n  #isDisabling = false;\n\n  #uiManager;\n\n  static _initialized = false;\n\n  /**\n   * @param {AnnotationEditorLayerOptions} options\n   */\n  constructor(options) {\n    if (!AnnotationEditorLayer._initialized) {\n      AnnotationEditorLayer._initialized = true;\n      FreeTextEditor.initialize(options.l10n);\n      InkEditor.initialize(options.l10n);\n    }\n    options.uiManager.registerEditorTypes([FreeTextEditor, InkEditor]);\n\n    this.#uiManager = options.uiManager;\n    this.pageIndex = options.pageIndex;\n    this.div = options.div;\n    this.#accessibilityManager = options.accessibilityManager;\n    this.#annotationLayer = options.annotationLayer;\n    this.viewport = options.viewport;\n\n    this.#uiManager.addLayer(this);\n  }\n\n  get isEmpty() {\n    return this.#editors.size === 0;\n  }\n\n  /**\n   * Update the toolbar if it's required to reflect the tool currently used.\n   * @param {number} mode\n   */\n  updateToolbar(mode) {\n    this.#uiManager.updateToolbar(mode);\n  }\n\n  /**\n   * The mode has changed: it must be updated.\n   * @param {number} mode\n   */\n  updateMode(mode = this.#uiManager.getMode()) {\n    this.#cleanup();\n    if (mode === AnnotationEditorType.INK) {\n      // We always want to an ink editor ready to draw in.\n      this.addInkEditorIfNeeded(false);\n      this.disableClick();\n    } else {\n      this.enableClick();\n    }\n    this.#uiManager.unselectAll();\n\n    if (mode !== AnnotationEditorType.NONE) {\n      this.div.classList.toggle(\n        \"freeTextEditing\",\n        mode === AnnotationEditorType.FREETEXT\n      );\n      this.div.classList.toggle(\n        \"inkEditing\",\n        mode === AnnotationEditorType.INK\n      );\n      this.div.hidden = false;\n    }\n  }\n\n  addInkEditorIfNeeded(isCommitting) {\n    if (\n      !isCommitting &&\n      this.#uiManager.getMode() !== AnnotationEditorType.INK\n    ) {\n      return;\n    }\n\n    if (!isCommitting) {\n      // We're removing an editor but an empty one can already exist so in this\n      // case we don't need to create a new one.\n      for (const editor of this.#editors.values()) {\n        if (editor.isEmpty()) {\n          editor.setInBackground();\n          return;\n        }\n      }\n    }\n\n    const editor = this.#createAndAddNewEditor({ offsetX: 0, offsetY: 0 });\n    editor.setInBackground();\n  }\n\n  /**\n   * Set the editing state.\n   * @param {boolean} isEditing\n   */\n  setEditingState(isEditing) {\n    this.#uiManager.setEditingState(isEditing);\n  }\n\n  /**\n   * Add some commands into the CommandManager (undo/redo stuff).\n   * @param {Object} params\n   */\n  addCommands(params) {\n    this.#uiManager.addCommands(params);\n  }\n\n  /**\n   * Enable pointer events on the main div in order to enable\n   * editor creation.\n   */\n  enable() {\n    this.div.style.pointerEvents = \"auto\";\n    const annotationElementIds = new Set();\n    for (const editor of this.#editors.values()) {\n      editor.enableEditing();\n      if (editor.annotationElementId) {\n        annotationElementIds.add(editor.annotationElementId);\n      }\n    }\n\n    if (!this.#annotationLayer) {\n      return;\n    }\n\n    const editables = this.#annotationLayer.getEditableAnnotations();\n    for (const editable of editables) {\n      // The element must be hidden whatever its state is.\n      editable.hide();\n      if (this.#uiManager.isDeletedAnnotationElement(editable.data.id)) {\n        continue;\n      }\n      if (annotationElementIds.has(editable.data.id)) {\n        continue;\n      }\n      const editor = this.deserialize(editable);\n      if (!editor) {\n        continue;\n      }\n      this.addOrRebuild(editor);\n      editor.enableEditing();\n    }\n  }\n\n  /**\n   * Disable editor creation.\n   */\n  disable() {\n    this.#isDisabling = true;\n    this.div.style.pointerEvents = \"none\";\n    const hiddenAnnotationIds = new Set();\n    for (const editor of this.#editors.values()) {\n      editor.disableEditing();\n      if (!editor.annotationElementId || editor.serialize() !== null) {\n        hiddenAnnotationIds.add(editor.annotationElementId);\n        continue;\n      }\n      this.getEditableAnnotation(editor.annotationElementId)?.show();\n      editor.remove();\n    }\n\n    if (this.#annotationLayer) {\n      // Show the annotations that were hidden in enable().\n      const editables = this.#annotationLayer.getEditableAnnotations();\n      for (const editable of editables) {\n        const { id } = editable.data;\n        if (\n          hiddenAnnotationIds.has(id) ||\n          this.#uiManager.isDeletedAnnotationElement(id)\n        ) {\n          continue;\n        }\n        editable.show();\n      }\n    }\n\n    this.#cleanup();\n    if (this.isEmpty) {\n      this.div.hidden = true;\n    }\n    this.#isDisabling = false;\n  }\n\n  getEditableAnnotation(id) {\n    return this.#annotationLayer?.getEditableAnnotation(id) || null;\n  }\n\n  /**\n   * Set the current editor.\n   * @param {AnnotationEditor} editor\n   */\n  setActiveEditor(editor) {\n    const currentActive = this.#uiManager.getActive();\n    if (currentActive === editor) {\n      return;\n    }\n\n    this.#uiManager.setActiveEditor(editor);\n  }\n\n  enableClick() {\n    this.div.addEventListener(\"pointerdown\", this.#boundPointerdown);\n    this.div.addEventListener(\"pointerup\", this.#boundPointerup);\n  }\n\n  disableClick() {\n    this.div.removeEventListener(\"pointerdown\", this.#boundPointerdown);\n    this.div.removeEventListener(\"pointerup\", this.#boundPointerup);\n  }\n\n  attach(editor) {\n    this.#editors.set(editor.id, editor);\n    const { annotationElementId } = editor;\n    if (\n      annotationElementId &&\n      this.#uiManager.isDeletedAnnotationElement(annotationElementId)\n    ) {\n      this.#uiManager.removeDeletedAnnotationElement(editor);\n    }\n  }\n\n  detach(editor) {\n    this.#editors.delete(editor.id);\n    this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n\n    if (!this.#isDisabling && editor.annotationElementId) {\n      this.#uiManager.addDeletedAnnotationElement(editor);\n    }\n  }\n\n  /**\n   * Remove an editor.\n   * @param {AnnotationEditor} editor\n   */\n  remove(editor) {\n    // Since we can undo a removal we need to keep the\n    // parent property as it is, so don't null it!\n\n    this.detach(editor);\n    this.#uiManager.removeEditor(editor);\n    editor.div.style.display = \"none\";\n    setTimeout(() => {\n      // When the div is removed from DOM the focus can move on the\n      // document.body, so we just slightly postpone the removal in\n      // order to let an element potentially grab the focus before\n      // the body.\n      editor.div.style.display = \"\";\n      editor.div.remove();\n      editor.isAttachedToDOM = false;\n      if (document.activeElement === document.body) {\n        this.#uiManager.focusMainContainer();\n      }\n    }, 0);\n\n    if (!this.#isCleaningUp) {\n      this.addInkEditorIfNeeded(/* isCommitting = */ false);\n    }\n  }\n\n  /**\n   * An editor can have a different parent, for example after having\n   * being dragged and droped from a page to another.\n   * @param {AnnotationEditor} editor\n   */\n  #changeParent(editor) {\n    if (editor.parent === this) {\n      return;\n    }\n\n    if (editor.annotationElementId) {\n      this.#uiManager.addDeletedAnnotationElement(editor.annotationElementId);\n      AnnotationEditor.deleteAnnotationElement(editor);\n      editor.annotationElementId = null;\n    }\n\n    this.attach(editor);\n    editor.parent?.detach(editor);\n    editor.setParent(this);\n    if (editor.div && editor.isAttachedToDOM) {\n      editor.div.remove();\n      this.div.append(editor.div);\n    }\n  }\n\n  /**\n   * Add a new editor in the current view.\n   * @param {AnnotationEditor} editor\n   */\n  add(editor) {\n    this.#changeParent(editor);\n    this.#uiManager.addEditor(editor);\n    this.attach(editor);\n\n    if (!editor.isAttachedToDOM) {\n      const div = editor.render();\n      this.div.append(div);\n      editor.isAttachedToDOM = true;\n    }\n\n    this.moveEditorInDOM(editor);\n    editor.onceAdded();\n    this.#uiManager.addToAnnotationStorage(editor);\n  }\n\n  moveEditorInDOM(editor) {\n    this.#accessibilityManager?.moveElementInDOM(\n      this.div,\n      editor.div,\n      editor.contentDiv,\n      /* isRemovable = */ true\n    );\n  }\n\n  /**\n   * Add or rebuild depending if it has been removed or not.\n   * @param {AnnotationEditor} editor\n   */\n  addOrRebuild(editor) {\n    if (editor.needsToBeRebuilt()) {\n      editor.rebuild();\n    } else {\n      this.add(editor);\n    }\n  }\n\n  /**\n   * Get an id for an editor.\n   * @returns {string}\n   */\n  getNextId() {\n    return this.#uiManager.getId();\n  }\n\n  /**\n   * Create a new editor\n   * @param {Object} params\n   * @returns {AnnotationEditor}\n   */\n  #createNewEditor(params) {\n    switch (this.#uiManager.getMode()) {\n      case AnnotationEditorType.FREETEXT:\n        return new FreeTextEditor(params);\n      case AnnotationEditorType.INK:\n        return new InkEditor(params);\n    }\n    return null;\n  }\n\n  /**\n   * Create a new editor\n   * @param {Object} data\n   * @returns {AnnotationEditor}\n   */\n  deserialize(data) {\n    switch (data.annotationType ?? data.annotationEditorType) {\n      case AnnotationEditorType.FREETEXT:\n        return FreeTextEditor.deserialize(data, this, this.#uiManager);\n      case AnnotationEditorType.INK:\n        return InkEditor.deserialize(data, this, this.#uiManager);\n    }\n    return null;\n  }\n\n  /**\n   * Create and add a new editor.\n   * @param {PointerEvent} event\n   * @returns {AnnotationEditor}\n   */\n  #createAndAddNewEditor(event) {\n    const id = this.getNextId();\n    const editor = this.#createNewEditor({\n      parent: this,\n      id,\n      x: event.offsetX,\n      y: event.offsetY,\n      uiManager: this.#uiManager,\n    });\n    if (editor) {\n      this.add(editor);\n    }\n\n    return editor;\n  }\n\n  /**\n   * Set the last selected editor.\n   * @param {AnnotationEditor} editor\n   */\n  setSelected(editor) {\n    this.#uiManager.setSelected(editor);\n  }\n\n  /**\n   * Add or remove an editor the current selection.\n   * @param {AnnotationEditor} editor\n   */\n  toggleSelected(editor) {\n    this.#uiManager.toggleSelected(editor);\n  }\n\n  /**\n   * Check if the editor is selected.\n   * @param {AnnotationEditor} editor\n   */\n  isSelected(editor) {\n    return this.#uiManager.isSelected(editor);\n  }\n\n  /**\n   * Unselect an editor.\n   * @param {AnnotationEditor} editor\n   */\n  unselect(editor) {\n    this.#uiManager.unselect(editor);\n  }\n\n  /**\n   * Pointerup callback.\n   * @param {PointerEvent} event\n   */\n  pointerup(event) {\n    const { isMac } = FeatureTest.platform;\n    if (event.button !== 0 || (event.ctrlKey && isMac)) {\n      // Don't create an editor on right click.\n      return;\n    }\n\n    if (event.target !== this.div) {\n      return;\n    }\n\n    if (!this.#hadPointerDown) {\n      // It can happen when the user starts a drag inside a text editor\n      // and then releases the mouse button outside of it. In such a case\n      // we don't want to create a new editor, hence we check that a pointerdown\n      // occurred on this div previously.\n      return;\n    }\n    this.#hadPointerDown = false;\n\n    if (!this.#allowClick) {\n      this.#allowClick = true;\n      return;\n    }\n\n    this.#createAndAddNewEditor(event);\n  }\n\n  /**\n   * Pointerdown callback.\n   * @param {PointerEvent} event\n   */\n  pointerdown(event) {\n    const { isMac } = FeatureTest.platform;\n    if (event.button !== 0 || (event.ctrlKey && isMac)) {\n      // Do nothing on right click.\n      return;\n    }\n\n    if (event.target !== this.div) {\n      return;\n    }\n\n    this.#hadPointerDown = true;\n\n    const editor = this.#uiManager.getActive();\n    this.#allowClick = !editor || editor.isEmpty();\n  }\n\n  /**\n   * Drag callback.\n   * @param {DragEvent} event\n   */\n  drop(event) {\n    const id = event.dataTransfer.getData(\"text/plain\");\n    const editor = this.#uiManager.getEditor(id);\n    if (!editor) {\n      return;\n    }\n\n    event.preventDefault();\n    event.dataTransfer.dropEffect = \"move\";\n\n    this.#changeParent(editor);\n\n    const rect = this.div.getBoundingClientRect();\n    const endX = event.clientX - rect.x;\n    const endY = event.clientY - rect.y;\n\n    editor.translate(endX - editor.startX, endY - editor.startY);\n    this.moveEditorInDOM(editor);\n    editor.div.focus();\n  }\n\n  /**\n   * Dragover callback.\n   * @param {DragEvent} event\n   */\n  dragover(event) {\n    event.preventDefault();\n  }\n\n  /**\n   * Destroy the main editor.\n   */\n  destroy() {\n    if (this.#uiManager.getActive()?.parent === this) {\n      this.#uiManager.setActiveEditor(null);\n    }\n\n    for (const editor of this.#editors.values()) {\n      this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n      editor.setParent(null);\n      editor.isAttachedToDOM = false;\n      editor.div.remove();\n    }\n    this.div = null;\n    this.#editors.clear();\n    this.#uiManager.removeLayer(this);\n  }\n\n  #cleanup() {\n    // When we're cleaning up, some editors are removed but we don't want\n    // to add a new one which will induce an addition in this.#editors, hence\n    // an infinite loop.\n    this.#isCleaningUp = true;\n    for (const editor of this.#editors.values()) {\n      if (editor.isEmpty()) {\n        editor.remove();\n      }\n    }\n    this.#isCleaningUp = false;\n  }\n\n  /**\n   * Render the main editor.\n   * @param {RenderEditorLayerOptions} parameters\n   */\n  render({ viewport }) {\n    this.viewport = viewport;\n    setLayerDimensions(this.div, viewport);\n    bindEvents(this, this.div, [\"dragover\", \"drop\"]);\n    for (const editor of this.#uiManager.getEditors(this.pageIndex)) {\n      this.add(editor);\n    }\n    this.updateMode();\n  }\n\n  /**\n   * Update the main editor.\n   * @param {RenderEditorLayerOptions} parameters\n   */\n  update({ viewport }) {\n    // Editors have their dimensions/positions in percent so to avoid any\n    // issues (see #15582), we must commit the current one before changing\n    // the viewport.\n    this.#uiManager.commitOrRemove();\n\n    this.viewport = viewport;\n    setLayerDimensions(this.div, { rotation: viewport.rotation });\n    this.updateMode();\n  }\n\n  /**\n   * Get page dimensions.\n   * @returns {Object} dimensions.\n   */\n  get pageDimensions() {\n    const { pageWidth, pageHeight } = this.viewport.rawDims;\n    return [pageWidth, pageHeight];\n  }\n}\n\nexport { AnnotationEditorLayer };\n", "/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./annotation_editor_layer.js\").AnnotationEditorLayer} AnnotationEditorLayer */\n\nimport {\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  assert,\n  LINE_FACTOR,\n  shadow,\n  Util,\n} from \"../../shared/util.js\";\nimport { bindEvents, KeyboardManager } from \"./tools.js\";\nimport { AnnotationEditor } from \"./editor.js\";\nimport { FreeTextAnnotationElement } from \"../annotation_layer.js\";\n\n/**\n * Basic text editor in order to create a FreeTex annotation.\n */\nclass FreeTextEditor extends AnnotationEditor {\n  #boundEditorDivBlur = this.editorDivBlur.bind(this);\n\n  #boundEditorDivFocus = this.editorDivFocus.bind(this);\n\n  #boundEditorDivInput = this.editorDivInput.bind(this);\n\n  #boundEditorDivKeydown = this.editorDivKeydown.bind(this);\n\n  #color;\n\n  #content = \"\";\n\n  #editorDivId = `${this.id}-editor`;\n\n  #fontSize;\n\n  #initialData = null;\n\n  static _freeTextDefaultContent = \"\";\n\n  static _l10nPromise;\n\n  static _internalPadding = 0;\n\n  static _defaultColor = null;\n\n  static _defaultFontSize = 10;\n\n  static get _keyboardManager() {\n    return shadow(\n      this,\n      \"_keyboardManager\",\n      new KeyboardManager([\n        [\n          // Commit the text in case the user use ctrl+s to save the document.\n          // The event must bubble in order to be caught by the viewer.\n          // See bug 1831574.\n          [\"ctrl+s\", \"mac+meta+s\", \"ctrl+p\", \"mac+meta+p\"],\n          FreeTextEditor.prototype.commitOrRemove,\n          /* bubbles = */ true,\n        ],\n        [\n          [\"ctrl+Enter\", \"mac+meta+Enter\", \"Escape\", \"mac+Escape\"],\n          FreeTextEditor.prototype.commitOrRemove,\n        ],\n      ])\n    );\n  }\n\n  static _type = \"freetext\";\n\n  constructor(params) {\n    super({ ...params, name: \"freeTextEditor\" });\n    this.#color =\n      params.color ||\n      FreeTextEditor._defaultColor ||\n      AnnotationEditor._defaultLineColor;\n    this.#fontSize = params.fontSize || FreeTextEditor._defaultFontSize;\n  }\n\n  static initialize(l10n) {\n    this._l10nPromise = new Map(\n      [\"free_text2_default_content\", \"editor_free_text2_aria_label\"].map(\n        str => [str, l10n.get(str)]\n      )\n    );\n\n    const style = getComputedStyle(document.documentElement);\n\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      const lineHeight = parseFloat(\n        style.getPropertyValue(\"--freetext-line-height\")\n      );\n      assert(\n        lineHeight === LINE_FACTOR,\n        \"Update the CSS variable to agree with the constant.\"\n      );\n    }\n\n    this._internalPadding = parseFloat(\n      style.getPropertyValue(\"--freetext-padding\")\n    );\n  }\n\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.FREETEXT_SIZE:\n        FreeTextEditor._defaultFontSize = value;\n        break;\n      case AnnotationEditorParamsType.FREETEXT_COLOR:\n        FreeTextEditor._defaultColor = value;\n        break;\n    }\n  }\n\n  /** @inheritdoc */\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.FREETEXT_SIZE:\n        this.#updateFontSize(value);\n        break;\n      case AnnotationEditorParamsType.FREETEXT_COLOR:\n        this.#updateColor(value);\n        break;\n    }\n  }\n\n  static get defaultPropertiesToUpdate() {\n    return [\n      [\n        AnnotationEditorParamsType.FREETEXT_SIZE,\n        FreeTextEditor._defaultFontSize,\n      ],\n      [\n        AnnotationEditorParamsType.FREETEXT_COLOR,\n        FreeTextEditor._defaultColor || AnnotationEditor._defaultLineColor,\n      ],\n    ];\n  }\n\n  get propertiesToUpdate() {\n    return [\n      [AnnotationEditorParamsType.FREETEXT_SIZE, this.#fontSize],\n      [AnnotationEditorParamsType.FREETEXT_COLOR, this.#color],\n    ];\n  }\n\n  /**\n   * Update the font size and make this action as undoable.\n   * @param {number} fontSize\n   */\n  #updateFontSize(fontSize) {\n    const setFontsize = size => {\n      this.editorDiv.style.fontSize = `calc(${size}px * var(--scale-factor))`;\n      this.translate(0, -(size - this.#fontSize) * this.parentScale);\n      this.#fontSize = size;\n      this.#setEditorDimensions();\n    };\n    const savedFontsize = this.#fontSize;\n    this.addCommands({\n      cmd: () => {\n        setFontsize(fontSize);\n      },\n      undo: () => {\n        setFontsize(savedFontsize);\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.FREETEXT_SIZE,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /**\n   * Update the color and make this action undoable.\n   * @param {string} color\n   */\n  #updateColor(color) {\n    const savedColor = this.#color;\n    this.addCommands({\n      cmd: () => {\n        this.#color = this.editorDiv.style.color = color;\n      },\n      undo: () => {\n        this.#color = this.editorDiv.style.color = savedColor;\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.FREETEXT_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /** @inheritdoc */\n  getInitialTranslation() {\n    // The start of the base line is where the user clicked.\n    const scale = this.parentScale;\n    return [\n      -FreeTextEditor._internalPadding * scale,\n      -(FreeTextEditor._internalPadding + this.#fontSize) * scale,\n    ];\n  }\n\n  /** @inheritdoc */\n  rebuild() {\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n\n    if (!this.isAttachedToDOM) {\n      // At some point this editor was removed and we're rebuilting it,\n      // hence we must add it to its parent.\n      this.parent.add(this);\n    }\n  }\n\n  /** @inheritdoc */\n  enableEditMode() {\n    if (this.isInEditMode()) {\n      return;\n    }\n\n    this.parent.setEditingState(false);\n    this.parent.updateToolbar(AnnotationEditorType.FREETEXT);\n    super.enableEditMode();\n    this.overlayDiv.classList.remove(\"enabled\");\n    this.editorDiv.contentEditable = true;\n    this.div.draggable = false;\n    this.div.removeAttribute(\"aria-activedescendant\");\n    this.editorDiv.addEventListener(\"keydown\", this.#boundEditorDivKeydown);\n    this.editorDiv.addEventListener(\"focus\", this.#boundEditorDivFocus);\n    this.editorDiv.addEventListener(\"blur\", this.#boundEditorDivBlur);\n    this.editorDiv.addEventListener(\"input\", this.#boundEditorDivInput);\n  }\n\n  /** @inheritdoc */\n  disableEditMode() {\n    if (!this.isInEditMode()) {\n      return;\n    }\n\n    this.parent.setEditingState(true);\n    super.disableEditMode();\n    this.overlayDiv.classList.add(\"enabled\");\n    this.editorDiv.contentEditable = false;\n    this.div.setAttribute(\"aria-activedescendant\", this.#editorDivId);\n    this.div.draggable = true;\n    this.editorDiv.removeEventListener(\"keydown\", this.#boundEditorDivKeydown);\n    this.editorDiv.removeEventListener(\"focus\", this.#boundEditorDivFocus);\n    this.editorDiv.removeEventListener(\"blur\", this.#boundEditorDivBlur);\n    this.editorDiv.removeEventListener(\"input\", this.#boundEditorDivInput);\n\n    // On Chrome, the focus is given to <body> when contentEditable is set to\n    // false, hence we focus the div.\n    this.div.focus({\n      preventScroll: true /* See issue #15744 */,\n    });\n\n    // In case the blur callback hasn't been called.\n    this.isEditing = false;\n    this.parent.div.classList.add(\"freeTextEditing\");\n  }\n\n  /** @inheritdoc */\n  focusin(event) {\n    super.focusin(event);\n    if (event.target !== this.editorDiv) {\n      this.editorDiv.focus();\n    }\n  }\n\n  /** @inheritdoc */\n  onceAdded() {\n    if (this.width) {\n      this.#cheatInitialRect();\n      // The editor was created in using ctrl+c.\n      return;\n    }\n    this.enableEditMode();\n    this.editorDiv.focus();\n  }\n\n  /** @inheritdoc */\n  isEmpty() {\n    return !this.editorDiv || this.editorDiv.innerText.trim() === \"\";\n  }\n\n  /** @inheritdoc */\n  remove() {\n    this.isEditing = false;\n    this.parent.setEditingState(true);\n    this.parent.div.classList.add(\"freeTextEditing\");\n    super.remove();\n  }\n\n  /**\n   * Extract the text from this editor.\n   * @returns {string}\n   */\n  #extractText() {\n    const divs = this.editorDiv.getElementsByTagName(\"div\");\n    if (divs.length === 0) {\n      return this.editorDiv.innerText;\n    }\n    const buffer = [];\n    for (const div of divs) {\n      buffer.push(div.innerText.replace(/\\r\\n?|\\n/, \"\"));\n    }\n    return buffer.join(\"\\n\");\n  }\n\n  #setEditorDimensions() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n\n    let rect;\n    if (this.isAttachedToDOM) {\n      rect = this.div.getBoundingClientRect();\n    } else {\n      // This editor isn't on screen but we need to get its dimensions, so\n      // we just insert it in the DOM, get its bounding box and then remove it.\n      const { currentLayer, div } = this;\n      const savedDisplay = div.style.display;\n      div.style.display = \"hidden\";\n      currentLayer.div.append(this.div);\n      rect = div.getBoundingClientRect();\n      div.remove();\n      div.style.display = savedDisplay;\n    }\n\n    this.width = rect.width / parentWidth;\n    this.height = rect.height / parentHeight;\n  }\n\n  /**\n   * Commit the content we have in this editor.\n   * @returns {undefined}\n   */\n  commit() {\n    if (!this.isInEditMode()) {\n      return;\n    }\n\n    super.commit();\n    this.disableEditMode();\n    const savedText = this.#content;\n    const newText = (this.#content = this.#extractText().trimEnd());\n    if (savedText === newText) {\n      return;\n    }\n\n    const setText = text => {\n      this.#content = text;\n      if (!text) {\n        this.remove();\n        return;\n      }\n      this.#setContent();\n      this.rebuild();\n      this.#setEditorDimensions();\n    };\n    this.addCommands({\n      cmd: () => {\n        setText(newText);\n      },\n      undo: () => {\n        setText(savedText);\n      },\n      mustExec: false,\n    });\n    this.#setEditorDimensions();\n  }\n\n  /** @inheritdoc */\n  shouldGetKeyboardEvents() {\n    return this.isInEditMode();\n  }\n\n  /**\n   * ondblclick callback.\n   * @param {MouseEvent} event\n   */\n  dblclick(event) {\n    this.enableEditMode();\n    this.editorDiv.focus();\n  }\n\n  /**\n   * onkeydown callback.\n   * @param {KeyboardEvent} event\n   */\n  keydown(event) {\n    if (event.target === this.div && event.key === \"Enter\") {\n      this.enableEditMode();\n      this.editorDiv.focus();\n    }\n  }\n\n  editorDivKeydown(event) {\n    FreeTextEditor._keyboardManager.exec(this, event);\n  }\n\n  editorDivFocus(event) {\n    this.isEditing = true;\n  }\n\n  editorDivBlur(event) {\n    this.isEditing = false;\n  }\n\n  editorDivInput(event) {\n    this.parent.div.classList.toggle(\"freeTextEditing\", this.isEmpty());\n  }\n\n  /** @inheritdoc */\n  disableEditing() {\n    this.editorDiv.setAttribute(\"role\", \"comment\");\n    this.editorDiv.removeAttribute(\"aria-multiline\");\n  }\n\n  /** @inheritdoc */\n  enableEditing() {\n    this.editorDiv.setAttribute(\"role\", \"textbox\");\n    this.editorDiv.setAttribute(\"aria-multiline\", true);\n  }\n\n  /** @inheritdoc */\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    let baseX, baseY;\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n\n    super.render();\n    this.editorDiv = document.createElement(\"div\");\n    this.editorDiv.className = \"internal\";\n\n    this.editorDiv.setAttribute(\"id\", this.#editorDivId);\n    this.enableEditing();\n\n    FreeTextEditor._l10nPromise\n      .get(\"editor_free_text2_aria_label\")\n      .then(msg => this.editorDiv?.setAttribute(\"aria-label\", msg));\n\n    FreeTextEditor._l10nPromise\n      .get(\"free_text2_default_content\")\n      .then(msg => this.editorDiv?.setAttribute(\"default-content\", msg));\n    this.editorDiv.contentEditable = true;\n\n    const { style } = this.editorDiv;\n    style.fontSize = `calc(${this.#fontSize}px * var(--scale-factor))`;\n    style.color = this.#color;\n\n    this.div.append(this.editorDiv);\n\n    this.overlayDiv = document.createElement(\"div\");\n    this.overlayDiv.classList.add(\"overlay\", \"enabled\");\n    this.div.append(this.overlayDiv);\n\n    // TODO: implement paste callback.\n    // The goal is to sanitize and have something suitable for this\n    // editor.\n    bindEvents(this, this.div, [\"dblclick\", \"keydown\"]);\n\n    if (this.width) {\n      // This editor was created in using copy (ctrl+c).\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      if (this.annotationElementId) {\n        const [tx] = this.getInitialTranslation();\n        this.setAt(baseX * parentWidth, baseY * parentHeight, tx, tx);\n      } else {\n        this.setAt(\n          baseX * parentWidth,\n          baseY * parentHeight,\n          this.width * parentWidth,\n          this.height * parentHeight\n        );\n      }\n\n      this.#setContent();\n      this.div.draggable = true;\n      this.editorDiv.contentEditable = false;\n    } else {\n      this.div.draggable = false;\n      this.editorDiv.contentEditable = true;\n    }\n\n    return this.div;\n  }\n\n  #setContent() {\n    this.editorDiv.replaceChildren();\n    if (!this.#content) {\n      return;\n    }\n    for (const line of this.#content.split(\"\\n\")) {\n      const div = document.createElement(\"div\");\n      div.append(\n        line ? document.createTextNode(line) : document.createElement(\"br\")\n      );\n      this.editorDiv.append(div);\n    }\n  }\n\n  get contentDiv() {\n    return this.editorDiv;\n  }\n\n  /** @inheritdoc */\n  static deserialize(data, parent, uiManager) {\n    let initialData = null;\n    if (data instanceof FreeTextAnnotationElement) {\n      const {\n        data: {\n          defaultAppearanceData: { fontSize, fontColor },\n          rect,\n          rotation,\n          id,\n        },\n        textContent,\n        parent: {\n          page: { pageNumber },\n        },\n      } = data;\n      // textContent is supposed to be an array of strings containing each line\n      // of text. However, it can be null or empty.\n      if (!textContent || textContent.length === 0) {\n        // Empty annotation.\n        return null;\n      }\n      initialData = data = {\n        annotationType: AnnotationEditorType.FREETEXT,\n        color: Array.from(fontColor),\n        fontSize,\n        value: textContent.join(\"\\n\"),\n        pageIndex: pageNumber - 1,\n        rect,\n        rotation,\n        id,\n        deleted: false,\n      };\n    }\n    const editor = super.deserialize(data, parent, uiManager);\n\n    editor.#fontSize = data.fontSize;\n    editor.#color = Util.makeHexColor(...data.color);\n    editor.#content = data.value;\n    editor.annotationElementId = data.id || null;\n    editor.#initialData = initialData;\n\n    return editor;\n  }\n\n  /** @inheritdoc */\n  serialize(isForCopying = false) {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    if (this.deleted) {\n      return {\n        pageIndex: this.pageIndex,\n        id: this.annotationElementId,\n        deleted: true,\n      };\n    }\n\n    const padding = FreeTextEditor._internalPadding * this.parentScale;\n    const rect = this.getRect(padding, padding);\n    const color = AnnotationEditor._colorManager.convert(\n      this.isAttachedToDOM\n        ? getComputedStyle(this.editorDiv).color\n        : this.#color\n    );\n\n    const serialized = {\n      annotationType: AnnotationEditorType.FREETEXT,\n      color,\n      fontSize: this.#fontSize,\n      value: this.#content,\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.rotation,\n    };\n\n    if (isForCopying) {\n      // Don't add the id when copying because the pasted editor mustn't be\n      // linked to an existing annotation.\n      return serialized;\n    }\n\n    if (this.annotationElementId && !this.#hasElementChanged(serialized)) {\n      return null;\n    }\n\n    serialized.id = this.annotationElementId;\n\n    return serialized;\n  }\n\n  #hasElementChanged(serialized) {\n    const { value, fontSize, color, rect, pageIndex } = this.#initialData;\n\n    return (\n      serialized.value !== value ||\n      serialized.fontSize !== fontSize ||\n      serialized.rect.some((x, i) => Math.abs(x - rect[i]) >= 1) ||\n      serialized.color.some((c, i) => c !== color[i]) ||\n      serialized.pageIndex !== pageIndex\n    );\n  }\n\n  #cheatInitialRect(delayed = false) {\n    // The annotation has a rect but the editor has an other one.\n    // When we want to know if the annotation has changed (e.g. has been moved)\n    // we must compare the editor initial rect with the current one.\n    // So this method is a hack to have a way to compare the real rects.\n    if (!this.annotationElementId) {\n      return;\n    }\n\n    this.#setEditorDimensions();\n    if (!delayed && (this.width === 0 || this.height === 0)) {\n      setTimeout(() => this.#cheatInitialRect(/* delayed = */ true), 0);\n      return;\n    }\n\n    const padding = FreeTextEditor._internalPadding * this.parentScale;\n    this.#initialData.rect = this.getRect(padding, padding);\n  }\n}\n\nexport { FreeTextEditor };\n", "/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./api\").PDFPageProxy} PDFPageProxy */\n/** @typedef {import(\"./display_utils\").PageViewport} PageViewport */\n/** @typedef {import(\"./interfaces\").IDownloadManager} IDownloadManager */\n/** @typedef {import(\"../../web/interfaces\").IPDFLinkService} IPDFLinkService */\n\nimport {\n  AnnotationBorderStyleType,\n  AnnotationEditorType,\n  AnnotationType,\n  assert,\n  FeatureTest,\n  LINE_FACTOR,\n  shadow,\n  unreachable,\n  Util,\n  warn,\n} from \"../shared/util.js\";\nimport {\n  AnnotationPrefix,\n  DOMSVGFactory,\n  getFilenameFromUrl,\n  PDFDateString,\n  setLayerDimensions,\n} from \"./display_utils.js\";\nimport { AnnotationStorage } from \"./annotation_storage.js\";\nimport { ColorConverters } from \"../shared/scripting_utils.js\";\nimport { XfaLayer } from \"./xfa_layer.js\";\n\nconst DEFAULT_TAB_INDEX = 1000;\nconst DEFAULT_FONT_SIZE = 9;\nconst GetElementsByNameSet = new WeakSet();\n\nfunction getRectDims(rect) {\n  return {\n    width: rect[2] - rect[0],\n    height: rect[3] - rect[1],\n  };\n}\n\n/**\n * @typedef {Object} AnnotationElementParameters\n * @property {Object} data\n * @property {HTMLDivElement} layer\n * @property {IPDFLinkService} linkService\n * @property {IDownloadManager} downloadManager\n * @property {AnnotationStorage} [annotationStorage]\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   for annotation icons. Include trailing slash.\n * @property {boolean} renderForms\n * @property {Object} svgFactory\n * @property {boolean} [enableScripting]\n * @property {boolean} [hasJSActions]\n * @property {Object} [fieldObjects]\n */\n\nclass AnnotationElementFactory {\n  /**\n   * @param {AnnotationElementParameters} parameters\n   * @returns {AnnotationElement}\n   */\n  static create(parameters) {\n    const subtype = parameters.data.annotationType;\n\n    switch (subtype) {\n      case AnnotationType.LINK:\n        return new LinkAnnotationElement(parameters);\n\n      case AnnotationType.TEXT:\n        return new TextAnnotationElement(parameters);\n\n      case AnnotationType.WIDGET:\n        const fieldType = parameters.data.fieldType;\n\n        switch (fieldType) {\n          case \"Tx\":\n            return new TextWidgetAnnotationElement(parameters);\n          case \"Btn\":\n            if (parameters.data.radioButton) {\n              return new RadioButtonWidgetAnnotationElement(parameters);\n            } else if (parameters.data.checkBox) {\n              return new CheckboxWidgetAnnotationElement(parameters);\n            }\n            return new PushButtonWidgetAnnotationElement(parameters);\n          case \"Ch\":\n            return new ChoiceWidgetAnnotationElement(parameters);\n          case \"Sig\":\n            return new SignatureWidgetAnnotationElement(parameters);\n        }\n        return new WidgetAnnotationElement(parameters);\n\n      case AnnotationType.POPUP:\n        return new PopupAnnotationElement(parameters);\n\n      case AnnotationType.FREETEXT:\n        return new FreeTextAnnotationElement(parameters);\n\n      case AnnotationType.LINE:\n        return new LineAnnotationElement(parameters);\n\n      case AnnotationType.SQUARE:\n        return new SquareAnnotationElement(parameters);\n\n      case AnnotationType.CIRCLE:\n        return new CircleAnnotationElement(parameters);\n\n      case AnnotationType.POLYLINE:\n        return new PolylineAnnotationElement(parameters);\n\n      case AnnotationType.CARET:\n        return new CaretAnnotationElement(parameters);\n\n      case AnnotationType.INK:\n        return new InkAnnotationElement(parameters);\n\n      case AnnotationType.POLYGON:\n        return new PolygonAnnotationElement(parameters);\n\n      case AnnotationType.HIGHLIGHT:\n        return new HighlightAnnotationElement(parameters);\n\n      case AnnotationType.UNDERLINE:\n        return new UnderlineAnnotationElement(parameters);\n\n      case AnnotationType.SQUIGGLY:\n        return new SquigglyAnnotationElement(parameters);\n\n      case AnnotationType.STRIKEOUT:\n        return new StrikeOutAnnotationElement(parameters);\n\n      case AnnotationType.STAMP:\n        return new StampAnnotationElement(parameters);\n\n      case AnnotationType.FILEATTACHMENT:\n        return new FileAttachmentAnnotationElement(parameters);\n\n      default:\n        return new AnnotationElement(parameters);\n    }\n  }\n}\n\nclass AnnotationElement {\n  constructor(\n    parameters,\n    {\n      isRenderable = false,\n      ignoreBorder = false,\n      createQuadrilaterals = false,\n    } = {}\n  ) {\n    this.isRenderable = isRenderable;\n    this.data = parameters.data;\n    this.layer = parameters.layer;\n    this.linkService = parameters.linkService;\n    this.downloadManager = parameters.downloadManager;\n    this.imageResourcesPath = parameters.imageResourcesPath;\n    this.renderForms = parameters.renderForms;\n    this.svgFactory = parameters.svgFactory;\n    this.annotationStorage = parameters.annotationStorage;\n    this.enableScripting = parameters.enableScripting;\n    this.hasJSActions = parameters.hasJSActions;\n    this._fieldObjects = parameters.fieldObjects;\n    this.parent = parameters.parent;\n\n    if (isRenderable) {\n      this.container = this._createContainer(ignoreBorder);\n    }\n    if (createQuadrilaterals) {\n      this.quadrilaterals = this._createQuadrilaterals(ignoreBorder);\n    }\n  }\n\n  /**\n   * Create an empty container for the annotation's HTML element.\n   *\n   * @private\n   * @param {boolean} ignoreBorder\n   * @memberof AnnotationElement\n   * @returns {HTMLElement} A section element.\n   */\n  _createContainer(ignoreBorder) {\n    const {\n      data,\n      parent: { page, viewport },\n    } = this;\n\n    const container = document.createElement(\"section\");\n    container.setAttribute(\"data-annotation-id\", data.id);\n\n    // The accessibility manager will move the annotation in the DOM in\n    // order to match the visual ordering.\n    // But if an annotation is above an other one, then we must draw it\n    // after the other one whatever the order is in the DOM, hence the\n    // use of the z-index.\n    container.style.zIndex = this.parent.zIndex++;\n\n    if (this.data.popupRef) {\n      container.setAttribute(\"aria-haspopup\", \"dialog\");\n    }\n\n    if (data.noRotate) {\n      container.classList.add(\"norotate\");\n    }\n\n    const { pageWidth, pageHeight, pageX, pageY } = viewport.rawDims;\n\n    if (!data.rect || this instanceof PopupAnnotationElement) {\n      const { rotation } = data;\n      if (!data.hasOwnCanvas && rotation !== 0) {\n        this.setRotation(rotation, container);\n      }\n      return container;\n    }\n\n    const { width, height } = getRectDims(data.rect);\n\n    // Do *not* modify `data.rect`, since that will corrupt the annotation\n    // position on subsequent calls to `_createContainer` (see issue 6804).\n    const rect = Util.normalizeRect([\n      data.rect[0],\n      page.view[3] - data.rect[1] + page.view[1],\n      data.rect[2],\n      page.view[3] - data.rect[3] + page.view[1],\n    ]);\n\n    if (!ignoreBorder && data.borderStyle.width > 0) {\n      container.style.borderWidth = `${data.borderStyle.width}px`;\n\n      const horizontalRadius = data.borderStyle.horizontalCornerRadius;\n      const verticalRadius = data.borderStyle.verticalCornerRadius;\n      if (horizontalRadius > 0 || verticalRadius > 0) {\n        const radius = `calc(${horizontalRadius}px * var(--scale-factor)) / calc(${verticalRadius}px * var(--scale-factor))`;\n        container.style.borderRadius = radius;\n      } else if (this instanceof RadioButtonWidgetAnnotationElement) {\n        const radius = `calc(${width}px * var(--scale-factor)) / calc(${height}px * var(--scale-factor))`;\n        container.style.borderRadius = radius;\n      }\n\n      switch (data.borderStyle.style) {\n        case AnnotationBorderStyleType.SOLID:\n          container.style.borderStyle = \"solid\";\n          break;\n\n        case AnnotationBorderStyleType.DASHED:\n          container.style.borderStyle = \"dashed\";\n          break;\n\n        case AnnotationBorderStyleType.BEVELED:\n          warn(\"Unimplemented border style: beveled\");\n          break;\n\n        case AnnotationBorderStyleType.INSET:\n          warn(\"Unimplemented border style: inset\");\n          break;\n\n        case AnnotationBorderStyleType.UNDERLINE:\n          container.style.borderBottomStyle = \"solid\";\n          break;\n\n        default:\n          break;\n      }\n\n      const borderColor = data.borderColor || null;\n      if (borderColor) {\n        container.style.borderColor = Util.makeHexColor(\n          borderColor[0] | 0,\n          borderColor[1] | 0,\n          borderColor[2] | 0\n        );\n      } else {\n        // Transparent (invisible) border, so do not draw it at all.\n        container.style.borderWidth = 0;\n      }\n    }\n\n    container.style.left = `${(100 * (rect[0] - pageX)) / pageWidth}%`;\n    container.style.top = `${(100 * (rect[1] - pageY)) / pageHeight}%`;\n\n    const { rotation } = data;\n    if (data.hasOwnCanvas || rotation === 0) {\n      container.style.width = `${(100 * width) / pageWidth}%`;\n      container.style.height = `${(100 * height) / pageHeight}%`;\n    } else {\n      this.setRotation(rotation, container);\n    }\n\n    return container;\n  }\n\n  setRotation(angle, container = this.container) {\n    const { pageWidth, pageHeight } = this.parent.viewport.rawDims;\n    const { width, height } = getRectDims(this.data.rect);\n\n    let elementWidth, elementHeight;\n    if (angle % 180 === 0) {\n      elementWidth = (100 * width) / pageWidth;\n      elementHeight = (100 * height) / pageHeight;\n    } else {\n      elementWidth = (100 * height) / pageWidth;\n      elementHeight = (100 * width) / pageHeight;\n    }\n\n    container.style.width = `${elementWidth}%`;\n    container.style.height = `${elementHeight}%`;\n\n    container.setAttribute(\"data-main-rotation\", (360 - angle) % 360);\n  }\n\n  get _commonActions() {\n    const setColor = (jsName, styleName, event) => {\n      const color = event.detail[jsName];\n      event.target.style[styleName] = ColorConverters[`${color[0]}_HTML`](\n        color.slice(1)\n      );\n    };\n\n    return shadow(this, \"_commonActions\", {\n      display: event => {\n        const hidden = event.detail.display % 2 === 1;\n        this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n        this.annotationStorage.setValue(this.data.id, {\n          hidden,\n          print: event.detail.display === 0 || event.detail.display === 3,\n        });\n      },\n      print: event => {\n        this.annotationStorage.setValue(this.data.id, {\n          print: event.detail.print,\n        });\n      },\n      hidden: event => {\n        this.container.style.visibility = event.detail.hidden\n          ? \"hidden\"\n          : \"visible\";\n        this.annotationStorage.setValue(this.data.id, {\n          hidden: event.detail.hidden,\n        });\n      },\n      focus: event => {\n        setTimeout(() => event.target.focus({ preventScroll: false }), 0);\n      },\n      userName: event => {\n        // tooltip\n        event.target.title = event.detail.userName;\n      },\n      readonly: event => {\n        if (event.detail.readonly) {\n          event.target.setAttribute(\"readonly\", \"\");\n        } else {\n          event.target.removeAttribute(\"readonly\");\n        }\n      },\n      required: event => {\n        this._setRequired(event.target, event.detail.required);\n      },\n      bgColor: event => {\n        setColor(\"bgColor\", \"backgroundColor\", event);\n      },\n      fillColor: event => {\n        setColor(\"fillColor\", \"backgroundColor\", event);\n      },\n      fgColor: event => {\n        setColor(\"fgColor\", \"color\", event);\n      },\n      textColor: event => {\n        setColor(\"textColor\", \"color\", event);\n      },\n      borderColor: event => {\n        setColor(\"borderColor\", \"borderColor\", event);\n      },\n      strokeColor: event => {\n        setColor(\"strokeColor\", \"borderColor\", event);\n      },\n      rotation: event => {\n        const angle = event.detail.rotation;\n        this.setRotation(angle);\n        this.annotationStorage.setValue(this.data.id, {\n          rotation: angle,\n        });\n      },\n    });\n  }\n\n  _dispatchEventFromSandbox(actions, jsEvent) {\n    const commonActions = this._commonActions;\n    for (const name of Object.keys(jsEvent.detail)) {\n      const action = actions[name] || commonActions[name];\n      action?.(jsEvent);\n    }\n  }\n\n  _setDefaultPropertiesFromJS(element) {\n    if (!this.enableScripting) {\n      return;\n    }\n\n    // Some properties may have been updated thanks to JS.\n    const storedData = this.annotationStorage.getRawValue(this.data.id);\n    if (!storedData) {\n      return;\n    }\n\n    const commonActions = this._commonActions;\n    for (const [actionName, detail] of Object.entries(storedData)) {\n      const action = commonActions[actionName];\n      if (action) {\n        const eventProxy = {\n          detail: {\n            [actionName]: detail,\n          },\n          target: element,\n        };\n        action(eventProxy);\n        // The action has been consumed: no need to keep it.\n        delete storedData[actionName];\n      }\n    }\n  }\n\n  /**\n   * Create quadrilaterals from the annotation's quadpoints.\n   *\n   * @private\n   * @param {boolean} ignoreBorder\n   * @memberof AnnotationElement\n   * @returns {Array<HTMLElement>} An array of section elements.\n   */\n  _createQuadrilaterals(ignoreBorder = false) {\n    if (!this.data.quadPoints) {\n      return null;\n    }\n\n    const quadrilaterals = [];\n    const savedRect = this.data.rect;\n    let firstQuadRect = null;\n    for (const quadPoint of this.data.quadPoints) {\n      this.data.rect = [\n        quadPoint[2].x,\n        quadPoint[2].y,\n        quadPoint[1].x,\n        quadPoint[1].y,\n      ];\n      quadrilaterals.push(this._createContainer(ignoreBorder));\n      firstQuadRect ||= this.data.rect;\n    }\n    this.data.rect = savedRect;\n    this.firstQuadRect = firstQuadRect;\n    return quadrilaterals;\n  }\n\n  /**\n   * Create a popup for the annotation's HTML element. This is used for\n   * annotations that do not have a Popup entry in the dictionary, but\n   * are of a type that works with popups (such as Highlight annotations).\n   *\n   * @private\n   * @memberof AnnotationElement\n   */\n  _createPopup() {\n    const { container, data } = this;\n    container.setAttribute(\"aria-haspopup\", \"dialog\");\n\n    const popup = new PopupAnnotationElement({\n      data: {\n        color: data.color,\n        titleObj: data.titleObj,\n        modificationDate: data.modificationDate,\n        contentsObj: data.contentsObj,\n        richText: data.richText,\n        parentRect: this.firstQuadRect || data.rect,\n        borderStyle: 0,\n        id: `popup_${data.id}`,\n        rotation: data.rotation,\n      },\n      parent: this.parent,\n      elements: [this],\n    });\n    this.parent.div.append(popup.render());\n  }\n\n  /**\n   * Render the quadrilaterals of the annotation.\n   *\n   * @private\n   * @param {string} className\n   * @memberof AnnotationElement\n   * @returns {Array<HTMLElement>} An array of section elements.\n   */\n  _renderQuadrilaterals(className) {\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n      assert(this.quadrilaterals, \"Missing quadrilaterals during rendering\");\n    }\n\n    for (const quadrilateral of this.quadrilaterals) {\n      quadrilateral.classList.add(className);\n    }\n    return this.quadrilaterals;\n  }\n\n  /**\n   * Render the annotation's HTML element(s).\n   *\n   * @public\n   * @memberof AnnotationElement\n   * @returns {HTMLElement|Array<HTMLElement>|undefined} A section element or\n   *   an array of section elements.\n   */\n  render() {\n    unreachable(\"Abstract method `AnnotationElement.render` called\");\n  }\n\n  /**\n   * @private\n   * @returns {Array}\n   */\n  _getElementsByName(name, skipId = null) {\n    const fields = [];\n\n    if (this._fieldObjects) {\n      const fieldObj = this._fieldObjects[name];\n      if (fieldObj) {\n        for (const { page, id, exportValues } of fieldObj) {\n          if (page === -1) {\n            continue;\n          }\n          if (id === skipId) {\n            continue;\n          }\n          const exportValue =\n            typeof exportValues === \"string\" ? exportValues : null;\n\n          const domElement = document.querySelector(\n            `[data-element-id=\"${id}\"]`\n          );\n          if (domElement && !GetElementsByNameSet.has(domElement)) {\n            warn(`_getElementsByName - element not allowed: ${id}`);\n            continue;\n          }\n          fields.push({ id, exportValue, domElement });\n        }\n      }\n      return fields;\n    }\n    // Fallback to a regular DOM lookup, to ensure that the standalone\n    // viewer components won't break.\n    for (const domElement of document.getElementsByName(name)) {\n      const { exportValue } = domElement;\n      const id = domElement.getAttribute(\"data-element-id\");\n      if (id === skipId) {\n        continue;\n      }\n      if (!GetElementsByNameSet.has(domElement)) {\n        continue;\n      }\n      fields.push({ id, exportValue, domElement });\n    }\n    return fields;\n  }\n\n  show() {\n    if (this.container) {\n      this.container.hidden = false;\n    }\n    this.popup?.maybeShow();\n  }\n\n  hide() {\n    if (this.container) {\n      this.container.hidden = true;\n    }\n    this.popup?.forceHide();\n  }\n\n  getElementsToTriggerPopup() {\n    return this.quadrilaterals || this.container;\n  }\n\n  addHighlightArea() {\n    const triggers = this.getElementsToTriggerPopup();\n    if (Array.isArray(triggers)) {\n      for (const element of triggers) {\n        element.classList.add(\"highlightArea\");\n      }\n    } else {\n      triggers.classList.add(\"highlightArea\");\n    }\n  }\n}\n\nclass LinkAnnotationElement extends AnnotationElement {\n  constructor(parameters, options = null) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: !!options?.ignoreBorder,\n      createQuadrilaterals: true,\n    });\n    this.isTooltipOnly = parameters.data.isTooltipOnly;\n  }\n\n  render() {\n    const { data, linkService } = this;\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"data-element-id\", data.id);\n    let isBound = false;\n\n    if (data.url) {\n      linkService.addLinkAttributes(link, data.url, data.newWindow);\n      isBound = true;\n    } else if (data.action) {\n      this._bindNamedAction(link, data.action);\n      isBound = true;\n    } else if (data.attachment) {\n      this._bindAttachment(link, data.attachment);\n      isBound = true;\n    } else if (data.setOCGState) {\n      this.#bindSetOCGState(link, data.setOCGState);\n      isBound = true;\n    } else if (data.dest) {\n      this._bindLink(link, data.dest);\n      isBound = true;\n    } else {\n      if (\n        data.actions &&\n        (data.actions.Action ||\n          data.actions[\"Mouse Up\"] ||\n          data.actions[\"Mouse Down\"]) &&\n        this.enableScripting &&\n        this.hasJSActions\n      ) {\n        this._bindJSAction(link, data);\n        isBound = true;\n      }\n\n      if (data.resetForm) {\n        this._bindResetFormAction(link, data.resetForm);\n        isBound = true;\n      } else if (this.isTooltipOnly && !isBound) {\n        this._bindLink(link, \"\");\n        isBound = true;\n      }\n    }\n\n    if (this.quadrilaterals) {\n      return this._renderQuadrilaterals(\"linkAnnotation\").map(\n        (quadrilateral, index) => {\n          const linkElement = index === 0 ? link : link.cloneNode();\n          quadrilateral.append(linkElement);\n          return quadrilateral;\n        }\n      );\n    }\n\n    this.container.classList.add(\"linkAnnotation\");\n    if (isBound) {\n      this.container.append(link);\n    }\n\n    return this.container;\n  }\n\n  #setInternalLink() {\n    this.container.setAttribute(\"data-internal-link\", \"\");\n  }\n\n  /**\n   * Bind internal links to the link element.\n   *\n   * @private\n   * @param {Object} link\n   * @param {Object} destination\n   * @memberof LinkAnnotationElement\n   */\n  _bindLink(link, destination) {\n    link.href = this.linkService.getDestinationHash(destination);\n    link.onclick = () => {\n      if (destination) {\n        this.linkService.goToDestination(destination);\n      }\n      return false;\n    };\n    if (destination || destination === /* isTooltipOnly = */ \"\") {\n      this.#setInternalLink();\n    }\n  }\n\n  /**\n   * Bind named actions to the link element.\n   *\n   * @private\n   * @param {Object} link\n   * @param {Object} action\n   * @memberof LinkAnnotationElement\n   */\n  _bindNamedAction(link, action) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    link.onclick = () => {\n      this.linkService.executeNamedAction(action);\n      return false;\n    };\n    this.#setInternalLink();\n  }\n\n  /**\n   * Bind attachments to the link element.\n   * @param {Object} link\n   * @param {Object} attachment\n   */\n  _bindAttachment(link, attachment) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    link.onclick = () => {\n      this.downloadManager?.openOrDownloadData(\n        this.container,\n        attachment.content,\n        attachment.filename\n      );\n      return false;\n    };\n    this.#setInternalLink();\n  }\n\n  /**\n   * Bind SetOCGState actions to the link element.\n   * @param {Object} link\n   * @param {Object} action\n   */\n  #bindSetOCGState(link, action) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    link.onclick = () => {\n      this.linkService.executeSetOCGState(action);\n      return false;\n    };\n    this.#setInternalLink();\n  }\n\n  /**\n   * Bind JS actions to the link element.\n   *\n   * @private\n   * @param {Object} link\n   * @param {Object} data\n   * @memberof LinkAnnotationElement\n   */\n  _bindJSAction(link, data) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    const map = new Map([\n      [\"Action\", \"onclick\"],\n      [\"Mouse Up\", \"onmouseup\"],\n      [\"Mouse Down\", \"onmousedown\"],\n    ]);\n    for (const name of Object.keys(data.actions)) {\n      const jsName = map.get(name);\n      if (!jsName) {\n        continue;\n      }\n      link[jsName] = () => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: data.id,\n            name,\n          },\n        });\n        return false;\n      };\n    }\n\n    if (!link.onclick) {\n      link.onclick = () => false;\n    }\n    this.#setInternalLink();\n  }\n\n  _bindResetFormAction(link, resetForm) {\n    const otherClickAction = link.onclick;\n    if (!otherClickAction) {\n      link.href = this.linkService.getAnchorUrl(\"\");\n    }\n    this.#setInternalLink();\n\n    if (!this._fieldObjects) {\n      warn(\n        `_bindResetFormAction - \"resetForm\" action not supported, ` +\n          \"ensure that the `fieldObjects` parameter is provided.\"\n      );\n      if (!otherClickAction) {\n        link.onclick = () => false;\n      }\n      return;\n    }\n\n    link.onclick = () => {\n      otherClickAction?.();\n\n      const {\n        fields: resetFormFields,\n        refs: resetFormRefs,\n        include,\n      } = resetForm;\n\n      const allFields = [];\n      if (resetFormFields.length !== 0 || resetFormRefs.length !== 0) {\n        const fieldIds = new Set(resetFormRefs);\n        for (const fieldName of resetFormFields) {\n          const fields = this._fieldObjects[fieldName] || [];\n          for (const { id } of fields) {\n            fieldIds.add(id);\n          }\n        }\n        for (const fields of Object.values(this._fieldObjects)) {\n          for (const field of fields) {\n            if (fieldIds.has(field.id) === include) {\n              allFields.push(field);\n            }\n          }\n        }\n      } else {\n        for (const fields of Object.values(this._fieldObjects)) {\n          allFields.push(...fields);\n        }\n      }\n\n      const storage = this.annotationStorage;\n      const allIds = [];\n      for (const field of allFields) {\n        const { id } = field;\n        allIds.push(id);\n        switch (field.type) {\n          case \"text\": {\n            const value = field.defaultValue || \"\";\n            storage.setValue(id, { value });\n            break;\n          }\n          case \"checkbox\":\n          case \"radiobutton\": {\n            const value = field.defaultValue === field.exportValues;\n            storage.setValue(id, { value });\n            break;\n          }\n          case \"combobox\":\n          case \"listbox\": {\n            const value = field.defaultValue || \"\";\n            storage.setValue(id, { value });\n            break;\n          }\n          default:\n            continue;\n        }\n\n        const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n        if (!domElement) {\n          continue;\n        } else if (!GetElementsByNameSet.has(domElement)) {\n          warn(`_bindResetFormAction - element not allowed: ${id}`);\n          continue;\n        }\n        domElement.dispatchEvent(new Event(\"resetform\"));\n      }\n\n      if (this.enableScripting) {\n        // Update the values in the sandbox.\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: \"app\",\n            ids: allIds,\n            name: \"ResetForm\",\n          },\n        });\n      }\n\n      return false;\n    };\n  }\n}\n\nclass TextAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable });\n  }\n\n  render() {\n    this.container.classList.add(\"textAnnotation\");\n\n    const image = document.createElement(\"img\");\n    image.src =\n      this.imageResourcesPath +\n      \"annotation-\" +\n      this.data.name.toLowerCase() +\n      \".svg\";\n    image.alt = \"[{{type}} Annotation]\";\n    image.dataset.l10nId = \"text_annotation_type\";\n    image.dataset.l10nArgs = JSON.stringify({ type: this.data.name });\n\n    if (!this.data.popupRef) {\n      this._createPopup();\n    }\n\n    this.container.append(image);\n    return this.container;\n  }\n}\n\nclass WidgetAnnotationElement extends AnnotationElement {\n  render() {\n    // Show only the container for unsupported field types.\n    if (this.data.alternativeText) {\n      this.container.title = this.data.alternativeText;\n    }\n\n    return this.container;\n  }\n\n  showElementAndHideCanvas(element) {\n    if (this.data.hasOwnCanvas) {\n      if (element.previousSibling?.nodeName === \"CANVAS\") {\n        element.previousSibling.hidden = true;\n      }\n      element.hidden = false;\n    }\n  }\n\n  _getKeyModifier(event) {\n    const { isWin, isMac } = FeatureTest.platform;\n    return (isWin && event.ctrlKey) || (isMac && event.metaKey);\n  }\n\n  _setEventListener(element, baseName, eventName, valueGetter) {\n    if (baseName.includes(\"mouse\")) {\n      // Mouse events\n      element.addEventListener(baseName, event => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: this.data.id,\n            name: eventName,\n            value: valueGetter(event),\n            shift: event.shiftKey,\n            modifier: this._getKeyModifier(event),\n          },\n        });\n      });\n    } else {\n      // Non mouse event\n      element.addEventListener(baseName, event => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: this.data.id,\n            name: eventName,\n            value: valueGetter(event),\n          },\n        });\n      });\n    }\n  }\n\n  _setEventListeners(element, names, getter) {\n    for (const [baseName, eventName] of names) {\n      if (eventName === \"Action\" || this.data.actions?.[eventName]) {\n        this._setEventListener(element, baseName, eventName, getter);\n      }\n    }\n  }\n\n  _setBackgroundColor(element) {\n    const color = this.data.backgroundColor || null;\n    element.style.backgroundColor =\n      color === null\n        ? \"transparent\"\n        : Util.makeHexColor(color[0], color[1], color[2]);\n  }\n\n  /**\n   * Apply text styles to the text in the element.\n   *\n   * @private\n   * @param {HTMLDivElement} element\n   * @memberof TextWidgetAnnotationElement\n   */\n  _setTextStyle(element) {\n    const TEXT_ALIGNMENT = [\"left\", \"center\", \"right\"];\n    const { fontColor } = this.data.defaultAppearanceData;\n    const fontSize =\n      this.data.defaultAppearanceData.fontSize || DEFAULT_FONT_SIZE;\n\n    const style = element.style;\n\n    // TODO: If the font-size is zero, calculate it based on the height and\n    //       width of the element.\n    // Not setting `style.fontSize` will use the default font-size for now.\n\n    // We don't use the font, as specified in the PDF document, for the <input>\n    // element. Hence using the original `fontSize` could look bad, which is why\n    // it's instead based on the field height.\n    // If the height is \"big\" then it could lead to a too big font size\n    // so in this case use the one we've in the pdf (hence the min).\n    let computedFontSize;\n    const BORDER_SIZE = 2;\n    const roundToOneDecimal = x => Math.round(10 * x) / 10;\n    if (this.data.multiLine) {\n      const height = Math.abs(\n        this.data.rect[3] - this.data.rect[1] - BORDER_SIZE\n      );\n      const numberOfLines = Math.round(height / (LINE_FACTOR * fontSize)) || 1;\n      const lineHeight = height / numberOfLines;\n      computedFontSize = Math.min(\n        fontSize,\n        roundToOneDecimal(lineHeight / LINE_FACTOR)\n      );\n    } else {\n      const height = Math.abs(\n        this.data.rect[3] - this.data.rect[1] - BORDER_SIZE\n      );\n      computedFontSize = Math.min(\n        fontSize,\n        roundToOneDecimal(height / LINE_FACTOR)\n      );\n    }\n    style.fontSize = `calc(${computedFontSize}px * var(--scale-factor))`;\n\n    style.color = Util.makeHexColor(fontColor[0], fontColor[1], fontColor[2]);\n\n    if (this.data.textAlignment !== null) {\n      style.textAlign = TEXT_ALIGNMENT[this.data.textAlignment];\n    }\n  }\n\n  _setRequired(element, isRequired) {\n    if (isRequired) {\n      element.setAttribute(\"required\", true);\n    } else {\n      element.removeAttribute(\"required\");\n    }\n    element.setAttribute(\"aria-required\", isRequired);\n  }\n}\n\nclass TextWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    const isRenderable =\n      parameters.renderForms ||\n      (!parameters.data.hasAppearance && !!parameters.data.fieldValue);\n    super(parameters, { isRenderable });\n  }\n\n  setPropertyOnSiblings(base, key, value, keyInStorage) {\n    const storage = this.annotationStorage;\n    for (const element of this._getElementsByName(\n      base.name,\n      /* skipId = */ base.id\n    )) {\n      if (element.domElement) {\n        element.domElement[key] = value;\n      }\n      storage.setValue(element.id, { [keyInStorage]: value });\n    }\n  }\n\n  render() {\n    const storage = this.annotationStorage;\n    const id = this.data.id;\n\n    this.container.classList.add(\"textWidgetAnnotation\");\n\n    let element = null;\n    if (this.renderForms) {\n      // NOTE: We cannot set the values using `element.value` below, since it\n      //       prevents the AnnotationLayer rasterizer in `test/driver.js`\n      //       from parsing the elements correctly for the reference tests.\n      const storedData = storage.getValue(id, {\n        value: this.data.fieldValue,\n      });\n      let textContent = storedData.value || \"\";\n      const maxLen = storage.getValue(id, {\n        charLimit: this.data.maxLen,\n      }).charLimit;\n      if (maxLen && textContent.length > maxLen) {\n        textContent = textContent.slice(0, maxLen);\n      }\n\n      let fieldFormattedValues =\n        storedData.formattedValue || this.data.textContent?.join(\"\\n\") || null;\n      if (fieldFormattedValues && this.data.comb) {\n        fieldFormattedValues = fieldFormattedValues.replaceAll(/\\s+/g, \"\");\n      }\n\n      const elementData = {\n        userValue: textContent,\n        formattedValue: fieldFormattedValues,\n        lastCommittedValue: null,\n        commitKey: 1,\n      };\n\n      if (this.data.multiLine) {\n        element = document.createElement(\"textarea\");\n        element.textContent = fieldFormattedValues ?? textContent;\n        if (this.data.doNotScroll) {\n          element.style.overflowY = \"hidden\";\n        }\n      } else {\n        element = document.createElement(\"input\");\n        element.type = \"text\";\n        element.setAttribute(\"value\", fieldFormattedValues ?? textContent);\n        if (this.data.doNotScroll) {\n          element.style.overflowX = \"hidden\";\n        }\n      }\n      if (this.data.hasOwnCanvas) {\n        element.hidden = true;\n      }\n      GetElementsByNameSet.add(element);\n      element.setAttribute(\"data-element-id\", id);\n\n      element.disabled = this.data.readOnly;\n      element.name = this.data.baseFieldName || this.data.fieldName;\n      element.tabIndex = DEFAULT_TAB_INDEX;\n\n      this._setRequired(element, this.data.required);\n\n      if (maxLen) {\n        element.maxLength = maxLen;\n      }\n\n      element.addEventListener(\"input\", event => {\n        storage.setValue(id, { value: event.target.value });\n        this.setPropertyOnSiblings(\n          element,\n          \"value\",\n          event.target.value,\n          \"value\"\n        );\n        elementData.formattedValue = null;\n      });\n\n      element.addEventListener(\"resetform\", event => {\n        const defaultValue = this.data.defaultFieldValue ?? \"\";\n        element.value = elementData.userValue = defaultValue;\n        elementData.formattedValue = null;\n      });\n\n      let blurListener = event => {\n        const { formattedValue } = elementData;\n        if (formattedValue !== null && formattedValue !== undefined) {\n          event.target.value = formattedValue;\n        }\n        // Reset the cursor position to the start of the field (issue 12359).\n        event.target.scrollLeft = 0;\n      };\n\n      if (this.enableScripting && this.hasJSActions) {\n        element.addEventListener(\"focus\", event => {\n          const { target } = event;\n          if (elementData.userValue) {\n            target.value = elementData.userValue;\n          }\n          elementData.lastCommittedValue = target.value;\n          elementData.commitKey = 1;\n        });\n\n        element.addEventListener(\"updatefromsandbox\", jsEvent => {\n          this.showElementAndHideCanvas(jsEvent.target);\n          const actions = {\n            value(event) {\n              elementData.userValue = event.detail.value ?? \"\";\n              storage.setValue(id, { value: elementData.userValue.toString() });\n              event.target.value = elementData.userValue;\n            },\n            formattedValue(event) {\n              const { formattedValue } = event.detail;\n              elementData.formattedValue = formattedValue;\n              if (\n                formattedValue !== null &&\n                formattedValue !== undefined &&\n                event.target !== document.activeElement\n              ) {\n                // Input hasn't the focus so display formatted string\n                event.target.value = formattedValue;\n              }\n              storage.setValue(id, {\n                formattedValue,\n              });\n            },\n            selRange(event) {\n              event.target.setSelectionRange(...event.detail.selRange);\n            },\n            charLimit: event => {\n              const { charLimit } = event.detail;\n              const { target } = event;\n              if (charLimit === 0) {\n                target.removeAttribute(\"maxLength\");\n                return;\n              }\n\n              target.setAttribute(\"maxLength\", charLimit);\n              let value = elementData.userValue;\n              if (!value || value.length <= charLimit) {\n                return;\n              }\n              value = value.slice(0, charLimit);\n              target.value = elementData.userValue = value;\n              storage.setValue(id, { value });\n\n              this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n                source: this,\n                detail: {\n                  id,\n                  name: \"Keystroke\",\n                  value,\n                  willCommit: true,\n                  commitKey: 1,\n                  selStart: target.selectionStart,\n                  selEnd: target.selectionEnd,\n                },\n              });\n            },\n          };\n          this._dispatchEventFromSandbox(actions, jsEvent);\n        });\n\n        // Even if the field hasn't any actions\n        // leaving it can still trigger some actions with Calculate\n        element.addEventListener(\"keydown\", event => {\n          elementData.commitKey = 1;\n          // If the key is one of Escape, Enter then the data are committed.\n          // If we've a Tab then data will be committed on blur.\n          let commitKey = -1;\n          if (event.key === \"Escape\") {\n            commitKey = 0;\n          } else if (event.key === \"Enter\" && !this.data.multiLine) {\n            // When we've a multiline field, \"Enter\" key is a key as the other\n            // hence we don't commit the data (Acrobat behaves the same way)\n            // (see issue #15627).\n            commitKey = 2;\n          } else if (event.key === \"Tab\") {\n            elementData.commitKey = 3;\n          }\n          if (commitKey === -1) {\n            return;\n          }\n          const { value } = event.target;\n          if (elementData.lastCommittedValue === value) {\n            return;\n          }\n          elementData.lastCommittedValue = value;\n          // Save the entered value\n          elementData.userValue = value;\n          this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n            source: this,\n            detail: {\n              id,\n              name: \"Keystroke\",\n              value,\n              willCommit: true,\n              commitKey,\n              selStart: event.target.selectionStart,\n              selEnd: event.target.selectionEnd,\n            },\n          });\n        });\n        const _blurListener = blurListener;\n        blurListener = null;\n        element.addEventListener(\"blur\", event => {\n          if (!event.relatedTarget) {\n            return;\n          }\n          const { value } = event.target;\n          elementData.userValue = value;\n          if (elementData.lastCommittedValue !== value) {\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value,\n                willCommit: true,\n                commitKey: elementData.commitKey,\n                selStart: event.target.selectionStart,\n                selEnd: event.target.selectionEnd,\n              },\n            });\n          }\n          _blurListener(event);\n        });\n\n        if (this.data.actions?.Keystroke) {\n          element.addEventListener(\"beforeinput\", event => {\n            elementData.lastCommittedValue = null;\n            const { data, target } = event;\n            const { value, selectionStart, selectionEnd } = target;\n\n            let selStart = selectionStart,\n              selEnd = selectionEnd;\n\n            switch (event.inputType) {\n              // https://rawgit.com/w3c/input-events/v1/index.html#interface-InputEvent-Attributes\n              case \"deleteWordBackward\": {\n                const match = value\n                  .substring(0, selectionStart)\n                  .match(/\\w*[^\\w]*$/);\n                if (match) {\n                  selStart -= match[0].length;\n                }\n                break;\n              }\n              case \"deleteWordForward\": {\n                const match = value\n                  .substring(selectionStart)\n                  .match(/^[^\\w]*\\w*/);\n                if (match) {\n                  selEnd += match[0].length;\n                }\n                break;\n              }\n              case \"deleteContentBackward\":\n                if (selectionStart === selectionEnd) {\n                  selStart -= 1;\n                }\n                break;\n              case \"deleteContentForward\":\n                if (selectionStart === selectionEnd) {\n                  selEnd += 1;\n                }\n                break;\n            }\n\n            // We handle the event ourselves.\n            event.preventDefault();\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value,\n                change: data || \"\",\n                willCommit: false,\n                selStart,\n                selEnd,\n              },\n            });\n          });\n        }\n\n        this._setEventListeners(\n          element,\n          [\n            [\"focus\", \"Focus\"],\n            [\"blur\", \"Blur\"],\n            [\"mousedown\", \"Mouse Down\"],\n            [\"mouseenter\", \"Mouse Enter\"],\n            [\"mouseleave\", \"Mouse Exit\"],\n            [\"mouseup\", \"Mouse Up\"],\n          ],\n          event => event.target.value\n        );\n      }\n\n      if (blurListener) {\n        element.addEventListener(\"blur\", blurListener);\n      }\n\n      if (this.data.comb) {\n        const fieldWidth = this.data.rect[2] - this.data.rect[0];\n        const combWidth = fieldWidth / maxLen;\n\n        element.classList.add(\"comb\");\n        element.style.letterSpacing = `calc(${combWidth}px * var(--scale-factor) - 1ch)`;\n      }\n    } else {\n      element = document.createElement(\"div\");\n      element.textContent = this.data.fieldValue;\n      element.style.verticalAlign = \"middle\";\n      element.style.display = \"table-cell\";\n    }\n\n    this._setTextStyle(element);\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n}\n\nclass SignatureWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: !!parameters.data.hasOwnCanvas });\n  }\n}\n\nclass CheckboxWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: parameters.renderForms });\n  }\n\n  render() {\n    const storage = this.annotationStorage;\n    const data = this.data;\n    const id = data.id;\n    let value = storage.getValue(id, {\n      value: data.exportValue === data.fieldValue,\n    }).value;\n    if (typeof value === \"string\") {\n      // The value has been changed through js and set in annotationStorage.\n      value = value !== \"Off\";\n      storage.setValue(id, { value });\n    }\n\n    this.container.classList.add(\"buttonWidgetAnnotation\", \"checkBox\");\n\n    const element = document.createElement(\"input\");\n    GetElementsByNameSet.add(element);\n    element.setAttribute(\"data-element-id\", id);\n\n    element.disabled = data.readOnly;\n    this._setRequired(element, this.data.required);\n    element.type = \"checkbox\";\n    element.name = data.baseFieldName || data.fieldName;\n    if (value) {\n      element.setAttribute(\"checked\", true);\n    }\n    element.setAttribute(\"exportValue\", data.exportValue);\n    element.tabIndex = DEFAULT_TAB_INDEX;\n\n    element.addEventListener(\"change\", event => {\n      const { name, checked } = event.target;\n      for (const checkbox of this._getElementsByName(name, /* skipId = */ id)) {\n        const curChecked = checked && checkbox.exportValue === data.exportValue;\n        if (checkbox.domElement) {\n          checkbox.domElement.checked = curChecked;\n        }\n        storage.setValue(checkbox.id, { value: curChecked });\n      }\n      storage.setValue(id, { value: checked });\n    });\n\n    element.addEventListener(\"resetform\", event => {\n      const defaultValue = data.defaultFieldValue || \"Off\";\n      event.target.checked = defaultValue === data.exportValue;\n    });\n\n    if (this.enableScripting && this.hasJSActions) {\n      element.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value(event) {\n            event.target.checked = event.detail.value !== \"Off\";\n            storage.setValue(id, { value: event.target.checked });\n          },\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n\n      this._setEventListeners(\n        element,\n        [\n          [\"change\", \"Validate\"],\n          [\"change\", \"Action\"],\n          [\"focus\", \"Focus\"],\n          [\"blur\", \"Blur\"],\n          [\"mousedown\", \"Mouse Down\"],\n          [\"mouseenter\", \"Mouse Enter\"],\n          [\"mouseleave\", \"Mouse Exit\"],\n          [\"mouseup\", \"Mouse Up\"],\n        ],\n        event => event.target.checked\n      );\n    }\n\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n}\n\nclass RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: parameters.renderForms });\n  }\n\n  render() {\n    this.container.classList.add(\"buttonWidgetAnnotation\", \"radioButton\");\n    const storage = this.annotationStorage;\n    const data = this.data;\n    const id = data.id;\n    let value = storage.getValue(id, {\n      value: data.fieldValue === data.buttonValue,\n    }).value;\n    if (typeof value === \"string\") {\n      // The value has been changed through js and set in annotationStorage.\n      value = value !== data.buttonValue;\n      storage.setValue(id, { value });\n    }\n\n    const element = document.createElement(\"input\");\n    GetElementsByNameSet.add(element);\n    element.setAttribute(\"data-element-id\", id);\n\n    element.disabled = data.readOnly;\n    this._setRequired(element, this.data.required);\n    element.type = \"radio\";\n    element.name = data.baseFieldName || data.fieldName;\n    if (value) {\n      element.setAttribute(\"checked\", true);\n    }\n    element.tabIndex = DEFAULT_TAB_INDEX;\n\n    element.addEventListener(\"change\", event => {\n      const { name, checked } = event.target;\n      for (const radio of this._getElementsByName(name, /* skipId = */ id)) {\n        storage.setValue(radio.id, { value: false });\n      }\n      storage.setValue(id, { value: checked });\n    });\n\n    element.addEventListener(\"resetform\", event => {\n      const defaultValue = data.defaultFieldValue;\n      event.target.checked =\n        defaultValue !== null &&\n        defaultValue !== undefined &&\n        defaultValue === data.buttonValue;\n    });\n\n    if (this.enableScripting && this.hasJSActions) {\n      const pdfButtonValue = data.buttonValue;\n      element.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value: event => {\n            const checked = pdfButtonValue === event.detail.value;\n            for (const radio of this._getElementsByName(event.target.name)) {\n              const curChecked = checked && radio.id === id;\n              if (radio.domElement) {\n                radio.domElement.checked = curChecked;\n              }\n              storage.setValue(radio.id, { value: curChecked });\n            }\n          },\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n\n      this._setEventListeners(\n        element,\n        [\n          [\"change\", \"Validate\"],\n          [\"change\", \"Action\"],\n          [\"focus\", \"Focus\"],\n          [\"blur\", \"Blur\"],\n          [\"mousedown\", \"Mouse Down\"],\n          [\"mouseenter\", \"Mouse Enter\"],\n          [\"mouseleave\", \"Mouse Exit\"],\n          [\"mouseup\", \"Mouse Up\"],\n        ],\n        event => event.target.checked\n      );\n    }\n\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n}\n\nclass PushButtonWidgetAnnotationElement extends LinkAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { ignoreBorder: parameters.data.hasAppearance });\n  }\n\n  render() {\n    // The rendering and functionality of a push button widget annotation is\n    // equal to that of a link annotation, but may have more functionality, such\n    // as performing actions on form fields (resetting, submitting, et cetera).\n    const container = super.render();\n    container.classList.add(\"buttonWidgetAnnotation\", \"pushButton\");\n\n    if (this.data.alternativeText) {\n      container.title = this.data.alternativeText;\n    }\n\n    const linkElement = container.lastChild;\n    if (this.enableScripting && this.hasJSActions && linkElement) {\n      this._setDefaultPropertiesFromJS(linkElement);\n\n      linkElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n        this._dispatchEventFromSandbox({}, jsEvent);\n      });\n    }\n\n    return container;\n  }\n}\n\nclass ChoiceWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, { isRenderable: parameters.renderForms });\n  }\n\n  render() {\n    this.container.classList.add(\"choiceWidgetAnnotation\");\n    const storage = this.annotationStorage;\n    const id = this.data.id;\n\n    const storedData = storage.getValue(id, {\n      value: this.data.fieldValue,\n    });\n\n    const selectElement = document.createElement(\"select\");\n    GetElementsByNameSet.add(selectElement);\n    selectElement.setAttribute(\"data-element-id\", id);\n\n    selectElement.disabled = this.data.readOnly;\n    this._setRequired(selectElement, this.data.required);\n    selectElement.name = this.data.baseFieldName || this.data.fieldName;\n    selectElement.tabIndex = DEFAULT_TAB_INDEX;\n\n    let addAnEmptyEntry = this.data.combo && this.data.options.length > 0;\n\n    if (!this.data.combo) {\n      // List boxes have a size and (optionally) multiple selection.\n      selectElement.size = this.data.options.length;\n      if (this.data.multiSelect) {\n        selectElement.multiple = true;\n      }\n    }\n\n    selectElement.addEventListener(\"resetform\", event => {\n      const defaultValue = this.data.defaultFieldValue;\n      for (const option of selectElement.options) {\n        option.selected = option.value === defaultValue;\n      }\n    });\n\n    // Insert the options into the choice field.\n    for (const option of this.data.options) {\n      const optionElement = document.createElement(\"option\");\n      optionElement.textContent = option.displayValue;\n      optionElement.value = option.exportValue;\n      if (storedData.value.includes(option.exportValue)) {\n        optionElement.setAttribute(\"selected\", true);\n        addAnEmptyEntry = false;\n      }\n      selectElement.append(optionElement);\n    }\n\n    let removeEmptyEntry = null;\n    if (addAnEmptyEntry) {\n      const noneOptionElement = document.createElement(\"option\");\n      noneOptionElement.value = \" \";\n      noneOptionElement.setAttribute(\"hidden\", true);\n      noneOptionElement.setAttribute(\"selected\", true);\n      selectElement.prepend(noneOptionElement);\n\n      removeEmptyEntry = () => {\n        noneOptionElement.remove();\n        selectElement.removeEventListener(\"input\", removeEmptyEntry);\n        removeEmptyEntry = null;\n      };\n      selectElement.addEventListener(\"input\", removeEmptyEntry);\n    }\n\n    const getValue = isExport => {\n      const name = isExport ? \"value\" : \"textContent\";\n      const { options, multiple } = selectElement;\n      if (!multiple) {\n        return options.selectedIndex === -1\n          ? null\n          : options[options.selectedIndex][name];\n      }\n      return Array.prototype.filter\n        .call(options, option => option.selected)\n        .map(option => option[name]);\n    };\n\n    let selectedValues = getValue(/* isExport */ false);\n\n    const getItems = event => {\n      const options = event.target.options;\n      return Array.prototype.map.call(options, option => {\n        return { displayValue: option.textContent, exportValue: option.value };\n      });\n    };\n\n    if (this.enableScripting && this.hasJSActions) {\n      selectElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value(event) {\n            removeEmptyEntry?.();\n            const value = event.detail.value;\n            const values = new Set(Array.isArray(value) ? value : [value]);\n            for (const option of selectElement.options) {\n              option.selected = values.has(option.value);\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          multipleSelection(event) {\n            selectElement.multiple = true;\n          },\n          remove(event) {\n            const options = selectElement.options;\n            const index = event.detail.remove;\n            options[index].selected = false;\n            selectElement.remove(index);\n            if (options.length > 0) {\n              const i = Array.prototype.findIndex.call(\n                options,\n                option => option.selected\n              );\n              if (i === -1) {\n                options[0].selected = true;\n              }\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n              items: getItems(event),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          clear(event) {\n            while (selectElement.length !== 0) {\n              selectElement.remove(0);\n            }\n            storage.setValue(id, { value: null, items: [] });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          insert(event) {\n            const { index, displayValue, exportValue } = event.detail.insert;\n            const selectChild = selectElement.children[index];\n            const optionElement = document.createElement(\"option\");\n            optionElement.textContent = displayValue;\n            optionElement.value = exportValue;\n\n            if (selectChild) {\n              selectChild.before(optionElement);\n            } else {\n              selectElement.append(optionElement);\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n              items: getItems(event),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          items(event) {\n            const { items } = event.detail;\n            while (selectElement.length !== 0) {\n              selectElement.remove(0);\n            }\n            for (const item of items) {\n              const { displayValue, exportValue } = item;\n              const optionElement = document.createElement(\"option\");\n              optionElement.textContent = displayValue;\n              optionElement.value = exportValue;\n              selectElement.append(optionElement);\n            }\n            if (selectElement.options.length > 0) {\n              selectElement.options[0].selected = true;\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n              items: getItems(event),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          indices(event) {\n            const indices = new Set(event.detail.indices);\n            for (const option of event.target.options) {\n              option.selected = indices.has(option.index);\n            }\n            storage.setValue(id, {\n              value: getValue(/* isExport */ true),\n            });\n            selectedValues = getValue(/* isExport */ false);\n          },\n          editable(event) {\n            event.target.disabled = !event.detail.editable;\n          },\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n\n      selectElement.addEventListener(\"input\", event => {\n        const exportValue = getValue(/* isExport */ true);\n        storage.setValue(id, { value: exportValue });\n\n        event.preventDefault();\n\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id,\n            name: \"Keystroke\",\n            value: selectedValues,\n            changeEx: exportValue,\n            willCommit: false,\n            commitKey: 1,\n            keyDown: false,\n          },\n        });\n      });\n\n      this._setEventListeners(\n        selectElement,\n        [\n          [\"focus\", \"Focus\"],\n          [\"blur\", \"Blur\"],\n          [\"mousedown\", \"Mouse Down\"],\n          [\"mouseenter\", \"Mouse Enter\"],\n          [\"mouseleave\", \"Mouse Exit\"],\n          [\"mouseup\", \"Mouse Up\"],\n          [\"input\", \"Action\"],\n          [\"input\", \"Validate\"],\n        ],\n        event => event.target.value\n      );\n    } else {\n      selectElement.addEventListener(\"input\", function (event) {\n        storage.setValue(id, { value: getValue(/* isExport */ true) });\n      });\n    }\n\n    if (this.data.combo) {\n      this._setTextStyle(selectElement);\n    } else {\n      // Just use the default font size...\n      // it's a bit hard to guess what is a good size.\n    }\n    this._setBackgroundColor(selectElement);\n    this._setDefaultPropertiesFromJS(selectElement);\n\n    this.container.append(selectElement);\n    return this.container;\n  }\n}\n\nclass PopupAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const { data, elements } = parameters;\n    const isRenderable = !!(\n      data.titleObj?.str ||\n      data.contentsObj?.str ||\n      data.richText?.str\n    );\n    super(parameters, { isRenderable });\n    this.elements = elements;\n  }\n\n  render() {\n    this.container.classList.add(\"popupAnnotation\");\n\n    const popup = new PopupElement({\n      container: this.container,\n      color: this.data.color,\n      titleObj: this.data.titleObj,\n      modificationDate: this.data.modificationDate,\n      contentsObj: this.data.contentsObj,\n      richText: this.data.richText,\n      rect: this.data.rect,\n      parentRect: this.data.parentRect || null,\n      parent: this.parent,\n      elements: this.elements,\n      open: this.data.open,\n    });\n\n    const elementIds = [];\n    for (const element of this.elements) {\n      element.popup = popup;\n      elementIds.push(element.data.id);\n      element.addHighlightArea();\n    }\n\n    this.container.setAttribute(\"aria-controls\", elementIds.join(\",\"));\n\n    return this.container;\n  }\n}\n\nclass PopupElement {\n  #dateTimePromise = null;\n\n  #boundHide = this.#hide.bind(this);\n\n  #boundShow = this.#show.bind(this);\n\n  #boundToggle = this.#toggle.bind(this);\n\n  #color = null;\n\n  #container = null;\n\n  #contentsObj = null;\n\n  #elements = null;\n\n  #parent = null;\n\n  #parentRect = null;\n\n  #pinned = false;\n\n  #popup = null;\n\n  #rect = null;\n\n  #richText = null;\n\n  #titleObj = null;\n\n  #wasVisible = false;\n\n  constructor({\n    container,\n    color,\n    elements,\n    titleObj,\n    modificationDate,\n    contentsObj,\n    richText,\n    parent,\n    rect,\n    parentRect,\n    open,\n  }) {\n    this.#container = container;\n    this.#titleObj = titleObj;\n    this.#contentsObj = contentsObj;\n    this.#richText = richText;\n    this.#parent = parent;\n    this.#color = color;\n    this.#rect = rect;\n    this.#parentRect = parentRect;\n    this.#elements = elements;\n\n    const dateObject = PDFDateString.toDateObject(modificationDate);\n    if (dateObject) {\n      // The modification date is shown in the popup instead of the creation\n      // date if it is available and can be parsed correctly, which is\n      // consistent with other viewers such as Adobe Acrobat.\n      this.#dateTimePromise = parent.l10n.get(\"annotation_date_string\", {\n        date: dateObject.toLocaleDateString(),\n        time: dateObject.toLocaleTimeString(),\n      });\n    }\n\n    this.trigger = elements.flatMap(e => e.getElementsToTriggerPopup());\n    // Attach the event listeners to the trigger element.\n    for (const element of this.trigger) {\n      element.addEventListener(\"click\", this.#boundToggle);\n      element.addEventListener(\"mouseenter\", this.#boundShow);\n      element.addEventListener(\"mouseleave\", this.#boundHide);\n      if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n        element.classList.add(\"popupTriggerArea\");\n      }\n    }\n\n    this.#container.hidden = true;\n    if (open) {\n      this.#toggle();\n    }\n\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n      // Since the popup is lazily created, we need to ensure that it'll be\n      // created and displayed during reference tests.\n      this.#parent.popupShow.push(async () => {\n        if (this.#container.hidden) {\n          this.#show();\n        }\n        if (this.#dateTimePromise) {\n          await this.#dateTimePromise;\n        }\n      });\n    }\n  }\n\n  render() {\n    if (this.#popup) {\n      return;\n    }\n\n    const {\n      page: { view },\n      viewport: {\n        rawDims: { pageWidth, pageHeight, pageX, pageY },\n      },\n    } = this.#parent;\n    const popup = (this.#popup = document.createElement(\"div\"));\n    popup.className = \"popup\";\n\n    if (this.#color) {\n      const baseColor = (popup.style.outlineColor = Util.makeHexColor(\n        ...this.#color\n      ));\n      if (\n        (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n        CSS.supports(\"background-color\", \"color-mix(in srgb, red 30%, white)\")\n      ) {\n        popup.style.backgroundColor = `color-mix(in srgb, ${baseColor} 30%, white)`;\n      } else {\n        // color-mix isn't supported in some browsers hence this version.\n        // See https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/color-mix#browser_compatibility\n        // TODO: Use color-mix when it's supported everywhere.\n        // Enlighten the color.\n        const BACKGROUND_ENLIGHT = 0.7;\n        popup.style.backgroundColor = Util.makeHexColor(\n          ...this.#color.map(c =>\n            Math.floor(BACKGROUND_ENLIGHT * (255 - c) + c)\n          )\n        );\n      }\n    }\n\n    const header = document.createElement(\"span\");\n    header.className = \"header\";\n    const title = document.createElement(\"h1\");\n    header.append(title);\n    ({ dir: title.dir, str: title.textContent } = this.#titleObj);\n    popup.append(header);\n\n    if (this.#dateTimePromise) {\n      const modificationDate = document.createElement(\"span\");\n      modificationDate.classList.add(\"popupDate\");\n      this.#dateTimePromise.then(localized => {\n        modificationDate.textContent = localized;\n      });\n      header.append(modificationDate);\n    }\n\n    const contentsObj = this.#contentsObj;\n    const richText = this.#richText;\n    if (\n      richText?.str &&\n      (!contentsObj?.str || contentsObj.str === richText.str)\n    ) {\n      XfaLayer.render({\n        xfaHtml: richText.html,\n        intent: \"richText\",\n        div: popup,\n      });\n      popup.lastChild.classList.add(\"richText\", \"popupContent\");\n    } else {\n      const contents = this._formatContents(contentsObj);\n      popup.append(contents);\n    }\n\n    let useParentRect = !!this.#parentRect;\n    let rect = useParentRect ? this.#parentRect : this.#rect;\n    for (const element of this.#elements) {\n      if (!rect || Util.intersect(element.data.rect, rect) !== null) {\n        rect = element.data.rect;\n        useParentRect = true;\n        break;\n      }\n    }\n\n    const normalizedRect = Util.normalizeRect([\n      rect[0],\n      view[3] - rect[1] + view[1],\n      rect[2],\n      view[3] - rect[3] + view[1],\n    ]);\n\n    const HORIZONTAL_SPACE_AFTER_ANNOTATION = 5;\n    const parentWidth = useParentRect\n      ? rect[2] - rect[0] + HORIZONTAL_SPACE_AFTER_ANNOTATION\n      : 0;\n    const popupLeft = normalizedRect[0] + parentWidth;\n    const popupTop = normalizedRect[1];\n\n    const { style } = this.#container;\n    style.left = `${(100 * (popupLeft - pageX)) / pageWidth}%`;\n    style.top = `${(100 * (popupTop - pageY)) / pageHeight}%`;\n\n    this.#container.append(popup);\n  }\n\n  /**\n   * Format the contents of the popup by adding newlines where necessary.\n   *\n   * @private\n   * @param {Object<string, string>} contentsObj\n   * @memberof PopupElement\n   * @returns {HTMLParagraphElement}\n   */\n  _formatContents({ str, dir }) {\n    const p = document.createElement(\"p\");\n    p.classList.add(\"popupContent\");\n    p.dir = dir;\n    const lines = str.split(/(?:\\r\\n?|\\n)/);\n    for (let i = 0, ii = lines.length; i < ii; ++i) {\n      const line = lines[i];\n      p.append(document.createTextNode(line));\n      if (i < ii - 1) {\n        p.append(document.createElement(\"br\"));\n      }\n    }\n    return p;\n  }\n\n  /**\n   * Toggle the visibility of the popup.\n   */\n  #toggle() {\n    this.#pinned = !this.#pinned;\n    if (this.#pinned) {\n      this.#show();\n      this.#container.addEventListener(\"click\", this.#boundToggle);\n    } else {\n      this.#hide();\n      this.#container.removeEventListener(\"click\", this.#boundToggle);\n    }\n  }\n\n  /**\n   * Show the popup.\n   */\n  #show() {\n    if (!this.#popup) {\n      this.render();\n    }\n    if (!this.isVisible) {\n      this.#container.hidden = false;\n      this.#container.style.zIndex =\n        parseInt(this.#container.style.zIndex) + 1000;\n    } else if (this.#pinned) {\n      this.#container.classList.add(\"focused\");\n    }\n  }\n\n  /**\n   * Hide the popup.\n   */\n  #hide() {\n    this.#container.classList.remove(\"focused\");\n    if (this.#pinned) {\n      return;\n    }\n    this.#container.hidden = true;\n    this.#container.style.zIndex =\n      parseInt(this.#container.style.zIndex) - 1000;\n  }\n\n  forceHide() {\n    this.#wasVisible = this.isVisible;\n    if (!this.#wasVisible) {\n      return;\n    }\n    this.#container.hidden = true;\n  }\n\n  maybeShow() {\n    if (!this.#wasVisible) {\n      return;\n    }\n    this.#wasVisible = false;\n    this.#container.hidden = false;\n  }\n\n  get isVisible() {\n    return this.#container.hidden === false;\n  }\n}\n\nclass FreeTextAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable, ignoreBorder: true });\n    this.textContent = parameters.data.textContent;\n    this.annotationEditorType = AnnotationEditorType.FREETEXT;\n  }\n\n  render() {\n    this.container.classList.add(\"freeTextAnnotation\");\n\n    if (this.textContent) {\n      const content = document.createElement(\"div\");\n      content.classList.add(\"annotationTextContent\");\n      content.setAttribute(\"role\", \"comment\");\n      for (const line of this.textContent) {\n        const lineSpan = document.createElement(\"span\");\n        lineSpan.textContent = line;\n        content.append(lineSpan);\n      }\n      this.container.append(content);\n    }\n\n    if (!this.data.popupRef) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n}\n\nclass LineAnnotationElement extends AnnotationElement {\n  #line = null;\n\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"lineAnnotation\");\n\n    // Create an invisible line with the same starting and ending coordinates\n    // that acts as the trigger for the popup. Only the line itself should\n    // trigger the popup, not the entire container.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    // PDF coordinates are calculated from a bottom left origin, so transform\n    // the line coordinates to a top left origin for the SVG element.\n    const line = (this.#line = this.svgFactory.createElement(\"svg:line\"));\n    line.setAttribute(\"x1\", data.rect[2] - data.lineCoordinates[0]);\n    line.setAttribute(\"y1\", data.rect[3] - data.lineCoordinates[1]);\n    line.setAttribute(\"x2\", data.rect[2] - data.lineCoordinates[2]);\n    line.setAttribute(\"y2\", data.rect[3] - data.lineCoordinates[3]);\n    // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    // won't be possible to open/close the popup (note e.g. issue 11122).\n    line.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n    line.setAttribute(\"stroke\", \"transparent\");\n    line.setAttribute(\"fill\", \"transparent\");\n\n    svg.append(line);\n    this.container.append(svg);\n\n    // Create the popup ourselves so that we can bind it to the line instead\n    // of to the entire container (which is the default).\n    if (!data.popupRef) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#line;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass SquareAnnotationElement extends AnnotationElement {\n  #square = null;\n\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"squareAnnotation\");\n\n    // Create an invisible square with the same rectangle that acts as the\n    // trigger for the popup. Only the square itself should trigger the\n    // popup, not the entire container.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    // The browser draws half of the borders inside the square and half of\n    // the borders outside the square by default. This behavior cannot be\n    // changed programmatically, so correct for that here.\n    const borderWidth = data.borderStyle.width;\n    const square = (this.#square = this.svgFactory.createElement(\"svg:rect\"));\n    square.setAttribute(\"x\", borderWidth / 2);\n    square.setAttribute(\"y\", borderWidth / 2);\n    square.setAttribute(\"width\", width - borderWidth);\n    square.setAttribute(\"height\", height - borderWidth);\n    // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    // won't be possible to open/close the popup (note e.g. issue 11122).\n    square.setAttribute(\"stroke-width\", borderWidth || 1);\n    square.setAttribute(\"stroke\", \"transparent\");\n    square.setAttribute(\"fill\", \"transparent\");\n\n    svg.append(square);\n    this.container.append(svg);\n\n    // Create the popup ourselves so that we can bind it to the square instead\n    // of to the entire container (which is the default).\n    if (!data.popupRef) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#square;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass CircleAnnotationElement extends AnnotationElement {\n  #circle = null;\n\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"circleAnnotation\");\n\n    // Create an invisible circle with the same ellipse that acts as the\n    // trigger for the popup. Only the circle itself should trigger the\n    // popup, not the entire container.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    // The browser draws half of the borders inside the circle and half of\n    // the borders outside the circle by default. This behavior cannot be\n    // changed programmatically, so correct for that here.\n    const borderWidth = data.borderStyle.width;\n    const circle = (this.#circle =\n      this.svgFactory.createElement(\"svg:ellipse\"));\n    circle.setAttribute(\"cx\", width / 2);\n    circle.setAttribute(\"cy\", height / 2);\n    circle.setAttribute(\"rx\", width / 2 - borderWidth / 2);\n    circle.setAttribute(\"ry\", height / 2 - borderWidth / 2);\n    // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    // won't be possible to open/close the popup (note e.g. issue 11122).\n    circle.setAttribute(\"stroke-width\", borderWidth || 1);\n    circle.setAttribute(\"stroke\", \"transparent\");\n    circle.setAttribute(\"fill\", \"transparent\");\n\n    svg.append(circle);\n    this.container.append(svg);\n\n    // Create the popup ourselves so that we can bind it to the circle instead\n    // of to the entire container (which is the default).\n    if (!data.popupRef) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#circle;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass PolylineAnnotationElement extends AnnotationElement {\n  #polyline = null;\n\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable, ignoreBorder: true });\n\n    this.containerClassName = \"polylineAnnotation\";\n    this.svgElementName = \"svg:polyline\";\n  }\n\n  render() {\n    this.container.classList.add(this.containerClassName);\n\n    // Create an invisible polyline with the same points that acts as the\n    // trigger for the popup. Only the polyline itself should trigger the\n    // popup, not the entire container.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    // Convert the vertices array to a single points string that the SVG\n    // polyline element expects (\"x1,y1 x2,y2 ...\"). PDF coordinates are\n    // calculated from a bottom left origin, so transform the polyline\n    // coordinates to a top left origin for the SVG element.\n    let points = [];\n    for (const coordinate of data.vertices) {\n      const x = coordinate.x - data.rect[0];\n      const y = data.rect[3] - coordinate.y;\n      points.push(x + \",\" + y);\n    }\n    points = points.join(\" \");\n\n    const polyline = (this.#polyline = this.svgFactory.createElement(\n      this.svgElementName\n    ));\n    polyline.setAttribute(\"points\", points);\n    // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    // won't be possible to open/close the popup (note e.g. issue 11122).\n    polyline.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n    polyline.setAttribute(\"stroke\", \"transparent\");\n    polyline.setAttribute(\"fill\", \"transparent\");\n\n    svg.append(polyline);\n    this.container.append(svg);\n\n    // Create the popup ourselves so that we can bind it to the polyline\n    // instead of to the entire container (which is the default).\n    if (!data.popupRef) {\n      this._createPopup(polyline, data);\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#polyline;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass PolygonAnnotationElement extends PolylineAnnotationElement {\n  constructor(parameters) {\n    // Polygons are specific forms of polylines, so reuse their logic.\n    super(parameters);\n\n    this.containerClassName = \"polygonAnnotation\";\n    this.svgElementName = \"svg:polygon\";\n  }\n}\n\nclass CaretAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"caretAnnotation\");\n\n    if (!this.data.popupRef) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n}\n\nclass InkAnnotationElement extends AnnotationElement {\n  #polylines = [];\n\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable, ignoreBorder: true });\n\n    this.containerClassName = \"inkAnnotation\";\n\n    // Use the polyline SVG element since it allows us to use coordinates\n    // directly and to draw both straight lines and curves.\n    this.svgElementName = \"svg:polyline\";\n    this.annotationEditorType = AnnotationEditorType.INK;\n  }\n\n  render() {\n    this.container.classList.add(this.containerClassName);\n\n    // Create an invisible polyline with the same points that acts as the\n    // trigger for the popup.\n    const data = this.data;\n    const { width, height } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(\n      width,\n      height,\n      /* skipDimensions = */ true\n    );\n\n    for (const inkList of data.inkLists) {\n      // Convert the ink list to a single points string that the SVG\n      // polyline element expects (\"x1,y1 x2,y2 ...\"). PDF coordinates are\n      // calculated from a bottom left origin, so transform the polyline\n      // coordinates to a top left origin for the SVG element.\n      let points = [];\n      for (const coordinate of inkList) {\n        const x = coordinate.x - data.rect[0];\n        const y = data.rect[3] - coordinate.y;\n        points.push(`${x},${y}`);\n      }\n      points = points.join(\" \");\n\n      const polyline = this.svgFactory.createElement(this.svgElementName);\n      this.#polylines.push(polyline);\n      polyline.setAttribute(\"points\", points);\n      // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n      // won't be possible to open/close the popup (note e.g. issue 11122).\n      polyline.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n      polyline.setAttribute(\"stroke\", \"transparent\");\n      polyline.setAttribute(\"fill\", \"transparent\");\n\n      // Create the popup ourselves so that we can bind it to the polyline\n      // instead of to the entire container (which is the default).\n      if (!data.popupRef) {\n        this._createPopup(polyline, data);\n      }\n\n      svg.append(polyline);\n    }\n\n    this.container.append(svg);\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#polylines;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\n\nclass HighlightAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, {\n      isRenderable,\n      ignoreBorder: true,\n      createQuadrilaterals: true,\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef) {\n      this._createPopup();\n    }\n\n    if (this.quadrilaterals) {\n      return this._renderQuadrilaterals(\"highlightAnnotation\");\n    }\n\n    this.container.classList.add(\"highlightAnnotation\");\n    return this.container;\n  }\n}\n\nclass UnderlineAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, {\n      isRenderable,\n      ignoreBorder: true,\n      createQuadrilaterals: true,\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef) {\n      this._createPopup();\n    }\n\n    if (this.quadrilaterals) {\n      return this._renderQuadrilaterals(\"underlineAnnotation\");\n    }\n\n    this.container.classList.add(\"underlineAnnotation\");\n    return this.container;\n  }\n}\n\nclass SquigglyAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, {\n      isRenderable,\n      ignoreBorder: true,\n      createQuadrilaterals: true,\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef) {\n      this._createPopup();\n    }\n\n    if (this.quadrilaterals) {\n      return this._renderQuadrilaterals(\"squigglyAnnotation\");\n    }\n\n    this.container.classList.add(\"squigglyAnnotation\");\n    return this.container;\n  }\n}\n\nclass StrikeOutAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, {\n      isRenderable,\n      ignoreBorder: true,\n      createQuadrilaterals: true,\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef) {\n      this._createPopup();\n    }\n\n    if (this.quadrilaterals) {\n      return this._renderQuadrilaterals(\"strikeoutAnnotation\");\n    }\n\n    this.container.classList.add(\"strikeoutAnnotation\");\n    return this.container;\n  }\n}\n\nclass StampAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const isRenderable = !!(\n      parameters.data.popupRef ||\n      parameters.data.titleObj?.str ||\n      parameters.data.contentsObj?.str ||\n      parameters.data.richText?.str\n    );\n    super(parameters, { isRenderable, ignoreBorder: true });\n  }\n\n  render() {\n    this.container.classList.add(\"stampAnnotation\");\n\n    if (!this.data.popupRef) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n}\n\nclass FileAttachmentAnnotationElement extends AnnotationElement {\n  #trigger = null;\n\n  constructor(parameters) {\n    super(parameters, { isRenderable: true });\n\n    const { filename, content } = this.data.file;\n    this.filename = getFilenameFromUrl(filename, /* onlyStripPath = */ true);\n    this.content = content;\n\n    this.linkService.eventBus?.dispatch(\"fileattachmentannotation\", {\n      source: this,\n      filename,\n      content,\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"fileAttachmentAnnotation\");\n\n    let trigger;\n    if (this.data.hasAppearance) {\n      trigger = document.createElement(\"div\");\n    } else {\n      // Unfortunately it seems that it's not clearly specified exactly what\n      // names are actually valid, since Table 184 contains:\n      //   Conforming readers shall provide predefined icon appearances for at\n      //   least the following standard names: GraphPushPin, PaperclipTag.\n      //   Additional names may be supported as well. Default value: PushPin.\n      trigger = document.createElement(\"img\");\n      trigger.src = `${this.imageResourcesPath}annotation-${\n        /paperclip/i.test(this.data.name) ? \"paperclip\" : \"pushpin\"\n      }.svg`;\n    }\n    trigger.classList.add(\"popupTriggerArea\");\n    trigger.addEventListener(\"dblclick\", this._download.bind(this));\n    this.#trigger = trigger;\n\n    if (\n      !this.data.popupRef &&\n      (this.data.titleObj?.str ||\n        this.data.contentsObj?.str ||\n        this.data.richText)\n    ) {\n      this._createPopup();\n    }\n\n    this.container.append(trigger);\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#trigger;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n\n  /**\n   * Download the file attachment associated with this annotation.\n   *\n   * @private\n   * @memberof FileAttachmentAnnotationElement\n   */\n  _download() {\n    this.downloadManager?.openOrDownloadData(\n      this.container,\n      this.content,\n      this.filename\n    );\n  }\n}\n\n/**\n * @typedef {Object} AnnotationLayerParameters\n * @property {PageViewport} viewport\n * @property {HTMLDivElement} div\n * @property {Array} annotations\n * @property {PDFPageProxy} page\n * @property {IPDFLinkService} linkService\n * @property {IDownloadManager} downloadManager\n * @property {AnnotationStorage} [annotationStorage]\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   for annotation icons. Include trailing slash.\n * @property {boolean} renderForms\n * @property {boolean} [enableScripting] - Enable embedded script execution.\n * @property {boolean} [hasJSActions] - Some fields have JS actions.\n *   The default value is `false`.\n * @property {Object<string, Array<Object>> | null} [fieldObjects]\n * @property {Map<string, HTMLCanvasElement>} [annotationCanvasMap]\n * @property {TextAccessibilityManager} [accessibilityManager]\n */\n\n/**\n * Manage the layer containing all the annotations.\n */\nclass AnnotationLayer {\n  #accessibilityManager = null;\n\n  #annotationCanvasMap = null;\n\n  #editableAnnotations = new Map();\n\n  constructor({\n    div,\n    accessibilityManager,\n    annotationCanvasMap,\n    l10n,\n    page,\n    viewport,\n  }) {\n    this.div = div;\n    this.#accessibilityManager = accessibilityManager;\n    this.#annotationCanvasMap = annotationCanvasMap;\n    this.l10n = l10n;\n    this.page = page;\n    this.viewport = viewport;\n    this.zIndex = 0;\n\n    if (\n      typeof PDFJSDev !== \"undefined\" &&\n      PDFJSDev.test(\"GENERIC && !TESTING\")\n    ) {\n      const { NullL10n } = require(\"pdfjs-web/l10n_utils.js\");\n      this.l10n ||= NullL10n;\n    }\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n      // For testing purposes.\n      Object.defineProperty(this, \"showPopups\", {\n        value: async () => {\n          for (const show of this.popupShow) {\n            await show();\n          }\n        },\n      });\n      this.popupShow = [];\n    }\n  }\n\n  #appendElement(element, id) {\n    const contentElement = element.firstChild || element;\n    contentElement.id = `${AnnotationPrefix}${id}`;\n\n    this.div.append(element);\n    this.#accessibilityManager?.moveElementInDOM(\n      this.div,\n      element,\n      contentElement,\n      /* isRemovable = */ false\n    );\n  }\n\n  /**\n   * Render a new annotation layer with all annotation elements.\n   *\n   * @param {AnnotationLayerParameters} params\n   * @memberof AnnotationLayer\n   */\n  async render(params) {\n    const { annotations } = params;\n    const layer = this.div;\n    setLayerDimensions(layer, this.viewport);\n\n    const popupToElements = new Map();\n    const elementParams = {\n      data: null,\n      layer,\n      linkService: params.linkService,\n      downloadManager: params.downloadManager,\n      imageResourcesPath: params.imageResourcesPath || \"\",\n      renderForms: params.renderForms !== false,\n      svgFactory: new DOMSVGFactory(),\n      annotationStorage: params.annotationStorage || new AnnotationStorage(),\n      enableScripting: params.enableScripting === true,\n      hasJSActions: params.hasJSActions,\n      fieldObjects: params.fieldObjects,\n      parent: this,\n      elements: null,\n    };\n\n    for (const data of annotations) {\n      if (data.noHTML) {\n        continue;\n      }\n      const isPopupAnnotation = data.annotationType === AnnotationType.POPUP;\n      if (!isPopupAnnotation) {\n        const { width, height } = getRectDims(data.rect);\n        if (width <= 0 || height <= 0) {\n          continue; // Ignore empty annotations.\n        }\n      } else {\n        const elements = popupToElements.get(data.id);\n        if (!elements) {\n          // Ignore popup annotations without a corresponding annotation.\n          continue;\n        }\n        elementParams.elements = elements;\n      }\n      elementParams.data = data;\n      const element = AnnotationElementFactory.create(elementParams);\n\n      if (!element.isRenderable) {\n        continue;\n      }\n\n      if (!isPopupAnnotation && data.popupRef) {\n        const elements = popupToElements.get(data.popupRef);\n        if (!elements) {\n          popupToElements.set(data.popupRef, [element]);\n        } else {\n          elements.push(element);\n        }\n      }\n\n      if (element.annotationEditorType > 0) {\n        this.#editableAnnotations.set(element.data.id, element);\n      }\n\n      const rendered = element.render();\n      if (data.hidden) {\n        rendered.style.visibility = \"hidden\";\n      }\n      if (Array.isArray(rendered)) {\n        for (const renderedElement of rendered) {\n          this.#appendElement(renderedElement, data.id);\n        }\n      } else {\n        this.#appendElement(rendered, data.id);\n      }\n    }\n\n    this.#setAnnotationCanvasMap();\n\n    await this.l10n.translate(layer);\n  }\n\n  /**\n   * Update the annotation elements on existing annotation layer.\n   *\n   * @param {AnnotationLayerParameters} viewport\n   * @memberof AnnotationLayer\n   */\n  update({ viewport }) {\n    const layer = this.div;\n    this.viewport = viewport;\n    setLayerDimensions(layer, { rotation: viewport.rotation });\n\n    this.#setAnnotationCanvasMap();\n    layer.hidden = false;\n  }\n\n  #setAnnotationCanvasMap() {\n    if (!this.#annotationCanvasMap) {\n      return;\n    }\n    const layer = this.div;\n    for (const [id, canvas] of this.#annotationCanvasMap) {\n      const element = layer.querySelector(`[data-annotation-id=\"${id}\"]`);\n      if (!element) {\n        continue;\n      }\n\n      const { firstChild } = element;\n      if (!firstChild) {\n        element.append(canvas);\n      } else if (firstChild.nodeName === \"CANVAS\") {\n        firstChild.replaceWith(canvas);\n      } else {\n        firstChild.before(canvas);\n      }\n    }\n    this.#annotationCanvasMap.clear();\n  }\n\n  getEditableAnnotations() {\n    return Array.from(this.#editableAnnotations.values());\n  }\n\n  getEditableAnnotation(id) {\n    return this.#editableAnnotations.get(id);\n  }\n}\n\nexport { AnnotationLayer, FreeTextAnnotationElement, InkAnnotationElement };\n", "/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * PLEASE NOTE: This file is currently imported in both the `../display/` and\n *              `../scripting_api/` folders, hence be EXTREMELY careful about\n *              introducing any dependencies here since that can lead to an\n *              unexpected/unnecessary size increase of the *built* files.\n */\n\nfunction makeColorComp(n) {\n  return Math.floor(Math.max(0, Math.min(1, n)) * 255)\n    .toString(16)\n    .padStart(2, \"0\");\n}\n\n// PDF specifications section 10.3\nclass ColorConverters {\n  static CMYK_G([c, y, m, k]) {\n    return [\"G\", 1 - Math.min(1, 0.3 * c + 0.59 * m + 0.11 * y + k)];\n  }\n\n  static G_CMYK([g]) {\n    return [\"CMYK\", 0, 0, 0, 1 - g];\n  }\n\n  static G_RGB([g]) {\n    return [\"RGB\", g, g, g];\n  }\n\n  static G_HTML([g]) {\n    const G = makeColorComp(g);\n    return `#${G}${G}${G}`;\n  }\n\n  static RGB_G([r, g, b]) {\n    return [\"G\", 0.3 * r + 0.59 * g + 0.11 * b];\n  }\n\n  static RGB_HTML([r, g, b]) {\n    const R = makeColorComp(r);\n    const G = makeColorComp(g);\n    const B = makeColorComp(b);\n    return `#${R}${G}${B}`;\n  }\n\n  static T_HTML() {\n    return \"#00000000\";\n  }\n\n  static CMYK_RGB([c, y, m, k]) {\n    return [\n      \"RGB\",\n      1 - Math.min(1, c + k),\n      1 - Math.min(1, m + k),\n      1 - Math.min(1, y + k),\n    ];\n  }\n\n  static CMYK_HTML(components) {\n    const rgb = this.CMYK_RGB(components).slice(1);\n    return this.RGB_HTML(rgb);\n  }\n\n  static RGB_CMYK([r, g, b]) {\n    const c = 1 - r;\n    const m = 1 - g;\n    const y = 1 - b;\n    const k = Math.min(c, m, y);\n    return [\"CMYK\", c, m, y, k];\n  }\n}\n\nexport { ColorConverters };\n", "/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./display_utils\").PageViewport} PageViewport */\n/** @typedef {import(\"../../web/interfaces\").IPDFLinkService} IPDFLinkService */\n\nimport { XfaText } from \"./xfa_text.js\";\n\n/**\n * @typedef {Object} XfaLayerParameters\n * @property {PageViewport} viewport\n * @property {HTMLDivElement} div\n * @property {Object} xfaHtml\n * @property {AnnotationStorage} [annotationStorage]\n * @property {IPDFLinkService} linkService\n * @property {string} [intent] - (default value is 'display').\n */\n\nclass XfaLayer {\n  static setupStorage(html, id, element, storage, intent) {\n    const storedData = storage.getValue(id, { value: null });\n    switch (element.name) {\n      case \"textarea\":\n        if (storedData.value !== null) {\n          html.textContent = storedData.value;\n        }\n        if (intent === \"print\") {\n          break;\n        }\n        html.addEventListener(\"input\", event => {\n          storage.setValue(id, { value: event.target.value });\n        });\n        break;\n      case \"input\":\n        if (\n          element.attributes.type === \"radio\" ||\n          element.attributes.type === \"checkbox\"\n        ) {\n          if (storedData.value === element.attributes.xfaOn) {\n            html.setAttribute(\"checked\", true);\n          } else if (storedData.value === element.attributes.xfaOff) {\n            // The checked attribute may have been set when opening the file,\n            // unset through the UI and we're here because of printing.\n            html.removeAttribute(\"checked\");\n          }\n          if (intent === \"print\") {\n            break;\n          }\n          html.addEventListener(\"change\", event => {\n            storage.setValue(id, {\n              value: event.target.checked\n                ? event.target.getAttribute(\"xfaOn\")\n                : event.target.getAttribute(\"xfaOff\"),\n            });\n          });\n        } else {\n          if (storedData.value !== null) {\n            html.setAttribute(\"value\", storedData.value);\n          }\n          if (intent === \"print\") {\n            break;\n          }\n          html.addEventListener(\"input\", event => {\n            storage.setValue(id, { value: event.target.value });\n          });\n        }\n        break;\n      case \"select\":\n        if (storedData.value !== null) {\n          for (const option of element.children) {\n            if (option.attributes.value === storedData.value) {\n              option.attributes.selected = true;\n            }\n          }\n        }\n        html.addEventListener(\"input\", event => {\n          const options = event.target.options;\n          const value =\n            options.selectedIndex === -1\n              ? \"\"\n              : options[options.selectedIndex].value;\n          storage.setValue(id, { value });\n        });\n        break;\n    }\n  }\n\n  static setAttributes({ html, element, storage = null, intent, linkService }) {\n    const { attributes } = element;\n    const isHTMLAnchorElement = html instanceof HTMLAnchorElement;\n\n    if (attributes.type === \"radio\") {\n      // Avoid to have a radio group when printing with the same as one\n      // already displayed.\n      attributes.name = `${attributes.name}-${intent}`;\n    }\n    for (const [key, value] of Object.entries(attributes)) {\n      if (value === null || value === undefined) {\n        continue;\n      }\n\n      switch (key) {\n        case \"class\":\n          if (value.length) {\n            html.setAttribute(key, value.join(\" \"));\n          }\n          break;\n        case \"dataId\":\n          // We don't need to add dataId in the html object but it can\n          // be useful to know its value when writing printing tests:\n          // in this case, don't skip dataId to have its value.\n          break;\n        case \"id\":\n          html.setAttribute(\"data-element-id\", value);\n          break;\n        case \"style\":\n          Object.assign(html.style, value);\n          break;\n        case \"textContent\":\n          html.textContent = value;\n          break;\n        default:\n          if (!isHTMLAnchorElement || (key !== \"href\" && key !== \"newWindow\")) {\n            html.setAttribute(key, value);\n          }\n      }\n    }\n\n    if (isHTMLAnchorElement) {\n      linkService.addLinkAttributes(\n        html,\n        attributes.href,\n        attributes.newWindow\n      );\n    }\n\n    // Set the value after the others to be sure to overwrite any other values.\n    if (storage && attributes.dataId) {\n      this.setupStorage(html, attributes.dataId, element, storage);\n    }\n  }\n\n  /**\n   * Render the XFA layer.\n   *\n   * @param {XfaLayerParameters} parameters\n   */\n  static render(parameters) {\n    const storage = parameters.annotationStorage;\n    const linkService = parameters.linkService;\n    const root = parameters.xfaHtml;\n    const intent = parameters.intent || \"display\";\n    const rootHtml = document.createElement(root.name);\n    if (root.attributes) {\n      this.setAttributes({\n        html: rootHtml,\n        element: root,\n        intent,\n        linkService,\n      });\n    }\n    const stack = [[root, -1, rootHtml]];\n\n    const rootDiv = parameters.div;\n    rootDiv.append(rootHtml);\n\n    if (parameters.viewport) {\n      const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n      rootDiv.style.transform = transform;\n    }\n\n    // Set defaults.\n    if (intent !== \"richText\") {\n      rootDiv.setAttribute(\"class\", \"xfaLayer xfaFont\");\n    }\n\n    // Text nodes used for the text highlighter.\n    const textDivs = [];\n\n    while (stack.length > 0) {\n      const [parent, i, html] = stack.at(-1);\n      if (i + 1 === parent.children.length) {\n        stack.pop();\n        continue;\n      }\n\n      const child = parent.children[++stack.at(-1)[1]];\n      if (child === null) {\n        continue;\n      }\n\n      const { name } = child;\n      if (name === \"#text\") {\n        const node = document.createTextNode(child.value);\n        textDivs.push(node);\n        html.append(node);\n        continue;\n      }\n\n      let childHtml;\n      if (child?.attributes?.xmlns) {\n        childHtml = document.createElementNS(child.attributes.xmlns, name);\n      } else {\n        childHtml = document.createElement(name);\n      }\n\n      html.append(childHtml);\n      if (child.attributes) {\n        this.setAttributes({\n          html: childHtml,\n          element: child,\n          storage,\n          intent,\n          linkService,\n        });\n      }\n\n      if (child.children && child.children.length > 0) {\n        stack.push([child, -1, childHtml]);\n      } else if (child.value) {\n        const node = document.createTextNode(child.value);\n        if (XfaText.shouldBuildText(name)) {\n          textDivs.push(node);\n        }\n        childHtml.append(node);\n      }\n    }\n\n    /**\n     * TODO: re-enable that stuff once we've JS implementation.\n     * See https://bugzilla.mozilla.org/show_bug.cgi?id=1719465.\n     *\n     * for (const el of rootDiv.querySelectorAll(\n     * \".xfaDisabled input, .xfaDisabled textarea\"\n     * )) {\n     * el.setAttribute(\"disabled\", true);\n     * }\n     * for (const el of rootDiv.querySelectorAll(\n     * \".xfaReadOnly input, .xfaReadOnly textarea\"\n     * )) {\n     * el.setAttribute(\"readOnly\", true);\n     * }\n     */\n\n    for (const el of rootDiv.querySelectorAll(\n      \".xfaNonInteractive input, .xfaNonInteractive textarea\"\n    )) {\n      el.setAttribute(\"readOnly\", true);\n    }\n\n    return {\n      textDivs,\n    };\n  }\n\n  /**\n   * Update the XFA layer.\n   *\n   * @param {XfaLayerParameters} parameters\n   */\n  static update(parameters) {\n    const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n    parameters.div.style.transform = transform;\n    parameters.div.hidden = false;\n  }\n}\n\nexport { XfaLayer };\n", "/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * PLEASE NOTE: This file is currently imported in both the `web/` and\n *              `src/display/` folders, hence be EXTREMELY careful about\n *              introducing any dependencies here since that can lead to an\n *              unexpected/unnecessary size increase of the *built* files.\n */\n\n/**\n * A subset of the l10n strings in the `l10n/en-US/viewer.properties` file.\n */\nconst DEFAULT_L10N_STRINGS = {\n  of_pages: \"of {{pagesCount}}\",\n  page_of_pages: \"({{pageNumber}} of {{pagesCount}})\",\n\n  document_properties_kb: \"{{size_kb}} KB ({{size_b}} bytes)\",\n  document_properties_mb: \"{{size_mb}} MB ({{size_b}} bytes)\",\n  document_properties_date_string: \"{{date}}, {{time}}\",\n  document_properties_page_size_unit_inches: \"in\",\n  document_properties_page_size_unit_millimeters: \"mm\",\n  document_properties_page_size_orientation_portrait: \"portrait\",\n  document_properties_page_size_orientation_landscape: \"landscape\",\n  document_properties_page_size_name_a3: \"A3\",\n  document_properties_page_size_name_a4: \"A4\",\n  document_properties_page_size_name_letter: \"Letter\",\n  document_properties_page_size_name_legal: \"Legal\",\n  document_properties_page_size_dimension_string:\n    \"{{width}} × {{height}} {{unit}} ({{orientation}})\",\n  document_properties_page_size_dimension_name_string:\n    \"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})\",\n  document_properties_linearized_yes: \"Yes\",\n  document_properties_linearized_no: \"No\",\n\n  additional_layers: \"Additional Layers\",\n  page_landmark: \"Page {{page}}\",\n  thumb_page_title: \"Page {{page}}\",\n  thumb_page_canvas: \"Thumbnail of Page {{page}}\",\n\n  find_reached_top: \"Reached top of document, continued from bottom\",\n  find_reached_bottom: \"Reached end of document, continued from top\",\n  \"find_match_count[one]\": \"{{current}} of {{total}} match\",\n  \"find_match_count[other]\": \"{{current}} of {{total}} matches\",\n  \"find_match_count_limit[one]\": \"More than {{limit}} match\",\n  \"find_match_count_limit[other]\": \"More than {{limit}} matches\",\n  find_not_found: \"Phrase not found\",\n\n  page_scale_width: \"Page Width\",\n  page_scale_fit: \"Page Fit\",\n  page_scale_auto: \"Automatic Zoom\",\n  page_scale_actual: \"Actual Size\",\n  page_scale_percent: \"{{scale}}%\",\n\n  loading_error: \"An error occurred while loading the PDF.\",\n  invalid_file_error: \"Invalid or corrupted PDF file.\",\n  missing_file_error: \"Missing PDF file.\",\n  unexpected_response_error: \"Unexpected server response.\",\n  rendering_error: \"An error occurred while rendering the page.\",\n\n  annotation_date_string: \"{{date}}, {{time}}\",\n\n  printing_not_supported:\n    \"Warning: Printing is not fully supported by this browser.\",\n  printing_not_ready: \"Warning: The PDF is not fully loaded for printing.\",\n  web_fonts_disabled:\n    \"Web fonts are disabled: unable to use embedded PDF fonts.\",\n\n  free_text2_default_content: \"Start typing…\",\n  editor_free_text2_aria_label: \"Text Editor\",\n  editor_ink2_aria_label: \"Draw Editor\",\n  editor_ink_canvas_aria_label: \"User-created image\",\n};\nif (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n  DEFAULT_L10N_STRINGS.print_progress_percent = \"{{progress}}%\";\n}\n\nfunction getL10nFallback(key, args) {\n  switch (key) {\n    case \"find_match_count\":\n      key = `find_match_count[${args.total === 1 ? \"one\" : \"other\"}]`;\n      break;\n    case \"find_match_count_limit\":\n      key = `find_match_count_limit[${args.limit === 1 ? \"one\" : \"other\"}]`;\n      break;\n  }\n  return DEFAULT_L10N_STRINGS[key] || \"\";\n}\n\n// Replaces {{arguments}} with their values.\nfunction formatL10nValue(text, args) {\n  if (!args) {\n    return text;\n  }\n  return text.replaceAll(/\\{\\{\\s*(\\w+)\\s*\\}\\}/g, (all, name) => {\n    return name in args ? args[name] : \"{{\" + name + \"}}\";\n  });\n}\n\n/**\n * No-op implementation of the localization service.\n * @implements {IL10n}\n */\nconst NullL10n = {\n  async getLanguage() {\n    return \"en-us\";\n  },\n\n  async getDirection() {\n    return \"ltr\";\n  },\n\n  async get(key, args = null, fallback = getL10nFallback(key, args)) {\n    return formatL10nValue(fallback, args);\n  },\n\n  async translate(element) {},\n};\n\nexport { getL10nFallback, NullL10n };\n", "/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  Util,\n} from \"../../shared/util.js\";\nimport { AnnotationEditor } from \"./editor.js\";\nimport { InkAnnotationElement } from \"../annotation_layer.js\";\nimport { opacityToHex } from \"./tools.js\";\n\n// The dimensions of the resizer is 15x15:\n// https://searchfox.org/mozilla-central/rev/1ce190047b9556c3c10ab4de70a0e61d893e2954/toolkit/content/minimal-xul.css#136-137\n// so each dimension must be greater than RESIZER_SIZE.\nconst RESIZER_SIZE = 16;\n\n/**\n * Basic draw editor in order to generate an Ink annotation.\n */\nclass InkEditor extends AnnotationEditor {\n  #aspectRatio = 0;\n\n  #baseHeight = 0;\n\n  #baseWidth = 0;\n\n  #boundCanvasContextMenu = this.canvasContextMenu.bind(this);\n\n  #boundCanvasPointermove = this.canvasPointermove.bind(this);\n\n  #boundCanvasPointerleave = this.canvasPointerleave.bind(this);\n\n  #boundCanvasPointerup = this.canvasPointerup.bind(this);\n\n  #boundCanvasPointerdown = this.canvasPointerdown.bind(this);\n\n  #currentPath2D = new Path2D();\n\n  #disableEditing = false;\n\n  #hasSomethingToDraw = false;\n\n  #isCanvasInitialized = false;\n\n  #observer = null;\n\n  #realWidth = 0;\n\n  #realHeight = 0;\n\n  #requestFrameCallback = null;\n\n  static _defaultColor = null;\n\n  static _defaultOpacity = 1;\n\n  static _defaultThickness = 1;\n\n  static _l10nPromise;\n\n  static _type = \"ink\";\n\n  constructor(params) {\n    super({ ...params, name: \"inkEditor\" });\n    this.color = params.color || null;\n    this.thickness = params.thickness || null;\n    this.opacity = params.opacity || null;\n    this.paths = [];\n    this.bezierPath2D = [];\n    this.allRawPaths = [];\n    this.currentPath = [];\n    this.scaleFactor = 1;\n    this.translationX = this.translationY = 0;\n    this.x = 0;\n    this.y = 0;\n  }\n\n  static initialize(l10n) {\n    this._l10nPromise = new Map(\n      [\"editor_ink_canvas_aria_label\", \"editor_ink2_aria_label\"].map(str => [\n        str,\n        l10n.get(str),\n      ])\n    );\n  }\n\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.INK_THICKNESS:\n        InkEditor._defaultThickness = value;\n        break;\n      case AnnotationEditorParamsType.INK_COLOR:\n        InkEditor._defaultColor = value;\n        break;\n      case AnnotationEditorParamsType.INK_OPACITY:\n        InkEditor._defaultOpacity = value / 100;\n        break;\n    }\n  }\n\n  /** @inheritdoc */\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.INK_THICKNESS:\n        this.#updateThickness(value);\n        break;\n      case AnnotationEditorParamsType.INK_COLOR:\n        this.#updateColor(value);\n        break;\n      case AnnotationEditorParamsType.INK_OPACITY:\n        this.#updateOpacity(value);\n        break;\n    }\n  }\n\n  static get defaultPropertiesToUpdate() {\n    return [\n      [AnnotationEditorParamsType.INK_THICKNESS, InkEditor._defaultThickness],\n      [\n        AnnotationEditorParamsType.INK_COLOR,\n        InkEditor._defaultColor || AnnotationEditor._defaultLineColor,\n      ],\n      [\n        AnnotationEditorParamsType.INK_OPACITY,\n        Math.round(InkEditor._defaultOpacity * 100),\n      ],\n    ];\n  }\n\n  /** @inheritdoc */\n  get propertiesToUpdate() {\n    return [\n      [\n        AnnotationEditorParamsType.INK_THICKNESS,\n        this.thickness || InkEditor._defaultThickness,\n      ],\n      [\n        AnnotationEditorParamsType.INK_COLOR,\n        this.color ||\n          InkEditor._defaultColor ||\n          AnnotationEditor._defaultLineColor,\n      ],\n      [\n        AnnotationEditorParamsType.INK_OPACITY,\n        Math.round(100 * (this.opacity ?? InkEditor._defaultOpacity)),\n      ],\n    ];\n  }\n\n  /**\n   * Update the thickness and make this action undoable.\n   * @param {number} thickness\n   */\n  #updateThickness(thickness) {\n    const savedThickness = this.thickness;\n    this.addCommands({\n      cmd: () => {\n        this.thickness = thickness;\n        this.#fitToContent();\n      },\n      undo: () => {\n        this.thickness = savedThickness;\n        this.#fitToContent();\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_THICKNESS,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /**\n   * Update the color and make this action undoable.\n   * @param {string} color\n   */\n  #updateColor(color) {\n    const savedColor = this.color;\n    this.addCommands({\n      cmd: () => {\n        this.color = color;\n        this.#redraw();\n      },\n      undo: () => {\n        this.color = savedColor;\n        this.#redraw();\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /**\n   * Update the opacity and make this action undoable.\n   * @param {number} opacity\n   */\n  #updateOpacity(opacity) {\n    opacity /= 100;\n    const savedOpacity = this.opacity;\n    this.addCommands({\n      cmd: () => {\n        this.opacity = opacity;\n        this.#redraw();\n      },\n      undo: () => {\n        this.opacity = savedOpacity;\n        this.#redraw();\n      },\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_OPACITY,\n      overwriteIfSameType: true,\n      keepUndo: true,\n    });\n  }\n\n  /** @inheritdoc */\n  rebuild() {\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n\n    if (!this.canvas) {\n      this.#createCanvas();\n      this.#createObserver();\n    }\n\n    if (!this.isAttachedToDOM) {\n      // At some point this editor was removed and we're rebuilding it,\n      // hence we must add it to its parent.\n      this.parent.add(this);\n      this.#setCanvasDims();\n    }\n    this.#fitToContent();\n  }\n\n  /** @inheritdoc */\n  remove() {\n    if (this.canvas === null) {\n      return;\n    }\n\n    if (!this.isEmpty()) {\n      this.commit();\n    }\n\n    // Destroy the canvas.\n    this.canvas.width = this.canvas.height = 0;\n    this.canvas.remove();\n    this.canvas = null;\n\n    this.#observer.disconnect();\n    this.#observer = null;\n\n    super.remove();\n  }\n\n  setParent(parent) {\n    if (!this.parent && parent) {\n      // We've a parent hence the rescale will be handled thanks to the\n      // ResizeObserver.\n      this._uiManager.removeShouldRescale(this);\n    } else if (this.parent && parent === null) {\n      // The editor is removed from the DOM, hence we handle the rescale thanks\n      // to the onScaleChanging callback.\n      // This way, it'll be saved/printed correctly.\n      this._uiManager.addShouldRescale(this);\n    }\n    super.setParent(parent);\n  }\n\n  onScaleChanging() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const width = this.width * parentWidth;\n    const height = this.height * parentHeight;\n    this.setDimensions(width, height);\n  }\n\n  /** @inheritdoc */\n  enableEditMode() {\n    if (this.#disableEditing || this.canvas === null) {\n      return;\n    }\n\n    super.enableEditMode();\n    this.div.draggable = false;\n    this.canvas.addEventListener(\"pointerdown\", this.#boundCanvasPointerdown);\n  }\n\n  /** @inheritdoc */\n  disableEditMode() {\n    if (!this.isInEditMode() || this.canvas === null) {\n      return;\n    }\n\n    super.disableEditMode();\n    this.div.draggable = !this.isEmpty();\n    this.div.classList.remove(\"editing\");\n\n    this.canvas.removeEventListener(\n      \"pointerdown\",\n      this.#boundCanvasPointerdown\n    );\n  }\n\n  /** @inheritdoc */\n  onceAdded() {\n    this.div.draggable = !this.isEmpty();\n  }\n\n  /** @inheritdoc */\n  isEmpty() {\n    return (\n      this.paths.length === 0 ||\n      (this.paths.length === 1 && this.paths[0].length === 0)\n    );\n  }\n\n  #getInitialBBox() {\n    const {\n      parentRotation,\n      parentDimensions: [width, height],\n    } = this;\n    switch (parentRotation) {\n      case 90:\n        return [0, height, height, width];\n      case 180:\n        return [width, height, width, height];\n      case 270:\n        return [width, 0, height, width];\n      default:\n        return [0, 0, width, height];\n    }\n  }\n\n  /**\n   * Set line styles.\n   */\n  #setStroke() {\n    const { ctx, color, opacity, thickness, parentScale, scaleFactor } = this;\n    ctx.lineWidth = (thickness * parentScale) / scaleFactor;\n    ctx.lineCap = \"round\";\n    ctx.lineJoin = \"round\";\n    ctx.miterLimit = 10;\n    ctx.strokeStyle = `${color}${opacityToHex(opacity)}`;\n  }\n\n  /**\n   * Start to draw on the canvas.\n   * @param {number} x\n   * @param {number} y\n   */\n  #startDrawing(x, y) {\n    this.canvas.addEventListener(\"contextmenu\", this.#boundCanvasContextMenu);\n    this.canvas.addEventListener(\"pointerleave\", this.#boundCanvasPointerleave);\n    this.canvas.addEventListener(\"pointermove\", this.#boundCanvasPointermove);\n    this.canvas.addEventListener(\"pointerup\", this.#boundCanvasPointerup);\n    this.canvas.removeEventListener(\n      \"pointerdown\",\n      this.#boundCanvasPointerdown\n    );\n\n    this.isEditing = true;\n    if (!this.#isCanvasInitialized) {\n      this.#isCanvasInitialized = true;\n      this.#setCanvasDims();\n      this.thickness ||= InkEditor._defaultThickness;\n      this.color ||=\n        InkEditor._defaultColor || AnnotationEditor._defaultLineColor;\n      this.opacity ??= InkEditor._defaultOpacity;\n    }\n    this.currentPath.push([x, y]);\n    this.#hasSomethingToDraw = false;\n    this.#setStroke();\n\n    this.#requestFrameCallback = () => {\n      this.#drawPoints();\n      if (this.#requestFrameCallback) {\n        window.requestAnimationFrame(this.#requestFrameCallback);\n      }\n    };\n    window.requestAnimationFrame(this.#requestFrameCallback);\n  }\n\n  /**\n   * Draw on the canvas.\n   * @param {number} x\n   * @param {number} y\n   */\n  #draw(x, y) {\n    const [lastX, lastY] = this.currentPath.at(-1);\n    if (this.currentPath.length > 1 && x === lastX && y === lastY) {\n      return;\n    }\n    const currentPath = this.currentPath;\n    let path2D = this.#currentPath2D;\n    currentPath.push([x, y]);\n    this.#hasSomethingToDraw = true;\n\n    if (currentPath.length <= 2) {\n      path2D.moveTo(...currentPath[0]);\n      path2D.lineTo(x, y);\n      return;\n    }\n\n    if (currentPath.length === 3) {\n      this.#currentPath2D = path2D = new Path2D();\n      path2D.moveTo(...currentPath[0]);\n    }\n\n    this.#makeBezierCurve(\n      path2D,\n      ...currentPath.at(-3),\n      ...currentPath.at(-2),\n      x,\n      y\n    );\n  }\n\n  #endPath() {\n    if (this.currentPath.length === 0) {\n      return;\n    }\n    const lastPoint = this.currentPath.at(-1);\n    this.#currentPath2D.lineTo(...lastPoint);\n  }\n\n  /**\n   * Stop to draw on the canvas.\n   * @param {number} x\n   * @param {number} y\n   */\n  #stopDrawing(x, y) {\n    this.#requestFrameCallback = null;\n\n    x = Math.min(Math.max(x, 0), this.canvas.width);\n    y = Math.min(Math.max(y, 0), this.canvas.height);\n\n    this.#draw(x, y);\n    this.#endPath();\n\n    // Interpolate the path entered by the user with some\n    // Bezier's curves in order to have a smoother path and\n    // to reduce the data size used to draw it in the PDF.\n    let bezier;\n    if (this.currentPath.length !== 1) {\n      bezier = this.#generateBezierPoints();\n    } else {\n      // We have only one point finally.\n      const xy = [x, y];\n      bezier = [[xy, xy.slice(), xy.slice(), xy]];\n    }\n    const path2D = this.#currentPath2D;\n    const currentPath = this.currentPath;\n    this.currentPath = [];\n    this.#currentPath2D = new Path2D();\n\n    const cmd = () => {\n      this.allRawPaths.push(currentPath);\n      this.paths.push(bezier);\n      this.bezierPath2D.push(path2D);\n      this.rebuild();\n    };\n\n    const undo = () => {\n      this.allRawPaths.pop();\n      this.paths.pop();\n      this.bezierPath2D.pop();\n      if (this.paths.length === 0) {\n        this.remove();\n      } else {\n        if (!this.canvas) {\n          this.#createCanvas();\n          this.#createObserver();\n        }\n        this.#fitToContent();\n      }\n    };\n\n    this.addCommands({ cmd, undo, mustExec: true });\n  }\n\n  #drawPoints() {\n    if (!this.#hasSomethingToDraw) {\n      return;\n    }\n    this.#hasSomethingToDraw = false;\n\n    const thickness = Math.ceil(this.thickness * this.parentScale);\n    const lastPoints = this.currentPath.slice(-3);\n    const x = lastPoints.map(xy => xy[0]);\n    const y = lastPoints.map(xy => xy[1]);\n    const xMin = Math.min(...x) - thickness;\n    const xMax = Math.max(...x) + thickness;\n    const yMin = Math.min(...y) - thickness;\n    const yMax = Math.max(...y) + thickness;\n\n    const { ctx } = this;\n    ctx.save();\n\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n      // In Chrome, the clip() method doesn't work as expected.\n      ctx.clearRect(xMin, yMin, xMax - xMin, yMax - yMin);\n      ctx.beginPath();\n      ctx.rect(xMin, yMin, xMax - xMin, yMax - yMin);\n      ctx.clip();\n    } else {\n      ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    for (const path of this.bezierPath2D) {\n      ctx.stroke(path);\n    }\n    ctx.stroke(this.#currentPath2D);\n\n    ctx.restore();\n  }\n\n  #makeBezierCurve(path2D, x0, y0, x1, y1, x2, y2) {\n    const prevX = (x0 + x1) / 2;\n    const prevY = (y0 + y1) / 2;\n    const x3 = (x1 + x2) / 2;\n    const y3 = (y1 + y2) / 2;\n\n    path2D.bezierCurveTo(\n      prevX + (2 * (x1 - prevX)) / 3,\n      prevY + (2 * (y1 - prevY)) / 3,\n      x3 + (2 * (x1 - x3)) / 3,\n      y3 + (2 * (y1 - y3)) / 3,\n      x3,\n      y3\n    );\n  }\n\n  #generateBezierPoints() {\n    const path = this.currentPath;\n    if (path.length <= 2) {\n      return [[path[0], path[0], path.at(-1), path.at(-1)]];\n    }\n\n    const bezierPoints = [];\n    let i;\n    let [x0, y0] = path[0];\n    for (i = 1; i < path.length - 2; i++) {\n      const [x1, y1] = path[i];\n      const [x2, y2] = path[i + 1];\n      const x3 = (x1 + x2) / 2;\n      const y3 = (y1 + y2) / 2;\n\n      // The quadratic is: [[x0, y0], [x1, y1], [x3, y3]].\n      // Convert the quadratic to a cubic\n      // (see https://fontforge.org/docs/techref/bezier.html#converting-truetype-to-postscript)\n      const control1 = [x0 + (2 * (x1 - x0)) / 3, y0 + (2 * (y1 - y0)) / 3];\n      const control2 = [x3 + (2 * (x1 - x3)) / 3, y3 + (2 * (y1 - y3)) / 3];\n\n      bezierPoints.push([[x0, y0], control1, control2, [x3, y3]]);\n\n      [x0, y0] = [x3, y3];\n    }\n\n    const [x1, y1] = path[i];\n    const [x2, y2] = path[i + 1];\n\n    // The quadratic is: [[x0, y0], [x1, y1], [x2, y2]].\n    const control1 = [x0 + (2 * (x1 - x0)) / 3, y0 + (2 * (y1 - y0)) / 3];\n    const control2 = [x2 + (2 * (x1 - x2)) / 3, y2 + (2 * (y1 - y2)) / 3];\n\n    bezierPoints.push([[x0, y0], control1, control2, [x2, y2]]);\n    return bezierPoints;\n  }\n\n  /**\n   * Redraw all the paths.\n   */\n  #redraw() {\n    if (this.isEmpty()) {\n      this.#updateTransform();\n      return;\n    }\n    this.#setStroke();\n\n    const { canvas, ctx } = this;\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    this.#updateTransform();\n\n    for (const path of this.bezierPath2D) {\n      ctx.stroke(path);\n    }\n  }\n\n  /**\n   * Commit the curves we have in this editor.\n   */\n  commit() {\n    if (this.#disableEditing) {\n      return;\n    }\n\n    super.commit();\n\n    this.isEditing = false;\n    this.disableEditMode();\n\n    // This editor must be on top of the main ink editor.\n    this.setInForeground();\n\n    this.#disableEditing = true;\n    this.div.classList.add(\"disabled\");\n\n    this.#fitToContent(/* firstTime = */ true);\n\n    this.parent.addInkEditorIfNeeded(/* isCommitting = */ true);\n\n    // When commiting, the position of this editor is changed, hence we must\n    // move it to the right position in the DOM.\n    this.parent.moveEditorInDOM(this);\n    this.div.focus({\n      preventScroll: true /* See issue #15744 */,\n    });\n  }\n\n  /** @inheritdoc */\n  focusin(event) {\n    super.focusin(event);\n    this.enableEditMode();\n  }\n\n  /**\n   * onpointerdown callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasPointerdown(event) {\n    if (event.button !== 0 || !this.isInEditMode() || this.#disableEditing) {\n      return;\n    }\n\n    // We want to draw on top of any other editors.\n    // Since it's the last child, there's no need to give it a higher z-index.\n    this.setInForeground();\n\n    event.preventDefault();\n\n    if (event.type !== \"mouse\") {\n      this.div.focus();\n    }\n\n    this.#startDrawing(event.offsetX, event.offsetY);\n  }\n\n  /**\n   * oncontextmenu callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasContextMenu(event) {\n    event.preventDefault();\n  }\n\n  /**\n   * onpointermove callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasPointermove(event) {\n    event.preventDefault();\n    this.#draw(event.offsetX, event.offsetY);\n  }\n\n  /**\n   * onpointerup callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasPointerup(event) {\n    event.preventDefault();\n    this.#endDrawing(event);\n  }\n\n  /**\n   * onpointerleave callback for the canvas we're drawing on.\n   * @param {PointerEvent} event\n   */\n  canvasPointerleave(event) {\n    this.#endDrawing(event);\n  }\n\n  /**\n   * End the drawing.\n   * @param {PointerEvent} event\n   */\n  #endDrawing(event) {\n    this.canvas.removeEventListener(\n      \"pointerleave\",\n      this.#boundCanvasPointerleave\n    );\n    this.canvas.removeEventListener(\n      \"pointermove\",\n      this.#boundCanvasPointermove\n    );\n    this.canvas.removeEventListener(\"pointerup\", this.#boundCanvasPointerup);\n    this.canvas.addEventListener(\"pointerdown\", this.#boundCanvasPointerdown);\n\n    // Slight delay to avoid the context menu to appear (it can happen on a long\n    // tap with a pen).\n    setTimeout(() => {\n      this.canvas.removeEventListener(\n        \"contextmenu\",\n        this.#boundCanvasContextMenu\n      );\n    }, 10);\n\n    this.#stopDrawing(event.offsetX, event.offsetY);\n\n    this.addToAnnotationStorage();\n\n    // Since the ink editor covers all of the page and we want to be able\n    // to select another editor, we just put this one in the background.\n    this.setInBackground();\n  }\n\n  /**\n   * Create the canvas element.\n   */\n  #createCanvas() {\n    this.canvas = document.createElement(\"canvas\");\n    this.canvas.width = this.canvas.height = 0;\n    this.canvas.className = \"inkEditorCanvas\";\n\n    InkEditor._l10nPromise\n      .get(\"editor_ink_canvas_aria_label\")\n      .then(msg => this.canvas?.setAttribute(\"aria-label\", msg));\n    this.div.append(this.canvas);\n    this.ctx = this.canvas.getContext(\"2d\");\n  }\n\n  /**\n   * Create the resize observer.\n   */\n  #createObserver() {\n    this.#observer = new ResizeObserver(entries => {\n      const rect = entries[0].contentRect;\n      if (rect.width && rect.height) {\n        this.setDimensions(rect.width, rect.height);\n      }\n    });\n    this.#observer.observe(this.div);\n  }\n\n  /** @inheritdoc */\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    let baseX, baseY;\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n\n    super.render();\n\n    InkEditor._l10nPromise\n      .get(\"editor_ink2_aria_label\")\n      .then(msg => this.div?.setAttribute(\"aria-label\", msg));\n\n    const [x, y, w, h] = this.#getInitialBBox();\n    this.setAt(x, y, 0, 0);\n    this.setDims(w, h);\n\n    this.#createCanvas();\n\n    if (this.width) {\n      // This editor was created in using copy (ctrl+c).\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      this.setAt(\n        baseX * parentWidth,\n        baseY * parentHeight,\n        this.width * parentWidth,\n        this.height * parentHeight\n      );\n      this.#isCanvasInitialized = true;\n      this.#setCanvasDims();\n      this.setDims(this.width * parentWidth, this.height * parentHeight);\n      this.#redraw();\n      this.#setMinDims();\n      this.div.classList.add(\"disabled\");\n    } else {\n      this.div.classList.add(\"editing\");\n      this.enableEditMode();\n    }\n\n    this.#createObserver();\n\n    return this.div;\n  }\n\n  #setCanvasDims() {\n    if (!this.#isCanvasInitialized) {\n      return;\n    }\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.canvas.width = Math.ceil(this.width * parentWidth);\n    this.canvas.height = Math.ceil(this.height * parentHeight);\n    this.#updateTransform();\n  }\n\n  /**\n   * When the dimensions of the div change the inner canvas must\n   * renew its dimensions, hence it must redraw its own contents.\n   * @param {number} width - the new width of the div\n   * @param {number} height - the new height of the div\n   * @returns\n   */\n  setDimensions(width, height) {\n    const roundedWidth = Math.round(width);\n    const roundedHeight = Math.round(height);\n    if (\n      this.#realWidth === roundedWidth &&\n      this.#realHeight === roundedHeight\n    ) {\n      return;\n    }\n\n    this.#realWidth = roundedWidth;\n    this.#realHeight = roundedHeight;\n\n    this.canvas.style.visibility = \"hidden\";\n\n    if (\n      this.#aspectRatio &&\n      Math.abs(this.#aspectRatio - width / height) > 1e-2\n    ) {\n      height = Math.ceil(width / this.#aspectRatio);\n      this.setDims(width, height);\n    }\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n\n    if (this.#disableEditing) {\n      this.#setScaleFactor(width, height);\n    }\n\n    this.#setCanvasDims();\n    this.#redraw();\n\n    this.canvas.style.visibility = \"visible\";\n\n    // For any reason the dimensions couldn't be in percent but in pixels, hence\n    // we must fix them.\n    this.fixDims();\n  }\n\n  #setScaleFactor(width, height) {\n    const padding = this.#getPadding();\n    const scaleFactorW = (width - padding) / this.#baseWidth;\n    const scaleFactorH = (height - padding) / this.#baseHeight;\n    this.scaleFactor = Math.min(scaleFactorW, scaleFactorH);\n  }\n\n  /**\n   * Update the canvas transform.\n   */\n  #updateTransform() {\n    const padding = this.#getPadding() / 2;\n    this.ctx.setTransform(\n      this.scaleFactor,\n      0,\n      0,\n      this.scaleFactor,\n      this.translationX * this.scaleFactor + padding,\n      this.translationY * this.scaleFactor + padding\n    );\n  }\n\n  /**\n   * Convert into a Path2D.\n   * @param {Arra<Array<number>} bezier\n   * @returns {Path2D}\n   */\n  static #buildPath2D(bezier) {\n    const path2D = new Path2D();\n    for (let i = 0, ii = bezier.length; i < ii; i++) {\n      const [first, control1, control2, second] = bezier[i];\n      if (i === 0) {\n        path2D.moveTo(...first);\n      }\n      path2D.bezierCurveTo(\n        control1[0],\n        control1[1],\n        control2[0],\n        control2[1],\n        second[0],\n        second[1]\n      );\n    }\n    return path2D;\n  }\n\n  static #toPDFCoordinates(points, rect, rotation) {\n    const [blX, blY, trX, trY] = rect;\n\n    switch (rotation) {\n      case 0:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] += blX;\n          points[i + 1] = trY - points[i + 1];\n        }\n        break;\n      case 90:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = points[i + 1] + blX;\n          points[i + 1] = x + blY;\n        }\n        break;\n      case 180:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] = trX - points[i];\n          points[i + 1] += blY;\n        }\n        break;\n      case 270:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = trX - points[i + 1];\n          points[i + 1] = trY - x;\n        }\n        break;\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n    return points;\n  }\n\n  static #fromPDFCoordinates(points, rect, rotation) {\n    const [blX, blY, trX, trY] = rect;\n\n    switch (rotation) {\n      case 0:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] -= blX;\n          points[i + 1] = trY - points[i + 1];\n        }\n        break;\n      case 90:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = points[i + 1] - blY;\n          points[i + 1] = x - blX;\n        }\n        break;\n      case 180:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] = trX - points[i];\n          points[i + 1] -= blY;\n        }\n        break;\n      case 270:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = trY - points[i + 1];\n          points[i + 1] = trX - x;\n        }\n        break;\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n    return points;\n  }\n\n  /**\n   * Transform and serialize the paths.\n   * @param {number} s - scale factor\n   * @param {number} tx - abscissa of the translation\n   * @param {number} ty - ordinate of the translation\n   * @param {Array<number>} rect - the bounding box of the annotation\n   */\n  #serializePaths(s, tx, ty, rect) {\n    const paths = [];\n    const padding = this.thickness / 2;\n    const shiftX = s * tx + padding;\n    const shiftY = s * ty + padding;\n    for (const bezier of this.paths) {\n      const buffer = [];\n      const points = [];\n      for (let j = 0, jj = bezier.length; j < jj; j++) {\n        const [first, control1, control2, second] = bezier[j];\n        const p10 = s * first[0] + shiftX;\n        const p11 = s * first[1] + shiftY;\n        const p20 = s * control1[0] + shiftX;\n        const p21 = s * control1[1] + shiftY;\n        const p30 = s * control2[0] + shiftX;\n        const p31 = s * control2[1] + shiftY;\n        const p40 = s * second[0] + shiftX;\n        const p41 = s * second[1] + shiftY;\n\n        if (j === 0) {\n          buffer.push(p10, p11);\n          points.push(p10, p11);\n        }\n        buffer.push(p20, p21, p30, p31, p40, p41);\n        points.push(p20, p21);\n        if (j === jj - 1) {\n          points.push(p40, p41);\n        }\n      }\n      paths.push({\n        bezier: InkEditor.#toPDFCoordinates(buffer, rect, this.rotation),\n        points: InkEditor.#toPDFCoordinates(points, rect, this.rotation),\n      });\n    }\n\n    return paths;\n  }\n\n  /**\n   * Get the bounding box containing all the paths.\n   * @returns {Array<number>}\n   */\n  #getBbox() {\n    let xMin = Infinity;\n    let xMax = -Infinity;\n    let yMin = Infinity;\n    let yMax = -Infinity;\n\n    for (const path of this.paths) {\n      for (const [first, control1, control2, second] of path) {\n        const bbox = Util.bezierBoundingBox(\n          ...first,\n          ...control1,\n          ...control2,\n          ...second\n        );\n        xMin = Math.min(xMin, bbox[0]);\n        yMin = Math.min(yMin, bbox[1]);\n        xMax = Math.max(xMax, bbox[2]);\n        yMax = Math.max(yMax, bbox[3]);\n      }\n    }\n\n    return [xMin, yMin, xMax, yMax];\n  }\n\n  /**\n   * The bounding box is computed with null thickness, so we must take\n   * it into account for the display.\n   * It corresponds to the total padding, hence it should be divided by 2\n   * in order to have left/right paddings.\n   * @returns {number}\n   */\n  #getPadding() {\n    return this.#disableEditing\n      ? Math.ceil(this.thickness * this.parentScale)\n      : 0;\n  }\n\n  /**\n   * Set the div position and dimensions in order to fit to\n   * the bounding box of the contents.\n   * @returns {undefined}\n   */\n  #fitToContent(firstTime = false) {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    if (!this.#disableEditing) {\n      this.#redraw();\n      return;\n    }\n\n    const bbox = this.#getBbox();\n    const padding = this.#getPadding();\n    this.#baseWidth = Math.max(RESIZER_SIZE, bbox[2] - bbox[0]);\n    this.#baseHeight = Math.max(RESIZER_SIZE, bbox[3] - bbox[1]);\n\n    const width = Math.ceil(padding + this.#baseWidth * this.scaleFactor);\n    const height = Math.ceil(padding + this.#baseHeight * this.scaleFactor);\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n\n    this.#aspectRatio = width / height;\n    this.#setMinDims();\n\n    const prevTranslationX = this.translationX;\n    const prevTranslationY = this.translationY;\n\n    this.translationX = -bbox[0];\n    this.translationY = -bbox[1];\n    this.#setCanvasDims();\n    this.#redraw();\n\n    this.#realWidth = width;\n    this.#realHeight = height;\n\n    this.setDims(width, height);\n    const unscaledPadding = firstTime ? padding / this.scaleFactor / 2 : 0;\n    this.translate(\n      prevTranslationX - this.translationX - unscaledPadding,\n      prevTranslationY - this.translationY - unscaledPadding\n    );\n  }\n\n  #setMinDims() {\n    const { style } = this.div;\n    if (this.#aspectRatio >= 1) {\n      style.minHeight = `${RESIZER_SIZE}px`;\n      style.minWidth = `${Math.round(this.#aspectRatio * RESIZER_SIZE)}px`;\n    } else {\n      style.minWidth = `${RESIZER_SIZE}px`;\n      style.minHeight = `${Math.round(RESIZER_SIZE / this.#aspectRatio)}px`;\n    }\n  }\n\n  /** @inheritdoc */\n  static deserialize(data, parent, uiManager) {\n    if (data instanceof InkAnnotationElement) {\n      return null;\n    }\n    const editor = super.deserialize(data, parent, uiManager);\n\n    editor.thickness = data.thickness;\n    editor.color = Util.makeHexColor(...data.color);\n    editor.opacity = data.opacity;\n\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    const width = editor.width * pageWidth;\n    const height = editor.height * pageHeight;\n    const scaleFactor = editor.parentScale;\n    const padding = data.thickness / 2;\n\n    editor.#aspectRatio = width / height;\n    editor.#disableEditing = true;\n    editor.#realWidth = Math.round(width);\n    editor.#realHeight = Math.round(height);\n\n    const { paths, rect, rotation } = data;\n\n    for (let { bezier } of paths) {\n      bezier = InkEditor.#fromPDFCoordinates(bezier, rect, rotation);\n      const path = [];\n      editor.paths.push(path);\n      let p0 = scaleFactor * (bezier[0] - padding);\n      let p1 = scaleFactor * (bezier[1] - padding);\n      for (let i = 2, ii = bezier.length; i < ii; i += 6) {\n        const p10 = scaleFactor * (bezier[i] - padding);\n        const p11 = scaleFactor * (bezier[i + 1] - padding);\n        const p20 = scaleFactor * (bezier[i + 2] - padding);\n        const p21 = scaleFactor * (bezier[i + 3] - padding);\n        const p30 = scaleFactor * (bezier[i + 4] - padding);\n        const p31 = scaleFactor * (bezier[i + 5] - padding);\n        path.push([\n          [p0, p1],\n          [p10, p11],\n          [p20, p21],\n          [p30, p31],\n        ]);\n        p0 = p30;\n        p1 = p31;\n      }\n      const path2D = this.#buildPath2D(path);\n      editor.bezierPath2D.push(path2D);\n    }\n\n    const bbox = editor.#getBbox();\n    editor.#baseWidth = Math.max(RESIZER_SIZE, bbox[2] - bbox[0]);\n    editor.#baseHeight = Math.max(RESIZER_SIZE, bbox[3] - bbox[1]);\n    editor.#setScaleFactor(width, height);\n\n    return editor;\n  }\n\n  /** @inheritdoc */\n  serialize() {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    const rect = this.getRect(0, 0);\n    const color = AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);\n\n    return {\n      annotationType: AnnotationEditorType.INK,\n      color,\n      thickness: this.thickness,\n      opacity: this.opacity,\n      paths: this.#serializePaths(\n        this.scaleFactor / this.parentScale,\n        this.translationX,\n        this.translationY,\n        rect\n      ),\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.rotation,\n    };\n  }\n}\n\nexport { InkEditor };\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals __non_webpack_require__ */\n\nimport { deprecated, DOMSVGFactory } from \"./display_utils.js\";\nimport {\n  FONT_IDENTITY_MATRIX,\n  IDENTITY_MATRIX,\n  ImageKind,\n  OPS,\n  TextRenderingMode,\n  Util,\n  warn,\n} from \"../shared/util.js\";\nimport { isNodeJS } from \"../shared/is_node.js\";\n\nif (typeof PDFJSDev !== \"undefined\" && !PDFJSDev.test(\"GENERIC\")) {\n  throw new Error(\n    'Module \"SVGGraphics\" shall not be used outside GENERIC builds.'\n  );\n}\n\nconst SVG_DEFAULTS = {\n  fontStyle: \"normal\",\n  fontWeight: \"normal\",\n  fillColor: \"#000000\",\n};\nconst XML_NS = \"http://www.w3.org/XML/1998/namespace\";\nconst XLINK_NS = \"http://www.w3.org/1999/xlink\";\nconst LINE_CAP_STYLES = [\"butt\", \"round\", \"square\"];\nconst LINE_JOIN_STYLES = [\"miter\", \"round\", \"bevel\"];\n\nconst createObjectURL = function (\n  data,\n  contentType = \"\",\n  forceDataSchema = false\n) {\n  if (URL.createObjectURL && typeof Blob !== \"undefined\" && !forceDataSchema) {\n    return URL.createObjectURL(new Blob([data], { type: contentType }));\n  }\n  // Blob/createObjectURL is not available, falling back to data schema.\n  const digits =\n    \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\n  let buffer = `data:${contentType};base64,`;\n  for (let i = 0, ii = data.length; i < ii; i += 3) {\n    const b1 = data[i] & 0xff;\n    const b2 = data[i + 1] & 0xff;\n    const b3 = data[i + 2] & 0xff;\n    const d1 = b1 >> 2,\n      d2 = ((b1 & 3) << 4) | (b2 >> 4);\n    const d3 = i + 1 < ii ? ((b2 & 0xf) << 2) | (b3 >> 6) : 64;\n    const d4 = i + 2 < ii ? b3 & 0x3f : 64;\n    buffer += digits[d1] + digits[d2] + digits[d3] + digits[d4];\n  }\n  return buffer;\n};\n\nconst convertImgDataToPng = (function () {\n  const PNG_HEADER = new Uint8Array([\n    0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a,\n  ]);\n  const CHUNK_WRAPPER_SIZE = 12;\n\n  const crcTable = new Int32Array(256);\n  for (let i = 0; i < 256; i++) {\n    let c = i;\n    for (let h = 0; h < 8; h++) {\n      if (c & 1) {\n        c = 0xedb88320 ^ ((c >> 1) & 0x7fffffff);\n      } else {\n        c = (c >> 1) & 0x7fffffff;\n      }\n    }\n    crcTable[i] = c;\n  }\n\n  function crc32(data, start, end) {\n    let crc = -1;\n    for (let i = start; i < end; i++) {\n      const a = (crc ^ data[i]) & 0xff;\n      const b = crcTable[a];\n      crc = (crc >>> 8) ^ b;\n    }\n    return crc ^ -1;\n  }\n\n  function writePngChunk(type, body, data, offset) {\n    let p = offset;\n    const len = body.length;\n\n    data[p] = (len >> 24) & 0xff;\n    data[p + 1] = (len >> 16) & 0xff;\n    data[p + 2] = (len >> 8) & 0xff;\n    data[p + 3] = len & 0xff;\n    p += 4;\n\n    data[p] = type.charCodeAt(0) & 0xff;\n    data[p + 1] = type.charCodeAt(1) & 0xff;\n    data[p + 2] = type.charCodeAt(2) & 0xff;\n    data[p + 3] = type.charCodeAt(3) & 0xff;\n    p += 4;\n\n    data.set(body, p);\n    p += body.length;\n\n    const crc = crc32(data, offset + 4, p);\n    data[p] = (crc >> 24) & 0xff;\n    data[p + 1] = (crc >> 16) & 0xff;\n    data[p + 2] = (crc >> 8) & 0xff;\n    data[p + 3] = crc & 0xff;\n  }\n\n  function adler32(data, start, end) {\n    let a = 1;\n    let b = 0;\n    for (let i = start; i < end; ++i) {\n      a = (a + (data[i] & 0xff)) % 65521;\n      b = (b + a) % 65521;\n    }\n    return (b << 16) | a;\n  }\n\n  /**\n   * @param {Uint8Array} literals The input data.\n   * @returns {Uint8Array} The DEFLATE-compressed data stream in zlib format.\n   *   This is the required format for compressed streams in the PNG format:\n   *   http://www.libpng.org/pub/png/spec/1.2/PNG-Compression.html\n   */\n  function deflateSync(literals) {\n    if (!isNodeJS) {\n      // zlib is certainly not available outside of Node.js. We can either use\n      // the pako library for client-side DEFLATE compression, or use the\n      // canvas API of the browser to obtain a more optimal PNG file.\n      return deflateSyncUncompressed(literals);\n    }\n    try {\n      // NOTE: This implementation is far from perfect, but already way better\n      // than not applying any compression.\n      //\n      // A better algorithm will try to choose a good predictor/filter and\n      // then choose a suitable zlib compression strategy (e.g. 3,Z_RLE).\n      //\n      // Node v0.11.12 zlib.deflateSync is introduced (and returns a Buffer).\n      // Node v3.0.0   Buffer inherits from Uint8Array.\n      // Node v8.0.0   zlib.deflateSync accepts Uint8Array as input.\n      let input;\n      // eslint-disable-next-line no-undef\n      if (parseInt(process.versions.node) >= 8) {\n        input = literals;\n      } else {\n        // eslint-disable-next-line no-undef\n        input = Buffer.from(literals);\n      }\n      const output = __non_webpack_require__(\"zlib\").deflateSync(input, {\n        level: 9,\n      });\n      return output instanceof Uint8Array ? output : new Uint8Array(output);\n    } catch (e) {\n      warn(\"Not compressing PNG because zlib.deflateSync is unavailable: \" + e);\n    }\n\n    return deflateSyncUncompressed(literals);\n  }\n\n  // An implementation of DEFLATE with compression level 0 (Z_NO_COMPRESSION).\n  function deflateSyncUncompressed(literals) {\n    let len = literals.length;\n    const maxBlockLength = 0xffff;\n\n    const deflateBlocks = Math.ceil(len / maxBlockLength);\n    const idat = new Uint8Array(2 + len + deflateBlocks * 5 + 4);\n    let pi = 0;\n    idat[pi++] = 0x78; // compression method and flags\n    idat[pi++] = 0x9c; // flags\n\n    let pos = 0;\n    while (len > maxBlockLength) {\n      // writing non-final DEFLATE blocks type 0 and length of 65535\n      idat[pi++] = 0x00;\n      idat[pi++] = 0xff;\n      idat[pi++] = 0xff;\n      idat[pi++] = 0x00;\n      idat[pi++] = 0x00;\n      idat.set(literals.subarray(pos, pos + maxBlockLength), pi);\n      pi += maxBlockLength;\n      pos += maxBlockLength;\n      len -= maxBlockLength;\n    }\n\n    // writing non-final DEFLATE blocks type 0\n    idat[pi++] = 0x01;\n    idat[pi++] = len & 0xff;\n    idat[pi++] = (len >> 8) & 0xff;\n    idat[pi++] = ~len & 0xffff & 0xff;\n    idat[pi++] = ((~len & 0xffff) >> 8) & 0xff;\n    idat.set(literals.subarray(pos), pi);\n    pi += literals.length - pos;\n\n    const adler = adler32(literals, 0, literals.length); // checksum\n    idat[pi++] = (adler >> 24) & 0xff;\n    idat[pi++] = (adler >> 16) & 0xff;\n    idat[pi++] = (adler >> 8) & 0xff;\n    idat[pi++] = adler & 0xff;\n    return idat;\n  }\n\n  function encode(imgData, kind, forceDataSchema, isMask) {\n    const width = imgData.width;\n    const height = imgData.height;\n    let bitDepth, colorType, lineSize;\n    const bytes = imgData.data;\n\n    switch (kind) {\n      case ImageKind.GRAYSCALE_1BPP:\n        colorType = 0;\n        bitDepth = 1;\n        lineSize = (width + 7) >> 3;\n        break;\n      case ImageKind.RGB_24BPP:\n        colorType = 2;\n        bitDepth = 8;\n        lineSize = width * 3;\n        break;\n      case ImageKind.RGBA_32BPP:\n        colorType = 6;\n        bitDepth = 8;\n        lineSize = width * 4;\n        break;\n      default:\n        throw new Error(\"invalid format\");\n    }\n\n    // prefix every row with predictor 0\n    const literals = new Uint8Array((1 + lineSize) * height);\n    let offsetLiterals = 0,\n      offsetBytes = 0;\n    for (let y = 0; y < height; ++y) {\n      literals[offsetLiterals++] = 0; // no prediction\n      literals.set(\n        bytes.subarray(offsetBytes, offsetBytes + lineSize),\n        offsetLiterals\n      );\n      offsetBytes += lineSize;\n      offsetLiterals += lineSize;\n    }\n\n    if (kind === ImageKind.GRAYSCALE_1BPP && isMask) {\n      // inverting for image masks\n      offsetLiterals = 0;\n      for (let y = 0; y < height; y++) {\n        offsetLiterals++; // skipping predictor\n        for (let i = 0; i < lineSize; i++) {\n          literals[offsetLiterals++] ^= 0xff;\n        }\n      }\n    }\n\n    const ihdr = new Uint8Array([\n      (width >> 24) & 0xff,\n      (width >> 16) & 0xff,\n      (width >> 8) & 0xff,\n      width & 0xff,\n      (height >> 24) & 0xff,\n      (height >> 16) & 0xff,\n      (height >> 8) & 0xff,\n      height & 0xff,\n      bitDepth, // bit depth\n      colorType, // color type\n      0x00, // compression method\n      0x00, // filter method\n      0x00, // interlace method\n    ]);\n    const idat = deflateSync(literals);\n\n    // PNG consists of: header, IHDR+data, IDAT+data, and IEND.\n    const pngLength =\n      PNG_HEADER.length + CHUNK_WRAPPER_SIZE * 3 + ihdr.length + idat.length;\n    const data = new Uint8Array(pngLength);\n    let offset = 0;\n    data.set(PNG_HEADER, offset);\n    offset += PNG_HEADER.length;\n    writePngChunk(\"IHDR\", ihdr, data, offset);\n    offset += CHUNK_WRAPPER_SIZE + ihdr.length;\n    writePngChunk(\"IDATA\", idat, data, offset);\n    offset += CHUNK_WRAPPER_SIZE + idat.length;\n    writePngChunk(\"IEND\", new Uint8Array(0), data, offset);\n\n    return createObjectURL(data, \"image/png\", forceDataSchema);\n  }\n\n  // eslint-disable-next-line no-shadow\n  return function convertImgDataToPng(imgData, forceDataSchema, isMask) {\n    const kind =\n      imgData.kind === undefined ? ImageKind.GRAYSCALE_1BPP : imgData.kind;\n    return encode(imgData, kind, forceDataSchema, isMask);\n  };\n})();\n\nclass SVGExtraState {\n  constructor() {\n    this.fontSizeScale = 1;\n    this.fontWeight = SVG_DEFAULTS.fontWeight;\n    this.fontSize = 0;\n\n    this.textMatrix = IDENTITY_MATRIX;\n    this.fontMatrix = FONT_IDENTITY_MATRIX;\n    this.leading = 0;\n    this.textRenderingMode = TextRenderingMode.FILL;\n    this.textMatrixScale = 1;\n\n    // Current point (in user coordinates)\n    this.x = 0;\n    this.y = 0;\n\n    // Start of text line (in text coordinates)\n    this.lineX = 0;\n    this.lineY = 0;\n\n    // Character and word spacing\n    this.charSpacing = 0;\n    this.wordSpacing = 0;\n    this.textHScale = 1;\n    this.textRise = 0;\n\n    // Default foreground and background colors\n    this.fillColor = SVG_DEFAULTS.fillColor;\n    this.strokeColor = \"#000000\";\n\n    this.fillAlpha = 1;\n    this.strokeAlpha = 1;\n    this.lineWidth = 1;\n    this.lineJoin = \"\";\n    this.lineCap = \"\";\n    this.miterLimit = 0;\n\n    this.dashArray = [];\n    this.dashPhase = 0;\n\n    this.dependencies = [];\n\n    // Clipping\n    this.activeClipUrl = null;\n    this.clipGroup = null;\n\n    this.maskId = \"\";\n  }\n\n  clone() {\n    return Object.create(this);\n  }\n\n  setCurrentPoint(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n}\n\nfunction opListToTree(opList) {\n  let opTree = [];\n  const tmp = [];\n\n  for (const opListElement of opList) {\n    if (opListElement.fn === \"save\") {\n      opTree.push({ fnId: 92, fn: \"group\", items: [] });\n      tmp.push(opTree);\n      opTree = opTree.at(-1).items;\n      continue;\n    }\n\n    if (opListElement.fn === \"restore\") {\n      opTree = tmp.pop();\n    } else {\n      opTree.push(opListElement);\n    }\n  }\n  return opTree;\n}\n\n/**\n * Format a float number as a string.\n *\n * @param value {number} - The float number to format.\n * @returns {string}\n */\nfunction pf(value) {\n  if (Number.isInteger(value)) {\n    return value.toString();\n  }\n  const s = value.toFixed(10);\n  let i = s.length - 1;\n  if (s[i] !== \"0\") {\n    return s;\n  }\n\n  // Remove trailing zeros.\n  do {\n    i--;\n  } while (s[i] === \"0\");\n  return s.substring(0, s[i] === \".\" ? i : i + 1);\n}\n\n/**\n * Format a transform matrix as a string. The standard rotation, scale and\n * translation matrices are replaced by their shorter forms, and for\n * identity matrices an empty string is returned to save memory.\n *\n * @param m {Array} - The transform matrix to format.\n * @returns {string}\n */\nfunction pm(m) {\n  if (m[4] === 0 && m[5] === 0) {\n    if (m[1] === 0 && m[2] === 0) {\n      if (m[0] === 1 && m[3] === 1) {\n        return \"\";\n      }\n      return `scale(${pf(m[0])} ${pf(m[3])})`;\n    }\n    if (m[0] === m[3] && m[1] === -m[2]) {\n      const a = (Math.acos(m[0]) * 180) / Math.PI;\n      return `rotate(${pf(a)})`;\n    }\n  } else {\n    if (m[0] === 1 && m[1] === 0 && m[2] === 0 && m[3] === 1) {\n      return `translate(${pf(m[4])} ${pf(m[5])})`;\n    }\n  }\n  return (\n    `matrix(${pf(m[0])} ${pf(m[1])} ${pf(m[2])} ${pf(m[3])} ${pf(m[4])} ` +\n    `${pf(m[5])})`\n  );\n}\n\n// The counts below are relevant for all pages, so they have to be global\n// instead of being members of `SVGGraphics` (which is recreated for\n// each page).\nlet clipCount = 0;\nlet maskCount = 0;\nlet shadingCount = 0;\n\nclass SVGGraphics {\n  constructor(commonObjs, objs, forceDataSchema = false) {\n    deprecated(\n      \"The SVG back-end is no longer maintained and *may* be removed in the future.\"\n    );\n    this.svgFactory = new DOMSVGFactory();\n\n    this.current = new SVGExtraState();\n    this.transformMatrix = IDENTITY_MATRIX; // Graphics state matrix\n    this.transformStack = [];\n    this.extraStack = [];\n    this.commonObjs = commonObjs;\n    this.objs = objs;\n    this.pendingClip = null;\n    this.pendingEOFill = false;\n\n    this.embedFonts = false;\n    this.embeddedFonts = Object.create(null);\n    this.cssStyle = null;\n    this.forceDataSchema = !!forceDataSchema;\n\n    // In `src/shared/util.js` the operator names are mapped to IDs.\n    // The list below represents the reverse of that, i.e., it maps IDs\n    // to operator names.\n    this._operatorIdMapping = [];\n    for (const op in OPS) {\n      this._operatorIdMapping[OPS[op]] = op;\n    }\n  }\n\n  getObject(data, fallback = null) {\n    if (typeof data === \"string\") {\n      return data.startsWith(\"g_\")\n        ? this.commonObjs.get(data)\n        : this.objs.get(data);\n    }\n    return fallback;\n  }\n\n  save() {\n    this.transformStack.push(this.transformMatrix);\n    const old = this.current;\n    this.extraStack.push(old);\n    this.current = old.clone();\n  }\n\n  restore() {\n    this.transformMatrix = this.transformStack.pop();\n    this.current = this.extraStack.pop();\n    this.pendingClip = null;\n    this.tgrp = null;\n  }\n\n  group(items) {\n    this.save();\n    this.executeOpTree(items);\n    this.restore();\n  }\n\n  loadDependencies(operatorList) {\n    const fnArray = operatorList.fnArray;\n    const argsArray = operatorList.argsArray;\n\n    for (let i = 0, ii = fnArray.length; i < ii; i++) {\n      if (fnArray[i] !== OPS.dependency) {\n        continue;\n      }\n\n      for (const obj of argsArray[i]) {\n        const objsPool = obj.startsWith(\"g_\") ? this.commonObjs : this.objs;\n        const promise = new Promise(resolve => {\n          objsPool.get(obj, resolve);\n        });\n        this.current.dependencies.push(promise);\n      }\n    }\n    return Promise.all(this.current.dependencies);\n  }\n\n  transform(a, b, c, d, e, f) {\n    const transformMatrix = [a, b, c, d, e, f];\n    this.transformMatrix = Util.transform(\n      this.transformMatrix,\n      transformMatrix\n    );\n    this.tgrp = null;\n  }\n\n  getSVG(operatorList, viewport) {\n    this.viewport = viewport;\n\n    const svgElement = this._initialize(viewport);\n    return this.loadDependencies(operatorList).then(() => {\n      this.transformMatrix = IDENTITY_MATRIX;\n      this.executeOpTree(this.convertOpList(operatorList));\n      return svgElement;\n    });\n  }\n\n  convertOpList(operatorList) {\n    const operatorIdMapping = this._operatorIdMapping;\n    const argsArray = operatorList.argsArray;\n    const fnArray = operatorList.fnArray;\n    const opList = [];\n    for (let i = 0, ii = fnArray.length; i < ii; i++) {\n      const fnId = fnArray[i];\n      opList.push({\n        fnId,\n        fn: operatorIdMapping[fnId],\n        args: argsArray[i],\n      });\n    }\n    return opListToTree(opList);\n  }\n\n  executeOpTree(opTree) {\n    for (const opTreeElement of opTree) {\n      const fn = opTreeElement.fn;\n      const fnId = opTreeElement.fnId;\n      const args = opTreeElement.args;\n\n      switch (fnId | 0) {\n        case OPS.beginText:\n          this.beginText();\n          break;\n        case OPS.dependency:\n          // Handled in `loadDependencies`, so no warning should be shown.\n          break;\n        case OPS.setLeading:\n          this.setLeading(args);\n          break;\n        case OPS.setLeadingMoveText:\n          this.setLeadingMoveText(args[0], args[1]);\n          break;\n        case OPS.setFont:\n          this.setFont(args);\n          break;\n        case OPS.showText:\n          this.showText(args[0]);\n          break;\n        case OPS.showSpacedText:\n          this.showText(args[0]);\n          break;\n        case OPS.endText:\n          this.endText();\n          break;\n        case OPS.moveText:\n          this.moveText(args[0], args[1]);\n          break;\n        case OPS.setCharSpacing:\n          this.setCharSpacing(args[0]);\n          break;\n        case OPS.setWordSpacing:\n          this.setWordSpacing(args[0]);\n          break;\n        case OPS.setHScale:\n          this.setHScale(args[0]);\n          break;\n        case OPS.setTextMatrix:\n          this.setTextMatrix(\n            args[0],\n            args[1],\n            args[2],\n            args[3],\n            args[4],\n            args[5]\n          );\n          break;\n        case OPS.setTextRise:\n          this.setTextRise(args[0]);\n          break;\n        case OPS.setTextRenderingMode:\n          this.setTextRenderingMode(args[0]);\n          break;\n        case OPS.setLineWidth:\n          this.setLineWidth(args[0]);\n          break;\n        case OPS.setLineJoin:\n          this.setLineJoin(args[0]);\n          break;\n        case OPS.setLineCap:\n          this.setLineCap(args[0]);\n          break;\n        case OPS.setMiterLimit:\n          this.setMiterLimit(args[0]);\n          break;\n        case OPS.setFillRGBColor:\n          this.setFillRGBColor(args[0], args[1], args[2]);\n          break;\n        case OPS.setStrokeRGBColor:\n          this.setStrokeRGBColor(args[0], args[1], args[2]);\n          break;\n        case OPS.setStrokeColorN:\n          this.setStrokeColorN(args);\n          break;\n        case OPS.setFillColorN:\n          this.setFillColorN(args);\n          break;\n        case OPS.shadingFill:\n          this.shadingFill(args[0]);\n          break;\n        case OPS.setDash:\n          this.setDash(args[0], args[1]);\n          break;\n        case OPS.setRenderingIntent:\n          this.setRenderingIntent(args[0]);\n          break;\n        case OPS.setFlatness:\n          this.setFlatness(args[0]);\n          break;\n        case OPS.setGState:\n          this.setGState(args[0]);\n          break;\n        case OPS.fill:\n          this.fill();\n          break;\n        case OPS.eoFill:\n          this.eoFill();\n          break;\n        case OPS.stroke:\n          this.stroke();\n          break;\n        case OPS.fillStroke:\n          this.fillStroke();\n          break;\n        case OPS.eoFillStroke:\n          this.eoFillStroke();\n          break;\n        case OPS.clip:\n          this.clip(\"nonzero\");\n          break;\n        case OPS.eoClip:\n          this.clip(\"evenodd\");\n          break;\n        case OPS.paintSolidColorImageMask:\n          this.paintSolidColorImageMask();\n          break;\n        case OPS.paintImageXObject:\n          this.paintImageXObject(args[0]);\n          break;\n        case OPS.paintInlineImageXObject:\n          this.paintInlineImageXObject(args[0]);\n          break;\n        case OPS.paintImageMaskXObject:\n          this.paintImageMaskXObject(args[0]);\n          break;\n        case OPS.paintFormXObjectBegin:\n          this.paintFormXObjectBegin(args[0], args[1]);\n          break;\n        case OPS.paintFormXObjectEnd:\n          this.paintFormXObjectEnd();\n          break;\n        case OPS.closePath:\n          this.closePath();\n          break;\n        case OPS.closeStroke:\n          this.closeStroke();\n          break;\n        case OPS.closeFillStroke:\n          this.closeFillStroke();\n          break;\n        case OPS.closeEOFillStroke:\n          this.closeEOFillStroke();\n          break;\n        case OPS.nextLine:\n          this.nextLine();\n          break;\n        case OPS.transform:\n          this.transform(args[0], args[1], args[2], args[3], args[4], args[5]);\n          break;\n        case OPS.constructPath:\n          this.constructPath(args[0], args[1]);\n          break;\n        case OPS.endPath:\n          this.endPath();\n          break;\n        case 92:\n          this.group(opTreeElement.items);\n          break;\n        default:\n          warn(`Unimplemented operator ${fn}`);\n          break;\n      }\n    }\n  }\n\n  setWordSpacing(wordSpacing) {\n    this.current.wordSpacing = wordSpacing;\n  }\n\n  setCharSpacing(charSpacing) {\n    this.current.charSpacing = charSpacing;\n  }\n\n  nextLine() {\n    this.moveText(0, this.current.leading);\n  }\n\n  setTextMatrix(a, b, c, d, e, f) {\n    const current = this.current;\n    current.textMatrix = current.lineMatrix = [a, b, c, d, e, f];\n    current.textMatrixScale = Math.hypot(a, b);\n\n    current.x = current.lineX = 0;\n    current.y = current.lineY = 0;\n\n    current.xcoords = [];\n    current.ycoords = [];\n    current.tspan = this.svgFactory.createElement(\"svg:tspan\");\n    current.tspan.setAttributeNS(null, \"font-family\", current.fontFamily);\n    current.tspan.setAttributeNS(\n      null,\n      \"font-size\",\n      `${pf(current.fontSize)}px`\n    );\n    current.tspan.setAttributeNS(null, \"y\", pf(-current.y));\n\n    current.txtElement = this.svgFactory.createElement(\"svg:text\");\n    current.txtElement.append(current.tspan);\n  }\n\n  beginText() {\n    const current = this.current;\n    current.x = current.lineX = 0;\n    current.y = current.lineY = 0;\n    current.textMatrix = IDENTITY_MATRIX;\n    current.lineMatrix = IDENTITY_MATRIX;\n    current.textMatrixScale = 1;\n    current.tspan = this.svgFactory.createElement(\"svg:tspan\");\n    current.txtElement = this.svgFactory.createElement(\"svg:text\");\n    current.txtgrp = this.svgFactory.createElement(\"svg:g\");\n    current.xcoords = [];\n    current.ycoords = [];\n  }\n\n  moveText(x, y) {\n    const current = this.current;\n    current.x = current.lineX += x;\n    current.y = current.lineY += y;\n\n    current.xcoords = [];\n    current.ycoords = [];\n    current.tspan = this.svgFactory.createElement(\"svg:tspan\");\n    current.tspan.setAttributeNS(null, \"font-family\", current.fontFamily);\n    current.tspan.setAttributeNS(\n      null,\n      \"font-size\",\n      `${pf(current.fontSize)}px`\n    );\n    current.tspan.setAttributeNS(null, \"y\", pf(-current.y));\n  }\n\n  showText(glyphs) {\n    const current = this.current;\n    const font = current.font;\n    const fontSize = current.fontSize;\n    if (fontSize === 0) {\n      return;\n    }\n\n    const fontSizeScale = current.fontSizeScale;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const fontDirection = current.fontDirection;\n    const textHScale = current.textHScale * fontDirection;\n    const vertical = font.vertical;\n    const spacingDir = vertical ? 1 : -1;\n    const defaultVMetrics = font.defaultVMetrics;\n    const widthAdvanceScale = fontSize * current.fontMatrix[0];\n\n    let x = 0;\n    for (const glyph of glyphs) {\n      if (glyph === null) {\n        // Word break\n        x += fontDirection * wordSpacing;\n        continue;\n      } else if (typeof glyph === \"number\") {\n        x += (spacingDir * glyph * fontSize) / 1000;\n        continue;\n      }\n\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const character = glyph.fontChar;\n      let scaledX, scaledY;\n      let width = glyph.width;\n      if (vertical) {\n        let vx;\n        const vmetric = glyph.vmetric || defaultVMetrics;\n        vx = glyph.vmetric ? vmetric[1] : width * 0.5;\n        vx = -vx * widthAdvanceScale;\n        const vy = vmetric[2] * widthAdvanceScale;\n\n        width = vmetric ? -vmetric[0] : width;\n        scaledX = vx / fontSizeScale;\n        scaledY = (x + vy) / fontSizeScale;\n      } else {\n        scaledX = x / fontSizeScale;\n        scaledY = 0;\n      }\n\n      if (glyph.isInFont || font.missingFile) {\n        current.xcoords.push(current.x + scaledX);\n        if (vertical) {\n          current.ycoords.push(-current.y + scaledY);\n        }\n        current.tspan.textContent += character;\n      } else {\n        // TODO: To assist with text selection, we should replace the missing\n        // character with a space character if charWidth is not zero.\n        // But we cannot just do \"character = ' '\", because the ' ' character\n        // might actually map to a different glyph.\n      }\n\n      let charWidth;\n      if (vertical) {\n        charWidth = width * widthAdvanceScale - spacing * fontDirection;\n      } else {\n        charWidth = width * widthAdvanceScale + spacing * fontDirection;\n      }\n\n      x += charWidth;\n    }\n    current.tspan.setAttributeNS(null, \"x\", current.xcoords.map(pf).join(\" \"));\n    if (vertical) {\n      current.tspan.setAttributeNS(\n        null,\n        \"y\",\n        current.ycoords.map(pf).join(\" \")\n      );\n    } else {\n      current.tspan.setAttributeNS(null, \"y\", pf(-current.y));\n    }\n\n    if (vertical) {\n      current.y -= x;\n    } else {\n      current.x += x * textHScale;\n    }\n\n    current.tspan.setAttributeNS(null, \"font-family\", current.fontFamily);\n    current.tspan.setAttributeNS(\n      null,\n      \"font-size\",\n      `${pf(current.fontSize)}px`\n    );\n    if (current.fontStyle !== SVG_DEFAULTS.fontStyle) {\n      current.tspan.setAttributeNS(null, \"font-style\", current.fontStyle);\n    }\n    if (current.fontWeight !== SVG_DEFAULTS.fontWeight) {\n      current.tspan.setAttributeNS(null, \"font-weight\", current.fontWeight);\n    }\n\n    const fillStrokeMode =\n      current.textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n    if (\n      fillStrokeMode === TextRenderingMode.FILL ||\n      fillStrokeMode === TextRenderingMode.FILL_STROKE\n    ) {\n      if (current.fillColor !== SVG_DEFAULTS.fillColor) {\n        current.tspan.setAttributeNS(null, \"fill\", current.fillColor);\n      }\n      if (current.fillAlpha < 1) {\n        current.tspan.setAttributeNS(null, \"fill-opacity\", current.fillAlpha);\n      }\n    } else if (current.textRenderingMode === TextRenderingMode.ADD_TO_PATH) {\n      // Workaround for Firefox: We must set fill=\"transparent\" because\n      // fill=\"none\" would generate an empty clipping path.\n      current.tspan.setAttributeNS(null, \"fill\", \"transparent\");\n    } else {\n      current.tspan.setAttributeNS(null, \"fill\", \"none\");\n    }\n\n    if (\n      fillStrokeMode === TextRenderingMode.STROKE ||\n      fillStrokeMode === TextRenderingMode.FILL_STROKE\n    ) {\n      const lineWidthScale = 1 / (current.textMatrixScale || 1);\n      this._setStrokeAttributes(current.tspan, lineWidthScale);\n    }\n\n    // Include the text rise in the text matrix since the `pm` function\n    // creates the SVG element's `translate` entry (work on a copy to avoid\n    // altering the original text matrix).\n    let textMatrix = current.textMatrix;\n    if (current.textRise !== 0) {\n      textMatrix = textMatrix.slice();\n      textMatrix[5] += current.textRise;\n    }\n\n    current.txtElement.setAttributeNS(\n      null,\n      \"transform\",\n      `${pm(textMatrix)} scale(${pf(textHScale)}, -1)`\n    );\n    current.txtElement.setAttributeNS(XML_NS, \"xml:space\", \"preserve\");\n    current.txtElement.append(current.tspan);\n    current.txtgrp.append(current.txtElement);\n\n    this._ensureTransformGroup().append(current.txtElement);\n  }\n\n  setLeadingMoveText(x, y) {\n    this.setLeading(-y);\n    this.moveText(x, y);\n  }\n\n  addFontStyle(fontObj) {\n    if (!fontObj.data) {\n      throw new Error(\n        \"addFontStyle: No font data available, \" +\n          'ensure that the \"fontExtraProperties\" API parameter is set.'\n      );\n    }\n    if (!this.cssStyle) {\n      this.cssStyle = this.svgFactory.createElement(\"svg:style\");\n      this.cssStyle.setAttributeNS(null, \"type\", \"text/css\");\n      this.defs.append(this.cssStyle);\n    }\n\n    const url = createObjectURL(\n      fontObj.data,\n      fontObj.mimetype,\n      this.forceDataSchema\n    );\n    this.cssStyle.textContent +=\n      `@font-face { font-family: \"${fontObj.loadedName}\";` +\n      ` src: url(${url}); }\\n`;\n  }\n\n  setFont(details) {\n    const current = this.current;\n    const fontObj = this.commonObjs.get(details[0]);\n    let size = details[1];\n    current.font = fontObj;\n\n    if (\n      this.embedFonts &&\n      !fontObj.missingFile &&\n      !this.embeddedFonts[fontObj.loadedName]\n    ) {\n      this.addFontStyle(fontObj);\n      this.embeddedFonts[fontObj.loadedName] = fontObj;\n    }\n    current.fontMatrix = fontObj.fontMatrix || FONT_IDENTITY_MATRIX;\n\n    let bold = \"normal\";\n    if (fontObj.black) {\n      bold = \"900\";\n    } else if (fontObj.bold) {\n      bold = \"bold\";\n    }\n    const italic = fontObj.italic ? \"italic\" : \"normal\";\n\n    if (size < 0) {\n      size = -size;\n      current.fontDirection = -1;\n    } else {\n      current.fontDirection = 1;\n    }\n    current.fontSize = size;\n    current.fontFamily = fontObj.loadedName;\n    current.fontWeight = bold;\n    current.fontStyle = italic;\n\n    current.tspan = this.svgFactory.createElement(\"svg:tspan\");\n    current.tspan.setAttributeNS(null, \"y\", pf(-current.y));\n    current.xcoords = [];\n    current.ycoords = [];\n  }\n\n  endText() {\n    const current = this.current;\n    if (\n      current.textRenderingMode & TextRenderingMode.ADD_TO_PATH_FLAG &&\n      current.txtElement?.hasChildNodes()\n    ) {\n      // If no glyphs are shown (i.e. no child nodes), no clipping occurs.\n      current.element = current.txtElement;\n      this.clip(\"nonzero\");\n      this.endPath();\n    }\n  }\n\n  // Path properties\n  setLineWidth(width) {\n    if (width > 0) {\n      this.current.lineWidth = width;\n    }\n  }\n\n  setLineCap(style) {\n    this.current.lineCap = LINE_CAP_STYLES[style];\n  }\n\n  setLineJoin(style) {\n    this.current.lineJoin = LINE_JOIN_STYLES[style];\n  }\n\n  setMiterLimit(limit) {\n    this.current.miterLimit = limit;\n  }\n\n  setStrokeAlpha(strokeAlpha) {\n    this.current.strokeAlpha = strokeAlpha;\n  }\n\n  setStrokeRGBColor(r, g, b) {\n    this.current.strokeColor = Util.makeHexColor(r, g, b);\n  }\n\n  setFillAlpha(fillAlpha) {\n    this.current.fillAlpha = fillAlpha;\n  }\n\n  setFillRGBColor(r, g, b) {\n    this.current.fillColor = Util.makeHexColor(r, g, b);\n    this.current.tspan = this.svgFactory.createElement(\"svg:tspan\");\n    this.current.xcoords = [];\n    this.current.ycoords = [];\n  }\n\n  setStrokeColorN(args) {\n    this.current.strokeColor = this._makeColorN_Pattern(args);\n  }\n\n  setFillColorN(args) {\n    this.current.fillColor = this._makeColorN_Pattern(args);\n  }\n\n  shadingFill(args) {\n    const { width, height } = this.viewport;\n    const inv = Util.inverseTransform(this.transformMatrix);\n    const [x0, y0, x1, y1] = Util.getAxialAlignedBoundingBox(\n      [0, 0, width, height],\n      inv\n    );\n\n    const rect = this.svgFactory.createElement(\"svg:rect\");\n    rect.setAttributeNS(null, \"x\", x0);\n    rect.setAttributeNS(null, \"y\", y0);\n    rect.setAttributeNS(null, \"width\", x1 - x0);\n    rect.setAttributeNS(null, \"height\", y1 - y0);\n    rect.setAttributeNS(null, \"fill\", this._makeShadingPattern(args));\n    if (this.current.fillAlpha < 1) {\n      rect.setAttributeNS(null, \"fill-opacity\", this.current.fillAlpha);\n    }\n    this._ensureTransformGroup().append(rect);\n  }\n\n  /**\n   * @private\n   */\n  _makeColorN_Pattern(args) {\n    if (args[0] === \"TilingPattern\") {\n      return this._makeTilingPattern(args);\n    }\n    return this._makeShadingPattern(args);\n  }\n\n  /**\n   * @private\n   */\n  _makeTilingPattern(args) {\n    const color = args[1];\n    const operatorList = args[2];\n    const matrix = args[3] || IDENTITY_MATRIX;\n    const [x0, y0, x1, y1] = args[4];\n    const xstep = args[5];\n    const ystep = args[6];\n    const paintType = args[7];\n\n    const tilingId = `shading${shadingCount++}`;\n    const [tx0, ty0, tx1, ty1] = Util.normalizeRect([\n      ...Util.applyTransform([x0, y0], matrix),\n      ...Util.applyTransform([x1, y1], matrix),\n    ]);\n    const [xscale, yscale] = Util.singularValueDecompose2dScale(matrix);\n    const txstep = xstep * xscale;\n    const tystep = ystep * yscale;\n\n    const tiling = this.svgFactory.createElement(\"svg:pattern\");\n    tiling.setAttributeNS(null, \"id\", tilingId);\n    tiling.setAttributeNS(null, \"patternUnits\", \"userSpaceOnUse\");\n    tiling.setAttributeNS(null, \"width\", txstep);\n    tiling.setAttributeNS(null, \"height\", tystep);\n    tiling.setAttributeNS(null, \"x\", `${tx0}`);\n    tiling.setAttributeNS(null, \"y\", `${ty0}`);\n\n    // Save current state.\n    const svg = this.svg;\n    const transformMatrix = this.transformMatrix;\n    const fillColor = this.current.fillColor;\n    const strokeColor = this.current.strokeColor;\n\n    const bbox = this.svgFactory.create(tx1 - tx0, ty1 - ty0);\n    this.svg = bbox;\n    this.transformMatrix = matrix;\n    if (paintType === 2) {\n      const cssColor = Util.makeHexColor(...color);\n      this.current.fillColor = cssColor;\n      this.current.strokeColor = cssColor;\n    }\n    this.executeOpTree(this.convertOpList(operatorList));\n\n    // Restore saved state.\n    this.svg = svg;\n    this.transformMatrix = transformMatrix;\n    this.current.fillColor = fillColor;\n    this.current.strokeColor = strokeColor;\n\n    tiling.append(bbox.childNodes[0]);\n    this.defs.append(tiling);\n    return `url(#${tilingId})`;\n  }\n\n  /**\n   * @private\n   */\n  _makeShadingPattern(args) {\n    if (typeof args === \"string\") {\n      args = this.objs.get(args);\n    }\n    switch (args[0]) {\n      case \"RadialAxial\":\n        const shadingId = `shading${shadingCount++}`;\n        const colorStops = args[3];\n        let gradient;\n\n        switch (args[1]) {\n          case \"axial\":\n            const point0 = args[4];\n            const point1 = args[5];\n            gradient = this.svgFactory.createElement(\"svg:linearGradient\");\n            gradient.setAttributeNS(null, \"id\", shadingId);\n            gradient.setAttributeNS(null, \"gradientUnits\", \"userSpaceOnUse\");\n            gradient.setAttributeNS(null, \"x1\", point0[0]);\n            gradient.setAttributeNS(null, \"y1\", point0[1]);\n            gradient.setAttributeNS(null, \"x2\", point1[0]);\n            gradient.setAttributeNS(null, \"y2\", point1[1]);\n            break;\n          case \"radial\":\n            const focalPoint = args[4];\n            const circlePoint = args[5];\n            const focalRadius = args[6];\n            const circleRadius = args[7];\n            gradient = this.svgFactory.createElement(\"svg:radialGradient\");\n            gradient.setAttributeNS(null, \"id\", shadingId);\n            gradient.setAttributeNS(null, \"gradientUnits\", \"userSpaceOnUse\");\n            gradient.setAttributeNS(null, \"cx\", circlePoint[0]);\n            gradient.setAttributeNS(null, \"cy\", circlePoint[1]);\n            gradient.setAttributeNS(null, \"r\", circleRadius);\n            gradient.setAttributeNS(null, \"fx\", focalPoint[0]);\n            gradient.setAttributeNS(null, \"fy\", focalPoint[1]);\n            gradient.setAttributeNS(null, \"fr\", focalRadius);\n            break;\n          default:\n            throw new Error(`Unknown RadialAxial type: ${args[1]}`);\n        }\n        for (const colorStop of colorStops) {\n          const stop = this.svgFactory.createElement(\"svg:stop\");\n          stop.setAttributeNS(null, \"offset\", colorStop[0]);\n          stop.setAttributeNS(null, \"stop-color\", colorStop[1]);\n          gradient.append(stop);\n        }\n        this.defs.append(gradient);\n        return `url(#${shadingId})`;\n      case \"Mesh\":\n        warn(\"Unimplemented pattern Mesh\");\n        return null;\n      case \"Dummy\":\n        return \"hotpink\";\n      default:\n        throw new Error(`Unknown IR type: ${args[0]}`);\n    }\n  }\n\n  setDash(dashArray, dashPhase) {\n    this.current.dashArray = dashArray;\n    this.current.dashPhase = dashPhase;\n  }\n\n  constructPath(ops, args) {\n    const current = this.current;\n    let x = current.x,\n      y = current.y;\n    let d = [];\n    let j = 0;\n\n    for (const op of ops) {\n      switch (op | 0) {\n        case OPS.rectangle:\n          x = args[j++];\n          y = args[j++];\n          const width = args[j++];\n          const height = args[j++];\n          const xw = x + width;\n          const yh = y + height;\n          d.push(\n            \"M\",\n            pf(x),\n            pf(y),\n            \"L\",\n            pf(xw),\n            pf(y),\n            \"L\",\n            pf(xw),\n            pf(yh),\n            \"L\",\n            pf(x),\n            pf(yh),\n            \"Z\"\n          );\n          break;\n        case OPS.moveTo:\n          x = args[j++];\n          y = args[j++];\n          d.push(\"M\", pf(x), pf(y));\n          break;\n        case OPS.lineTo:\n          x = args[j++];\n          y = args[j++];\n          d.push(\"L\", pf(x), pf(y));\n          break;\n        case OPS.curveTo:\n          x = args[j + 4];\n          y = args[j + 5];\n          d.push(\n            \"C\",\n            pf(args[j]),\n            pf(args[j + 1]),\n            pf(args[j + 2]),\n            pf(args[j + 3]),\n            pf(x),\n            pf(y)\n          );\n          j += 6;\n          break;\n        case OPS.curveTo2:\n          d.push(\n            \"C\",\n            pf(x),\n            pf(y),\n            pf(args[j]),\n            pf(args[j + 1]),\n            pf(args[j + 2]),\n            pf(args[j + 3])\n          );\n          x = args[j + 2];\n          y = args[j + 3];\n          j += 4;\n          break;\n        case OPS.curveTo3:\n          x = args[j + 2];\n          y = args[j + 3];\n          d.push(\"C\", pf(args[j]), pf(args[j + 1]), pf(x), pf(y), pf(x), pf(y));\n          j += 4;\n          break;\n        case OPS.closePath:\n          d.push(\"Z\");\n          break;\n      }\n    }\n\n    d = d.join(\" \");\n\n    if (\n      current.path &&\n      ops.length > 0 &&\n      ops[0] !== OPS.rectangle &&\n      ops[0] !== OPS.moveTo\n    ) {\n      // If a path does not start with an OPS.rectangle or OPS.moveTo, it has\n      // probably been divided into two OPS.constructPath operators by\n      // OperatorList. Append the commands to the previous path element.\n      d = current.path.getAttributeNS(null, \"d\") + d;\n    } else {\n      current.path = this.svgFactory.createElement(\"svg:path\");\n      this._ensureTransformGroup().append(current.path);\n    }\n\n    current.path.setAttributeNS(null, \"d\", d);\n    current.path.setAttributeNS(null, \"fill\", \"none\");\n\n    // Saving a reference in current.element so that it can be addressed\n    // in 'fill' and 'stroke'\n    current.element = current.path;\n    current.setCurrentPoint(x, y);\n  }\n\n  endPath() {\n    const current = this.current;\n\n    // Painting operators end a path.\n    current.path = null;\n\n    if (!this.pendingClip) {\n      return;\n    }\n    if (!current.element) {\n      this.pendingClip = null;\n      return;\n    }\n\n    // Add the current path to a clipping path.\n    const clipId = `clippath${clipCount++}`;\n    const clipPath = this.svgFactory.createElement(\"svg:clipPath\");\n    clipPath.setAttributeNS(null, \"id\", clipId);\n    clipPath.setAttributeNS(null, \"transform\", pm(this.transformMatrix));\n\n    // A deep clone is needed when text is used as a clipping path.\n    const clipElement = current.element.cloneNode(true);\n    if (this.pendingClip === \"evenodd\") {\n      clipElement.setAttributeNS(null, \"clip-rule\", \"evenodd\");\n    } else {\n      clipElement.setAttributeNS(null, \"clip-rule\", \"nonzero\");\n    }\n    this.pendingClip = null;\n    clipPath.append(clipElement);\n    this.defs.append(clipPath);\n\n    if (current.activeClipUrl) {\n      // The previous clipping group content can go out of order -- resetting\n      // cached clipGroups.\n      current.clipGroup = null;\n      for (const prev of this.extraStack) {\n        prev.clipGroup = null;\n      }\n      // Intersect with the previous clipping path.\n      clipPath.setAttributeNS(null, \"clip-path\", current.activeClipUrl);\n    }\n    current.activeClipUrl = `url(#${clipId})`;\n\n    this.tgrp = null;\n  }\n\n  clip(type) {\n    this.pendingClip = type;\n  }\n\n  closePath() {\n    const current = this.current;\n    if (current.path) {\n      const d = `${current.path.getAttributeNS(null, \"d\")}Z`;\n      current.path.setAttributeNS(null, \"d\", d);\n    }\n  }\n\n  setLeading(leading) {\n    this.current.leading = -leading;\n  }\n\n  setTextRise(textRise) {\n    this.current.textRise = textRise;\n  }\n\n  setTextRenderingMode(textRenderingMode) {\n    this.current.textRenderingMode = textRenderingMode;\n  }\n\n  setHScale(scale) {\n    this.current.textHScale = scale / 100;\n  }\n\n  setRenderingIntent(intent) {\n    // This operation is ignored since we haven't found a use case for it yet.\n  }\n\n  setFlatness(flatness) {\n    // This operation is ignored since we haven't found a use case for it yet.\n  }\n\n  setGState(states) {\n    for (const [key, value] of states) {\n      switch (key) {\n        case \"LW\":\n          this.setLineWidth(value);\n          break;\n        case \"LC\":\n          this.setLineCap(value);\n          break;\n        case \"LJ\":\n          this.setLineJoin(value);\n          break;\n        case \"ML\":\n          this.setMiterLimit(value);\n          break;\n        case \"D\":\n          this.setDash(value[0], value[1]);\n          break;\n        case \"RI\":\n          this.setRenderingIntent(value);\n          break;\n        case \"FL\":\n          this.setFlatness(value);\n          break;\n        case \"Font\":\n          this.setFont(value);\n          break;\n        case \"CA\":\n          this.setStrokeAlpha(value);\n          break;\n        case \"ca\":\n          this.setFillAlpha(value);\n          break;\n        default:\n          warn(`Unimplemented graphic state operator ${key}`);\n          break;\n      }\n    }\n  }\n\n  fill() {\n    const current = this.current;\n    if (current.element) {\n      current.element.setAttributeNS(null, \"fill\", current.fillColor);\n      current.element.setAttributeNS(null, \"fill-opacity\", current.fillAlpha);\n      this.endPath();\n    }\n  }\n\n  stroke() {\n    const current = this.current;\n    if (current.element) {\n      this._setStrokeAttributes(current.element);\n      current.element.setAttributeNS(null, \"fill\", \"none\");\n      this.endPath();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _setStrokeAttributes(element, lineWidthScale = 1) {\n    const current = this.current;\n    let dashArray = current.dashArray;\n    if (lineWidthScale !== 1 && dashArray.length > 0) {\n      dashArray = dashArray.map(function (value) {\n        return lineWidthScale * value;\n      });\n    }\n    element.setAttributeNS(null, \"stroke\", current.strokeColor);\n    element.setAttributeNS(null, \"stroke-opacity\", current.strokeAlpha);\n    element.setAttributeNS(null, \"stroke-miterlimit\", pf(current.miterLimit));\n    element.setAttributeNS(null, \"stroke-linecap\", current.lineCap);\n    element.setAttributeNS(null, \"stroke-linejoin\", current.lineJoin);\n    element.setAttributeNS(\n      null,\n      \"stroke-width\",\n      pf(lineWidthScale * current.lineWidth) + \"px\"\n    );\n    element.setAttributeNS(\n      null,\n      \"stroke-dasharray\",\n      dashArray.map(pf).join(\" \")\n    );\n    element.setAttributeNS(\n      null,\n      \"stroke-dashoffset\",\n      pf(lineWidthScale * current.dashPhase) + \"px\"\n    );\n  }\n\n  eoFill() {\n    this.current.element?.setAttributeNS(null, \"fill-rule\", \"evenodd\");\n    this.fill();\n  }\n\n  fillStroke() {\n    // Order is important since stroke wants fill to be none.\n    // First stroke, then if fill needed, it will be overwritten.\n    this.stroke();\n    this.fill();\n  }\n\n  eoFillStroke() {\n    this.current.element?.setAttributeNS(null, \"fill-rule\", \"evenodd\");\n    this.fillStroke();\n  }\n\n  closeStroke() {\n    this.closePath();\n    this.stroke();\n  }\n\n  closeFillStroke() {\n    this.closePath();\n    this.fillStroke();\n  }\n\n  closeEOFillStroke() {\n    this.closePath();\n    this.eoFillStroke();\n  }\n\n  paintSolidColorImageMask() {\n    const rect = this.svgFactory.createElement(\"svg:rect\");\n    rect.setAttributeNS(null, \"x\", \"0\");\n    rect.setAttributeNS(null, \"y\", \"0\");\n    rect.setAttributeNS(null, \"width\", \"1px\");\n    rect.setAttributeNS(null, \"height\", \"1px\");\n    rect.setAttributeNS(null, \"fill\", this.current.fillColor);\n\n    this._ensureTransformGroup().append(rect);\n  }\n\n  paintImageXObject(objId) {\n    const imgData = this.getObject(objId);\n    if (!imgData) {\n      warn(`Dependent image with object ID ${objId} is not ready yet`);\n      return;\n    }\n    this.paintInlineImageXObject(imgData);\n  }\n\n  paintInlineImageXObject(imgData, mask) {\n    const width = imgData.width;\n    const height = imgData.height;\n\n    const imgSrc = convertImgDataToPng(imgData, this.forceDataSchema, !!mask);\n    const cliprect = this.svgFactory.createElement(\"svg:rect\");\n    cliprect.setAttributeNS(null, \"x\", \"0\");\n    cliprect.setAttributeNS(null, \"y\", \"0\");\n    cliprect.setAttributeNS(null, \"width\", pf(width));\n    cliprect.setAttributeNS(null, \"height\", pf(height));\n    this.current.element = cliprect;\n    this.clip(\"nonzero\");\n\n    const imgEl = this.svgFactory.createElement(\"svg:image\");\n    imgEl.setAttributeNS(XLINK_NS, \"xlink:href\", imgSrc);\n    imgEl.setAttributeNS(null, \"x\", \"0\");\n    imgEl.setAttributeNS(null, \"y\", pf(-height));\n    imgEl.setAttributeNS(null, \"width\", pf(width) + \"px\");\n    imgEl.setAttributeNS(null, \"height\", pf(height) + \"px\");\n    imgEl.setAttributeNS(\n      null,\n      \"transform\",\n      `scale(${pf(1 / width)} ${pf(-1 / height)})`\n    );\n    if (mask) {\n      mask.append(imgEl);\n    } else {\n      this._ensureTransformGroup().append(imgEl);\n    }\n  }\n\n  paintImageMaskXObject(img) {\n    const imgData = this.getObject(img.data, img);\n    if (imgData.bitmap) {\n      warn(\n        \"paintImageMaskXObject: ImageBitmap support is not implemented, \" +\n          \"ensure that the `isOffscreenCanvasSupported` API parameter is disabled.\"\n      );\n      return;\n    }\n    const current = this.current;\n    const width = imgData.width;\n    const height = imgData.height;\n    const fillColor = current.fillColor;\n\n    current.maskId = `mask${maskCount++}`;\n    const mask = this.svgFactory.createElement(\"svg:mask\");\n    mask.setAttributeNS(null, \"id\", current.maskId);\n\n    const rect = this.svgFactory.createElement(\"svg:rect\");\n    rect.setAttributeNS(null, \"x\", \"0\");\n    rect.setAttributeNS(null, \"y\", \"0\");\n    rect.setAttributeNS(null, \"width\", pf(width));\n    rect.setAttributeNS(null, \"height\", pf(height));\n    rect.setAttributeNS(null, \"fill\", fillColor);\n    rect.setAttributeNS(null, \"mask\", `url(#${current.maskId})`);\n\n    this.defs.append(mask);\n    this._ensureTransformGroup().append(rect);\n\n    this.paintInlineImageXObject(imgData, mask);\n  }\n\n  paintFormXObjectBegin(matrix, bbox) {\n    if (Array.isArray(matrix) && matrix.length === 6) {\n      this.transform(\n        matrix[0],\n        matrix[1],\n        matrix[2],\n        matrix[3],\n        matrix[4],\n        matrix[5]\n      );\n    }\n\n    if (bbox) {\n      const width = bbox[2] - bbox[0];\n      const height = bbox[3] - bbox[1];\n\n      const cliprect = this.svgFactory.createElement(\"svg:rect\");\n      cliprect.setAttributeNS(null, \"x\", bbox[0]);\n      cliprect.setAttributeNS(null, \"y\", bbox[1]);\n      cliprect.setAttributeNS(null, \"width\", pf(width));\n      cliprect.setAttributeNS(null, \"height\", pf(height));\n      this.current.element = cliprect;\n      this.clip(\"nonzero\");\n      this.endPath();\n    }\n  }\n\n  paintFormXObjectEnd() {}\n\n  /**\n   * @private\n   */\n  _initialize(viewport) {\n    const svg = this.svgFactory.create(viewport.width, viewport.height);\n\n    // Create the definitions element.\n    const definitions = this.svgFactory.createElement(\"svg:defs\");\n    svg.append(definitions);\n    this.defs = definitions;\n\n    // Create the root group element, which acts a container for all other\n    // groups and applies the viewport transform.\n    const rootGroup = this.svgFactory.createElement(\"svg:g\");\n    rootGroup.setAttributeNS(null, \"transform\", pm(viewport.transform));\n    svg.append(rootGroup);\n\n    // For the construction of the SVG image we are only interested in the\n    // root group, so we expose it as the entry point of the SVG image for\n    // the other code in this class.\n    this.svg = rootGroup;\n\n    return svg;\n  }\n\n  /**\n   * @private\n   */\n  _ensureClipGroup() {\n    if (!this.current.clipGroup) {\n      const clipGroup = this.svgFactory.createElement(\"svg:g\");\n      clipGroup.setAttributeNS(null, \"clip-path\", this.current.activeClipUrl);\n      this.svg.append(clipGroup);\n      this.current.clipGroup = clipGroup;\n    }\n    return this.current.clipGroup;\n  }\n\n  /**\n   * @private\n   */\n  _ensureTransformGroup() {\n    if (!this.tgrp) {\n      this.tgrp = this.svgFactory.createElement(\"svg:g\");\n      this.tgrp.setAttributeNS(null, \"transform\", pm(this.transformMatrix));\n      if (this.current.activeClipUrl) {\n        this._ensureClipGroup().append(this.tgrp);\n      } else {\n        this.svg.append(this.tgrp);\n      }\n    }\n    return this.tgrp;\n  }\n}\n\nexport { SVGGraphics };\n", "// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __w_pdfjs_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __w_pdfjs_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n", "/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./display/api\").OnProgressParameters} OnProgressParameters */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./display/api\").PDFDocumentLoadingTask} PDFDocumentLoadingTask */\n/** @typedef {import(\"./display/api\").PDFDocumentProxy} PDFDocumentProxy */\n/** @typedef {import(\"./display/api\").PDFPageProxy} PDFPageProxy */\n/** @typedef {import(\"./display/api\").RenderTask} RenderTask */\n/** @typedef {import(\"./display/display_utils\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./display/text_layer\").TextLayerRenderTask} TextLayerRenderTask */\n\nimport {\n  AbortException,\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  AnnotationMode,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  FeatureTest,\n  ImageKind,\n  InvalidPDFException,\n  MissingPDFException,\n  normalizeUnicode,\n  OPS,\n  PasswordResponses,\n  PermissionFlag,\n  PromiseCapability,\n  shadow,\n  UnexpectedResponseException,\n  Util,\n  VerbosityLevel,\n} from \"./shared/util.js\";\nimport {\n  build,\n  getDocument,\n  PDFDataRangeTransport,\n  PDFWorker,\n  version,\n} from \"./display/api.js\";\nimport {\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl,\n  getXfaPageViewport,\n  isDataScheme,\n  isPdfFile,\n  loadScript,\n  PDFDateString,\n  PixelsPerInch,\n  RenderingCancelledException,\n  setLayerDimensions,\n} from \"./display/display_utils.js\";\nimport { renderTextLayer, updateTextLayer } from \"./display/text_layer.js\";\nimport { AnnotationEditorLayer } from \"./display/editor/annotation_editor_layer.js\";\nimport { AnnotationEditorUIManager } from \"./display/editor/tools.js\";\nimport { AnnotationLayer } from \"./display/annotation_layer.js\";\nimport { GlobalWorkerOptions } from \"./display/worker_options.js\";\nimport { XfaLayer } from \"./display/xfa_layer.js\";\n\n/* eslint-disable-next-line no-unused-vars */\nconst pdfjsVersion =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_VERSION\") : void 0;\n/* eslint-disable-next-line no-unused-vars */\nconst pdfjsBuild =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_BUILD\") : void 0;\n\nconst SVGGraphics =\n  typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"GENERIC\")\n    ? require(\"./display/svg.js\").SVGGraphics\n    : null;\n\nexport {\n  AbortException,\n  AnnotationEditorLayer,\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  AnnotationEditorUIManager,\n  AnnotationLayer,\n  AnnotationMode,\n  build,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  FeatureTest,\n  getDocument,\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl,\n  getXfaPageViewport,\n  GlobalWorkerOptions,\n  ImageKind,\n  InvalidPDFException,\n  isDataScheme,\n  isPdfFile,\n  loadScript,\n  MissingPDFException,\n  normalizeUnicode,\n  OPS,\n  PasswordResponses,\n  PDFDataRangeTransport,\n  PDFDateString,\n  PDFWorker,\n  PermissionFlag,\n  PixelsPerInch,\n  PromiseCapability,\n  RenderingCancelledException,\n  renderTextLayer,\n  setLayerDimensions,\n  shadow,\n  SVGGraphics,\n  UnexpectedResponseException,\n  updateTextLayer,\n  Util,\n  VerbosityLevel,\n  version,\n  XfaLayer,\n};\n"],
  "mappings": "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",
  "names": ["exports", "module", "exports", "module", "exports", "module", "exports", "module", "exports", "module", "IDENTITY_MATRIX", "exports", "FONT_IDENTITY_MATRIX", "MAX_IMAGE_SIZE_TO_CACHE", "LINE_FACTOR", "LINE_DESCENT_FACTOR", "BASELINE_FACTOR", "RenderingIntentFlag", "ANY", "DISPLAY", "PRINT", "SAVE", "ANNOTATIONS_FORMS", "ANNOTATIONS_STORAGE", "ANNOTATIONS_DISABLE", "OPLIST", "AnnotationMode", "DISABLE", "ENABLE", "ENABLE_FORMS", "ENABLE_STORAGE", "AnnotationEditorPrefix", "AnnotationEditorType", "NONE", "FREETEXT", "STAMP", "INK", "AnnotationEditorParamsType", "FREETEXT_SIZE", "FREETEXT_COLOR", "FREETEXT_OPACITY", "INK_COLOR", "INK_THICKNESS", "INK_OPACITY", "PermissionFlag", "MODIFY_CONTENTS", "COPY", "MODIFY_ANNOTATIONS", "FILL_INTERACTIVE_FORMS", "COPY_FOR_ACCESSIBILITY", "ASSEMBLE", "PRINT_HIGH_QUALITY", "TextRenderingMode", "FILL", "STROKE", "FILL_STROKE", "INVISIBLE", "FILL_ADD_TO_PATH", "STROKE_ADD_TO_PATH", "FILL_STROKE_ADD_TO_PATH", "ADD_TO_PATH", "FILL_STROKE_MASK", "ADD_TO_PATH_FLAG", "ImageKind", "GRAYSCALE_1BPP", "RGB_24BPP", "RGBA_32BPP", "AnnotationType", "TEXT", "LINK", "LINE", "SQUARE", "CIRCLE", "POLYGON", "POLYLINE", "HIGHLIGHT", "UNDERLINE", "SQUIGGLY", "STRIKEOUT", "CARET", "POPUP", "FILEATTACHMENT", "SOUND", "MOVIE", "WIDGET", "SCREEN", "PRINTERMARK", "TRAPNET", "WATERMARK", "THREED", "REDACT", "AnnotationReplyType", "GROUP", "REPLY", "AnnotationFlag", "HIDDEN", "NOZOOM", "NOROTATE", "NOVIEW", "READONLY", "LOCKED", "TOGGLENOVIEW", "LOCKEDCONTENTS", "AnnotationFieldFlag", "REQUIRED", "NOEXPORT", "MULTILINE", "PASSWORD", "NOTOGGLETOOFF", "RADIO", "PUSHBUTTON", "COMBO", "EDIT", "SORT", "FILESELECT", "MULTISELECT", "DONOTSPELLCHECK", "DONOTSCROLL", "COMB", "RICHTEXT", "RADIOSINUNISON", "COMMITONSELCHANGE", "AnnotationBorderStyleType", "SOLID", "DASHED", "BEVELED", "INSET", "AnnotationActionEventType", "E", "X", "D", "U", "Fo", "Bl", "PO", "PC", "PV", "PI", "K", "F", "V", "C", "DocumentActionEventType", "WC", "WS", "DS", "WP", "DP", "PageActionEventType", "O", "VerbosityLevel", "ERRORS", "WARNINGS", "INFOS", "CMapCompressionType", "BINARY", "OPS", "dependency", "setLineWidth", "setLineCap", "setLineJoin", "setMiterLimit", "setDash", "setRenderingIntent", "setFlatness", "setGState", "save", "restore", "transform", "moveTo", "lineTo", "curveTo", "curveTo2", "curveTo3", "closePath", "rectangle", "stroke", "closeStroke", "fill", "eoFill", "fillStroke", "eoFillStroke", "closeFillStroke", "closeEOFillStroke", "endPath", "clip", "eoClip", "beginText", "endText", "setCharSpacing", "setWordSpacing", "setHScale", "setLeading", "setFont", "setTextRenderingMode", "setTextRise", "moveText", "setLeadingMoveText", "setTextMatrix", "nextLine", "showText", "showSpacedText", "nextLineShowText", "nextLineSetSpacingShowText", "setCharWidth", "setCharWidthAndBounds", "setStrokeColorSpace", "setFillColorSpace", "setStrokeColor", "setStrokeColorN", "setFillColor", "setFillColorN", "setStrokeGray", "setFillGray", "setStrokeRGBColor", "setFillRGBColor", "setStrokeCMYKColor", "setFillCMYKColor", "shadingFill", "beginInlineImage", "beginImageData", "endInlineImage", "paintXObject", "markPoint", "markPointProps", "beginMarkedContent", "beginMarkedContentProps", "endMarkedContent", "beginCompat", "endCompat", "paintFormXObjectBegin", "paintFormXObjectEnd", "beginGroup", "endGroup", "beginAnnotation", "endAnnotation", "paintImageMaskXObject", "paintImageMaskXObjectGroup", "paintImageXObject", "paintInlineImageXObject", "paintInlineImageXObjectGroup", "paintImageXObjectRepeat", "paintImageMaskXObjectRepeat", "paintSolidColorImageMask", "constructPath", "PasswordResponses", "NEED_PASSWORD", "INCORRECT_PASSWORD", "verbosity", "setVerbosityLevel", "level", "Number", "isInteger", "getVerbosityLevel", "info", "msg", "console", "log", "warn", "unreachable", "Error", "assert", "cond", "_isValidProtocol", "url", "protocol", "createValidAbsoluteUrl", "baseUrl", "options", "addDefaultProtocol", "startsWith", "dots", "match", "length", "tryConvertEncoding", "stringToUTF8String", "absoluteUrl", "URL", "shadow", "obj", "prop", "value", "nonSerializable", "Object", "defineProperty", "enumerable", "configurable", "writable", "BaseException", "BaseExceptionClosure", "message", "name", "constructor", "prototype", "PasswordException", "code", "UnknownErrorException", "details", "InvalidPDFException", "MissingPDFException", "UnexpectedResponseException", "status", "FormatError", "AbortException", "bytesToString", "bytes", "undefined", "MAX_ARGUMENT_COUNT", "String", "fromCharCode", "apply", "strBuf", "i", "chunkEnd", "Math", "min", "chunk", "subarray", "push", "join", "stringToBytes", "str", "Uint8Array", "charCodeAt", "string32", "objectSize", "keys", "objectFromMap", "map", "create", "key", "isLittleEndian", "buffer8", "view32", "Uint32Array", "buffer", "isEvalSupported", "Function", "FeatureTest", "isOffscreenCanvasSupported", "OffscreenCanvas", "platform", "navigator", "isWin", "isMac", "includes", "hexNumbers", "Array", "n", "toString", "padStart", "Util", "makeHexColor", "r", "g", "b", "scaleMinMax", "minMax", "temp", "m1", "m2", "applyTransform", "p", "m", "xt", "yt", "applyInverseTransform", "d", "getAxialAlignedBoundingBox", "p1", "p2", "slice", "p3", "p4", "max", "inverseTransform", "singularValueDecompose2dScale", "transpose", "a", "c", "first", "second", "sqrt", "sx", "sy", "normalizeRect", "rect", "intersect", "rect1", "rect2", "xLow", "xHigh", "yLow", "yHigh", "bezierBoundingBox", "x0", "y0", "x1", "y1", "x2", "y2", "x3", "y3", "tvalues", "bounds", "t", "t1", "t2", "b2ac", "sqrtb2ac", "abs", "j", "mt", "jlen", "PDFStringTranslateTable", "stringToPDFString", "encoding", "decoder", "TextDecoder", "fatal", "decode", "ex", "ii", "charAt", "decodeURIComponent", "escape", "utf8StringToString", "unescape", "encodeURIComponent", "isArrayBuffer", "v", "byteLength", "isArrayEqual", "arr1", "arr2", "getModificationDate", "date", "Date", "getUTCFullYear", "getUTCMonth", "getUTCDate", "getUTCHours", "getUTCMinutes", "getUTCSeconds", "PromiseCapability", "promise", "Promise", "resolve", "reject", "data", "reason", "settled", "NormalizeRegex", "NormalizationMap", "normalizeUnicode", "Map", "replaceAll", "_", "normalize", "get", "_util", "require", "_annotation_storage", "_display_utils", "_font_loader", "_canvas", "_worker_options", "_is_node", "_message_handler", "_metadata", "_optional_content_config", "_transport_stream", "_xfa_text", "DEFAULT_RANGE_CHUNK_SIZE", "RENDERING_CANCELLED_TIMEOUT", "DELAYED_CLEANUP_TIMEOUT", "DefaultCanvasFactory", "isNodeJS", "DOMCanvasFactory", "DefaultCMapReaderFactory", "DOMCMapReaderFactory", "DefaultFilterFactory", "DOMFilterFactory", "DefaultStandardFontDataFactory", "DOMStandardFontDataFactory", "createPDFNetworkStream", "PDFNodeStream", "params", "PDFNetworkStream", "PDFFetchStream", "isValidFetchUrl", "getDocument", "src", "range", "task", "PDFDocumentLoadingTask", "docId", "getUrlProp", "getDataProp", "httpHeaders", "withCredentials", "password", "rangeTransport", "PDFDataRangeTransport", "rangeChunkSize", "worker", "PDFWorker", "docBaseUrl", "isDataScheme", "cMapUrl", "cMapPacked", "CMapReaderFactory", "standardFontDataUrl", "StandardFontDataFactory", "ignoreErrors", "stopAtErrors", "maxImageSize", "canvasMaxAreaInBytes", "disableFontFace", "fontExtraProperties", "enableXfa", "ownerDocument", "globalThis", "document", "disableRange", "disableStream", "disableAutoFetch", "pdfBug", "NaN", "useSystemFonts", "useWorkerFetch", "baseURI", "canvasFactory", "filterFactory", "styleElement", "transportFactory", "cMapReaderFactory", "isCompressed", "standardFontDataFactory", "workerParams", "port", "GlobalWorkerOptions", "workerPort", "fromPort", "_worker", "fetchDocParams", "apiVersion", "evaluatorOptions", "transportParams", "then", "destroyed", "workerIdPromise", "_fetchDocument", "networkStreamPromise", "networkStream", "PDFDataTransportStream", "initialData", "progressiveDone", "contentDispositionFilename", "all", "workerId", "messageHandler", "MessageHandler", "transport", "WorkerTransport", "_transport", "send", "catch", "_capability", "source", "sendWithPromise", "val", "href", "window", "location", "Buffer", "isNaN", "onPassword", "onProgress", "destroy", "_a", "_rangeListeners", "_progressListeners", "_progressiveReadListeners", "_progressiveDoneListeners", "_readyCapability", "addRangeListener", "listener", "addProgressListener", "addProgressiveReadListener", "addProgressiveDoneListener", "onDataRange", "begin", "onDataProgress", "loaded", "total", "onDataProgressiveRead", "onDataProgressiveDone", "transportReady", "requestDataRange", "end", "abort", "PDFDocumentProxy", "pdfInfo", "_pdfInfo", "annotationStorage", "numPages", "fingerprints", "isPureXfa", "_htmlForXfa", "allXfaHtml", "getPage", "pageNumber", "getPageIndex", "ref", "getDestinations", "getDestination", "id", "getPageLabels", "getPageLayout", "getPageMode", "getViewerPreferences", "getOpenAction", "getAttachments", "getJavaScript", "getJSActions", "getDocJSActions", "getOutline", "getOptionalContentConfig", "getPermissions", "getMetadata", "getMarkInfo", "getData", "saveDocument", "getDownloadInfo", "downloadInfoCapability", "cleanup", "keepLoadedFonts", "startCleanup", "loadingTask", "loadingParams", "getFieldObjects", "hasJSActions", "getCalculationOrderIds", "PDFPageProxy", "pageIndex", "pageInfo", "_pageIndex", "_pageInfo", "_stats", "StatTimer", "_pdfBug", "commonObjs", "objs", "PDFObjects", "_maybeCleanupAfterRender", "_intentStates", "rotate", "userUnit", "view", "getViewport", "scale", "rotation", "offsetX", "offsetY", "dontFlip", "PageViewport", "viewBox", "getAnnotations", "intent", "intentArgs", "getRenderingIntent", "renderingIntent", "getPageJSActions", "getXfa", "children", "render", "canvasContext", "viewport", "annotationMode", "background", "optionalContentConfigPromise", "annotationCanvasMap", "pageColors", "printAnnotationStorage", "time", "intentState", "cacheKey", "set", "streamReaderCancelTimeout", "clearTimeout", "intentPrint", "displayReadyCapability", "operatorList", "fnArray", "argsArray", "lastChunk", "separateAnnots", "_pumpOperatorList", "complete", "error", "renderTasks", "delete", "internalRenderTask", "capability", "_abortOperatorList", "timeEnd", "_b", "InternalRenderTask", "callback", "useRequestAnimationFrame", "Set", "add", "renderTask", "transparency", "optionalContentConfig", "initializeGraphics", "operatorListChanged", "getOperatorList", "opListReadCapability", "opListTask", "streamTextContent", "includeMarkedContent", "disableNormalization", "TEXT_CONTENT_CHUNK_SIZE", "sendWithStream", "highWaterMark", "size", "textContent", "items", "getTextContent", "xfa", "XfaText", "readableStream", "pump", "reader", "read", "done", "assign", "styles", "getReader", "getStructTree", "_destroy", "waitOn", "values", "force", "completed", "cancel", "clear", "resetStats", "success", "_startRenderPage", "_renderPageChunk", "operatorListChunk", "annotationStorageSerializable", "transfers", "streamReader", "RenderingCancelledException", "delay", "extraDelay", "setTimeout", "curCacheKey", "curIntentState", "stats", "tryCleanup", "delayed", "abortDelayedCleanup", "LoopbackPort", "postMessage", "transfer", "event", "structuredClone", "call", "addEventListener", "removeEventListener", "terminate", "PDFWorkerUtil", "isWorkerDisabled", "fallbackWorkerSrc", "fakeWorkerId", "__non_webpack_require__", "pdfjsFilePath", "currentScript", "replace", "isSameOrigin", "otherUrl", "base", "origin", "other", "createCDNWrapper", "wrapper", "createObjectURL", "Blob", "has", "_port", "_webWorker", "_messageHandler", "_initializeFromPort", "_initialize", "on", "_mainThreadWorkerMessageHandler", "workerSrc", "Worker", "terminateEarly", "onWorkerError", "_setupFakeWorker", "sendTest", "testObj", "_setupFakeWorkerGlobal", "WorkerMessageHandler", "workerHandler", "setup", "deprecated", "pdfjsWorker", "loader", "mainWorkerMessageHandler", "eval", "loadScript", "WeakMap", "factory", "fontLoader", "FontLoader", "_params", "destroyCapability", "_passwordCapability", "_networkStream", "_fullReader", "_lastProgress", "setupMessageHandler", "AnnotationStorage", "isOpList", "SerializableEmpty", "PrintAnnotationStorage", "serializable", "hash", "page", "hasOwnProperty", "resetModified", "terminated", "cancelAllRequests", "sink", "getFullReader", "evt", "onPull", "close", "ArrayBuffer", "enqueue", "onCancel", "ready", "readyReason", "headersCapability", "fullReader", "headersReady", "isStreamingSupported", "isRangeSupported", "contentLength", "rangeReader", "getRangeReader", "_numPages", "htmlForXfa", "exception", "updatePassword", "type", "exportedData", "exportedError", "inspectFont", "FontInspector", "enabled", "font", "fontAdded", "FontFaceObject", "bind", "finally", "imageData", "pageProxy", "bitmap", "width", "height", "fetch", "filename", "cachedPromise", "num", "gen", "results", "OptionalContentConfig", "metadata", "Metadata", "cleanupSuccessful", "cacheSimpleMethod", "objId", "ensureObj", "RenderTask", "onContinue", "form", "canvas", "operatorListIdx", "running", "graphicsReadyCallback", "graphicsReady", "_useRequestAnimationFrame", "cancelled", "_cancelBound", "_continueBound", "_continue", "_scheduleNextBound", "_scheduleNext", "_nextBound", "_next", "StepperManager", "stepper", "init", "nextBreakPoint", "getNextBreakPoint", "gfx", "CanvasGraphics", "beginDrawing", "endDrawing", "updateOperatorList", "requestAnimationFrame", "executeOperatorList", "WeakSet", "version", "build", "_editor", "_murmurhash", "freeze", "onSetModified", "onResetModified", "onAnnotationEditor", "getValue", "defaultValue", "getRawValue", "remove", "AnnotationEditor", "setValue", "modified", "entry", "entries", "_type", "getAll", "setAll", "print", "MurmurHash3_64", "serialized", "serialize", "update", "JSON", "stringify", "hexdigest", "setModified", "parent", "clone", "_tools", "parameters", "focusin", "focusout", "_uiManager", "_zIndex", "div", "uiManager", "annotationElementId", "rawDims", "pageWidth", "pageHeight", "pageX", "pageY", "pageRotation", "viewParameters", "pageDimensions", "pageTranslation", "parentDimensions", "x", "y", "isAttachedToDOM", "deleted", "_defaultLineColor", "_colorManager", "getHexCode", "deleteAnnotationElement", "editor", "fakeEditor", "FakeEditor", "getNextId", "addToAnnotationStorage", "addCommands", "currentLayer", "setInBackground", "style", "zIndex", "setInForeground", "setParent", "setSelected", "target", "relatedTarget", "closest", "preventDefault", "isMultipleSelection", "commitOrRemove", "isEmpty", "commit", "dragstart", "getBoundingClientRect", "startX", "clientX", "startY", "clientY", "dataTransfer", "setData", "effectAllowed", "setAt", "tx", "ty", "screenToPageTranslation", "left", "top", "translate", "parentRotation", "parentScale", "realScale", "setDims", "parentWidth", "parentHeight", "fixDims", "widthPercent", "endsWith", "heightPercent", "parseFloat", "getInitialTranslation", "createElement", "setAttribute", "className", "bindEvents", "pointerdown", "button", "ctrlKey", "shiftKey", "metaKey", "toggleSelected", "getRect", "shiftX", "shiftY", "getRectInCurrentCoords", "onceAdded", "enableEditMode", "disableEditMode", "isInEditMode", "shouldGetKeyboardEvents", "needsToBeRebuilt", "rebuild", "_isForCopying", "deserialize", "select", "classList", "unselect", "updateParams", "disableEditing", "enableEditing", "propertiesToUpdate", "contentDiv", "isEditing", "setActiveEditor", "ColorManager", "element", "names", "opacityToHex", "opacity", "round", "IdManager", "getId", "CommandManager", "maxSize", "cmd", "undo", "mustExec", "overwriteIfSameType", "keepUndo", "next", "splice", "redo", "hasSomethingToUndo", "hasSomethingToRedo", "KeyboardManager", "callbacks", "allKeys", "bubbles", "isMacKey", "split", "at", "exec", "self", "stopPropagation", "altKey", "_colors", "colors", "getColorValues", "convert", "color", "rgb", "getRGB", "matchMedia", "matches", "RGB", "every", "_colorsMapping", "AnnotationEditorUIManager", "container", "eventBus", "copy", "cut", "paste", "keydown", "onEditingAction", "onPageChanging", "onScaleChanging", "onRotationChanging", "hasSelectedEditor", "_on", "PixelsPerInch", "PDF_TO_CSS_UNITS", "_keyboardManager", "selectAll", "unselectAll", "_off", "layer", "focusMainContainer", "focus", "addShouldRescale", "removeShouldRescale", "pagesRotation", "hasSelection", "editors", "clipboardData", "parse", "isArray", "newEditors", "deserializedEditor", "getActive", "setEditingState", "registerEditorTypes", "types", "editorType", "defaultPropertiesToUpdate", "currentPageIndex", "addLayer", "enable", "disable", "removeLayer", "updateMode", "mode", "updateToolbar", "dispatch", "updateDefaultParams", "getEditors", "getEditor", "addEditor", "removeEditor", "addDeletedAnnotationElement", "isDeletedAnnotationElement", "removeDeletedAnnotationElement", "ed", "isSelected", "isActive", "getMode", "addKeyboardManager", "removeKeyboardManager", "addCopyPasteListeners", "removeCopyPasteListeners", "dispatchUpdateStates", "hasChanged", "some", "dispatchUpdateUI", "enableAll", "disableAll", "addEditorToLayer", "addOrRebuild", "selectEditors", "_base_factory", "SVG_NS", "AnnotationPrefix", "CSS", "PDF", "BaseFilterFactory", "addFilter", "maps", "tableR", "tableG", "tableB", "mapR", "mapG", "mapB", "bufferR", "bufferG", "bufferB", "filter", "addHCMFilter", "fgColor", "bgColor", "fgRGB", "bgRGB", "table", "getSteps", "start", "arr", "addHighlightHCMFilter", "newFgColor", "newBgColor", "fgGray", "bgGray", "newFgRGB", "newBgRGB", "fg", "bg", "step", "newStart", "newStep", "prev", "k", "keepHCM", "parentNode", "cache", "defs", "visibility", "contain", "position", "svg", "createElementNS", "append", "body", "addGrayConversion", "feColorMatrix", "createFilter", "appendFeFunc", "feComponentTransfer", "func", "feFunc", "addTransferMapConversion", "rTable", "gTable", "bTable", "getComputedStyle", "getPropertyValue", "BaseCanvasFactory", "_document", "_createCanvas", "fetchData", "asTypedArray", "response", "ok", "statusText", "arrayBuffer", "text", "request", "XMLHttpRequest", "open", "responseType", "onreadystatechange", "readyState", "DONE", "responseText", "BaseCMapReaderFactory", "_fetchData", "compressionType", "cMapData", "BaseStandardFontDataFactory", "DOMSVGFactory", "BaseSVGFactory", "_createSVG", "centerX", "centerY", "rotateA", "rotateB", "rotateC", "rotateD", "offsetCanvasX", "offsetCanvasY", "convertToViewportPoint", "convertToViewportRectangle", "topLeft", "bottomRight", "convertToPdfPoint", "trim", "substring", "toLowerCase", "isPdfFile", "test", "getFilenameFromUrl", "onlyStripPath", "lastIndexOf", "getPdfFilenameFromUrl", "defaultFilename", "reURI", "reFilename", "splitURI", "suggestedFilename", "started", "times", "now", "outBuf", "longest", "padEnd", "removeScriptElement", "script", "onload", "onerror", "head", "documentElement", "pdfDateStringRegex", "PDFDateString", "toDateObject", "input", "RegExp", "year", "parseInt", "month", "day", "hour", "minute", "universalTimeRelation", "offsetHour", "offsetMinute", "UTC", "getXfaPageViewport", "xfaPage", "attributes", "colorRGB", "span", "computedColor", "getCurrentTransform", "ctx", "e", "f", "getTransform", "getCurrentTransformInverse", "invertSelf", "setLayerDimensions", "mustFlip", "mustRotate", "widthStr", "heightStr", "context", "getContext", "reset", "canvasAndContext", "skipDimensions", "SEED", "MASK_HIGH", "MASK_LOW", "seed", "h1", "h2", "blockCounts", "tailLength", "dataUint32", "k1", "k2", "C1", "C2", "C1_LOW", "C2_LOW", "nativeFontFaces", "loadingRequests", "loadTestFontId", "addNativeFontFace", "nativeFontFace", "fonts", "removeNativeFontFace", "insertRule", "rule", "getElementsByTagName", "styleSheet", "sheet", "cssRules", "loadSystemFont", "loadedName", "isFontLoadingAPISupported", "fontFace", "FontFace", "load", "baseFontName", "attached", "missingFile", "systemFontInfo", "createNativeFontFace", "family", "createFontFaceRule", "isSyncFontLoadingSupported", "_queueLoadingCallback", "_prepareFontLoadEvent", "hasFonts", "supported", "userAgent", "completeRequest", "otherRequest", "shift", "_loadTestFont", "testFont", "atob", "int32", "offset", "spliceString", "s", "insert", "chunk1", "chunk2", "called", "isFontReady", "fillText", "getImageData", "COMMENT_OFFSET", "CFF_CHECKSUM_OFFSET", "XXXX_VALUE", "checksum", "btoa", "fontFamily", "translatedData", "compiledGlyphs", "_inspectFont", "cssFontInfo", "css", "weight", "fontWeight", "italicAngle", "mimetype", "getPathGenerator", "character", "cmds", "jsBuf", "current", "args", "process", "versions", "nw", "electron", "_pattern_helper", "_image_utils", "MIN_FONT_SIZE", "MAX_FONT_SIZE", "MAX_GROUP_SIZE", "EXECUTION_TIME", "EXECUTION_STEPS", "MAX_SIZE_TO_COMPILE", "FULL_CHUNK_HEIGHT", "mirrorContextOperations", "destCtx", "_removeMirroring", "__originalSave", "__originalRestore", "__originalRotate", "__originalScale", "__originalTranslate", "__originalTransform", "__originalSetTransform", "setTransform", "__originalResetTransform", "resetTransform", "__originalClip", "__originalMoveTo", "__originalLineTo", "__originalBezierCurveTo", "bezierCurveTo", "__originalRect", "__originalClosePath", "__originalBeginPath", "beginPath", "ctxSave", "ctxRestore", "ctxTranslate", "ctxScale", "ctxTransform", "ctxSetTransform", "ctxResetTransform", "ctxRotate", "angle", "cp1x", "cp1y", "cp2x", "cp2y", "CachedCanvases", "getCanvas", "canvasEntry", "drawImageAtIntegerCoords", "srcImg", "srcX", "srcY", "srcW", "srcH", "destX", "destY", "destW", "destH", "tlX", "rTlX", "tlY", "rTlY", "brX", "rWidth", "brY", "rHeight", "sign", "drawImage", "scaleX", "hypot", "scaleY", "compileType3Glyph", "imgData", "POINT_TO_PROCESS_LIMIT", "POINT_TYPES", "width1", "points", "j0", "lineSize", "pos", "elem", "mask", "count", "sum", "steps", "Int32Array", "path", "Path2D", "p0", "pp", "drawOutline", "CanvasExtraState", "alphaIsShape", "fontSize", "fontSizeScale", "textMatrix", "textMatrixScale", "fontMatrix", "leading", "lineX", "lineY", "charSpacing", "wordSpacing", "textHScale", "textRenderingMode", "textRise", "fillColor", "strokeColor", "patternFill", "fillAlpha", "strokeAlpha", "lineWidth", "activeSMask", "transferMaps", "startNewPathAndClipBox", "clipBox", "setCurrentPoint", "updatePathMinMax", "minX", "minY", "maxX", "maxY", "updateRectMinMax", "updateScalingPathMinMax", "updateCurvePathMinMax", "box", "getPathBoundingBox", "pathType", "PathType", "xStrokePad", "yStrokePad", "updateClipFromPath", "isEmptyClip", "Infinity", "getClippedPathBoundingBox", "putBinaryImageData", "ImageData", "putImageData", "partialChunkHeight", "fullChunks", "totalChunks", "chunkImgData", "createImageData", "srcPos", "destPos", "dest", "thisChunkHeight", "elemsInThisChunk", "kind", "srcLength", "dest32", "dest32DataLength", "fullSrcDiff", "white", "black", "srcDiff", "kEnd", "kEndUnrolled", "srcByte", "putBinaryImageMask", "convertBlackAndWhiteToRGBA", "nonBlackColor", "copyCtxState", "sourceCtx", "properties", "property", "setLineDash", "getLineDash", "lineDashOffset", "resetCtxToDefault", "strokeStyle", "fillStyle", "fillRule", "globalAlpha", "lineCap", "lineJoin", "miterLimit", "globalCompositeOperation", "composeSMaskBackdrop", "r0", "g0", "b0", "alpha", "alpha_", "composeSMaskAlpha", "maskData", "layerData", "transferMap", "composeSMaskLuminosity", "genericComposeSMask", "maskCtx", "layerCtx", "subtype", "backdrop", "layerOffsetX", "layerOffsetY", "maskOffsetX", "maskOffsetY", "hasBackdrop", "composeFn", "PIXELS_TO_PROCESS", "chunkSize", "ceil", "row", "chunkHeight", "composeSMask", "smask", "layerBox", "layerWidth", "layerHeight", "getImageSmoothingEnabled", "interpolate", "fround", "actualScale", "devicePixelRatio", "LINE_CAP_STYLES", "LINE_JOIN_STYLES", "NORMAL_CLIP", "EO_CLIP", "canvasCtx", "markedContentStack", "stateStack", "pendingClip", "pendingEOFill", "res", "xobjs", "groupStack", "processingType3", "baseTransform", "baseTransformStack", "groupLevel", "smaskStack", "smaskCounter", "tempSMask", "suspendedCtx", "contentVisible", "cachedCanvases", "cachedPatterns", "viewportScale", "outputScaleX", "outputScaleY", "_cachedScaleForStroking", "_cachedGetSinglePixelWidth", "_cachedBitmapsMap", "getObject", "fallback", "savedFillStyle", "fillRect", "transparentCanvas", "compositeCtx", "executionStartIdx", "continueCallback", "argsArrayLen", "chunkOperations", "endTime", "fnId", "breakIt", "depObjId", "objsPool", "HTMLCanvasElement", "_scaleImage", "img", "widthScale", "heightScale", "paintWidth", "paintHeight", "tmpCanvasId", "tmpCanvas", "tmpCtx", "newWidth", "newHeight", "floor", "clearRect", "_createMaskCanvas", "isPatternFill", "currentTransform", "scaled", "maskCanvas", "mainKey", "cachedImage", "maskToCanvas", "cord1", "cord2", "drawnWidth", "drawnHeight", "fillCanvas", "fillCtx", "imageSmoothingEnabled", "inverse", "getPattern", "limit", "dashArray", "dashPhase", "flatness", "states", "checkSMaskState", "inSMaskMode", "beginSMaskMode", "endSMaskMode", "cacheId", "scratchCanvas", "compose", "dirtyBox", "old", "pop", "ops", "isScalingMatrix", "minMaxForBezier", "xw", "yh", "consumePath", "rescaleAndStroke", "needRestore", "paths", "pendingTextPaths", "addToPath", "spacing", "fontRefName", "fontObj", "fontDirection", "isType3Font", "typeface", "fallbackName", "bold", "italic", "browserFontSize", "rise", "paintChar", "patternTransform", "fillStrokeMode", "isAddToPathSet", "strokeText", "isFontSubpixelAAEnabled", "glyphs", "showType3Text", "glyphsLength", "vertical", "spacingDir", "defaultVMetrics", "widthAdvanceScale", "simpleFillText", "pattern", "getSinglePixelWidth", "isInvalidPDFjsFont", "chars", "glyph", "unicode", "restoreNeeded", "isSpace", "fontChar", "accent", "scaledX", "scaledY", "vmetric", "vx", "vy", "remeasure", "measuredWidth", "measureText", "characterScaleX", "isInFont", "scaledAccentX", "scaledAccentY", "charWidth", "isTextInvisible", "spacingLength", "charProcOperatorList", "operatorListId", "transformed", "xWidth", "yWidth", "llx", "lly", "urx", "ury", "getColorN_Pattern", "IR", "canvasGraphicsFactory", "createCanvasGraphics", "TilingPattern", "_getPattern", "arguments", "matrix", "getShadingPattern", "SHADING", "inv", "bbox", "group", "currentCtx", "isolated", "knockout", "canvasBounds", "groupCtx", "startTransformInverse", "currentMtx", "hasOwnCanvas", "canvasWidth", "canvasHeight", "annotationCanvas", "savedCtx", "compiled", "skewX", "skewY", "positions", "trans", "images", "image", "w", "h", "applyTransferMapsToCanvas", "applyTransferMapsToBitmap", "imgToPaint", "HTMLElement", "tag", "visible", "isVisible", "isContentVisible", "absDet", "normX", "normY", "getScaleForStroking", "scaledLineWidth", "scaledXLineWidth", "scaledYLineWidth", "baseArea", "saveRestore", "dashes", "restoreInitialState", "drawFilter", "hcmFilterId", "foreground", "savedFilter", "op", "applyBoundingBox", "region", "BaseShadingPattern", "RadialAxialShadingPattern", "_bbox", "_colorStops", "_p0", "_p1", "_r0", "_r1", "_createGradient", "grad", "createLinearGradient", "createRadialGradient", "colorStop", "addColorStop", "owner", "ownerBBox", "createPattern", "domMatrix", "DOMMatrix", "drawTriangle", "c1", "c2", "c3", "coords", "rowSize", "tmp", "c1r", "c1g", "c1b", "c2r", "c2g", "c2b", "c3r", "c3g", "c3b", "xa", "car", "cag", "cab", "xb", "cbr", "cbg", "cbb", "x1_", "x2_", "drawFigure", "figure", "ps", "cs", "verticesPerRow", "rows", "cols", "q", "MeshShadingPattern", "_coords", "_figures", "_bounds", "_background", "_createMeshCanvas", "combinedScale", "backgroundColor", "EXPECTED_SCALE", "MAX_PATTERN_SIZE", "BORDER_SIZE", "boundsWidth", "boundsHeight", "paddedWidth", "paddedHeight", "matrixScale", "temporaryPatternCanvas", "DummyShadingPattern", "PaintType", "COLORED", "UNCOLORED", "xstep", "ystep", "paintType", "tilingType", "createPatternCanvas", "curMatrixScale", "dimx", "getSizeAndScale", "dimy", "graphics", "setFillAndStrokeStyleToContext", "adjustedX0", "adjustedY0", "adjustedX1", "adjustedY1", "clipBbox", "realOutputSize", "bboxWidth", "bboxHeight", "cssColor", "convertToRGBA", "convertRGBToRGBA", "inverseDecode", "zeroMapping", "oneMapping", "widthInSource", "widthRemainder", "len32", "src32", "s1", "s2", "s3", "jj", "grayToRGBA", "CallbackKind", "UNKNOWN", "DATA", "ERROR", "StreamKind", "CANCEL", "CANCEL_COMPLETE", "CLOSE", "ENQUEUE", "PULL", "PULL_COMPLETE", "START_COMPLETE", "wrapReason", "sourceName", "targetName", "comObj", "callbackId", "streamId", "streamSinks", "streamControllers", "callbackCapabilities", "actionHandler", "_onComObjOnMessage", "stream", "action", "cbSourceName", "cbTargetName", "result", "actionName", "handler", "ah", "queueingStrategy", "ReadableStream", "controller", "startCapability", "startCall", "pullCall", "cancelCall", "isClosed", "desiredSize", "pull", "pullCapability", "cancelCapability", "createStreamSink", "streamSink", "isCancelled", "lastDesiredSize", "sinkCapability", "processStreamMessage", "streamController", "deleteStreamController", "allSettled", "parsedData", "rawData", "getRaw", "INTERNAL", "Symbol", "OptionalContentGroup", "_setVisible", "internal", "creator", "order", "groups", "baseState", "off", "getHash", "expression", "policy", "ids", "setVisibility", "hasInitialVisibility", "getOrder", "getGroups", "getGroup", "evaluateVisibilityExpression", "array", "operator", "state", "pdfDataRangeTransport", "_queuedChunks", "_progressiveDone", "_contentDispositionFilename", "_pdfDataRangeTransport", "_isStreamingSupported", "_isRangeSupported", "_contentLength", "_fullRequestReader", "_rangeReaders", "_onReceiveData", "_onProgress", "_onProgressiveDone", "_enqueue", "found", "_begin", "_progressiveDataLength", "_loaded", "_removeRangeReader", "indexOf", "queuedChunks", "PDFDataTransportStreamReader", "PDFDataTransportStreamRangeReader", "_stream", "_done", "_filename", "_requests", "_headersReady", "requestCapability", "_end", "_queuedChunk", "requestsCapability", "output", "walk", "node", "shouldBuildText", "child", "fs", "readFile", "NodeFilterFactory", "NodeCanvasFactory", "Canvas", "createCanvas", "NodeCMapReaderFactory", "NodeStandardFontDataFactory", "_network_utils", "http", "https", "fileUriRegex", "parseUrl", "sourceUrl", "parsedUrl", "host", "isHttp", "isFsUrl", "_rangeRequestReaders", "PDFNodeStreamFsFullReader", "PDFNodeStreamFullReader", "PDFNodeStreamFsRangeReader", "PDFNodeStreamRangeReader", "BaseFullReader", "_url", "_storedError", "_disableRange", "_rangeChunkSize", "_readableStream", "_readCapability", "_headersCapability", "_error", "_setReadableStream", "BaseRangeReader", "createRequestOptions", "headers", "auth", "hostname", "method", "handleResponse", "statusCode", "getResponseHeader", "allowRangeRequests", "suggestedLength", "validateRangeRequestCapabilities", "extractFilenameFromHeader", "_request", "_httpHeaders", "Range", "lstat", "stat", "createReadStream", "_content_disposition", "returnValues", "contentEncoding", "contentDisposition", "getFilenameFromContentDispositionHeader", "createResponseStatusError", "validateResponseStatus", "needsEncodingFixup", "toParamRegExp", "rfc2616unquote", "rfc5987decode", "rfc2047decode", "fixupEncoding", "rfc2231getparam", "attributePattern", "flags", "textdecode", "contentDispositionStr", "iter", "quot", "part", "parts", "quotindex", "extvalue", "encodingend", "langvalue", "charset", "hex", "OK_RESPONSE", "PARTIAL_CONTENT_RESPONSE", "getArrayBuffer", "xhr", "NetworkManager", "currXhrId", "pendingRequests", "requestRange", "listeners", "requestFull", "xhrId", "pendingRequest", "setRequestHeader", "expectedStatus", "onError", "onStateChange", "onprogress", "onHeadersReceived", "onDone", "xhrStatus", "ok_response_on_range_request", "rangeHeader", "getRequestXhr", "isPendingRequest", "abortRequest", "_source", "_manager", "_onRangeRequestReaderClosed", "PDFNetworkStreamFullRequestReader", "PDFNetworkStreamRangeRequestReader", "onClosed", "manager", "_onHeadersReceived", "_onDone", "_onError", "_fullRequestId", "_headersReceivedCapability", "_cachedChunks", "fullRequestXhrId", "fullRequestXhr", "lengthComputable", "_requestId", "_close", "createFetchOptions", "abortController", "signal", "credentials", "redirect", "createHeaders", "Headers", "PDFFetchStreamReader", "PDFFetchStreamRangeReader", "_reader", "_withCredentials", "_abortController", "AbortController", "_headers", "MAX_TEXT_DIVS_TO_RENDER", "DEFAULT_FONT_SIZE", "DEFAULT_FONT_ASCENT", "ascentCache", "getCtx", "getAscent", "cachedAscent", "metrics", "ascent", "fontBoundingBoxAscent", "descent", "fontBoundingBoxDescent", "ratio", "pixels", "appendText", "geom", "textDiv", "textDivProperties", "hasText", "hasEOL", "_textDivs", "_transform", "atan2", "fontName", "fontHeight", "fontAscent", "_isOffscreenCanvasSupported", "sin", "cos", "scaleFactorStr", "divStyle", "_container", "_rootContainer", "_pageWidth", "toFixed", "_pageHeight", "dir", "_fontInspectorEnabled", "dataset", "shouldScaleText", "absScaleX", "absScaleY", "_textDivProperties", "_isReadableStream", "_layoutText", "layout", "prevFontSize", "prevFontFamily", "_canceled", "textDivs", "textDivsLength", "TextLayerRenderTask", "textContentSource", "textContentItemsStr", "_textContentSource", "_textContentItemsStr", "_layoutTextParams", "_processItems", "styleCache", "item", "br", "_render", "renderTextLayer", "textContentStream", "scaleFactor", "updateTextLayer", "mustRescale", "_freetext", "_ink", "AnnotationEditorLayer", "pointerup", "_initialized", "FreeTextEditor", "initialize", "l10n", "InkEditor", "accessibilityManager", "annotationLayer", "addInkEditorIfNeeded", "disableClick", "enableClick", "toggle", "hidden", "isCommitting", "pointerEvents", "annotationElementIds", "editables", "getEditableAnnotations", "editable", "hide", "hiddenAnnotationIds", "getEditableAnnotation", "show", "currentActive", "attach", "detach", "removePointerInTextLayer", "display", "activeElement", "moveEditorInDOM", "moveElementInDOM", "annotationType", "annotationEditorType", "drop", "dropEffect", "endX", "endY", "dragover", "changeParent", "createNewEditor", "createAndAddNewEditor", "_annotation_layer", "editorDivBlur", "editorDivFocus", "editorDivInput", "editorDivKeydown", "_defaultColor", "_defaultFontSize", "_l10nPromise", "_internalPadding", "overlayDiv", "editorDiv", "contentEditable", "draggable", "removeAttribute", "preventScroll", "innerText", "savedText", "newText", "trimEnd", "setText", "dblclick", "baseX", "baseY", "FreeTextAnnotationElement", "defaultAppearanceData", "fontColor", "from", "isForCopying", "padding", "updateFontSize", "setFontsize", "savedFontsize", "updateColor", "savedColor", "extractText", "divs", "setEditorDimensions", "savedDisplay", "setContent", "replaceChildren", "line", "createTextNode", "hasElementChanged", "cheatInitialRect", "_freeTextDefaultContent", "_scripting_utils", "_xfa_layer", "DEFAULT_TAB_INDEX", "GetElementsByNameSet", "getRectDims", "AnnotationElementFactory", "LinkAnnotationElement", "TextAnnotationElement", "fieldType", "TextWidgetAnnotationElement", "radioButton", "RadioButtonWidgetAnnotationElement", "checkBox", "CheckboxWidgetAnnotationElement", "PushButtonWidgetAnnotationElement", "ChoiceWidgetAnnotationElement", "SignatureWidgetAnnotationElement", "WidgetAnnotationElement", "PopupAnnotationElement", "LineAnnotationElement", "SquareAnnotationElement", "CircleAnnotationElement", "PolylineAnnotationElement", "CaretAnnotationElement", "InkAnnotationElement", "PolygonAnnotationElement", "HighlightAnnotationElement", "UnderlineAnnotationElement", "SquigglyAnnotationElement", "StrikeOutAnnotationElement", "StampAnnotationElement", "FileAttachmentAnnotationElement", "AnnotationElement", "isRenderable", "ignoreBorder", "createQuadrilaterals", "linkService", "downloadManager", "imageResourcesPath", "renderForms", "svgFactory", "enableScripting", "_fieldObjects", "fieldObjects", "_createContainer", "quadrilaterals", "_createQuadrilaterals", "popupRef", "noRotate", "setRotation", "borderStyle", "borderWidth", "horizontalRadius", "horizontalCornerRadius", "verticalRadius", "verticalCornerRadius", "radius", "borderRadius", "borderBottomStyle", "borderColor", "elementWidth", "elementHeight", "_commonActions", "setColor", "jsName", "styleName", "detail", "ColorConverters", "userName", "title", "readonly", "required", "_setRequired", "textColor", "_dispatchEventFromSandbox", "actions", "jsEvent", "commonActions", "_setDefaultPropertiesFromJS", "storedData", "eventProxy", "quadPoints", "savedRect", "firstQuadRect", "quadPoint", "_createPopup", "popup", "titleObj", "modificationDate", "contentsObj", "richText", "parentRect", "elements", "_renderQuadrilaterals", "quadrilateral", "_getElementsByName", "skipId", "fields", "fieldObj", "exportValues", "exportValue", "domElement", "querySelector", "getElementsByName", "getAttribute", "maybeShow", "forceHide", "getElementsToTriggerPopup", "addHighlightArea", "triggers", "isTooltipOnly", "link", "isBound", "addLinkAttributes", "newWindow", "_bindNamedAction", "attachment", "_bindAttachment", "setOCGState", "_bindLink", "Action", "_bindJSAction", "resetForm", "_bindResetFormAction", "index", "linkElement", "cloneNode", "destination", "getDestinationHash", "onclick", "goToDestination", "getAnchorUrl", "executeNamedAction", "openOrDownloadData", "content", "otherClickAction", "resetFormFields", "refs", "resetFormRefs", "include", "allFields", "fieldIds", "fieldName", "field", "storage", "allIds", "dispatchEvent", "Event", "setInternalLink", "bindSetOCGState", "executeSetOCGState", "alt", "l10nId", "l10nArgs", "alternativeText", "showElementAndHideCanvas", "previousSibling", "nodeName", "_getKeyModifier", "_setEventListener", "baseName", "eventName", "valueGetter", "modifier", "_setEventListeners", "getter", "_setBackgroundColor", "_setTextStyle", "TEXT_ALIGNMENT", "computedFontSize", "roundToOneDecimal", "multiLine", "numberOfLines", "lineHeight", "textAlignment", "textAlign", "isRequired", "hasAppearance", "fieldValue", "setPropertyOnSiblings", "keyInStorage", "maxLen", "charLimit", "fieldFormattedValues", "formattedValue", "comb", "elementData", "userValue", "lastCommittedValue", "commitKey", "doNotScroll", "overflowY", "overflowX", "disabled", "readOnly", "baseFieldName", "tabIndex", "maxLength", "defaultFieldValue", "blurListener", "scrollLeft", "selRange", "setSelectionRange", "willCommit", "selStart", "selectionStart", "selEnd", "selectionEnd", "_blurListener", "Keystroke", "inputType", "change", "fieldWidth", "combWidth", "letterSpacing", "verticalAlign", "checked", "checkbox", "curChecked", "buttonValue", "radio", "pdfButtonValue", "lastChild", "selectElement", "addAnEmptyEntry", "combo", "multiSelect", "multiple", "option", "selected", "optionElement", "displayValue", "removeEmptyEntry", "noneOptionElement", "prepend", "isExport", "selectedIndex", "selectedValues", "getItems", "multipleSelection", "findIndex", "selectChild", "before", "indices", "changeEx", "keyDown", "PopupElement", "elementIds", "dateObject", "toLocaleDateString", "toLocaleTimeString", "trigger", "flatMap", "baseColor", "outlineColor", "supports", "BACKGROUND_ENLIGHT", "header", "localized", "XfaLayer", "xfaHtml", "html", "contents", "_formatContents", "useParentRect", "normalizedRect", "HORIZONTAL_SPACE_AFTER_ANNOTATION", "popupLeft", "popupTop", "lines", "lineSpan", "lineCoordinates", "square", "circle", "containerClassName", "svgElementName", "coordinate", "vertices", "polyline", "inkList", "inkLists", "file", "_download", "AnnotationLayer", "NullL10n", "annotations", "popupToElements", "elementParams", "noHTML", "isPopupAnnotation", "rendered", "renderedElement", "appendElement", "contentElement", "firstChild", "setAnnotationCanvasMap", "replaceWith", "makeColorComp", "CMYK_G", "G_CMYK", "G_RGB", "G_HTML", "G", "RGB_G", "RGB_HTML", "R", "B", "T_HTML", "CMYK_RGB", "CMYK_HTML", "components", "RGB_CMYK", "setupStorage", "xfaOn", "xfaOff", "setAttributes", "isHTMLAnchorElement", "HTMLAnchorElement", "dataId", "root", "rootHtml", "stack", "rootDiv", "childHtml", "xmlns", "el", "querySelectorAll", "DEFAULT_L10N_STRINGS", "of_pages", "page_of_pages", "document_properties_kb", "document_properties_mb", "document_properties_date_string", "document_properties_page_size_unit_inches", "document_properties_page_size_unit_millimeters", "document_properties_page_size_orientation_portrait", "document_properties_page_size_orientation_landscape", "document_properties_page_size_name_a3", "document_properties_page_size_name_a4", "document_properties_page_size_name_letter", "document_properties_page_size_name_legal", "document_properties_page_size_dimension_string", "document_properties_page_size_dimension_name_string", "document_properties_linearized_yes", "document_properties_linearized_no", "additional_layers", "page_landmark", "thumb_page_title", "thumb_page_canvas", "find_reached_top", "find_reached_bottom", "find_not_found", "page_scale_width", "page_scale_fit", "page_scale_auto", "page_scale_actual", "page_scale_percent", "loading_error", "invalid_file_error", "missing_file_error", "unexpected_response_error", "rendering_error", "annotation_date_string", "printing_not_supported", "printing_not_ready", "web_fonts_disabled", "free_text2_default_content", "editor_free_text2_aria_label", "editor_ink2_aria_label", "editor_ink_canvas_aria_label", "print_progress_percent", "getL10nFallback", "formatL10nValue", "getLanguage", "getDirection", "RESIZER_SIZE", "canvasContextMenu", "canvasPointermove", "canvasPointerleave", "canvasPointerup", "canvasPointerdown", "thickness", "bezierPath2D", "allRawPaths", "currentPath", "translationX", "translationY", "_defaultThickness", "_defaultOpacity", "disconnect", "setDimensions", "roundedWidth", "roundedHeight", "bezier", "p10", "p11", "p20", "p21", "p30", "p31", "path2D", "updateThickness", "savedThickness", "updateOpacity", "savedOpacity", "getInitialBBox", "setStroke", "startDrawing", "draw", "lastX", "lastY", "lastPoint", "stopDrawing", "xy", "drawPoints", "lastPoints", "xMin", "xMax", "yMin", "yMax", "makeBezierCurve", "prevX", "prevY", "generateBezierPoints", "bezierPoints", "control1", "control2", "redraw", "createObserver", "ResizeObserver", "contentRect", "observe", "setCanvasDims", "setScaleFactor", "scaleFactorW", "scaleFactorH", "updateTransform", "buildPath2D", "toPDFCoordinates", "blX", "blY", "trX", "trY", "fromPDFCoordinates", "serializePaths", "p40", "p41", "getBbox", "getPadding", "fitToContent", "firstTime", "prevTranslationX", "prevTranslationY", "unscaledPadding", "setMinDims", "minHeight", "minWidth", "SVG_DEFAULTS", "fontStyle", "XML_NS", "XLINK_NS", "contentType", "forceDataSchema", "digits", "b1", "b2", "b3", "d1", "d2", "d3", "d4", "convertImgDataToPng", "PNG_HEADER", "CHUNK_WRAPPER_SIZE", "crcTable", "crc32", "crc", "writePngChunk", "len", "adler32", "deflateSync", "literals", "deflateSyncUncompressed", "maxBlockLength", "deflateBlocks", "idat", "pi", "adler", "encode", "isMask", "bitDepth", "colorType", "offsetLiterals", "offsetBytes", "ihdr", "pngLength", "SVGExtraState", "dependencies", "activeClipUrl", "clipGroup", "maskId", "opListToTree", "opList", "opTree", "opListElement", "fn", "pf", "pm", "acos", "clipCount", "maskCount", "shadingCount", "SVGGraphics", "transformMatrix", "transformStack", "extraStack", "embedFonts", "embeddedFonts", "cssStyle", "_operatorIdMapping", "tgrp", "executeOpTree", "loadDependencies", "getSVG", "svgElement", "convertOpList", "operatorIdMapping", "opTreeElement", "lineMatrix", "xcoords", "ycoords", "tspan", "setAttributeNS", "txtElement", "txtgrp", "lineWidthScale", "_setStrokeAttributes", "_ensureTransformGroup", "addFontStyle", "hasChildNodes", "setStrokeAlpha", "setFillAlpha", "_makeColorN_Pattern", "_makeShadingPattern", "_makeTilingPattern", "tilingId", "tx0", "ty0", "tx1", "ty1", "xscale", "yscale", "txstep", "tystep", "tiling", "childNodes", "shadingId", "colorStops", "gradient", "point0", "point1", "focalPoint", "circlePoint", "focalRadius", "circleRadius", "stop", "getAttributeNS", "clipId", "clipPath", "clipElement", "imgSrc", "cliprect", "imgEl", "definitions", "rootGroup", "_ensureClipGroup", "module", "_api", "_text_layer", "_annotation_editor_layer", "pdfjsVersion", "pdfjsBuild"]
}
